(()=>{var VQ=Object.create;var bx=Object.defineProperty;var YQ=Object.getOwnPropertyDescriptor;var XQ=Object.getOwnPropertyNames;var KQ=Object.getPrototypeOf,QQ=Object.prototype.hasOwnProperty;var JQ=(e,t,n)=>t in e?bx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ex=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),er=(e,t)=>{for(var n in t)bx(e,n,{get:t[n],enumerable:!0})},ZQ=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of XQ(t))!QQ.call(e,i)&&i!==n&&bx(e,i,{get:()=>t[i],enumerable:!(r=YQ(t,i))||r.enumerable});return e};var D_=(e,t,n)=>(n=e!=null?VQ(KQ(e)):{},ZQ(t||!e||!e.__esModule?bx(n,"default",{value:e,enumerable:!0}):n,e));var Re=(e,t,n)=>JQ(e,typeof t!="symbol"?t+"":t,n);var p3=Ex(vx=>{"use strict";vx.byteLength=tJ;vx.toByteArray=rJ;vx.fromByteArray=sJ;var ks=[],Yi=[],eJ=typeof Uint8Array<"u"?Uint8Array:Array,M_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Yl=0,f3=M_.length;Yl<f3;++Yl)ks[Yl]=M_[Yl],Yi[M_.charCodeAt(Yl)]=Yl;var Yl,f3;Yi[45]=62;Yi[95]=63;function d3(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function tJ(e){var t=d3(e),n=t[0],r=t[1];return(n+r)*3/4-r}function nJ(e,t,n){return(t+n)*3/4-n}function rJ(e){var t,n=d3(e),r=n[0],i=n[1],o=new eJ(nJ(e,r,i)),s=0,a=i>0?r-4:r,u;for(u=0;u<a;u+=4)t=Yi[e.charCodeAt(u)]<<18|Yi[e.charCodeAt(u+1)]<<12|Yi[e.charCodeAt(u+2)]<<6|Yi[e.charCodeAt(u+3)],o[s++]=t>>16&255,o[s++]=t>>8&255,o[s++]=t&255;return i===2&&(t=Yi[e.charCodeAt(u)]<<2|Yi[e.charCodeAt(u+1)]>>4,o[s++]=t&255),i===1&&(t=Yi[e.charCodeAt(u)]<<10|Yi[e.charCodeAt(u+1)]<<4|Yi[e.charCodeAt(u+2)]>>2,o[s++]=t>>8&255,o[s++]=t&255),o}function iJ(e){return ks[e>>18&63]+ks[e>>12&63]+ks[e>>6&63]+ks[e&63]}function oJ(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),i.push(iJ(r));return i.join("")}function sJ(e){for(var t,n=e.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(oJ(e,s,s+o>a?a:s+o));return r===1?(t=e[n-1],i.push(ks[t>>2]+ks[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],i.push(ks[t>>10]+ks[t>>4&63]+ks[t<<2&63]+"=")),i.join("")}});var m3=Ex(N_=>{N_.read=function(e,t,n,r,i){var o,s,a=i*8-r-1,u=(1<<a)-1,l=u>>1,c=-7,f=n?i-1:0,d=n?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-c)-1,p>>=-c,c+=a;c>0;o=o*256+e[t+f],f+=d,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=s*256+e[t+f],f+=d,c-=8);if(o===0)o=1-l;else{if(o===u)return s?NaN:(p?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-l}return(p?-1:1)*s*Math.pow(2,o-r)};N_.write=function(e,t,n,r,i,o){var s,a,u,l=o*8-i-1,c=(1<<l)-1,f=c>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,m=r?1:-1,h=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),s+f>=1?t+=d/u:t+=d*Math.pow(2,1-f),t*u>=2&&(s++,u/=2),s+f>=c?(a=0,s=c):s+f>=1?(a=(t*u-1)*Math.pow(2,i),s=s+f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=a&255,p+=m,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+p]=s&255,p+=m,s/=256,l-=8);e[n+p-m]|=h*128}});var D3=Ex(Vf=>{"use strict";var O_=p3(),jf=m3(),h3=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Vf.Buffer=H;Vf.SlowBuffer=dJ;Vf.INSPECT_MAX_BYTES=50;var wx=2147483647;Vf.kMaxLength=wx;H.TYPED_ARRAY_SUPPORT=aJ();!H.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function aJ(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),e.foo()===42}catch{return!1}}Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){if(H.isBuffer(this))return this.buffer}});Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){if(H.isBuffer(this))return this.byteOffset}});function Ea(e){if(e>wx)throw new RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,H.prototype),t}function H(e,t,n){if(typeof e=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B_(e)}return b3(e,t,n)}H.poolSize=8192;function b3(e,t,n){if(typeof e=="string")return lJ(e,t);if(ArrayBuffer.isView(e))return cJ(e);if(e==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Fs(e,ArrayBuffer)||e&&Fs(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Fs(e,SharedArrayBuffer)||e&&Fs(e.buffer,SharedArrayBuffer)))return P_(e,t,n);if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let r=e.valueOf&&e.valueOf();if(r!=null&&r!==e)return H.from(r,t,n);let i=fJ(e);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]=="function")return H.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}H.from=function(e,t,n){return b3(e,t,n)};Object.setPrototypeOf(H.prototype,Uint8Array.prototype);Object.setPrototypeOf(H,Uint8Array);function E3(e){if(typeof e!="number")throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function uJ(e,t,n){return E3(e),e<=0?Ea(e):t!==void 0?typeof n=="string"?Ea(e).fill(t,n):Ea(e).fill(t):Ea(e)}H.alloc=function(e,t,n){return uJ(e,t,n)};function B_(e){return E3(e),Ea(e<0?0:L_(e)|0)}H.allocUnsafe=function(e){return B_(e)};H.allocUnsafeSlow=function(e){return B_(e)};function lJ(e,t){if((typeof t!="string"||t==="")&&(t="utf8"),!H.isEncoding(t))throw new TypeError("Unknown encoding: "+t);let n=v3(e,t)|0,r=Ea(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}function I_(e){let t=e.length<0?0:L_(e.length)|0,n=Ea(t);for(let r=0;r<t;r+=1)n[r]=e[r]&255;return n}function cJ(e){if(Fs(e,Uint8Array)){let t=new Uint8Array(e);return P_(t.buffer,t.byteOffset,t.byteLength)}return I_(e)}function P_(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return t===void 0&&n===void 0?r=new Uint8Array(e):n===void 0?r=new Uint8Array(e,t):r=new Uint8Array(e,t,n),Object.setPrototypeOf(r,H.prototype),r}function fJ(e){if(H.isBuffer(e)){let t=L_(e.length)|0,n=Ea(t);return n.length===0||e.copy(n,0,0,t),n}if(e.length!==void 0)return typeof e.length!="number"||z_(e.length)?Ea(0):I_(e);if(e.type==="Buffer"&&Array.isArray(e.data))return I_(e.data)}function L_(e){if(e>=wx)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+wx.toString(16)+" bytes");return e|0}function dJ(e){return+e!=e&&(e=0),H.alloc(+e)}H.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==H.prototype};H.compare=function(t,n){if(Fs(t,Uint8Array)&&(t=H.from(t,t.offset,t.byteLength)),Fs(n,Uint8Array)&&(n=H.from(n,n.offset,n.byteLength)),!H.isBuffer(t)||!H.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===n)return 0;let r=t.length,i=n.length;for(let o=0,s=Math.min(r,i);o<s;++o)if(t[o]!==n[o]){r=t[o],i=n[o];break}return r<i?-1:i<r?1:0};H.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};H.concat=function(t,n){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return H.alloc(0);let r;if(n===void 0)for(n=0,r=0;r<t.length;++r)n+=t[r].length;let i=H.allocUnsafe(n),o=0;for(r=0;r<t.length;++r){let s=t[r];if(Fs(s,Uint8Array))o+s.length>i.length?(H.isBuffer(s)||(s=H.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(H.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function v3(e,t){if(H.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Fs(e,ArrayBuffer))return e.byteLength;if(typeof e!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let n=e.length,r=arguments.length>2&&arguments[2]===!0;if(!r&&n===0)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return $_(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return T3(e).length;default:if(i)return r?-1:$_(e).length;t=(""+t).toLowerCase(),i=!0}}H.byteLength=v3;function pJ(e,t,n){let r=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,t>>>=0,n<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":return SJ(this,t,n);case"utf8":case"utf-8":return S3(this,t,n);case"ascii":return vJ(this,t,n);case"latin1":case"binary":return wJ(this,t,n);case"base64":return bJ(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return AJ(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}H.prototype._isBuffer=!0;function Xl(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}H.prototype.swap16=function(){let t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)Xl(this,n,n+1);return this};H.prototype.swap32=function(){let t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)Xl(this,n,n+3),Xl(this,n+1,n+2);return this};H.prototype.swap64=function(){let t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)Xl(this,n,n+7),Xl(this,n+1,n+6),Xl(this,n+2,n+5),Xl(this,n+3,n+4);return this};H.prototype.toString=function(){let t=this.length;return t===0?"":arguments.length===0?S3(this,0,t):pJ.apply(this,arguments)};H.prototype.toLocaleString=H.prototype.toString;H.prototype.equals=function(t){if(!H.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:H.compare(this,t)===0};H.prototype.inspect=function(){let t="",n=Vf.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"};h3&&(H.prototype[h3]=H.prototype.inspect);H.prototype.compare=function(t,n,r,i,o){if(Fs(t,Uint8Array)&&(t=H.from(t,t.offset,t.byteLength)),!H.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(n===void 0&&(n=0),r===void 0&&(r=t?t.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),n<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&n>=r)return 0;if(i>=o)return-1;if(n>=r)return 1;if(n>>>=0,r>>>=0,i>>>=0,o>>>=0,this===t)return 0;let s=o-i,a=r-n,u=Math.min(s,a),l=this.slice(i,o),c=t.slice(n,r);for(let f=0;f<u;++f)if(l[f]!==c[f]){s=l[f],a=c[f];break}return s<a?-1:a<s?1:0};function w3(e,t,n,r,i){if(e.length===0)return-1;if(typeof n=="string"?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,z_(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0)if(i)n=0;else return-1;if(typeof t=="string"&&(t=H.from(t,r)),H.isBuffer(t))return t.length===0?-1:g3(e,t,n,r,i);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g3(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g3(e,t,n,r,i){let o=1,s=e.length,a=t.length;if(r!==void 0&&(r=String(r).toLowerCase(),r==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le")){if(e.length<2||t.length<2)return-1;o=2,s/=2,a/=2,n/=2}function u(c,f){return o===1?c[f]:c.readUInt16BE(f*o)}let l;if(i){let c=-1;for(l=n;l<s;l++)if(u(e,l)===u(t,c===-1?0:l-c)){if(c===-1&&(c=l),l-c+1===a)return c*o}else c!==-1&&(l-=l-c),c=-1}else for(n+a>s&&(n=s-a),l=n;l>=0;l--){let c=!0;for(let f=0;f<a;f++)if(u(e,l+f)!==u(t,f)){c=!1;break}if(c)return l}return-1}H.prototype.includes=function(t,n,r){return this.indexOf(t,n,r)!==-1};H.prototype.indexOf=function(t,n,r){return w3(this,t,n,r,!0)};H.prototype.lastIndexOf=function(t,n,r){return w3(this,t,n,r,!1)};function mJ(e,t,n,r){n=Number(n)||0;let i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;let o=t.length;r>o/2&&(r=o/2);let s;for(s=0;s<r;++s){let a=parseInt(t.substr(s*2,2),16);if(z_(a))return s;e[n+s]=a}return s}function hJ(e,t,n,r){return Sx($_(t,e.length-n),e,n,r)}function gJ(e,t,n,r){return Sx(FJ(t),e,n,r)}function yJ(e,t,n,r){return Sx(T3(t),e,n,r)}function xJ(e,t,n,r){return Sx(RJ(t,e.length-n),e,n,r)}H.prototype.write=function(t,n,r,i){if(n===void 0)i="utf8",r=this.length,n=0;else if(r===void 0&&typeof n=="string")i=n,r=this.length,n=0;else if(isFinite(n))n=n>>>0,isFinite(r)?(r=r>>>0,i===void 0&&(i="utf8")):(i=r,r=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-n;if((r===void 0||r>o)&&(r=o),t.length>0&&(r<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return mJ(this,t,n,r);case"utf8":case"utf-8":return hJ(this,t,n,r);case"ascii":case"latin1":case"binary":return gJ(this,t,n,r);case"base64":return yJ(this,t,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xJ(this,t,n,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function bJ(e,t,n){return t===0&&n===e.length?O_.fromByteArray(e):O_.fromByteArray(e.slice(t,n))}function S3(e,t,n){n=Math.min(e.length,n);let r=[],i=t;for(;i<n;){let o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=n){let u,l,c,f;switch(a){case 1:o<128&&(s=o);break;case 2:u=e[i+1],(u&192)===128&&(f=(o&31)<<6|u&63,f>127&&(s=f));break;case 3:u=e[i+1],l=e[i+2],(u&192)===128&&(l&192)===128&&(f=(o&15)<<12|(u&63)<<6|l&63,f>2047&&(f<55296||f>57343)&&(s=f));break;case 4:u=e[i+1],l=e[i+2],c=e[i+3],(u&192)===128&&(l&192)===128&&(c&192)===128&&(f=(o&15)<<18|(u&63)<<12|(l&63)<<6|c&63,f>65535&&f<1114112&&(s=f))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|s&1023),r.push(s),i+=a}return EJ(r)}var y3=4096;function EJ(e){let t=e.length;if(t<=y3)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=y3));return n}function vJ(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]&127);return r}function wJ(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function SJ(e,t,n){let r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let o=t;o<n;++o)i+=TJ[e[o]];return i}function AJ(e,t,n){let r=e.slice(t,n),i="";for(let o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+r[o+1]*256);return i}H.prototype.slice=function(t,n){let r=this.length;t=~~t,n=n===void 0?r:~~n,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),n<0?(n+=r,n<0&&(n=0)):n>r&&(n=r),n<t&&(n=t);let i=this.subarray(t,n);return Object.setPrototypeOf(i,H.prototype),i};function xn(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}H.prototype.readUintLE=H.prototype.readUIntLE=function(t,n,r){t=t>>>0,n=n>>>0,r||xn(t,n,this.length);let i=this[t],o=1,s=0;for(;++s<n&&(o*=256);)i+=this[t+s]*o;return i};H.prototype.readUintBE=H.prototype.readUIntBE=function(t,n,r){t=t>>>0,n=n>>>0,r||xn(t,n,this.length);let i=this[t+--n],o=1;for(;n>0&&(o*=256);)i+=this[t+--n]*o;return i};H.prototype.readUint8=H.prototype.readUInt8=function(t,n){return t=t>>>0,n||xn(t,1,this.length),this[t]};H.prototype.readUint16LE=H.prototype.readUInt16LE=function(t,n){return t=t>>>0,n||xn(t,2,this.length),this[t]|this[t+1]<<8};H.prototype.readUint16BE=H.prototype.readUInt16BE=function(t,n){return t=t>>>0,n||xn(t,2,this.length),this[t]<<8|this[t+1]};H.prototype.readUint32LE=H.prototype.readUInt32LE=function(t,n){return t=t>>>0,n||xn(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};H.prototype.readUint32BE=H.prototype.readUInt32BE=function(t,n){return t=t>>>0,n||xn(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};H.prototype.readBigUInt64LE=Cu(function(t){t=t>>>0,Wf(t,"offset");let n=this[t],r=this[t+7];(n===void 0||r===void 0)&&Vm(t,this.length-8);let i=n+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,o=this[++t]+this[++t]*2**8+this[++t]*2**16+r*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});H.prototype.readBigUInt64BE=Cu(function(t){t=t>>>0,Wf(t,"offset");let n=this[t],r=this[t+7];(n===void 0||r===void 0)&&Vm(t,this.length-8);let i=n*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],o=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+r;return(BigInt(i)<<BigInt(32))+BigInt(o)});H.prototype.readIntLE=function(t,n,r){t=t>>>0,n=n>>>0,r||xn(t,n,this.length);let i=this[t],o=1,s=0;for(;++s<n&&(o*=256);)i+=this[t+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*n)),i};H.prototype.readIntBE=function(t,n,r){t=t>>>0,n=n>>>0,r||xn(t,n,this.length);let i=n,o=1,s=this[t+--i];for(;i>0&&(o*=256);)s+=this[t+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*n)),s};H.prototype.readInt8=function(t,n){return t=t>>>0,n||xn(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};H.prototype.readInt16LE=function(t,n){t=t>>>0,n||xn(t,2,this.length);let r=this[t]|this[t+1]<<8;return r&32768?r|4294901760:r};H.prototype.readInt16BE=function(t,n){t=t>>>0,n||xn(t,2,this.length);let r=this[t+1]|this[t]<<8;return r&32768?r|4294901760:r};H.prototype.readInt32LE=function(t,n){return t=t>>>0,n||xn(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};H.prototype.readInt32BE=function(t,n){return t=t>>>0,n||xn(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};H.prototype.readBigInt64LE=Cu(function(t){t=t>>>0,Wf(t,"offset");let n=this[t],r=this[t+7];(n===void 0||r===void 0)&&Vm(t,this.length-8);let i=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(r<<24);return(BigInt(i)<<BigInt(32))+BigInt(n+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)});H.prototype.readBigInt64BE=Cu(function(t){t=t>>>0,Wf(t,"offset");let n=this[t],r=this[t+7];(n===void 0||r===void 0)&&Vm(t,this.length-8);let i=(n<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+r)});H.prototype.readFloatLE=function(t,n){return t=t>>>0,n||xn(t,4,this.length),jf.read(this,t,!0,23,4)};H.prototype.readFloatBE=function(t,n){return t=t>>>0,n||xn(t,4,this.length),jf.read(this,t,!1,23,4)};H.prototype.readDoubleLE=function(t,n){return t=t>>>0,n||xn(t,8,this.length),jf.read(this,t,!0,52,8)};H.prototype.readDoubleBE=function(t,n){return t=t>>>0,n||xn(t,8,this.length),jf.read(this,t,!1,52,8)};function Jr(e,t,n,r,i,o){if(!H.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}H.prototype.writeUintLE=H.prototype.writeUIntLE=function(t,n,r,i){if(t=+t,n=n>>>0,r=r>>>0,!i){let a=Math.pow(2,8*r)-1;Jr(this,t,n,r,a,0)}let o=1,s=0;for(this[n]=t&255;++s<r&&(o*=256);)this[n+s]=t/o&255;return n+r};H.prototype.writeUintBE=H.prototype.writeUIntBE=function(t,n,r,i){if(t=+t,n=n>>>0,r=r>>>0,!i){let a=Math.pow(2,8*r)-1;Jr(this,t,n,r,a,0)}let o=r-1,s=1;for(this[n+o]=t&255;--o>=0&&(s*=256);)this[n+o]=t/s&255;return n+r};H.prototype.writeUint8=H.prototype.writeUInt8=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,1,255,0),this[n]=t&255,n+1};H.prototype.writeUint16LE=H.prototype.writeUInt16LE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,2,65535,0),this[n]=t&255,this[n+1]=t>>>8,n+2};H.prototype.writeUint16BE=H.prototype.writeUInt16BE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,2,65535,0),this[n]=t>>>8,this[n+1]=t&255,n+2};H.prototype.writeUint32LE=H.prototype.writeUInt32LE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,4,4294967295,0),this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=t&255,n+4};H.prototype.writeUint32BE=H.prototype.writeUInt32BE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,4,4294967295,0),this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t&255,n+4};function A3(e,t,n,r,i){R3(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o=o>>8,e[n++]=o,o=o>>8,e[n++]=o,o=o>>8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s=s>>8,e[n++]=s,s=s>>8,e[n++]=s,s=s>>8,e[n++]=s,n}function _3(e,t,n,r,i){R3(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o=o>>8,e[n+6]=o,o=o>>8,e[n+5]=o,o=o>>8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s=s>>8,e[n+2]=s,s=s>>8,e[n+1]=s,s=s>>8,e[n]=s,n+8}H.prototype.writeBigUInt64LE=Cu(function(t,n=0){return A3(this,t,n,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeBigUInt64BE=Cu(function(t,n=0){return _3(this,t,n,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeIntLE=function(t,n,r,i){if(t=+t,n=n>>>0,!i){let u=Math.pow(2,8*r-1);Jr(this,t,n,r,u-1,-u)}let o=0,s=1,a=0;for(this[n]=t&255;++o<r&&(s*=256);)t<0&&a===0&&this[n+o-1]!==0&&(a=1),this[n+o]=(t/s>>0)-a&255;return n+r};H.prototype.writeIntBE=function(t,n,r,i){if(t=+t,n=n>>>0,!i){let u=Math.pow(2,8*r-1);Jr(this,t,n,r,u-1,-u)}let o=r-1,s=1,a=0;for(this[n+o]=t&255;--o>=0&&(s*=256);)t<0&&a===0&&this[n+o+1]!==0&&(a=1),this[n+o]=(t/s>>0)-a&255;return n+r};H.prototype.writeInt8=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,1,127,-128),t<0&&(t=255+t+1),this[n]=t&255,n+1};H.prototype.writeInt16LE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,2,32767,-32768),this[n]=t&255,this[n+1]=t>>>8,n+2};H.prototype.writeInt16BE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,2,32767,-32768),this[n]=t>>>8,this[n+1]=t&255,n+2};H.prototype.writeInt32LE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,4,2147483647,-2147483648),this[n]=t&255,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24,n+4};H.prototype.writeInt32BE=function(t,n,r){return t=+t,n=n>>>0,r||Jr(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t&255,n+4};H.prototype.writeBigInt64LE=Cu(function(t,n=0){return A3(this,t,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});H.prototype.writeBigInt64BE=Cu(function(t,n=0){return _3(this,t,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function C3(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k3(e,t,n,r,i){return t=+t,n=n>>>0,i||C3(e,t,n,4,34028234663852886e22,-34028234663852886e22),jf.write(e,t,n,r,23,4),n+4}H.prototype.writeFloatLE=function(t,n,r){return k3(this,t,n,!0,r)};H.prototype.writeFloatBE=function(t,n,r){return k3(this,t,n,!1,r)};function F3(e,t,n,r,i){return t=+t,n=n>>>0,i||C3(e,t,n,8,17976931348623157e292,-17976931348623157e292),jf.write(e,t,n,r,52,8),n+8}H.prototype.writeDoubleLE=function(t,n,r){return F3(this,t,n,!0,r)};H.prototype.writeDoubleBE=function(t,n,r){return F3(this,t,n,!1,r)};H.prototype.copy=function(t,n,r,i){if(!H.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),!i&&i!==0&&(i=this.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<r&&(i=r),i===r||t.length===0||this.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-r&&(i=t.length-n+r);let o=i-r;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(n,r,i):Uint8Array.prototype.set.call(t,this.subarray(r,i),n),o};H.prototype.fill=function(t,n,r,i){if(typeof t=="string"){if(typeof n=="string"?(i=n,n=0,r=this.length):typeof r=="string"&&(i=r,r=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!H.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(t.length===1){let s=t.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(t=s)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;n=n>>>0,r=r===void 0?this.length:r>>>0,t||(t=0);let o;if(typeof t=="number")for(o=n;o<r;++o)this[o]=t;else{let s=H.isBuffer(t)?t:H.from(t,i),a=s.length;if(a===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-n;++o)this[o+n]=s[o%a]}return this};var Gf={};function U_(e,t,n){Gf[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}U_("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);U_("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError);U_("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=x3(String(n)):typeof n=="bigint"&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=x3(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r},RangeError);function x3(e){let t="",n=e.length,r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function _J(e,t,n){Wf(t,"offset"),(e[t]===void 0||e[t+n]===void 0)&&Vm(t,e.length-(n+1))}function R3(e,t,n,r,i,o){if(e>n||e<t){let s=typeof t=="bigint"?"n":"",a;throw o>3?t===0||t===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:a=`>= ${t}${s} and <= ${n}${s}`,new Gf.ERR_OUT_OF_RANGE("value",a,e)}_J(r,i,o)}function Wf(e,t){if(typeof e!="number")throw new Gf.ERR_INVALID_ARG_TYPE(t,"number",e)}function Vm(e,t,n){throw Math.floor(e)!==e?(Wf(e,n),new Gf.ERR_OUT_OF_RANGE(n||"offset","an integer",e)):t<0?new Gf.ERR_BUFFER_OUT_OF_BOUNDS:new Gf.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}var CJ=/[^+/0-9A-Za-z-_]/g;function kJ(e){if(e=e.split("=")[0],e=e.trim().replace(CJ,""),e.length<2)return"";for(;e.length%4!==0;)e=e+"=";return e}function $_(e,t){t=t||1/0;let n,r=e.length,i=null,o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,n&63|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return o}function FJ(e){let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n)&255);return t}function RJ(e,t){let n,r,i,o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function T3(e){return O_.toByteArray(kJ(e))}function Sx(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Fs(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function z_(e){return e!==e}var TJ=function(){let e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){let r=n*16;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Cu(e){return typeof BigInt>"u"?DJ:e}function DJ(){throw new Error("BigInt not supported")}});var zP=Ex((fx,UP)=>{(function(e,t){typeof fx=="object"&&typeof UP=="object"?UP.exports=t():typeof define=="function"&&define.amd?define([],t):typeof fx=="object"?fx.bowser=t():e.bowser=t()})(fx,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(r,i,o){n.o(r,i)||Object.defineProperty(r,i,{enumerable:!0,get:o})},n.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,i){if(1&i&&(r=n(r)),8&i||4&i&&typeof r=="object"&&r&&r.__esModule)return r;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:r}),2&i&&typeof r!="string")for(var s in r)n.d(o,s,function(a){return r[a]}.bind(null,s));return o},n.n=function(r){var i=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(i,"a",i),i},n.o=function(r,i){return Object.prototype.hasOwnProperty.call(r,i)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function o(){}return o.getFirstMatch=function(s,a){var u=a.match(s);return u&&u.length>0&&u[1]||""},o.getSecondMatch=function(s,a){var u=a.match(s);return u&&u.length>1&&u[2]||""},o.matchAndReturnConst=function(s,a,u){if(s.test(a))return u},o.getWindowsVersionName=function(s){switch(s){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},o.getMacOSVersionName=function(s){var a=s.split(".").splice(0,2).map(function(u){return parseInt(u,10)||0});if(a.push(0),a[0]===10)switch(a[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},o.getAndroidVersionName=function(s){var a=s.split(".").splice(0,2).map(function(u){return parseInt(u,10)||0});if(a.push(0),!(a[0]===1&&a[1]<5))return a[0]===1&&a[1]<6?"Cupcake":a[0]===1&&a[1]>=6?"Donut":a[0]===2&&a[1]<2?"Eclair":a[0]===2&&a[1]===2?"Froyo":a[0]===2&&a[1]>2?"Gingerbread":a[0]===3?"Honeycomb":a[0]===4&&a[1]<1?"Ice Cream Sandwich":a[0]===4&&a[1]<4?"Jelly Bean":a[0]===4&&a[1]>=4?"KitKat":a[0]===5?"Lollipop":a[0]===6?"Marshmallow":a[0]===7?"Nougat":a[0]===8?"Oreo":a[0]===9?"Pie":void 0},o.getVersionPrecision=function(s){return s.split(".").length},o.compareVersions=function(s,a,u){u===void 0&&(u=!1);var l=o.getVersionPrecision(s),c=o.getVersionPrecision(a),f=Math.max(l,c),d=0,p=o.map([s,a],function(m){var h=f-o.getVersionPrecision(m),g=m+new Array(h+1).join(".0");return o.map(g.split("."),function(y){return new Array(20-y.length).join("0")+y}).reverse()});for(u&&(d=f-Math.min(l,c)),f-=1;f>=d;){if(p[0][f]>p[1][f])return 1;if(p[0][f]===p[1][f]){if(f===d)return 0;f-=1}else if(p[0][f]<p[1][f])return-1}},o.map=function(s,a){var u,l=[];if(Array.prototype.map)return Array.prototype.map.call(s,a);for(u=0;u<s.length;u+=1)l.push(a(s[u]));return l},o.find=function(s,a){var u,l;if(Array.prototype.find)return Array.prototype.find.call(s,a);for(u=0,l=s.length;u<l;u+=1){var c=s[u];if(a(c,u))return c}},o.assign=function(s){for(var a,u,l=s,c=arguments.length,f=new Array(c>1?c-1:0),d=1;d<c;d++)f[d-1]=arguments[d];if(Object.assign)return Object.assign.apply(Object,[s].concat(f));var p=function(){var m=f[a];typeof m=="object"&&m!==null&&Object.keys(m).forEach(function(h){l[h]=m[h]})};for(a=0,u=f.length;a<u;a+=1)p();return s},o.getBrowserAlias=function(s){return r.BROWSER_ALIASES_MAP[s]},o.getBrowserTypeByAlias=function(s){return r.BROWSER_MAP[s]||""},o}();t.default=i,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast","Pale Moon":"pale_moon",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",pale_moon:"Pale Moon",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv",bot:"bot"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function s(u,l){for(var c=0;c<l.length;c++){var f=l[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}var a=function(){function u(){}var l,c,f;return u.getParser=function(d,p){if(p===void 0&&(p=!1),typeof d!="string")throw new Error("UserAgent should be a string");return new i.default(d,p)},u.parse=function(d){return new i.default(d).getResult()},l=u,f=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(c=null)&&s(l.prototype,c),f&&s(l,f),u}();t.default=a,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=u(n(92)),i=u(n(93)),o=u(n(94)),s=u(n(95)),a=u(n(17));function u(c){return c&&c.__esModule?c:{default:c}}var l=function(){function c(d,p){if(p===void 0&&(p=!1),d==null||d==="")throw new Error("UserAgent parameter can't be empty");this._ua=d,this.parsedResult={},p!==!0&&this.parse()}var f=c.prototype;return f.getUA=function(){return this._ua},f.test=function(d){return d.test(this._ua)},f.parseBrowser=function(){var d=this;this.parsedResult.browser={};var p=a.default.find(r.default,function(m){if(typeof m.test=="function")return m.test(d);if(Array.isArray(m.test))return m.test.some(function(h){return d.test(h)});throw new Error("Browser's test function is not valid")});return p&&(this.parsedResult.browser=p.describe(this.getUA())),this.parsedResult.browser},f.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},f.getBrowserName=function(d){return d?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},f.getBrowserVersion=function(){return this.getBrowser().version},f.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},f.parseOS=function(){var d=this;this.parsedResult.os={};var p=a.default.find(i.default,function(m){if(typeof m.test=="function")return m.test(d);if(Array.isArray(m.test))return m.test.some(function(h){return d.test(h)});throw new Error("Browser's test function is not valid")});return p&&(this.parsedResult.os=p.describe(this.getUA())),this.parsedResult.os},f.getOSName=function(d){var p=this.getOS().name;return d?String(p).toLowerCase()||"":p||""},f.getOSVersion=function(){return this.getOS().version},f.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},f.getPlatformType=function(d){d===void 0&&(d=!1);var p=this.getPlatform().type;return d?String(p).toLowerCase()||"":p||""},f.parsePlatform=function(){var d=this;this.parsedResult.platform={};var p=a.default.find(o.default,function(m){if(typeof m.test=="function")return m.test(d);if(Array.isArray(m.test))return m.test.some(function(h){return d.test(h)});throw new Error("Browser's test function is not valid")});return p&&(this.parsedResult.platform=p.describe(this.getUA())),this.parsedResult.platform},f.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},f.getEngineName=function(d){return d?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},f.parseEngine=function(){var d=this;this.parsedResult.engine={};var p=a.default.find(s.default,function(m){if(typeof m.test=="function")return m.test(d);if(Array.isArray(m.test))return m.test.some(function(h){return d.test(h)});throw new Error("Browser's test function is not valid")});return p&&(this.parsedResult.engine=p.describe(this.getUA())),this.parsedResult.engine},f.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},f.getResult=function(){return a.default.assign({},this.parsedResult)},f.satisfies=function(d){var p=this,m={},h=0,g={},y=0;if(Object.keys(d).forEach(function(A){var F=d[A];typeof F=="string"?(g[A]=F,y+=1):typeof F=="object"&&(m[A]=F,h+=1)}),h>0){var x=Object.keys(m),b=a.default.find(x,function(A){return p.isOS(A)});if(b){var E=this.satisfies(m[b]);if(E!==void 0)return E}var v=a.default.find(x,function(A){return p.isPlatform(A)});if(v){var S=this.satisfies(m[v]);if(S!==void 0)return S}}if(y>0){var w=Object.keys(g),_=a.default.find(w,function(A){return p.isBrowser(A,!0)});if(_!==void 0)return this.compareVersion(g[_])}},f.isBrowser=function(d,p){p===void 0&&(p=!1);var m=this.getBrowserName().toLowerCase(),h=d.toLowerCase(),g=a.default.getBrowserTypeByAlias(h);return p&&g&&(h=g.toLowerCase()),h===m},f.compareVersion=function(d){var p=[0],m=d,h=!1,g=this.getBrowserVersion();if(typeof g=="string")return d[0]===">"||d[0]==="<"?(m=d.substr(1),d[1]==="="?(h=!0,m=d.substr(2)):p=[],d[0]===">"?p.push(1):p.push(-1)):d[0]==="="?m=d.substr(1):d[0]==="~"&&(h=!0,m=d.substr(1)),p.indexOf(a.default.compareVersions(g,m,h))>-1},f.isOS=function(d){return this.getOSName(!0)===String(d).toLowerCase()},f.isPlatform=function(d){return this.getPlatformType(!0)===String(d).toLowerCase()},f.isEngine=function(d){return this.getEngineName(!0)===String(d).toLowerCase()},f.is=function(d,p){return p===void 0&&(p=!1),this.isBrowser(d,p)||this.isOS(d)||this.isPlatform(d)},f.some=function(d){var p=this;return d===void 0&&(d=[]),d.some(function(m){return p.is(m)})},c}();t.default=l,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(a){var u={name:"Googlebot"},l=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/opera/i],describe:function(a){var u={name:"Opera"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/opr\/|opios/i],describe:function(a){var u={name:"Opera"},l=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/SamsungBrowser/i],describe:function(a){var u={name:"Samsung Internet for Android"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/Whale/i],describe:function(a){var u={name:"NAVER Whale Browser"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/PaleMoon/i],describe:function(a){var u={name:"Pale Moon"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:PaleMoon)[\s/](\d+(?:\.\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/MZBrowser/i],describe:function(a){var u={name:"MZ Browser"},l=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/focus/i],describe:function(a){var u={name:"Focus"},l=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/swing/i],describe:function(a){var u={name:"Swing"},l=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/coast/i],describe:function(a){var u={name:"Opera Coast"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(a){var u={name:"Opera Touch"},l=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/yabrowser/i],describe:function(a){var u={name:"Yandex Browser"},l=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/ucbrowser/i],describe:function(a){var u={name:"UC Browser"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/Maxthon|mxios/i],describe:function(a){var u={name:"Maxthon"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/epiphany/i],describe:function(a){var u={name:"Epiphany"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/puffin/i],describe:function(a){var u={name:"Puffin"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/sleipnir/i],describe:function(a){var u={name:"Sleipnir"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/k-meleon/i],describe:function(a){var u={name:"K-Meleon"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/micromessenger/i],describe:function(a){var u={name:"WeChat"},l=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/qqbrowser/i],describe:function(a){var u={name:/qqbrowserlite/i.test(a)?"QQ Browser Lite":"QQ Browser"},l=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/msie|trident/i],describe:function(a){var u={name:"Internet Explorer"},l=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/\sedg\//i],describe:function(a){var u={name:"Microsoft Edge"},l=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/edg([ea]|ios)/i],describe:function(a){var u={name:"Microsoft Edge"},l=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/vivaldi/i],describe:function(a){var u={name:"Vivaldi"},l=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/seamonkey/i],describe:function(a){var u={name:"SeaMonkey"},l=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/sailfish/i],describe:function(a){var u={name:"Sailfish"},l=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,a);return l&&(u.version=l),u}},{test:[/silk/i],describe:function(a){var u={name:"Amazon Silk"},l=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/phantom/i],describe:function(a){var u={name:"PhantomJS"},l=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/slimerjs/i],describe:function(a){var u={name:"SlimerJS"},l=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(a){var u={name:"BlackBerry"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/(web|hpw)[o0]s/i],describe:function(a){var u={name:"WebOS Browser"},l=i.default.getFirstMatch(o,a)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/bada/i],describe:function(a){var u={name:"Bada"},l=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/tizen/i],describe:function(a){var u={name:"Tizen"},l=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/qupzilla/i],describe:function(a){var u={name:"QupZilla"},l=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/firefox|iceweasel|fxios/i],describe:function(a){var u={name:"Firefox"},l=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/electron/i],describe:function(a){var u={name:"Electron"},l=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/MiuiBrowser/i],describe:function(a){var u={name:"Miui"},l=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/chromium/i],describe:function(a){var u={name:"Chromium"},l=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/chrome|crios|crmo/i],describe:function(a){var u={name:"Chrome"},l=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/GSA/i],describe:function(a){var u={name:"Google Search"},l=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:function(a){var u=!a.test(/like android/i),l=a.test(/android/i);return u&&l},describe:function(a){var u={name:"Android Browser"},l=i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/playstation 4/i],describe:function(a){var u={name:"PlayStation 4"},l=i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/safari|applewebkit/i],describe:function(a){var u={name:"Safari"},l=i.default.getFirstMatch(o,a);return l&&(u.version=l),u}},{test:[/.*/i],describe:function(a){var u=a.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(u,a),version:i.default.getSecondMatch(u,a)}}}];t.default=s,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:[/Roku\/DVP/],describe:function(a){var u=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,a);return{name:o.OS_MAP.Roku,version:u}}},{test:[/windows phone/i],describe:function(a){var u=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,a);return{name:o.OS_MAP.WindowsPhone,version:u}}},{test:[/windows /i],describe:function(a){var u=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,a),l=i.default.getWindowsVersionName(u);return{name:o.OS_MAP.Windows,version:u,versionName:l}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(a){var u={name:o.OS_MAP.iOS},l=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,a);return l&&(u.version=l),u}},{test:[/macintosh/i],describe:function(a){var u=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,a).replace(/[_\s]/g,"."),l=i.default.getMacOSVersionName(u),c={name:o.OS_MAP.MacOS,version:u};return l&&(c.versionName=l),c}},{test:[/(ipod|iphone|ipad)/i],describe:function(a){var u=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,a).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:u}}},{test:function(a){var u=!a.test(/like android/i),l=a.test(/android/i);return u&&l},describe:function(a){var u=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,a),l=i.default.getAndroidVersionName(u),c={name:o.OS_MAP.Android,version:u};return l&&(c.versionName=l),c}},{test:[/(web|hpw)[o0]s/i],describe:function(a){var u=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,a),l={name:o.OS_MAP.WebOS};return u&&u.length&&(l.version=u),l}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(a){var u=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,a)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,a)||i.default.getFirstMatch(/\bbb(\d+)/i,a);return{name:o.OS_MAP.BlackBerry,version:u}}},{test:[/bada/i],describe:function(a){var u=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,a);return{name:o.OS_MAP.Bada,version:u}}},{test:[/tizen/i],describe:function(a){var u=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,a);return{name:o.OS_MAP.Tizen,version:u}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(a){var u=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,a);return{name:o.OS_MAP.PlayStation4,version:u}}}];t.default=s,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:[/googlebot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Google"}}},{test:[/huawei/i],describe:function(a){var u=i.default.getFirstMatch(/(can-l01)/i,a)&&"Nova",l={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return u&&(l.model=u),l}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(a){var u=a.test(/ipod|iphone/i),l=a.test(/like (ipod|iphone)/i);return u&&!l},describe:function(a){var u=i.default.getFirstMatch(/(ipod|iphone)/i,a);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:u}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/Nokia/i],describe:function(a){var u=i.default.getFirstMatch(/Nokia\s+([0-9]+(\.[0-9]+)?)/i,a),l={type:o.PLATFORMS_MAP.mobile,vendor:"Nokia"};return u&&(l.model=u),l}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(a){return a.getBrowserName(!0)==="blackberry"},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(a){return a.getBrowserName(!0)==="bada"},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(a){return a.getBrowserName()==="windows phone"},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(a){var u=Number(String(a.getOSVersion()).split(".")[0]);return a.getOSName(!0)==="android"&&u>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(a){return a.getOSName(!0)==="android"},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(a){return a.getOSName(!0)==="macos"},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(a){return a.getOSName(!0)==="windows"},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(a){return a.getOSName(!0)==="linux"},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(a){return a.getOSName(!0)==="playstation 4"},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(a){return a.getOSName(!0)==="roku"},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:function(a){return a.getBrowserName(!0)==="microsoft edge"},describe:function(a){if(/\sedg\//i.test(a))return{name:o.ENGINE_MAP.Blink};var u=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,a);return{name:o.ENGINE_MAP.EdgeHTML,version:u}}},{test:[/trident/i],describe:function(a){var u={name:o.ENGINE_MAP.Trident},l=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:function(a){return a.test(/presto/i)},describe:function(a){var u={name:o.ENGINE_MAP.Presto},l=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:function(a){var u=a.test(/gecko/i),l=a.test(/like gecko/i);return u&&!l},describe:function(a){var u={name:o.ENGINE_MAP.Gecko},l=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(a){var u={name:o.ENGINE_MAP.WebKit},l=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,a);return l&&(u.version=l),u}}];t.default=s,e.exports=t.default}})})});var jQ=D_(D3());var MJ=/("(?:[^\\"]|\\.)*")|[:,]/g;function Ym(e,t={}){let n=JSON.stringify([1],void 0,t.indent===void 0?2:t.indent).slice(2,-3),r=n===""?1/0:t.maxLength===void 0?80:t.maxLength,{replacer:i}=t;return function o(s,a,u){s&&typeof s.toJSON=="function"&&(s=s.toJSON());let l=JSON.stringify(s,i);if(l===void 0)return l;let c=r-a.length-u;if(l.length<=c){let f=l.replace(MJ,(d,p)=>p||`${d} `);if(f.length<=c)return f}if(i!=null&&(s=JSON.parse(l),i=void 0),typeof s=="object"&&s!==null){let f=a+n,d=[],p=0,m,h;if(Array.isArray(s)){m="[",h="]";let{length:g}=s;for(;p<g;p++)d.push(o(s[p],f,p===g-1?0:1)||"null")}else{m="{",h="}";let g=Object.keys(s),{length:y}=g;for(;p<y;p++){let x=g[p],b=`${JSON.stringify(x)}: `,E=o(s[x],f,b.length+(p===y-1?0:1));E!==void 0&&d.push(b+E)}}if(d.length>0)return[m,n+d.join(`,
${f}`),h].join(`
${a}`)}return l}(e,"",0)}var XM={};er(XM,{Bounds:()=>It,CanvasHandler:()=>ol,CanvasRenderer:()=>Nd,DATE:()=>Mr,DAY:()=>Pn,DAYOFYEAR:()=>Ns,Dataflow:()=>Bu,Debug:()=>q_,Error:()=>Km,EventStream:()=>cd,Gradient:()=>CF,GroupItem:()=>Bg,HOURS:()=>ni,Handler:()=>Dg,HybridHandler:()=>zb,HybridRenderer:()=>Ng,Info:()=>H_,Item:()=>$g,MILLISECONDS:()=>eo,MINUTES:()=>ri,MONTH:()=>$n,Marks:()=>Ir,MultiPulse:()=>n1,None:()=>O3,Operator:()=>rt,Parameters:()=>Nh,Pulse:()=>Ma,QUARTER:()=>Dr,RenderType:()=>za,Renderer:()=>Mc,ResourceLoader:()=>kb,SECONDS:()=>ki,SVGHandler:()=>$b,SVGRenderer:()=>Mg,SVGStringRenderer:()=>Ub,Scenegraph:()=>Tg,TIME_UNITS:()=>Hx,Transform:()=>B,View:()=>wM,WEEK:()=>Zt,Warn:()=>Cx,YEAR:()=>En,accessor:()=>tr,accessorFields:()=>ln,accessorName:()=>xt,array:()=>Q,ascending:()=>Sa,bandwidthNRD:()=>s1,bin:()=>cC,bootstrapCI:()=>fC,boundClip:()=>QF,boundContext:()=>Lg,boundItem:()=>EF,boundMark:()=>d8,boundStroke:()=>js,changeset:()=>Oa,clampRange:()=>K_,codegenExpression:()=>ov,compare:()=>th,constant:()=>St,cumulativeLogNormal:()=>d1,cumulativeNormal:()=>Ph,cumulativeUniform:()=>g1,dayofyear:()=>$2,debounce:()=>nh,defaultLocale:()=>Rh,definition:()=>r1,densityLogNormal:()=>f1,densityNormal:()=>a1,densityUniform:()=>h1,domChild:()=>pn,domClear:()=>so,domCreate:()=>Zu,domFind:()=>GF,dotbin:()=>dC,error:()=>U,expressionFunction:()=>Lt,extend:()=>ve,extent:()=>kr,extentIndex:()=>Q_,falsy:()=>va,fastmap:()=>ku,field:()=>bn,flush:()=>J_,font:()=>Yb,fontFamily:()=>Hg,fontSize:()=>Ws,format:()=>Xx,formatLocale:()=>Fh,formats:()=>rC,hasOwnProperty:()=>ee,id:()=>Yf,identity:()=>Ot,inferType:()=>Z$,inferTypes:()=>eB,ingest:()=>Le,inherits:()=>Z,inrange:()=>Fu,interpolate:()=>bg,interpolateColors:()=>kd,interpolateRange:()=>db,intersect:()=>KF,intersectBoxLine:()=>Rd,intersectPath:()=>TF,intersectPoint:()=>DF,intersectRule:()=>t8,isArray:()=>M,isBoolean:()=>Zr,isDate:()=>Do,isFunction:()=>Ee,isIterable:()=>Z_,isNumber:()=>ke,isObject:()=>X,isRegExp:()=>Rx,isString:()=>V,isTuple:()=>ac,key:()=>rh,lerp:()=>e2,lineHeight:()=>rl,loader:()=>ud,locale:()=>Vx,logger:()=>Qm,lruCache:()=>t2,markup:()=>XF,merge:()=>n2,mergeConfig:()=>Ts,multiLineOffset:()=>Vb,one:()=>Rs,pad:()=>r2,panLinear:()=>G_,panLog:()=>j_,panPow:()=>W_,panSymlog:()=>V_,parse:()=>pz,parseExpression:()=>iv,parseSelector:()=>fr,path:()=>fc,pathCurves:()=>kF,pathEqual:()=>H8,pathParse:()=>Dc,pathRectangle:()=>K6,pathRender:()=>Td,pathSymbols:()=>X6,pathTrail:()=>Q6,peek:()=>Te,point:()=>qg,projection:()=>p0,quantileLogNormal:()=>p1,quantileNormal:()=>$h,quantileUniform:()=>y1,quantiles:()=>i1,quantizeInterpolator:()=>pb,quarter:()=>Y_,quartiles:()=>o1,random:()=>Nr,randomInteger:()=>jte,randomKDE:()=>l1,randomLCG:()=>Gte,randomLogNormal:()=>pC,randomMixture:()=>mC,randomNormal:()=>u1,randomUniform:()=>hC,read:()=>oC,regressionConstant:()=>x1,regressionExp:()=>yC,regressionLinear:()=>E1,regressionLoess:()=>EC,regressionLog:()=>gC,regressionPoly:()=>bC,regressionPow:()=>xC,regressionQuad:()=>v1,renderModule:()=>Gg,repeat:()=>Xm,resetDefaultLocale:()=>X$,resetSVGClipId:()=>Z6,resetSVGDefIds:()=>Rse,responseType:()=>iC,runtimeContext:()=>fv,sampleCurve:()=>dd,sampleLogNormal:()=>c1,sampleNormal:()=>Ih,sampleUniform:()=>m1,scale:()=>Ue,sceneEqual:()=>JF,sceneFromJSON:()=>m8,scenePickVisit:()=>Rb,sceneToJSON:()=>p8,sceneVisit:()=>Lo,sceneZOrder:()=>MF,scheme:()=>Eg,serializeXML:()=>T8,setHybridRendererOptions:()=>_se,setRandom:()=>Hte,span:()=>Aa,splitAccessPath:()=>Xi,stringValue:()=>Y,textMetrics:()=>ii,timeBin:()=>V2,timeFloor:()=>z2,timeFormatLocale:()=>sc,timeInterval:()=>Ra,timeOffset:()=>q2,timeSequence:()=>j2,timeUnitSpecifier:()=>I2,timeUnits:()=>qx,toBoolean:()=>ih,toDate:()=>oh,toNumber:()=>Gt,toSet:()=>Jt,toString:()=>sh,transform:()=>lC,transforms:()=>Na,truncate:()=>i2,truthy:()=>cn,tupleid:()=>he,typeParsers:()=>eC,utcFloor:()=>H2,utcInterval:()=>Ta,utcOffset:()=>G2,utcSequence:()=>W2,utcdayofyear:()=>L2,utcquarter:()=>X_,utcweek:()=>U2,version:()=>Y0e,visitArray:()=>_a,week:()=>B2,writeConfig:()=>wa,zero:()=>To,zoomLinear:()=>Jm,zoomLog:()=>Zm,zoomPow:()=>Xf,zoomSymlog:()=>eh});function tr(e,t,n){return e.fields=t||[],e.fname=n,e}function xt(e){return e==null?null:e.fname}function ln(e){return e==null?null:e.fields}function N3(e){return e.length===1?NJ(e[0]):OJ(e)}var NJ=e=>function(t){return t[e]},OJ=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function U(e){throw Error(e)}function Xi(e){let t=[],n=e.length,r=null,i=0,o="",s,a,u;e=e+"";function l(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(u=e[a],u==="\\")o+=e.substring(s,a++),s=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;s===i&&u==='"'||s===i&&u==="'"?(s=a+1,r=u):u==="."&&!i?a>s?l():s=a+1:u==="["?(a>s&&l(),i=s=a+1):u==="]"&&(i||U("Access path missing open bracket: "+e),i>0&&l(),i=0,s=a+1)}return i&&U("Access path missing closing bracket: "+e),r&&U("Access path missing closing quote: "+e),a>s&&(a++,l()),t}function bn(e,t,n){let r=Xi(e);return e=r.length===1?r[0]:e,tr((n&&n.get||N3)(r),[e],t||e)}var Yf=bn("id"),Ot=tr(e=>e,[],"identity"),To=tr(()=>0,[],"zero"),Rs=tr(()=>1,[],"one"),cn=tr(()=>!0,[],"true"),va=tr(()=>!1,[],"false");function IJ(e,t,n){let r=[t].concat([].slice.call(n));console[e].apply(console,r)}var O3=0,Km=1,Cx=2,H_=3,q_=4;function Qm(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:IJ,r=e||O3;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=Km&&n(t||"error","ERROR",arguments),this},warn(){return r>=Cx&&n(t||"warn","WARN",arguments),this},info(){return r>=H_&&n(t||"log","INFO",arguments),this},debug(){return r>=q_&&n(t||"log","DEBUG",arguments),this}}}var M=Array.isArray;function X(e){return e===Object(e)}var M3=e=>e!=="__proto__";function Ts(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(let o in i)if(o==="signals")r.signals=PJ(r.signals,i.signals);else{let s=o==="legend"?{layout:1}:o==="style"?!0:null;wa(r,o,i[o],s)}return r},{})}function wa(e,t,n,r){if(!M3(t))return;let i,o;if(X(n)&&!M(n)){o=X(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?wa(o,i,n[i]):M3(i)&&(o[i]=n[i])}else e[t]=n}function PJ(e,t){if(e==null)return t;let n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function Te(e){return e[e.length-1]}function Gt(e){return e==null||e===""?null:+e}var I3=e=>t=>e*Math.exp(t),P3=e=>t=>Math.log(e*t),$3=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),B3=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,_x=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function kx(e,t,n,r){let i=n(e[0]),o=n(Te(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function G_(e,t){return kx(e,t,Gt,Ot)}function j_(e,t){var n=Math.sign(e[0]);return kx(e,t,P3(n),I3(n))}function W_(e,t,n){return kx(e,t,_x(n),_x(1/n))}function V_(e,t,n){return kx(e,t,$3(n),B3(n))}function Fx(e,t,n,r,i){let o=r(e[0]),s=r(Te(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function Jm(e,t,n){return Fx(e,t,n,Gt,Ot)}function Zm(e,t,n){let r=Math.sign(e[0]);return Fx(e,t,n,P3(r),I3(r))}function Xf(e,t,n,r){return Fx(e,t,n,_x(r),_x(1/r))}function eh(e,t,n,r){return Fx(e,t,n,$3(r),B3(r))}function Y_(e){return 1+~~(new Date(e).getMonth()/3)}function X_(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Q(e){return e!=null?M(e)?e:[e]:[]}function K_(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function Ee(e){return typeof e=="function"}var $J="descending";function th(e,t,n){n=n||{},t=Q(t)||[];let r=[],i=[],o={},s=n.comparator||BJ;return Q(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===$J?-1:1),i.push(a=Ee(a)?a:bn(a,null,n)),(ln(a)||[]).forEach(l=>o[l]=1))}),i.length===0?null:tr(s(i,r),Object.keys(o))}var Sa=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),BJ=(e,t)=>e.length===1?LJ(e[0],t[0]):UJ(e,t,e.length),LJ=(e,t)=>function(n,r){return Sa(e(n),e(r))*t},UJ=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=Sa(o(r),o(i));return s*t[a]});function St(e){return Ee(e)?e:()=>e}function nh(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function ve(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function kr(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function Q_(e,t){let n=e.length,r=-1,i,o,s,a,u;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}return[a,u]}function ee(e,t){return Object.hasOwn(e,t)}var Ax={};function ku(e){let t={},n;function r(o){return ee(t,o)&&t[o]!==Ax}let i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,s){return r(o)||(++i.size,t[o]===Ax&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=Ax),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){let o={},s=0;for(let a in t){let u=t[a];u!==Ax&&(!n||!n(u))&&(o[a]=u,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function J_(e,t,n,r,i,o){if(!n&&n!==0)return o;let s=+n,a=e[0],u=Te(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);let c=Math.abs(u-t);return l<c&&l<=s?r:c<=s?i:o}function Z(e,t,n){let r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),ve(r,n)}function Fu(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function Zr(e){return typeof e=="boolean"}function Do(e){return Object.prototype.toString.call(e)==="[object Date]"}function Z_(e){return e&&Ee(e[Symbol.iterator])}function ke(e){return typeof e=="number"}function Rx(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function V(e){return typeof e=="string"}function rh(e,t,n){e&&(e=t?Q(e).map(a=>a.replace(/\\(.)/g,"$1")):Q(e));let r=e&&e.length,i=n&&n.get||N3,o=a=>i(t?[a]:Xi(a)),s;if(!r)s=function(){return""};else if(r===1){let a=o(e[0]);s=function(u){return""+a(u)}}else{let a=e.map(o);s=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}return tr(s,e,"key")}function e2(e,t){let n=e[0],r=Te(e),i=+t;return i?i===1?r:n+i*(r-n):n}var zJ=1e4;function t2(e){e=+e||zJ;let t,n,r,i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>ee(t,s)||ee(n,s),get:s=>ee(t,s)?t[s]:ee(n,s)?o(s,n[s]):void 0,set:(s,a)=>ee(t,s)?t[s]=a:o(s,a)}}function n2(e,t,n,r){let i=t.length,o=n.length;if(!o)return t;if(!i)return n;let s=r||new t.constructor(i+o),a=0,u=0,l=0;for(;a<i&&u<o;++l)s[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++l)s[l]=t[a];for(;u<o;++u,++l)s[l]=n[u];return s}function Xm(e,t){let n="";for(;--t>=0;)n+=e;return n}function r2(e,t,n,r){let i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?Xm(i,s)+o:r==="center"?Xm(i,~~(s/2))+o+Xm(i,Math.ceil(s/2)):o+Xm(i,s)}function Aa(e){return e&&Te(e)-e[0]||0}function Y(e){return M(e)?"["+e.map(Y)+"]":X(e)||V(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function ih(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}var HJ=e=>ke(e)||Do(e)?e:Date.parse(e);function oh(e,t){return t=t||HJ,e==null||e===""?null:t(e)}function sh(e){return e==null||e===""?null:e+""}function Jt(e){let t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function i2(e,t,n,r){let i=r??"\u2026",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function _a(e,t,n){if(e)if(t){let r=e.length;for(let i=0;i<r;++i){let o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var L3={},o2={},s2=34,ah=10,a2=13;function z3(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function qJ(e,t){var n=z3(e);return function(r,i){return t(n(r),i,e)}}function U3(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function ei(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function GJ(e){return e<0?"-"+ei(-e,6):e>9999?"+"+ei(e,6):ei(e,4)}function jJ(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":GJ(e.getUTCFullYear(),4)+"-"+ei(e.getUTCMonth()+1,2)+"-"+ei(e.getUTCDate(),2)+(i?"T"+ei(t,2)+":"+ei(n,2)+":"+ei(r,2)+"."+ei(i,3)+"Z":r?"T"+ei(t,2)+":"+ei(n,2)+":"+ei(r,2)+"Z":n||t?"T"+ei(t,2)+":"+ei(n,2)+"Z":"")}function u2(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var p,m,h=i(f,function(g,y){if(p)return p(g,y-1);m=g,p=d?qJ(g,d):z3(g)});return h.columns=m||[],h}function i(f,d){var p=[],m=f.length,h=0,g=0,y,x=m<=0,b=!1;f.charCodeAt(m-1)===ah&&--m,f.charCodeAt(m-1)===a2&&--m;function E(){if(x)return o2;if(b)return b=!1,L3;var S,w=h,_;if(f.charCodeAt(w)===s2){for(;h++<m&&f.charCodeAt(h)!==s2||f.charCodeAt(++h)===s2;);return(S=h)>=m?x=!0:(_=f.charCodeAt(h++))===ah?b=!0:_===a2&&(b=!0,f.charCodeAt(h)===ah&&++h),f.slice(w+1,S-1).replace(/""/g,'"')}for(;h<m;){if((_=f.charCodeAt(S=h++))===ah)b=!0;else if(_===a2)b=!0,f.charCodeAt(h)===ah&&++h;else if(_!==n)continue;return f.slice(w,S)}return x=!0,f.slice(w,m)}for(;(y=E())!==o2;){for(var v=[];y!==L3&&y!==o2;)v.push(y),y=E();d&&(v=d(v,g++))==null||p.push(v)}return p}function o(f,d){return f.map(function(p){return d.map(function(m){return c(p[m])}).join(e)})}function s(f,d){return d==null&&(d=U3(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=U3(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?jJ(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function l2(e){return e}function Tx(e){if(e==null)return l2;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+o,f[1]=(n+=a[1])*i+s;l<c;)f[l]=a[l],++l;return f}}function H3(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function c2(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return q3(e,n)})}:q3(e,t)}function q3(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=Dx(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function Dx(e,t){var n=Tx(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],p=0,m=d.length;p<m;++p)f.push(n(d[p],p));c<0&&H3(f,m)}function o(c){return n(c)}function s(c){for(var f=[],d=0,p=c.length;d<p;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function f2(e,t){var n={},r={},i={},o=[],s=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],p,m;if(p=i[f])if(delete i[p.end],p.push(l),p.end=d,m=r[d]){delete r[m.start];var h=m===p?p:p.concat(m);r[h.start=p.start]=i[h.end=m.end]=h}else r[p.start]=i[p.end]=p;else if(p=r[d])if(delete r[p.start],p.unshift(l),p.start=f,m=i[f]){delete i[m.end];var g=m===p?p:m.concat(p);r[g.start=m.start]=i[g.end=p.end]=g}else r[p.start]=i[p.end]=p;else p=[l],r[p.start=f]=i[p.end=d]=p});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),o.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function d2(e){return Dx(e,G3.apply(this,arguments))}function G3(e,t,n){var r,i,o;if(arguments.length>1)r=WJ(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:f2(e,r)}}function WJ(e,t,n){var r=[],i=[],o;function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}function nr(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function p2(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _i(e){let t,n,r;e.length!==2?(t=nr,n=(a,u)=>nr(e(a),u),r=(a,u)=>e(a)-u):(t=e===nr||e===p2?e:XJ,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{let f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{let f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){let f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:s,right:o}}function XJ(){return 0}function uh(e){return e===null?NaN:+e}function*j3(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}var W3=_i(nr),Kl=W3.right,m2=W3.left,KJ=_i(uh).center,Mo=Kl;function h2(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}function Mx(e,t){let n=h2(e,t);return n&&Math.sqrt(n)}var At=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){let n=this._partials,r=0;for(let i=0;i<this._n&&i<32;i++){let o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){let t=this._partials,n=this._n,r,i,o,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}};var Kf=class extends Map{constructor(t,n=X3){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(let[r,i]of t)this.set(r,i)}get(t){return super.get(g2(this,t))}has(t){return super.has(g2(this,t))}set(t,n){return super.set(V3(this,t),n)}delete(t){return super.delete(Y3(this,t))}},Ca=class extends Set{constructor(t,n=X3){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(let r of t)this.add(r)}has(t){return super.has(g2(this,t))}add(t){return super.add(V3(this,t))}delete(t){return super.delete(Y3(this,t))}};function g2({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):n}function V3({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Y3({_intern:e,_key:t},n){let r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function X3(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Nx(e,t){return Array.from(t,n=>e[n])}function K3(e=nr){if(e===nr)return y2;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{let r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function y2(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var QJ=Math.sqrt(50),JJ=Math.sqrt(10),ZJ=Math.sqrt(2);function Ox(e,t,n){let r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=QJ?10:o>=JJ?5:o>=ZJ?2:1,a,u,l;return i<0?(l=Math.pow(10,-i)/s,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*s,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?Ox(e,t,n*2):[a,u,l]}function Ql(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];let r=t<e,[i,o,s]=r?Ox(t,e,n):Ox(e,t,n);if(!(o>=i))return[];let a=o-i+1,u=new Array(a);if(r)if(s<0)for(let l=0;l<a;++l)u[l]=(o-l)/-s;else for(let l=0;l<a;++l)u[l]=(o-l)*s;else if(s<0)for(let l=0;l<a;++l)u[l]=(i+l)/-s;else for(let l=0;l<a;++l)u[l]=(i+l)*s;return u}function lh(e,t,n){return t=+t,e=+e,n=+n,Ox(e,t,n)[2]}function Fr(e,t,n){t=+t,e=+e,n=+n;let r=t<e,i=r?lh(t,e,n):lh(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Ki(e,t){let n;if(t===void 0)for(let r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Jl(e,t){let n;if(t===void 0)for(let r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function Ix(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?y2:K3(i);r>n;){if(r-n>600){let u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),p=Math.max(n,Math.floor(t-l*f/u+d)),m=Math.min(r,Math.floor(t+(u-l)*f/u+d));Ix(e,t,p,m,i)}let o=e[t],s=n,a=r;for(ch(e,n,t),i(e[r],o)>0&&ch(e,n,r);s<a;){for(ch(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[n],o)===0?ch(e,n,a):(++a,ch(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function ch(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function Zl(e,t,n){if(e=Float64Array.from(j3(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Jl(e);if(t>=1)return Ki(e);var r,i=(r-1)*t,o=Math.floor(i),s=Ki(Ix(e,o).subarray(0,o+1)),a=Jl(e.subarray(o+1));return s+(a-s)*(i-o)}}function fh(e,t,n=uh){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function Px(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function Qf(e,t){return Zl(e,.5,t)}function*tZ(e){for(let t of e)yield*t}function Jf(e){return Array.from(tZ(e))}function jt(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Zf(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function $x(e,...t){e=new Ca(e),t=t.map(nZ);e:for(let n of e)for(let r of t)if(!r.has(n)){e.delete(n);continue e}return e}function nZ(e){return e instanceof Ca?e:new Ca(e)}function Bx(...e){let t=new Ca;for(let n of e)for(let r of n)t.add(r);return t}function Q3(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ec(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Ds(e){return e=ec(Math.abs(e)),e?e[1]:NaN}function J3(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function Z3(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var rZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ci(e){if(!(t=rZ.exec(e)))throw new Error("invalid format: "+e);var t;return new Lx({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ci.prototype=Lx.prototype;function Lx(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Lx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function e$(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var x2;function t$(e,t){var n=ec(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(x2=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ec(e,Math.max(0,t+o-1))[0]}function b2(e,t){var n=ec(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var E2={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Q3,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>b2(e*100,t),r:b2,s:t$,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function v2(e){return e}var n$=Array.prototype.map,r$=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function dh(e){var t=e.grouping===void 0||e.thousands===void 0?v2:J3(n$.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?v2:Z3(n$.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Ci(f);var d=f.fill,p=f.align,m=f.sign,h=f.symbol,g=f.zero,y=f.width,x=f.comma,b=f.precision,E=f.trim,v=f.type;v==="n"?(x=!0,v="g"):E2[v]||(b===void 0&&(b=12),E=!0,v="g"),(g||d==="0"&&p==="=")&&(g=!0,d="0",p="=");var S=h==="$"?n:h==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w=h==="$"?r:/[%p]/.test(v)?s:"",_=E2[v],A=/[defgprs%]/.test(v);b=b===void 0?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function F(R){var D=S,O=w,T,k,C;if(v==="c")O=_(R)+O,R="";else{R=+R;var N=R<0||1/R<0;if(R=isNaN(R)?u:_(Math.abs(R),b),E&&(R=e$(R)),N&&+R==0&&m!=="+"&&(N=!1),D=(N?m==="("?m:a:m==="-"||m==="("?"":m)+D,O=(v==="s"?r$[8+x2/3]:"")+O+(N&&m==="("?")":""),A){for(T=-1,k=R.length;++T<k;)if(C=R.charCodeAt(T),48>C||C>57){O=(C===46?i+R.slice(T+1):R.slice(T))+O,R=R.slice(0,T);break}}}x&&!g&&(R=t(R,1/0));var I=D.length+R.length+O.length,L=I<y?new Array(y-I+1).join(d):"";switch(x&&g&&(R=t(L+R,L.length?y-O.length:1/0),L=""),p){case"<":R=D+R+O+L;break;case"=":R=D+L+R+O;break;case"^":R=L.slice(0,I=L.length>>1)+D+R+O+L.slice(I);break;default:R=L+D+R+O;break}return o(R)}return F.toString=function(){return f+""},F}function c(f,d){var p=l((f=Ci(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(Ds(d)/3)))*3,h=Math.pow(10,-m),g=r$[8+m/3];return function(y){return p(h*y)+g}}return{format:l,formatPrefix:c}}var Ux,Ru,ed;w2({thousands:",",grouping:[3],currency:["$",""]});function w2(e){return Ux=dh(e),Ru=Ux.format,ed=Ux.formatPrefix,Ux}function ph(e){return Math.max(0,-Ds(Math.abs(e)))}function mh(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ds(t)/3)))*3-Ds(Math.abs(e)))}function hh(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ds(t)-Ds(e))+1}var S2=new Date,A2=new Date;function ft(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{let s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{let u=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;let l;do u.push(l=new Date(+o)),t(o,a),e(o);while(l<o&&o<s);return u},i.filter=o=>ft(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(S2.setTime(+o),A2.setTime(+s),e(S2),e(A2),Math.floor(n(S2,A2))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}var No=ft(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);No.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ft(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):No);var i$=No.range;var rr=ft(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),o$=rr.range;var Tu=ft(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),iZ=Tu.range,Du=ft(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),oZ=Du.range;var Mu=ft(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),sZ=Mu.range,Nu=ft(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),aZ=Nu.range;var ti=ft(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),uZ=ti.range,Qi=ft(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),lZ=Qi.range,zx=ft(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),cZ=zx.range;function rc(e){return ft(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var Ji=rc(0),td=rc(1),a$=rc(2),u$=rc(3),Ou=rc(4),l$=rc(5),c$=rc(6),f$=Ji.range,fZ=td.range,dZ=a$.range,pZ=u$.range,mZ=Ou.range,hZ=l$.range,gZ=c$.range;function ic(e){return ft(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/6048e5)}var Zi=ic(0),nd=ic(1),d$=ic(2),p$=ic(3),Iu=ic(4),m$=ic(5),h$=ic(6),g$=Zi.range,yZ=nd.range,xZ=d$.range,bZ=p$.range,EZ=Iu.range,vZ=m$.range,wZ=h$.range;var ka=ft(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),SZ=ka.range,Fa=ft(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),AZ=Fa.range;var Rr=ft(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Rr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ft(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});var _Z=Rr.range,Tr=ft(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Tr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ft(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});var CZ=Tr.range;function x$(e,t,n,r,i,o){let s=[[rr,1,1e3],[rr,5,5*1e3],[rr,15,15*1e3],[rr,30,30*1e3],[o,1,6e4],[o,5,5*6e4],[o,15,15*6e4],[o,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[r,1,864e5],[r,2,2*864e5],[n,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function a(l,c,f){let d=c<l;d&&([l,c]=[c,l]);let p=f&&typeof f.range=="function"?f:u(l,c,f),m=p?p.range(l,+c+1):[];return d?m.reverse():m}function u(l,c,f){let d=Math.abs(c-l)/f,p=_i(([,,g])=>g).right(s,d);if(p===s.length)return e.every(Fr(l/31536e6,c/31536e6,f));if(p===0)return No.every(Math.max(Fr(l,c,f),1));let[m,h]=s[d/s[p-1][2]<s[p][2]/d?p-1:p];return m.every(h)}return[a,u]}var[_2,C2]=x$(Tr,Fa,Zi,zx,Nu,Du),[k2,F2]=x$(Rr,ka,Ji,ti,Mu,Tu);var En="year",Dr="quarter",$n="month",Zt="week",Mr="date",Pn="day",Ns="dayofyear",ni="hours",ri="minutes",ki="seconds",eo="milliseconds",Hx=[En,Dr,$n,Zt,Mr,Pn,Ns,ni,ri,ki,eo],R2=Hx.reduce((e,t,n)=>(e[t]=1+n,e),{});function qx(e){let t=Q(e).slice(),n={};return t.length||U("Missing time unit."),t.forEach(i=>{ee(R2,i)?n[i]=1:U(`Invalid time unit: ${i}.`)}),(n[Zt]||n[Pn]?1:0)+(n[Dr]||n[$n]||n[Mr]?1:0)+(n[Ns]?1:0)>1&&U(`Incompatible time units: ${e}`),t.sort((i,o)=>R2[i]-R2[o]),t}var FZ={[En]:"%Y ",[Dr]:"Q%q ",[$n]:"%b ",[Mr]:"%d ",[Zt]:"W%U ",[Pn]:"%a ",[Ns]:"%j ",[ni]:"%H:00",[ri]:"00:%M",[ki]:":%S",[eo]:".%L",[`${En}-${$n}`]:"%Y-%m ",[`${En}-${$n}-${Mr}`]:"%Y-%m-%d ",[`${ni}-${ri}`]:"%H:%M"};function I2(e,t){let n=ve({},FZ,t),r=qx(e),i=r.length,o="",s=0,a,u;for(s=0;s<i;)for(a=r.length;a>s;--a)if(u=r.slice(s,a).join("-"),n[u]!=null){o+=n[u],s=a;break}return o.trim()}var oc=new Date;function P2(e){return oc.setFullYear(e),oc.setMonth(0),oc.setDate(1),oc.setHours(0,0,0,0),oc}function $2(e){return v$(new Date(e))}function B2(e){return T2(new Date(e))}function v$(e){return ti.count(P2(e.getFullYear())-1,e)}function T2(e){return Ji.count(P2(e.getFullYear())-1,e)}function D2(e){return P2(e).getDay()}function RZ(e,t,n,r,i,o,s){if(0<=e&&e<100){let a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function L2(e){return w$(new Date(e))}function U2(e){return M2(new Date(e))}function w$(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return Qi.count(t-1,e)}function M2(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return Zi.count(t-1,e)}function N2(e){return oc.setTime(Date.UTC(e,0,1)),oc.getUTCDay()}function TZ(e,t,n,r,i,o,s){if(0<=e&&e<100){let a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function S$(e,t,n,r,i){let o=t||1,s=Te(e),a=(y,x,b)=>(b=b||y,DZ(n[b],r[b],y===s&&o,x)),u=new Date,l=Jt(e),c=l[En]?a(En):St(2012),f=l[$n]?a($n):l[Dr]?a(Dr):To,d=l[Zt]&&l[Pn]?a(Pn,1,Zt+Pn):l[Zt]?a(Zt,1):l[Pn]?a(Pn,1):l[Mr]?a(Mr,1):l[Ns]?a(Ns,1):Rs,p=l[ni]?a(ni):To,m=l[ri]?a(ri):To,h=l[ki]?a(ki):To,g=l[eo]?a(eo):To;return function(y){u.setTime(+y);let x=c(u);return i(x,f(u),d(u,x),p(u),m(u),h(u),g(u))}}function DZ(e,t,n,r){let i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}function rd(e,t,n){return t+e*7-(n+6)%7}var MZ={[En]:e=>e.getFullYear(),[Dr]:e=>Math.floor(e.getMonth()/3),[$n]:e=>e.getMonth(),[Mr]:e=>e.getDate(),[ni]:e=>e.getHours(),[ri]:e=>e.getMinutes(),[ki]:e=>e.getSeconds(),[eo]:e=>e.getMilliseconds(),[Ns]:e=>v$(e),[Zt]:e=>T2(e),[Zt+Pn]:(e,t)=>rd(T2(e),e.getDay(),D2(t)),[Pn]:(e,t)=>rd(1,e.getDay(),D2(t))},NZ={[Dr]:e=>3*e,[Zt]:(e,t)=>rd(e,0,D2(t))};function z2(e,t){return S$(e,t||1,MZ,NZ,RZ)}var OZ={[En]:e=>e.getUTCFullYear(),[Dr]:e=>Math.floor(e.getUTCMonth()/3),[$n]:e=>e.getUTCMonth(),[Mr]:e=>e.getUTCDate(),[ni]:e=>e.getUTCHours(),[ri]:e=>e.getUTCMinutes(),[ki]:e=>e.getUTCSeconds(),[eo]:e=>e.getUTCMilliseconds(),[Ns]:e=>w$(e),[Zt]:e=>M2(e),[Pn]:(e,t)=>rd(1,e.getUTCDay(),N2(t)),[Zt+Pn]:(e,t)=>rd(M2(e),e.getUTCDay(),N2(t))},IZ={[Dr]:e=>3*e,[Zt]:(e,t)=>rd(e,0,N2(t))};function H2(e,t){return S$(e,t||1,OZ,IZ,TZ)}var PZ={[En]:Rr,[Dr]:ka.every(3),[$n]:ka,[Zt]:Ji,[Mr]:ti,[Pn]:ti,[Ns]:ti,[ni]:Mu,[ri]:Tu,[ki]:rr,[eo]:No},$Z={[En]:Tr,[Dr]:Fa.every(3),[$n]:Fa,[Zt]:Zi,[Mr]:Qi,[Pn]:Qi,[Ns]:Qi,[ni]:Nu,[ri]:Du,[ki]:rr,[eo]:No};function Ra(e){return PZ[e]}function Ta(e){return $Z[e]}function A$(e,t,n){return e?e.offset(t,n):void 0}function q2(e,t,n){return A$(Ra(e),t,n)}function G2(e,t,n){return A$(Ta(e),t,n)}function _$(e,t,n,r){return e?e.range(t,n,r):void 0}function j2(e,t,n,r){return _$(Ra(e),t,n,r)}function W2(e,t,n,r){return _$(Ta(e),t,n,r)}var xh=1e3,bh=xh*60,Eh=bh*60,Gx=Eh*24,BZ=Gx*7,b$=Gx*30,O2=Gx*365,C$=[En,$n,Mr,ni,ri,ki,eo],vh=C$.slice(0,-1),wh=vh.slice(0,-1),Sh=wh.slice(0,-1),LZ=Sh.slice(0,-1),UZ=[En,Zt],E$=[En,$n],k$=[En],yh=[[vh,1,xh],[vh,5,5*xh],[vh,15,15*xh],[vh,30,30*xh],[wh,1,bh],[wh,5,5*bh],[wh,15,15*bh],[wh,30,30*bh],[Sh,1,Eh],[Sh,3,3*Eh],[Sh,6,6*Eh],[Sh,12,12*Eh],[LZ,1,Gx],[UZ,1,BZ],[E$,1,b$],[E$,3,3*b$],[k$,1,O2]];function V2(e){let t=e.extent,n=e.maxbins||40,r=Math.abs(Aa(t))/n,i=_i(a=>a[2]).right(yh,r),o,s;return i===yh.length?(o=k$,s=Fr(t[0]/O2,t[1]/O2,n)):i?(i=yh[r/yh[i-1][2]<yh[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=C$,s=Math.max(Fr(t[0],t[1],n),1)),{units:o,step:s}}function Y2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function X2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ah(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function id(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,l=_h(i),c=Ch(i),f=_h(o),d=Ch(o),p=_h(s),m=Ch(s),h=_h(a),g=Ch(a),y=_h(u),x=Ch(u),b={a:N,A:I,b:L,B:te,c:null,d:N$,e:N$,f:lee,g:bee,G:vee,H:see,I:aee,j:uee,L:B$,m:cee,M:fee,p:ie,q:oe,Q:P$,s:$$,S:dee,u:pee,U:mee,V:hee,w:gee,W:yee,x:null,X:null,y:xee,Y:Eee,Z:wee,"%":I$},E={a:Se,A:Oe,b:we,B:Qt,c:null,d:O$,e:O$,f:Cee,g:Pee,G:Bee,H:See,I:Aee,j:_ee,L:U$,m:kee,M:Fee,p:Ro,q:Ai,Q:P$,s:$$,S:Ree,u:Tee,U:Dee,V:Mee,w:Nee,W:Oee,x:null,X:null,y:Iee,Y:$ee,Z:Lee,"%":I$},v={a:F,A:R,b:D,B:O,c:T,d:D$,e:D$,f:nee,g:T$,G:R$,H:M$,I:M$,j:JZ,L:tee,m:QZ,M:ZZ,p:A,q:KZ,Q:iee,s:oee,S:eee,u:jZ,U:WZ,V:VZ,w:GZ,W:YZ,x:k,X:C,y:T$,Y:R$,Z:XZ,"%":ree};b.x=S(n,b),b.X=S(r,b),b.c=S(t,b),E.x=S(n,E),E.X=S(r,E),E.c=S(t,E);function S(ce,Fe){return function($e){var ne=[],In=-1,nt=0,Zn=ce.length,yn,Cs,xx;for($e instanceof Date||($e=new Date(+$e));++In<Zn;)ce.charCodeAt(In)===37&&(ne.push(ce.slice(nt,In)),(Cs=F$[yn=ce.charAt(++In)])!=null?yn=ce.charAt(++In):Cs=yn==="e"?" ":"0",(xx=Fe[yn])&&(yn=xx($e,Cs)),ne.push(yn),nt=In+1);return ne.push(ce.slice(nt,In)),ne.join("")}}function w(ce,Fe){return function($e){var ne=Ah(1900,void 0,1),In=_(ne,ce,$e+="",0),nt,Zn;if(In!=$e.length)return null;if("Q"in ne)return new Date(ne.Q);if("s"in ne)return new Date(ne.s*1e3+("L"in ne?ne.L:0));if(Fe&&!("Z"in ne)&&(ne.Z=0),"p"in ne&&(ne.H=ne.H%12+ne.p*12),ne.m===void 0&&(ne.m="q"in ne?ne.q:0),"V"in ne){if(ne.V<1||ne.V>53)return null;"w"in ne||(ne.w=1),"Z"in ne?(nt=X2(Ah(ne.y,0,1)),Zn=nt.getUTCDay(),nt=Zn>4||Zn===0?nd.ceil(nt):nd(nt),nt=Qi.offset(nt,(ne.V-1)*7),ne.y=nt.getUTCFullYear(),ne.m=nt.getUTCMonth(),ne.d=nt.getUTCDate()+(ne.w+6)%7):(nt=Y2(Ah(ne.y,0,1)),Zn=nt.getDay(),nt=Zn>4||Zn===0?td.ceil(nt):td(nt),nt=ti.offset(nt,(ne.V-1)*7),ne.y=nt.getFullYear(),ne.m=nt.getMonth(),ne.d=nt.getDate()+(ne.w+6)%7)}else("W"in ne||"U"in ne)&&("w"in ne||(ne.w="u"in ne?ne.u%7:"W"in ne?1:0),Zn="Z"in ne?X2(Ah(ne.y,0,1)).getUTCDay():Y2(Ah(ne.y,0,1)).getDay(),ne.m=0,ne.d="W"in ne?(ne.w+6)%7+ne.W*7-(Zn+5)%7:ne.w+ne.U*7-(Zn+6)%7);return"Z"in ne?(ne.H+=ne.Z/100|0,ne.M+=ne.Z%100,X2(ne)):Y2(ne)}}function _(ce,Fe,$e,ne){for(var In=0,nt=Fe.length,Zn=$e.length,yn,Cs;In<nt;){if(ne>=Zn)return-1;if(yn=Fe.charCodeAt(In++),yn===37){if(yn=Fe.charAt(In++),Cs=v[yn in F$?Fe.charAt(In++):yn],!Cs||(ne=Cs(ce,$e,ne))<0)return-1}else if(yn!=$e.charCodeAt(ne++))return-1}return ne}function A(ce,Fe,$e){var ne=l.exec(Fe.slice($e));return ne?(ce.p=c.get(ne[0].toLowerCase()),$e+ne[0].length):-1}function F(ce,Fe,$e){var ne=p.exec(Fe.slice($e));return ne?(ce.w=m.get(ne[0].toLowerCase()),$e+ne[0].length):-1}function R(ce,Fe,$e){var ne=f.exec(Fe.slice($e));return ne?(ce.w=d.get(ne[0].toLowerCase()),$e+ne[0].length):-1}function D(ce,Fe,$e){var ne=y.exec(Fe.slice($e));return ne?(ce.m=x.get(ne[0].toLowerCase()),$e+ne[0].length):-1}function O(ce,Fe,$e){var ne=h.exec(Fe.slice($e));return ne?(ce.m=g.get(ne[0].toLowerCase()),$e+ne[0].length):-1}function T(ce,Fe,$e){return _(ce,t,Fe,$e)}function k(ce,Fe,$e){return _(ce,n,Fe,$e)}function C(ce,Fe,$e){return _(ce,r,Fe,$e)}function N(ce){return s[ce.getDay()]}function I(ce){return o[ce.getDay()]}function L(ce){return u[ce.getMonth()]}function te(ce){return a[ce.getMonth()]}function ie(ce){return i[+(ce.getHours()>=12)]}function oe(ce){return 1+~~(ce.getMonth()/3)}function Se(ce){return s[ce.getUTCDay()]}function Oe(ce){return o[ce.getUTCDay()]}function we(ce){return u[ce.getUTCMonth()]}function Qt(ce){return a[ce.getUTCMonth()]}function Ro(ce){return i[+(ce.getUTCHours()>=12)]}function Ai(ce){return 1+~~(ce.getUTCMonth()/3)}return{format:function(ce){var Fe=S(ce+="",b);return Fe.toString=function(){return ce},Fe},parse:function(ce){var Fe=w(ce+="",!1);return Fe.toString=function(){return ce},Fe},utcFormat:function(ce){var Fe=S(ce+="",E);return Fe.toString=function(){return ce},Fe},utcParse:function(ce){var Fe=w(ce+="",!0);return Fe.toString=function(){return ce},Fe}}}var F$={"-":"",_:" ",0:"0"},vn=/^\s*\d+/,zZ=/^%/,HZ=/[\\^$*+?|[\]().{}]/g;function Ke(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function qZ(e){return e.replace(HZ,"\\$&")}function _h(e){return new RegExp("^(?:"+e.map(qZ).join("|")+")","i")}function Ch(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function GZ(e,t,n){var r=vn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function jZ(e,t,n){var r=vn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function WZ(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function VZ(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function YZ(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function R$(e,t,n){var r=vn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function T$(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function XZ(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function KZ(e,t,n){var r=vn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function QZ(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function D$(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function JZ(e,t,n){var r=vn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function M$(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function ZZ(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function eee(e,t,n){var r=vn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function tee(e,t,n){var r=vn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function nee(e,t,n){var r=vn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function ree(e,t,n){var r=zZ.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function iee(e,t,n){var r=vn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function oee(e,t,n){var r=vn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function N$(e,t){return Ke(e.getDate(),t,2)}function see(e,t){return Ke(e.getHours(),t,2)}function aee(e,t){return Ke(e.getHours()%12||12,t,2)}function uee(e,t){return Ke(1+ti.count(Rr(e),e),t,3)}function B$(e,t){return Ke(e.getMilliseconds(),t,3)}function lee(e,t){return B$(e,t)+"000"}function cee(e,t){return Ke(e.getMonth()+1,t,2)}function fee(e,t){return Ke(e.getMinutes(),t,2)}function dee(e,t){return Ke(e.getSeconds(),t,2)}function pee(e){var t=e.getDay();return t===0?7:t}function mee(e,t){return Ke(Ji.count(Rr(e)-1,e),t,2)}function L$(e){var t=e.getDay();return t>=4||t===0?Ou(e):Ou.ceil(e)}function hee(e,t){return e=L$(e),Ke(Ou.count(Rr(e),e)+(Rr(e).getDay()===4),t,2)}function gee(e){return e.getDay()}function yee(e,t){return Ke(td.count(Rr(e)-1,e),t,2)}function xee(e,t){return Ke(e.getFullYear()%100,t,2)}function bee(e,t){return e=L$(e),Ke(e.getFullYear()%100,t,2)}function Eee(e,t){return Ke(e.getFullYear()%1e4,t,4)}function vee(e,t){var n=e.getDay();return e=n>=4||n===0?Ou(e):Ou.ceil(e),Ke(e.getFullYear()%1e4,t,4)}function wee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ke(t/60|0,"0",2)+Ke(t%60,"0",2)}function O$(e,t){return Ke(e.getUTCDate(),t,2)}function See(e,t){return Ke(e.getUTCHours(),t,2)}function Aee(e,t){return Ke(e.getUTCHours()%12||12,t,2)}function _ee(e,t){return Ke(1+Qi.count(Tr(e),e),t,3)}function U$(e,t){return Ke(e.getUTCMilliseconds(),t,3)}function Cee(e,t){return U$(e,t)+"000"}function kee(e,t){return Ke(e.getUTCMonth()+1,t,2)}function Fee(e,t){return Ke(e.getUTCMinutes(),t,2)}function Ree(e,t){return Ke(e.getUTCSeconds(),t,2)}function Tee(e){var t=e.getUTCDay();return t===0?7:t}function Dee(e,t){return Ke(Zi.count(Tr(e)-1,e),t,2)}function z$(e){var t=e.getUTCDay();return t>=4||t===0?Iu(e):Iu.ceil(e)}function Mee(e,t){return e=z$(e),Ke(Iu.count(Tr(e),e)+(Tr(e).getUTCDay()===4),t,2)}function Nee(e){return e.getUTCDay()}function Oee(e,t){return Ke(nd.count(Tr(e)-1,e),t,2)}function Iee(e,t){return Ke(e.getUTCFullYear()%100,t,2)}function Pee(e,t){return e=z$(e),Ke(e.getUTCFullYear()%100,t,2)}function $ee(e,t){return Ke(e.getUTCFullYear()%1e4,t,4)}function Bee(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Iu(e):Iu.ceil(e),Ke(e.getUTCFullYear()%1e4,t,4)}function Lee(){return"+0000"}function I$(){return"%"}function P$(e){return+e}function $$(e){return Math.floor(+e/1e3)}var od,sd,jx,ad,Wx;K2({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function K2(e){return od=id(e),sd=od.format,jx=od.parse,ad=od.utcFormat,Wx=od.utcParse,od}function kh(e){let t={};return n=>t[n]||(t[n]=e(n))}function Uee(e,t){return n=>{let r=e(n),i=r.indexOf(t);if(i<0)return r;let o=zee(r,i),s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function zee(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function q$(e){let t=kh(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){let i=Ci(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return Uee(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=Ci(s??",f");let a=Fr(r,i,o),u=Math.max(Math.abs(r),Math.abs(i)),l;if(s.precision==null)switch(s.type){case"s":return isNaN(l=mh(a,u))||(s.precision=l),n(s,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=hh(a,u))||(s.precision=l-(s.type==="e"));break}case"f":case"%":{isNaN(l=ph(a))||(s.precision=l-(s.type==="%")*2);break}}return t(s)}}}var Q2;G$();function G$(){return Q2=q$({format:Ru,formatPrefix:ed})}function j$(e){return q$(dh(e))}function Fh(e){return arguments.length?Q2=j$(e):Q2}function H$(e,t,n){n=n||{},X(n)||U(`Invalid time multi-format specifier: ${n}`);let r=t(ki),i=t(ri),o=t(ni),s=t(Mr),a=t(Zt),u=t($n),l=t(Dr),c=t(En),f=e(n[eo]||".%L"),d=e(n[ki]||":%S"),p=e(n[ri]||"%I:%M"),m=e(n[ni]||"%I %p"),h=e(n[Mr]||n[Pn]||"%a %d"),g=e(n[Zt]||"%b %d"),y=e(n[$n]||"%B"),x=e(n[Dr]||"%B"),b=e(n[En]||"%Y");return E=>(r(E)<E?f:i(E)<E?d:o(E)<E?p:s(E)<E?m:u(E)<E?a(E)<E?h:g:c(E)<E?l(E)<E?y:x:b)(E)}function W$(e){let t=kh(e.format),n=kh(e.utcFormat);return{timeFormat:r=>V(r)?t(r):H$(t,Ra,r),utcFormat:r=>V(r)?n(r):H$(n,Ta,r),timeParse:kh(e.parse),utcParse:kh(e.utcParse)}}var J2;V$();function V$(){return J2=W$({format:sd,parse:jx,utcFormat:ad,utcParse:Wx})}function Y$(e){return W$(id(e))}function sc(e){return arguments.length?J2=Y$(e):J2}var Z2=(e,t)=>ve({},e,t);function Vx(e,t){let n=e?j$(e):Fh(),r=t?Y$(t):sc();return Z2(n,r)}function Rh(e,t){let n=arguments.length;return n&&n!==2&&U("defaultLocale expects either zero or two arguments."),n?Z2(Fh(e),sc(t)):Z2(Fh(),sc())}function X$(){return G$(),V$(),Rh()}var Hee=/^(data:|([A-Za-z]+:)?\/\/)/,qee=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Gee=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,K$="file://";function jee(e,t){return n=>({options:n||{},sanitize:Vee,load:Wee,fileAccess:!1,file:Yee(t),http:Kee(e)})}async function Wee(e,t){let n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Vee(e,t){t=ve({},this.options,t);let n=this.fileAccess,r={href:null},i,o,s,a=qee.test(e.replace(Gee,""));(e==null||typeof e!="string"||!a)&&U("Sanitize failure, invalid URI: "+Y(e));let u=Hee.test(e);return(s=t.baseURL)&&!u&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(K$))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(K$.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Yee(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):Xee}async function Xee(){U("No file system access.")}function Kee(e){return e?async function(t,n){let r=ve({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?Ee(o[i])?o[i]():o.text():U(o.status+""+o.statusText)}:Qee}async function Qee(){U("No HTTP fetch method available.")}var Jee=e=>e!=null&&e===e,Zee=e=>e==="true"||e==="false"||e===!0||e===!1,ete=e=>!Number.isNaN(Date.parse(e)),J$=e=>!Number.isNaN(+e)&&!(e instanceof Date),tte=e=>J$(e)&&Number.isInteger(+e),eC={boolean:ih,integer:Gt,number:Gt,date:oh,string:sh,unknown:Ot},Yx=[Zee,tte,J$,ete],nte=["boolean","integer","number","date"];function Z$(e,t){if(!e||!e.length)return"unknown";let n=e.length,r=Yx.length,i=Yx.map((o,s)=>s+1);for(let o=0,s=0,a,u;o<n;++o)for(u=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&Jee(u)&&!Yx[a](u)&&(i[a]=0,++s,s===Yx.length))return"string";return nte[i.reduce((o,s)=>o===0?s:o,0)-1]}function eB(e,t){return t.reduce((n,r)=>(n[r]=Z$(e,r),n),{})}function Q$(e){let t=function(n,r){let i={delimiter:e};return tC(n,r?ve(r,i):i)};return t.responseType="text",t}function tC(e,t){return t.header&&(e=t.header.map(Y).join(t.delimiter)+`
`+e),u2(t.delimiter).parse(e+"")}tC.responseType="text";function rte(e){return typeof Buffer=="function"&&Ee(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function nC(e,t){let n=t&&t.property?bn(t.property):Ot;return X(e)&&!rte(e)?ite(n(e),t):n(JSON.parse(e))}nC.responseType="json";function ite(e,t){return!M(e)&&Z_(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}var ote={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function tB(e,t){let n,r,i,o;return e=nC(e,t),t&&t.feature?(n=c2,i=t.feature):t&&t.mesh?(n=d2,i=t.mesh,o=ote[t.filter]):U("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):U("Invalid TopoJSON object: "+i),r&&r.features||[r]}tB.responseType="json";var Xx={dsv:tC,csv:Q$(","),tsv:Q$("	"),json:nC,topojson:tB};function rC(e,t){return arguments.length>1?(Xx[e]=t,this):ee(Xx,e)?Xx[e]:null}function iC(e){let t=rC(e);return t&&t.responseType||"text"}function oC(e,t,n,r){t=t||{};let i=rC(t.type||"json");return i||U("Unknown data format type: "+t.type),e=i(e,t),t.parse&&ste(e,t.parse,n,r),ee(e,"columns")&&delete e.columns,e}function ste(e,t,n,r){if(!e.length)return;let i=sc();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,u,l,c,f;t==="auto"&&(t=eB(e,o)),o=Object.keys(t);let d=o.map(p=>{let m=t[p],h,g;if(m&&(m.startsWith("date:")||m.startsWith("utc:")))return h=m.split(/:(.+)?/,2),g=h[1],(g[0]==="'"&&g[g.length-1]==="'"||g[0]==='"'&&g[g.length-1]==='"')&&(g=g.slice(1,-1)),(h[0]==="utc"?r:n)(g);if(!eC[m])throw Error("Illegal format pattern: "+p+":"+m);return eC[m]});for(u=0,c=e.length,f=o.length;u<c;++u)for(s=e[u],l=0;l<f;++l)a=o[l],s[a]=d[l](s[a])}var ud=jee(typeof fetch<"u"&&fetch,null);function Zx(e){let t=e||Ot,n=[],r={};return n.add=i=>{let o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{let o=t(i);if(r[o]){r[o]=0;let s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}async function Mh(e,t){try{await t(e)}catch(n){e.error(n)}}var uB=Symbol("vega_id"),ate=1;function ac(e){return!!(e&&he(e))}function he(e){return e[uB]}function lB(e,t){return e[uB]=t,e}function Le(e){let t=e===Object(e)?e:{data:e};return he(t)?t:lB(t,ate++)}function e1(e){return uc(e,Le({}))}function uc(e,t){for(let n in e)t[n]=e[n];return t}function t1(e,t){return lB(t,he(e))}function Is(e,t){return e?t?(n,r)=>e(n,r)||he(t(n))-he(t(r)):(n,r)=>e(n,r)||he(n)-he(r):null}function aC(e){return e&&e.constructor===Oa}function Oa(){let e=[],t=[],n=[],r=[],i=[],o=null,s=!1;return{constructor:Oa,insert(a){let u=Q(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){let u=Ee(a)?r:t,l=Q(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){let c={field:u,value:St(l)};return Ee(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return Ee(a)?i.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,u){let l={},c={},f,d,p,m,h,g;for(f=0,d=u.length;f<d;++f)l[he(u[f])]=1;for(f=0,d=t.length;f<d;++f)h=t[f],l[he(h)]=-1;for(f=0,d=r.length;f<d;++f)m=r[f],u.forEach(x=>{m(x)&&(l[he(x)]=-1)});for(f=0,d=e.length;f<d;++f)h=e[f],g=he(h),l[g]?l[g]=1:a.add.push(Le(e[f]));for(f=0,d=u.length;f<d;++f)h=u[f],l[he(h)]<0&&a.rem.push(h);function y(x,b,E){E?x[b]=E(x):a.encode=b,s||(c[he(x)]=x)}for(f=0,d=n.length;f<d;++f)p=n[f],h=p.tuple,m=p.field,g=l[he(h)],g>0&&(y(h,m,p.value),a.modifies(m));for(f=0,d=i.length;f<d;++f)p=i[f],m=p.filter,u.forEach(x=>{m(x)&&l[he(x)]>0&&y(x,p.field,p.value)}),a.modifies(p.field);if(s)a.mod=t.length||r.length?u.filter(x=>l[he(x)]>0):u.slice();else for(g in c)a.mod.push(c[g]);return(o||o==null&&(t.length||r.length))&&a.clean(!0),a}}}var Qx="_:mod:_";function Nh(){Object.defineProperty(this,Qx,{writable:!0,value:{}})}Nh.prototype={set(e,t,n,r){let i=this,o=i[e],s=i[Qx];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=M(n)?1+n.length:-1),i},modified(e,t){let n=this[Qx];if(arguments.length){if(M(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(let r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Qx]={},this}};var ute=0,lte="pulse",cte=new Nh,fte=1,dte=2;function rt(e,t,n,r){this.id=++ute,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function nB(e){return function(t){let n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}rt.prototype={targets(){return this._targets||(this._targets=Zx(Yf))},set(e){return this.value!==e?(this.value=e,1):0},skip:nB(fte),modified:nB(dte),parameters(e,t,n){t=t!==!1;let r=this._argval=this._argval||new Nh,i=this._argops=this._argops||[],o=[],s,a,u,l,c=(f,d,p)=>{p instanceof rt?(p!==this&&(t&&p.targets().add(this),o.push(p)),i.push({op:p,name:f,index:d})):r.set(f,d,p)};for(s in e)if(a=e[s],s===lte)Q(a).forEach(f=>{f instanceof rt?f!==this&&(f.targets().add(this),o.push(f)):U("Pulse parameters must be operator instances.")}),this.source=a;else if(M(a))for(r.set(s,-1,Array(u=a.length)),l=0;l<u;++l)c(s,l,a[l]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){let t=this._argval||cte,n=this._argops,r,i,o,s;if(n){let a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){let e=this._argops,t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){let t=this._update;if(t){let n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function pte(e,t,n,r){let i=1,o;return e instanceof rt?o=e:e&&e.prototype instanceof rt?o=new e:Ee(e)?o=new rt(null,e):(i=0,o=new rt(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function mte(e,t){let n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}var hte=0;function cd(e,t,n){this.id=++hte,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Pu(e,t,n){return new cd(e,t,n)}cd.prototype={_filter:cn,_apply:Ot,targets(){return this._targets||(this._targets=Zx(Yf))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){let t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){let t=Pu(e);return this.targets().add(t),t},apply(e){let t=Pu(null,e);return this.targets().add(t),t},merge(){let e=Pu();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{let n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){let t=Pu();return this.targets().add(Pu(null,null,nh(e,n=>{let r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Pu(null,null,()=>n=!0)),t.targets().add(Pu(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=cn,this._targets=null}};function gte(e,t,n,r){let i=this,o=Pu(n,r),s=function(l){l.dataflow=i;try{o.receive(l)}catch(c){i.error(c)}finally{i.run()}},a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=Q(e);let u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,s);return o}function yte(e,t){let n=this.locale();return oC(e,t,n.timeParse,n.utcParse)}function xte(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function bte(e,t){let n=this,r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:iC(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function Ete(e,t,n){let r=this,i=r._pending||vte(r);i.requests+=1;let o=await r.request(t,n);return r.pulse(e,r.changeset().remove(cn).insert(o.data||[])),i.done(),o}function vte(e){let t,n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}var wte={skip:!0};function Ste(e,t,n,r,i){return(e instanceof rt?_te:Ate)(this,e,t,n,r,i),this}function Ate(e,t,n,r,i,o){let s=ve({},o,wte),a,u;Ee(n)||(n=St(n)),r===void 0?a=l=>e.touch(n(l)):Ee(r)?(u=new rt(null,r,i,!1),a=l=>{u.evaluate(l);let c=n(l),f=u.value;aC(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=l=>e.update(n(l),r,s),t.apply(a)}function _te(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{let s=o||{},a=new rt(null,Cte(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function Cte(e,t){return t=Ee(t)?t:St(t),e?function(n,r){let i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function kte(e){e.rank=++this._rank}function Fte(e){let t=[e],n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&U("Cycle detected in dataflow graph.")}var Jx={},Os=1,$u=2,Da=4,Rte=Os|$u,rB=Os|Da,ld=Os|$u|Da,iB=8,Th=16,oB=32,sB=64;function Ma(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function sC(e,t){let n=[];return _a(e,t,r=>n.push(r)),n}function aB(e,t){let n={};return e.visit(t,r=>{n[he(r)]=1}),r=>n[he(r)]?null:r}function Kx(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}Ma.prototype={StopPropagation:Jx,ADD:Os,REM:$u,MOD:Da,ADD_REM:Rte,ADD_MOD:rB,ALL:ld,REFLOW:iB,SOURCE:Th,NO_SOURCE:oB,NO_FIELDS:sB,fork(e){return new Ma(this.dataflow).init(this,e)},clone(){let e=this.fork(ld);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(ld|Th)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Ma(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){let n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&sB)&&(n.fields=e.fields),t&Os?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&$u?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Da?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&oB?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){let t=e||ld;return t&Os&&this.add.length||t&$u&&this.rem.length||t&Da&&this.mod.length},reflow(e){if(e)return this.fork(ld).reflow();let t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Da,aB(this,Os))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){let t=this.fields||(this.fields={});return M(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){let n=this.fields;return(t||this.mod.length)&&n?arguments.length?M(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){let n=this;return e&Os&&(n.addF=Kx(n.addF,t)),e&$u&&(n.remF=Kx(n.remF,t)),e&Da&&(n.modF=Kx(n.modF,t)),e&Th&&(n.srcF=Kx(n.srcF,t)),n},materialize(e){e=e||ld;let t=this;return e&Os&&t.addF&&(t.add=sC(t.add,t.addF),t.addF=null),e&$u&&t.remF&&(t.rem=sC(t.rem,t.remF),t.remF=null),e&Da&&t.modF&&(t.mod=sC(t.mod,t.modF),t.modF=null),e&Th&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){let n=this,r=t;if(e&Th)return _a(n.source,n.srcF,r),n;e&Os&&_a(n.add,n.addF,r),e&$u&&_a(n.rem,n.remF,r),e&Da&&_a(n.mod,n.modF,r);let i=n.source;if(e&iB&&i){let o=n.add.length+n.mod.length;o===i.length||(o?_a(i,aB(n,rB),r):_a(i,n.srcF,r))}return n}};function n1(e,t,n,r){let i=this,o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s of n)if(s.stamp===t){if(s.fields){let a=i.fields||(i.fields={});for(let u in s.fields)a[u]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}Z(n1,Ma,{fork(e){let t=new Ma(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){let t=this,n=t.fields;return n&&t.changes&t.MOD?M(e)?e.some(r=>n[r]):n[e]:0},filter(){U("MultiPulse does not support filtering.")},materialize(){U("MultiPulse does not support materialization.")},visit(e,t){let n=this,r=n.pulses,i=r.length,o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function Tte(e,t,n){let r=this,i=[];if(r._pulse)return cB(r);if(r._pending&&await r._pending,t&&await Mh(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;let o=++r._clock;r._pulse=new Ma(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=Zx(Yf);let s=0,a,u,l;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}u=a.run(r._getPulse(a,e)),u.then?u=await u:u.async&&(i.push(u.async),u=Jx),u!==Jx&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++s}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){let c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await Mh(r,c[f].callback)}return n&&await Mh(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function Dte(e,t,n){for(;this._running;)await this._running;let r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function Mte(e,t,n){return this._pulse?cB(this):(this.evaluate(e,t,n),this)}function Nte(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function cB(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function Ote(e,t){let n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function Ite(e,t){let n=e.source,r=this._clock;return n&&M(n)?new n1(this,r,n.map(i=>i.pulse),t):this._input[e.id]||Pte(this._pulse,n&&n.pulse)}function Pte(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Jx&&(e.source=t.source),e)}var uC={skip:!1,force:!1};function $te(e,t){let n=t||uC;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function Bte(e,t,n){let r=n||uC;return(e.set(t)||r.force)&&this.touch(e,r),this}function Lte(e,t,n){this.touch(e,n||uC);let r=new Ma(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function Ute(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),fB(t,0,t.length-1,e)),pop:()=>{let n=t.pop(),r;return t.length?(r=t[0],t[0]=n,zte(t,0,e)):r=n,r}}}function fB(e,t,n,r){let i,o,s=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(s,i)<0){e[n]=i,n=o;continue}break}return e[n]=s}function zte(e,t,n){let r=t,i=e.length,o=e[t],s=(t<<1)+1,a;for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,fB(e,r,t,n)}function Bu(){this.logger(Qm()),this.logLevel(Km),this._clock=0,this._rank=0,this._locale=Rh();try{this._loader=ud()}catch{}this._touched=Zx(Yf),this._input={},this._pulse=null,this._heap=Ute((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Dh(e){return function(){return this._log[e].apply(this,arguments)}}Bu.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Dh("error"),warn:Dh("warn"),info:Dh("info"),debug:Dh("debug"),logLevel:Dh("level"),cleanThreshold:1e4,add:pte,connect:mte,rank:kte,rerank:Fte,pulse:Lte,touch:$te,update:Bte,changeset:Oa,ingest:xte,parse:yte,preload:Ete,request:bte,events:gte,on:Ste,evaluate:Tte,run:Mte,runAsync:Dte,runAfter:Nte,_enqueue:Ote,_getPulse:Ite};function B(e,t){rt.call(this,e,null,t)}Z(B,rt,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){let t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});var Na={};function r1(e){let t=lC(e);return t&&t.Definition||null}function lC(e){return e=e&&e.toLowerCase(),ee(Na,e)?Na[e]:null}var XC={};er(XC,{aggregate:()=>Lu,bin:()=>_C,collect:()=>CC,compare:()=>SB,countpattern:()=>kC,cross:()=>FC,density:()=>RC,dotbin:()=>DC,expression:()=>FB,extent:()=>MC,facet:()=>S1,field:()=>RB,filter:()=>OC,flatten:()=>IC,fold:()=>PC,formula:()=>$C,generate:()=>TB,impute:()=>BC,joinaggregate:()=>LC,kde:()=>UC,key:()=>DB,load:()=>MB,lookup:()=>zC,multiextent:()=>NB,multivalues:()=>OB,params:()=>IB,pivot:()=>HC,prefacet:()=>PB,project:()=>qC,proxy:()=>$B,quantile:()=>GC,relay:()=>BB,sample:()=>jC,sequence:()=>WC,sieve:()=>LB,subflow:()=>NC,timeunit:()=>VC,tupleindex:()=>zB,values:()=>HB,window:()=>YC});function*mB(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function i1(e,t,n){let r=Float64Array.from(mB(e,n));return r.sort(nr),t.map(i=>fh(r,i))}function o1(e,t){return i1(e,[.25,.5,.75],t)}function s1(e,t){let n=e.length,r=Mx(e,t),i=o1(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function cC(e){let t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2],o=e.extent[0],s=e.extent[1],a,u,l,c,f,d,p=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=p/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(p)/r)-u));Math.ceil(p/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=l&&p/c<=t&&(a=c)}c=Math.log(a);let m=c>=0?0:~~(-c/r)+1,h=Math.pow(n,-m-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/a+h)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var Nr=Math.random;function Hte(e){Nr=e}function fC(e,t,n,r){if(!e.length)return[void 0,void 0];let i=Float64Array.from(mB(e,r)),o=i.length,s=t,a,u,l,c;for(l=0,c=Array(s);l<s;++l){for(a=0,u=0;u<o;++u)a+=i[~~(Nr()*o)];c[l]=a/o}return c.sort(nr),[Zl(c,n/2),Zl(c,1-n/2)]}function dC(e,t,n,r){r=r||(d=>d);let i=e.length,o=new Float64Array(i),s=0,a=1,u=r(e[0]),l=u,c=u+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(l=(u+l)/2;s<a;++s)o[s]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;s<a;++s)o[s]=l;return n?qte(o,t+t/4):o}function qte(e,t){let n=e.length,r=0,i=1,o,s;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}function Gte(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function jte(e,t){t==null&&(t=e,e=0);let n,r,i,o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample(){return n+Math.floor(i*Nr())},pdf(s){return s===Math.floor(s)&&s>=n&&s<r?1/i:0},cdf(s){let a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*i):NaN}};return o.min(e).max(t)}var hB=Math.sqrt(2*Math.PI),Wte=Math.SQRT2,Oh=NaN;function Ih(e,t){e=e||0,t=t??1;let n=0,r=0,i,o;if(Oh===Oh)n=Oh,Oh=NaN;else{do n=Nr()*2-1,r=Nr()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,Oh=r*o}return e+n*t}function a1(e,t,n){n=n??1;let r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*hB)}function Ph(e,t,n){t=t||0,n=n??1;let r=(e-t)/n,i=Math.abs(r),o;if(i>37)o=0;else{let s=Math.exp(-i*i/2),a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o=o/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function $h(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*Wte*Vte(2*e-1)}function Vte(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function u1(e,t){let n,r,i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>Ih(n,r),pdf:o=>a1(o,n,r),cdf:o=>Ph(o,n,r),icdf:o=>$h(o,n,r)};return i.mean(e).stdev(t)}function l1(e,t){let n=u1(),r=0,i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=s1(e)),i):t},sample(){return e[~~(Nr()*r)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function c1(e,t){return e=e||0,t=t??1,Math.exp(e+Ih()*t)}function f1(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;let r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*hB*e)}function d1(e,t,n){return Ph(Math.log(e),t,n)}function p1(e,t,n){return Math.exp($h(e,t,n))}function pC(e,t){let n,r,i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>c1(n,r),pdf:o=>f1(o,n,r),cdf:o=>d1(o,n,r),icdf:o=>p1(o,n,r)};return i.mean(e).stdev(t)}function mC(e,t){let n=0,r;function i(s){let a=[],u=0,l;for(l=0;l<n;++l)u+=a[l]=s[l]==null?1:+s[l];for(l=0;l<n;++l)a[l]/=u;return a}let o={weights(s){return arguments.length?(r=i(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){let s=Nr(),a=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(s<u){a=e[l];break}return a.sample()},pdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(s);return a},cdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function m1(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Nr()}function h1(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function g1(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function y1(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function hC(e,t){let n,r,i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o??1,i):r},sample:()=>m1(n,r),pdf:o=>h1(o,n,r),cdf:o=>g1(o,n,r),icdf:o=>y1(o,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function x1(e,t,n){let r=0,i=0;for(let o of e){let s=n(o);t(o)==null||s==null||isNaN(s)||(r+=(s-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function Bh(e,t,n,r){let i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function b1(e,t,n,r){e=e.filter(p=>{let m=t(p),h=n(p);return m!=null&&(m=+m)>=m&&h!=null&&(h=+h)>=h}),r&&e.sort((p,m)=>t(p)-t(m));let i=e.length,o=new Float64Array(i),s=new Float64Array(i),a=0,u=0,l=0,c,f,d;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<i;++a)o[a]-=u,s[a]-=l;return[o,s,u,l]}function Lh(e,t,n,r){let i=-1,o,s;for(let a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&r(o,s,++i)}function fd(e,t,n,r,i){let o=0,s=0;return Lh(e,t,n,(a,u)=>{let l=u-i(a),c=u-r;o+=l*l,s+=c*c}),1-o/s}function E1(e,t,n){let r=0,i=0,o=0,s=0,a=0;Lh(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});let u=Bh(r,i,o,s),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:fd(e,t,n,i,l)}}function gC(e,t,n){let r=0,i=0,o=0,s=0,a=0;Lh(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});let u=Bh(r,i,o,s),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:fd(e,t,n,i,l)}}function yC(e,t,n){let[r,i,o,s]=b1(e,t,n),a=0,u=0,l=0,c=0,f=0,d,p,m;Lh(e,t,n,(x,b)=>{d=r[f++],p=Math.log(b),m=d*b,a+=(b*p-a)/f,u+=(m-u)/f,l+=(m*p-l)/f,c+=(d*m-c)/f});let[h,g]=Bh(u/s,a/s,l/s,c/s),y=x=>Math.exp(h+g*(x-o));return{coef:[Math.exp(h-g*o),g],predict:y,rSquared:fd(e,t,n,s,y)}}function xC(e,t,n){let r=0,i=0,o=0,s=0,a=0,u=0;Lh(e,t,n,(f,d)=>{let p=Math.log(f),m=Math.log(d);++u,r+=(p-r)/u,i+=(m-i)/u,o+=(p*m-o)/u,s+=(p*p-s)/u,a+=(d-a)/u});let l=Bh(r,i,o,s),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:fd(e,t,n,a,c)}}function v1(e,t,n){let[r,i,o,s]=b1(e,t,n),a=r.length,u=0,l=0,c=0,f=0,d=0,p,m,h,g;for(p=0;p<a;)m=r[p],h=i[p++],g=m*m,u+=(g-u)/p,l+=(g*m-l)/p,c+=(g*g-c)/p,f+=(m*h-f)/p,d+=(g*h-d)/p;let y=c-u*u,x=u*y-l*l,b=(d*u-f*l)/x,E=(f*y-d*l)/x,v=-b*u,S=w=>(w=w-o,b*w*w+E*w+v+s);return{coef:[v-E*o+b*o*o+s,E-2*b*o,b],predict:S,rSquared:fd(e,t,n,s,S)}}function bC(e,t,n,r){if(r===0)return x1(e,t,n);if(r===1)return E1(e,t,n);if(r===2)return v1(e,t,n);let[i,o,s,a]=b1(e,t,n),u=i.length,l=[],c=[],f=r+1,d,p,m,h,g;for(d=0;d<f;++d){for(m=0,h=0;m<u;++m)h+=Math.pow(i[m],d)*o[m];for(l.push(h),g=new Float64Array(f),p=0;p<f;++p){for(m=0,h=0;m<u;++m)h+=Math.pow(i[m],d+p);g[p]=h}c.push(g)}c.push(l);let y=Xte(c),x=b=>{b-=s;let E=a+y[0]+y[1]*b+y[2]*b*b;for(d=3;d<f;++d)E+=y[d]*Math.pow(b,d);return E};return{coef:Yte(f,y,-s,a),predict:x,rSquared:fd(e,t,n,a,x)}}function Yte(e,t,n,r){let i=Array(e),o,s,a,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function Xte(e){let t=e.length-1,n=[],r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}var dB=2,pB=1e-12;function EC(e,t,n,r){let[i,o,s,a]=b1(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let p=-1;++p<=dB;){let m=[0,l-1];for(let g=0;g<u;++g){let y=i[g],x=m[0],b=m[1],E=y-i[x]>i[b]-y?x:b,v=0,S=0,w=0,_=0,A=0,F=1/Math.abs(i[E]-y||1);for(let O=x;O<=b;++O){let T=i[O],k=o[O],C=Kte(Math.abs(y-T)*F)*d[O],N=T*C;v+=C,S+=N,w+=k*C,_+=k*N,A+=T*N}let[R,D]=Bh(S/v,w/v,_/v,A/v);c[g]=R+D*y,f[g]=Math.abs(o[g]-c[g]),Qte(i,g+1,m)}if(p===dB)break;let h=Qf(f);if(Math.abs(h)<pB)break;for(let g=0,y,x;g<u;++g)y=f[g]/(6*h),d[g]=y>=1?pB:(x=1-y*y)*x}return Jte(i,c,s,a)}function Kte(e){return(e=1-e*e*e)*e*e}function Qte(e,t,n){let r=e[t],i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function Jte(e,t,n,r){let i=e.length,o=[],s=0,a=0,u=[],l;for(;s<i;++s)l=e[s]+n,u[0]===l?u[1]+=(t[s]-u[1])/++a:(a=0,u[1]+=r,u=[l,t[s]],o.push(u));return u[1]+=r,o}var Zte=.5*Math.PI/180;function dd(e,t,n,r){n=n||25,r=Math.max(n,r||200);let i=h=>[h,e(h)],o=t[0],s=t[1],a=s-o,u=a/r,l=[i(o)],c=[];if(n===r){for(let h=1;h<r;++h)l.push(i(o+h/n*a));return l.push(i(s)),l}else{c.push(i(s));for(let h=n;--h>0;)c.push(i(o+h/n*a))}let f=l[0],d=c[c.length-1],p=1/a,m=ene(f[1],c);for(;d;){let h=i((f[0]+d[0])/2);h[0]-f[0]>=u&&tne(f,h,d,p,m)>Zte?c.push(h):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function ene(e,t){let n=e,r=e,i=t.length;for(let o=0;o<i;++o){let s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}function tne(e,t,n,r,i){let o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}function nne(e){return t=>{let n=e.length,r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function SC(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:nne(e)}function xB(e,t,n){return n||e+(t?"_"+t:"")}var vC=()=>{},rne={init:vC,add:vC,rem:vC,idx:0},Uh={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},Hh=Object.keys(Uh).filter(e=>e!=="__count__");function ine(e,t){return(n,r)=>ve({name:e,aggregate_param:r,out:n||e},rne,t)}[...Hh,"__count__"].forEach(e=>{Uh[e]=ine(e,Uh[e])});function bB(e,t,n){return Uh[e](n,t)}function EB(e,t){return e.idx-t.idx}function one(e){let t={};e.forEach(r=>t[r.name]=r);let n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=Uh[i]())})};return e.forEach(n),Object.values(t).sort(EB)}function sne(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function ane(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function une(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function lne(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function vB(e,t){let n=t||Ot,r=one(e),i=e.slice().sort(EB);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=sne,o.prototype.add=ane,o.prototype.rem=une,o.prototype.set=lne,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function AC(e){this._key=e?bn(e):he,this.reset()}var Bn=AC.prototype;Bn.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Bn.add=function(e){this._add.push(e)};Bn.rem=function(e){this._rem.push(e)};Bn.values=function(){if(this._get=null,this._rem.length===0)return this._add;let e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={},a,u,l;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,u=0;a<r;++a)s[n(l=e[a])]?s[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};Bn.distinct=function(e){let t=this.values(),n={},r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",ee(n,o)||(n[o]=1,++i);return i};Bn.extent=function(e){if(this._get!==e||!this._ext){let t=this.values(),n=Q_(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Bn.argmin=function(e){return this.extent(e)[0]||{}};Bn.argmax=function(e){return this.extent(e)[1]||{}};Bn.min=function(e){let t=this.extent(e)[0];return t!=null?e(t):void 0};Bn.max=function(e){let t=this.extent(e)[1];return t!=null?e(t):void 0};Bn.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=o1(this.values(),e),this._get=e),this._q};Bn.q1=function(e){return this.quartile(e)[0]};Bn.q2=function(e){return this.quartile(e)[1]};Bn.q3=function(e){return this.quartile(e)[2]};Bn.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=fC(this.values(),1e3,.05,e),this._get=e),this._ci};Bn.ci0=function(e){return this.ci(e)[0]};Bn.ci1=function(e){return this.ci(e)[1]};function Lu(e){B.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Lu.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Hh},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};Z(Lu,B,{transform(e,t){let n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){let e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}o(e._prev),o(t);function s(a,u,l){let c=n[l],f=r[l++];for(let d in f){let p=a?a+"|"+d:d;u[c]=f[d],l<i?s(p,u,l):t[p]||e.cell(p,u)}}s("",{},0)},init(e){let t=this._inputs=[],n=this._outputs=[],r={};function i(x){let b=Q(ln(x)),E=b.length,v=0,S;for(;v<E;++v)r[S=b[v]]||(r[S]=1,t.push(S))}this._dims=Q(e.groupby),this._dnames=this._dims.map(x=>{let b=xt(x);return i(x),n.push(b),b}),this.cellkey=e.key?e.key:SC(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];let o=e.fields||[null],s=e.ops||["count"],a=e.aggregate_params||[null],u=e.as||[],l=o.length,c={},f,d,p,m,h,g,y;for(l!==s.length&&U("Unmatched number of fields and aggregate ops."),y=0;y<l;++y){if(f=o[y],d=s[y],p=a[y]||null,f==null&&d!=="count"&&U("Null aggregate field specified."),h=xt(f),g=xB(d,h,u[y]),n.push(g),d==="count"){this._counts.push(g);continue}m=c[h],m||(i(f),m=c[h]=[],m.field=f,this._measures.push(m)),d!=="count"&&(this._countOnly=!1),m.push(bB(d,p,g))}return this._measures=this._measures.map(x=>vB(x,x.field)),Object.create(null)},cellkey:SC(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){let n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){let r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new AC),n},newtuple(e,t){let n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?t1(t.tuple,o):Le(o)},clean(){let e=this.value;for(let t in e)e[t].num===0&&delete e[t]},add(e){let t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);let r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){let t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);let r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){let t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){let r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){let t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod,u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&s.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?s:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});var cne=1e-14;function _C(e){B.call(this,null,e)}_C.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};Z(_C,B,{transform(e,t){let n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],u=s[1],l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(ln(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{let f=r(c);c[a]=f,c[u]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[a]=r(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;let t=e.field,n=cC(e),r=n.step,i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,s,a;(s=e.anchor)!=null&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);let u=function(l){let c=Gt(t(l));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(cne+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=tr(u,ln(t),e.name||"bin_"+xt(t))}});function wB(e,t,n){let r=e,i=t||[],o=n||[],s={},a=0;return{add:u=>o.push(u),remove:u=>s[r(u)]=++a,size:()=>i.length,data:(u,l)=>(a&&(i=i.filter(c=>!s[r(c)]),s={},a=0),l&&u&&i.sort(u),o.length&&(i=u?n2(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function CC(e){B.call(this,[],e)}CC.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};Z(CC,B,{transform(e,t){let n=t.fork(t.ALL),r=wB(he,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Is(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function SB(e){rt.call(this,null,fne,e)}Z(SB,rt);function fne(e){return this.value&&!e.modified()?this.value:th(e.fields,e.orders)}function kC(e){B.call(this,null,e)}kC.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function dne(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}Z(kC,B,{transform(e,t){let n=f=>d=>{for(var p=dne(a(d),e.case,o)||[],m,h=0,g=p.length;h<g;++h)s.test(m=p[h])||f(m)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){let n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS),a,u,l;for(a in n)u=r[a],l=n[a]||0,!u&&l?(r[a]=u=Le({}),u[i]=a,u[o]=l,s.add.push(u)):l===0?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==l&&(u[o]=l,s.mod.push(u));return s.modifies(t)}});function FC(e){B.call(this,null,e)}FC.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};Z(FC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter"),a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=pne(a,i,o,e.filter||cn)):n.mod=a,n.source=this.value,n.modifies(r)}});function pne(e,t,n,r){for(var i=[],o={},s=e.length,a=0,u,l;a<s;++a)for(o[t]=l=e[a],u=0;u<s;++u)o[n]=e[u],r(o)&&(i.push(Le(o)),o={},o[t]=l);return i}var gB={kde:l1,mixture:mC,normal:u1,lognormal:pC,uniform:hC},mne="distributions",yB="function",hne="field";function AB(e,t){let n=e[yB];ee(gB,n)||U("Unknown distribution function: "+n);let r=gB[n]();for(let i in e)i===hne?r.data((e.from||t()).map(e[i])):i===mne?r[i](e[i].map(o=>AB(o,t))):typeof r[i]===yB&&r[i](e[i]);return r}function RC(e){B.call(this,null,e)}var _B=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],gne={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:_B},{name:"weights",type:"number",array:!0}]};RC.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:_B.concat(gne)},{name:"as",type:"string",array:!0,default:["value","density"]}]};Z(RC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=AB(e.distribution,yne(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200,s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&U("Invalid density method: "+s),!e.extent&&!r.data&&U("Missing density extent parameter."),s=r[s];let a=e.as||["value","density"],u=e.extent||kr(r.data()),l=dd(s,u,i,o).map(c=>{let f={};return f[a[0]]=c[0],f[a[1]]=c[1],Le(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function yne(e){return()=>e.materialize(e.SOURCE).source}function CB(e,t){return e?e.map((n,r)=>t[r]||xt(n)):null}function TC(e,t,n){let r=[],i=f=>f(u),o,s,a,u,l,c;if(t==null)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)u=e[s],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}var kB="bin";function DC(e){B.call(this,null,e)}DC.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:kB}]};var xne=(e,t)=>Aa(kr(e,t))/30;Z(DC,B,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;let n=t.materialize(t.SOURCE).source,r=TC(t.source,e.groupby,Ot),i=e.smooth||!1,o=e.field,s=e.step||xne(n,o),a=Is((m,h)=>o(m)-o(h)),u=e.as||kB,l=r.length,c=1/0,f=-1/0,d=0,p;for(;d<l;++d){let m=r[d].sort(a);p=-1;for(let h of dC(m,s,i,o))h<c&&(c=h),h>f&&(f=h),m[++p][u]=h}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(u)}});function FB(e){rt.call(this,null,bne,e),this.modified(!0)}Z(FB,rt);function bne(e){let t=e.expr;return this.value&&!e.modified("expr")?this.value:tr(n=>t(n,e),ln(t),xt(t))}function MC(e){B.call(this,[void 0,void 0],e)}MC.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};Z(MC,B,{transform(e,t){let n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field"),o=n[0],s=n[1];if((i||o==null)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{let u=Gt(r(a));u!=null&&(u<o&&(o=u),u>s&&(s=u))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=xt(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});function NC(e,t){rt.call(this,e),this.parent=t,this.count=0}Z(NC,rt,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function S1(e){B.call(this,{},e),this._keys=ku();let t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}Z(S1,B,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){let i=this.value,o=ee(i,e)&&i[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new NC(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){let e=this.value,t=0;for(let n in e)if(e[n].count===0){let r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){let n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){let t=this._targets,n=t.length,r=e?e.length:0,i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){let n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{let l=he(u),c=o.get(l);c!==void 0&&(o.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{let l=r(u);o.set(he(u),l),a(l).add(u)}),s||t.modified(r.fields)?t.visit(t.MOD,u=>{let l=he(u),c=o.get(l),f=r(u);c===f?a(f).mod(u):(o.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(o.get(he(u))).mod(u)}),s&&t.visit(t.REFLOW,u=>{let l=he(u),c=o.get(l),f=r(u);c!==f&&(o.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function RB(e){rt.call(this,null,Ene,e)}Z(RB,rt);function Ene(e){return this.value&&!e.modified()?this.value:M(e.name)?Q(e.name).map(t=>bn(t)):bn(e.name,e.as)}function OC(e){B.call(this,ku(),e)}OC.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};Z(OC,B,{transform(e,t){let n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,u=e.expr,l=!0;t.visit(t.REM,f=>{let d=he(f);r.has(d)?r.delete(d):s.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):r.set(he(f),1)});function c(f){let d=he(f),p=u(f,e),m=r.get(d);p&&m?(r.delete(d),o.push(f)):!p&&!m?(r.set(d,1),s.push(f)):l&&p&&!m&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function IC(e){B.call(this,[],e)}IC.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};Z(IC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.fields,i=CB(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{let u=r.map(m=>m(a)),l=u.reduce((m,h)=>Math.max(m,h.length),0),c=0,f,d,p;for(;c<l;++c){for(d=e1(a),f=0;f<s;++f)d[i[f]]=(p=u[f][c])==null?null:p;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function PC(e){B.call(this,[],e)}PC.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};Z(PC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(xt),o=e.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=e1(l),f[s]=i[c],f[a]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function $C(e){B.call(this,null,e)}$C.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};Z($C,B,{transform(e,t){let n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}});function TB(e){B.call(this,[],e)}Z(TB,B,{transform(e,t){let n=t.fork(t.ALL),r=e.generator,i=this.value,o=e.size-i.length,s,a,u;if(o>0){for(s=[];--o>=0;)s.push(u=Le(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});var w1={value:"value",median:Qf,mean:Px,min:Jl,max:Ki},vne=[];function BC(e){B.call(this,[],e)}BC.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function wne(e){var t=e.method||w1.value,n;if(w1[t]==null)U("Unrecognized imputation method: "+t);else return t===w1.value?(n=e.value!==void 0?e.value:0,()=>n):w1[t]}function Sne(e){let t=e.field;return n=>n?t(n):NaN}Z(BC,B,{transform(e,t){var n=t.fork(t.ALL),r=wne(e),i=Sne(e),o=xt(e.field),s=xt(e.key),a=(e.groupby||[]).map(xt),u=Ane(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,p,m,h,g,y,x,b,E,v;for(g=0,b=u.length;g<b;++g)for(d=u[g],m=d.values,p=NaN,x=0;x<f;++x)if(d[x]==null){for(h=u.domain[x],v={_impute:!0},y=0,E=m.length;y<E;++y)v[a[y]]=m[y];v[s]=h,v[o]=Number.isNaN(p)?p=r(d,i):p,l.push(Le(v))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function Ane(e,t,n,r){var i=y=>y(g),o=[],s=r?r.slice():[],a={},u={},l,c,f,d,p,m,h,g;for(s.forEach((y,x)=>a[y]=x+1),d=0,h=e.length;d<h;++d)g=e[d],m=n(g),p=a[m]||(a[m]=s.push(m)),c=(l=t?t.map(i):vne)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[p-1]=g;return o.domain=s,o}function LC(e){Lu.call(this,e)}LC.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Hh},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};Z(LC,Lu,{transform(e,t){let n=this,r=e.modified(),i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{ve(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){let e=this._adds,t=this._mods,n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function UC(e){B.call(this,null,e)}UC.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};Z(UC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=t.materialize(t.SOURCE).source,i=TC(r,e.groupby,e.field),o=(e.groupby||[]).map(xt),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[],c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&U("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=kr(r,e.field)),f=d=e.steps||d),i.forEach(p=>{let m=l1(p,s)[a],h=e.counts?p.length:1,g=c||kr(p);dd(m,g,f,d).forEach(y=>{let x={};for(let b=0;b<o.length;++b)x[o[b]]=p.dims[b];x[u[0]]=y[0],x[u[1]]=y[1]*h,l.push(Le(x))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function DB(e){rt.call(this,null,_ne,e)}Z(DB,rt);function _ne(e){return this.value&&!e.modified()?this.value:rh(e.fields,e.flat)}function MB(e){B.call(this,[],e),this._pending=null}Z(MB,B,{transform(e,t){let n=t.dataflow;return this._pending?wC(this,t,this._pending):Cne(e)?t.StopPropagation:e.values?wC(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=Q(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>wC(this,t,Q(r.data)))}});function Cne(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function wC(e,t,n){n.forEach(Le);let r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function zC(e){B.call(this,{},e)}zC.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};Z(zC,B,{transform(e,t){let n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length,u=s?t.SOURCE:t.ADD,l=t,c=e.as,f,d,p;return i?(d=i.length,a>1&&!c&&U('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&U('The "as" parameter has too few output field names.'),c=c||i.map(xt),f=function(m){for(var h=0,g=0,y,x;h<a;++h)if(x=r.get(n[h](m)),x==null)for(y=0;y<d;++y,++g)m[c[g]]=o;else for(y=0;y<d;++y,++g)m[c[g]]=i[y](x)}):(c||U("Missing output field names."),f=function(m){for(var h=0,g;h<a;++h)g=r.get(n[h](m)),m[c[h]]=g??o}),s?l=t.reflow(!0):(p=n.some(m=>t.modified(m.fields)),u|=p?t.MOD:0),t.visit(u,f),l.modifies(c)}});function NB(e){rt.call(this,null,kne,e)}Z(NB,rt);function kne(e){if(this.value&&!e.modified())return this.value;let t=e.extents,n=t.length,r=1/0,i=-1/0,o,s;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function OB(e){rt.call(this,null,Fne,e)}Z(OB,rt);function Fne(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function IB(e){B.call(this,null,e)}Z(IB,B,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function HC(e){Lu.call(this,e)}HC.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Hh,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};Z(HC,Lu,{_transform:Lu.prototype.transform,transform(e,t){return this._transform(Rne(e,t),t)}});function Rne(e,t){let n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=ln(n).concat(ln(r)),s=Dne(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>Tne(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function Tne(e,t,n,r){return tr(i=>t(i)===e?n(i):NaN,r,e+"")}function Dne(e,t,n){let r={},i=[];return n.visit(n.SOURCE,o=>{let s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort(Sa),t?i.slice(0,t):i}function PB(e){S1.call(this,e)}Z(PB,S1,{transform(e,t){let n=e.subflow,r=e.field,i=o=>this.subflow(he(o),n,t,o);return(e.modified("field")||r&&t.modified(ln(r)))&&U("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{let s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{let s=i(o);r(o).forEach(a=>s.add(Le(a)))}),t.visit(t.REM,o=>{let s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function qC(e){B.call(this,null,e)}qC.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};Z(qC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.fields,i=CB(e.fields,e.as||[]),o=r?(a,u)=>Mne(a,u,r,i):uc,s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{let u=he(a);n.rem.push(s[u]),s[u]=null}),t.visit(t.ADD,a=>{let u=o(a,Le({}));s[he(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[he(a)]))}),n}});function Mne(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function $B(e){B.call(this,null,e)}Z($B,B,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function GC(e){B.call(this,null,e)}GC.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};var Nne=1e-14;Z(GC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;let i=t.materialize(t.SOURCE).source,o=TC(i,e.groupby,e.field),s=(e.groupby||[]).map(xt),a=[],u=e.step||.01,l=e.probs||jt(u/2,1-Nne,u),c=l.length;return o.forEach(f=>{let d=i1(f,l);for(let p=0;p<c;++p){let m={};for(let h=0;h<s.length;++h)m[s[h]]=f.dims[h];m[r[0]]=l[p],m[r[1]]=d[p],a.push(Le(m))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function BB(e){B.call(this,null,e)}Z(BB,B,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{let o=he(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{let o=e1(i);r[he(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{let o=r[he(i)];for(let s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}});function jC(e){B.call(this,[],e),this.count=0}jC.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};Z(jC,B,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[he(f)]=1,c),{}),s=this.value,a=this.count,u=0;function l(c){let f,d;s.length<i?s.push(c):(d=~~((a+1)*Nr()),d<s.length&&d>=u&&(f=s[d],o[he(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{let f=he(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>o[he(c)]!==-1)),(t.rem.length||r)&&s.length<i&&t.source&&(u=a=s.length,t.visit(t.SOURCE,c=>{o[he(c)]||l(c)}),u=-1),r&&s.length>i){let c=s.length-i;for(let f=0;f<c;++f)o[he(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[he(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=s.filter(c=>!o[he(c)])),this.count=a,this.value=n.source=s,n}});function WC(e){B.call(this,null,e)}WC.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};Z(WC,B,{transform(e,t){if(this.value&&!e.modified())return;let n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=jt(e.start,e.stop,e.step||1).map(i=>{let o={};return o[r]=i,Le(o)}),n.add=t.add.concat(this.value),n}});function LB(e){B.call(this,null,e),this.modified(!0)}Z(LB,B,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function VC(e){B.call(this,null,e)}var UB=["unit0","unit1"];VC.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Hx,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:UB}]};Z(VC,B,{transform(e,t){let n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),s=(i?Ta:Ra)(o.unit).offset,a=e.as||UB,u=a[0],l=a[1],c=o.step,f=o.start||1/0,d=o.stop||-1/0,p=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(ln(n)))&&(t=t.reflow(!0),p=t.SOURCE,f=1/0,d=-1/0),t.visit(p,m=>{let h=n(m),g,y;h==null?(m[u]=null,r&&(m[l]=null)):(m[u]=g=y=o(h),r&&(m[l]=y=s(g,c)),g<f&&(f=g),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(r?a:u)},_floor(e,t){let n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:V2({extent:e.extent||kr(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=qx(r),s=this.value||{},a=(n?H2:z2)(o,i);return a.unit=Te(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}});function zB(e){B.call(this,ku(),e)}Z(zB,B,{transform(e,t){let n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a),s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function HB(e){B.call(this,null,e)}Z(HB,B,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Is(e.sort)):t.source).map(e.field))}});function One(e,t,n,r){let i=zh[e](t,n);return{init:i.init||To,update:function(o,s){s[r]=i.next(o)}}}var zh={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){let e=zh.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{let n=t.data,r=t.compare,i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||U("ntile num must be greater than zero.");let n=zh.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{let r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{let r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||U("nth_value nth must be greater than zero."),{next:n=>{let r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{let r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{let i=r.data;return r.index<=n?t:(n=Ine(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function Ine(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}var Pne=Object.keys(zh);function qB(e){let t=Q(e.ops),n=Q(e.fields),r=Q(e.params),i=Q(e.aggregate_params),o=Q(e.as),s=this.outputs=[],a=this.windows=[],u={},l={},c=[],f=[],d=!0;function p(m){Q(ln(m)).forEach(h=>u[h]=1)}p(e.sort),t.forEach((m,h)=>{let g=n[h],y=r[h],x=i[h]||null,b=xt(g),E=xB(m,b,o[h]);if(p(g),s.push(E),ee(zh,m))a.push(One(m,g,y,E));else{if(g==null&&m!=="count"&&U("Null aggregate field specified."),m==="count"){c.push(E);return}d=!1;let v=l[b];v||(v=l[b]=[],v.field=g,f.push(v)),v.push(bB(m,x,E))}}),(c.length||f.length)&&(this.cell=$ne(f,c,d)),this.inputs=Object.keys(u)}var GB=qB.prototype;GB.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};GB.update=function(e,t){let n=this.cell,r=this.windows,i=e.data,o=r&&r.length,s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)};function $ne(e,t,n){e=e.map(u=>vB(u,u.field));let r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new AC;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(let l=0;l<i;++l)o[l].add(o[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(let l=0;l<i;++l)o[l].rem(o[l].get(u),u)}},r.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},r.init=function(){r.num=0,a&&a.reset();for(let u=0;u<i;++u)o[u].init()},r}function YC(e){B.call(this,{},e),this._mlen=0,this._mods=[]}YC.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Pne.concat(Hh)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};Z(YC,B,{transform(e,t){this.stamp=t.stamp;let n=e.modified(),r=Is(e.sort),i=SC(e.groupby),o=a=>this.group(i(a)),s=this.state;(!s||n)&&(s=this.state=new qB(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)Bne(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=wB(he),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function Bne(e,t,n,r){let i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),u=a.length,l=o?_i(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||St(-1)};t.init();for(let f=0;f<u;++f)Lne(c,s,f,u),o&&Une(c,l),t.update(c,a[f])}function Lne(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function Une(e,t){let n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}var uR={};er(uR,{bound:()=>a5,identifier:()=>aR,mark:()=>u5,overlap:()=>l5,render:()=>f5,viewlayout:()=>p5});function Ge(e){return function(){return e}}var KC=Math.abs,Ln=Math.atan2,Uu=Math.cos,jB=Math.max,A1=Math.min,Oo=Math.sin,Ia=Math.sqrt,wn=1e-12,zu=Math.PI,qh=zu/2,_1=2*zu;function WB(e){return e>1?0:e<-1?zu:Math.acos(e)}function QC(e){return e>=1?qh:e<=-1?-qh:Math.asin(e)}var JC=Math.PI,ZC=2*JC,lc=1e-6,zne=ZC-lc;function VB(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Hne(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return VB;let n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}var cc=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?VB:Hne(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=r-t,l=i-n,c=s-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>lc)if(!(Math.abs(f*u-l*c)>lc)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-s,m=i-a,h=u*u+l*l,g=p*p+m*m,y=Math.sqrt(h),x=Math.sqrt(d),b=o*Math.tan((JC-Math.acos((h+d-g)/(2*y*x)))/2),E=b/x,v=b/y;Math.abs(E-1)>lc&&this._append`L${t+E*c},${n+E*f}`,this._append`A${o},${o},0,0,${+(f*p>c*m)},${this._x1=t+v*u},${this._y1=n+v*l}`}}arc(t,n,r,i,o,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),u=r*Math.sin(i),l=t+a,c=n+u,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>lc||Math.abs(this._y1-c)>lc)&&this._append`L${l},${c}`,r&&(d<0&&(d=d%ZC+ZC),d>zne?this._append`A${r},${r},0,1,${f},${t-a},${n-u}A${r},${r},0,1,${f},${this._x1=l},${this._y1=c}`:d>lc&&this._append`A${r},${r},0,${+(d>=JC)},${f},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function fc(){return new cc}fc.prototype=cc.prototype;function Hu(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{let r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new cc(t)}function qne(e){return e.innerRadius}function Gne(e){return e.outerRadius}function jne(e){return e.startAngle}function Wne(e){return e.endAngle}function Vne(e){return e&&e.padAngle}function Yne(e,t,n,r,i,o,s,a){var u=n-e,l=r-t,c=s-i,f=a-o,d=f*u-c*l;if(!(d*d<wn))return d=(c*(t-o)-f*(e-i))/d,[e+d*u,t+d*l]}function C1(e,t,n,r,i,o,s){var a=e-n,u=t-r,l=(s?o:-o)/Ia(a*a+u*u),c=l*u,f=-l*a,d=e+c,p=t+f,m=n+c,h=r+f,g=(d+m)/2,y=(p+h)/2,x=m-d,b=h-p,E=x*x+b*b,v=i-o,S=d*h-m*p,w=(b<0?-1:1)*Ia(jB(0,v*v*E-S*S)),_=(S*b-x*w)/E,A=(-S*x-b*w)/E,F=(S*b+x*w)/E,R=(-S*x+b*w)/E,D=_-g,O=A-y,T=F-g,k=R-y;return D*D+O*O>T*T+k*k&&(_=F,A=R),{cx:_,cy:A,x01:-c,y01:-f,x11:_*(i/v-1),y11:A*(i/v-1)}}function ek(){var e=qne,t=Gne,n=Ge(0),r=null,i=jne,o=Wne,s=Vne,a=null,u=Hu(l);function l(){var c,f,d=+e.apply(this,arguments),p=+t.apply(this,arguments),m=i.apply(this,arguments)-qh,h=o.apply(this,arguments)-qh,g=KC(h-m),y=h>m;if(a||(a=c=u()),p<d&&(f=p,p=d,d=f),!(p>wn))a.moveTo(0,0);else if(g>_1-wn)a.moveTo(p*Uu(m),p*Oo(m)),a.arc(0,0,p,m,h,!y),d>wn&&(a.moveTo(d*Uu(h),d*Oo(h)),a.arc(0,0,d,h,m,y));else{var x=m,b=h,E=m,v=h,S=g,w=g,_=s.apply(this,arguments)/2,A=_>wn&&(r?+r.apply(this,arguments):Ia(d*d+p*p)),F=A1(KC(p-d)/2,+n.apply(this,arguments)),R=F,D=F,O,T;if(A>wn){var k=QC(A/d*Oo(_)),C=QC(A/p*Oo(_));(S-=k*2)>wn?(k*=y?1:-1,E+=k,v-=k):(S=0,E=v=(m+h)/2),(w-=C*2)>wn?(C*=y?1:-1,x+=C,b-=C):(w=0,x=b=(m+h)/2)}var N=p*Uu(x),I=p*Oo(x),L=d*Uu(v),te=d*Oo(v);if(F>wn){var ie=p*Uu(b),oe=p*Oo(b),Se=d*Uu(E),Oe=d*Oo(E),we;if(g<zu)if(we=Yne(N,I,Se,Oe,ie,oe,L,te)){var Qt=N-we[0],Ro=I-we[1],Ai=ie-we[0],ce=oe-we[1],Fe=1/Oo(WB((Qt*Ai+Ro*ce)/(Ia(Qt*Qt+Ro*Ro)*Ia(Ai*Ai+ce*ce)))/2),$e=Ia(we[0]*we[0]+we[1]*we[1]);R=A1(F,(d-$e)/(Fe-1)),D=A1(F,(p-$e)/(Fe+1))}else R=D=0}w>wn?D>wn?(O=C1(Se,Oe,N,I,p,D,y),T=C1(ie,oe,L,te,p,D,y),a.moveTo(O.cx+O.x01,O.cy+O.y01),D<F?a.arc(O.cx,O.cy,D,Ln(O.y01,O.x01),Ln(T.y01,T.x01),!y):(a.arc(O.cx,O.cy,D,Ln(O.y01,O.x01),Ln(O.y11,O.x11),!y),a.arc(0,0,p,Ln(O.cy+O.y11,O.cx+O.x11),Ln(T.cy+T.y11,T.cx+T.x11),!y),a.arc(T.cx,T.cy,D,Ln(T.y11,T.x11),Ln(T.y01,T.x01),!y))):(a.moveTo(N,I),a.arc(0,0,p,x,b,!y)):a.moveTo(N,I),!(d>wn)||!(S>wn)?a.lineTo(L,te):R>wn?(O=C1(L,te,ie,oe,d,-R,y),T=C1(N,I,Se,Oe,d,-R,y),a.lineTo(O.cx+O.x01,O.cy+O.y01),R<F?a.arc(O.cx,O.cy,R,Ln(O.y01,O.x01),Ln(T.y01,T.x01),!y):(a.arc(O.cx,O.cy,R,Ln(O.y01,O.x01),Ln(O.y11,O.x11),!y),a.arc(0,0,d,Ln(O.cy+O.y11,O.cx+O.x11),Ln(T.cy+T.y11,T.cx+T.x11),y),a.arc(T.cx,T.cy,R,Ln(T.y11,T.x11),Ln(T.y01,T.x01),!y))):a.arc(0,0,d,v,E,y)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-zu/2;return[Uu(f)*c,Oo(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Ge(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Ge(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Ge(+c),l):n},l.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Ge(+c),l):r},l.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Ge(+c),l):i},l.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Ge(+c),l):o},l.padAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Ge(+c),l):s},l.context=function(c){return arguments.length?(a=c??null,l):a},l}var BDe=Array.prototype.slice;function k1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function YB(e){this._context=e}YB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function dc(e){return new YB(e)}function F1(e){return e[0]}function R1(e){return e[1]}function Gh(e,t){var n=Ge(!0),r=null,i=dc,o=null,s=Hu(a);e=typeof e=="function"?e:e===void 0?F1:Ge(e),t=typeof t=="function"?t:t===void 0?R1:Ge(t);function a(u){var l,c=(u=k1(u)).length,f,d=!1,p;for(r==null&&(o=i(p=s())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(f,l,u),+t(f,l,u));if(p)return o=null,p+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:Ge(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:Ge(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Ge(!!u),a):n},a.curve=function(u){return arguments.length?(i=u,r!=null&&(o=i(r)),a):i},a.context=function(u){return arguments.length?(u==null?r=o=null:o=i(r=u),a):r},a}function T1(e,t,n){var r=null,i=Ge(!0),o=null,s=dc,a=null,u=Hu(l);e=typeof e=="function"?e:e===void 0?F1:Ge(+e),t=typeof t=="function"?t:t===void 0?Ge(0):Ge(+t),n=typeof n=="function"?n:n===void 0?R1:Ge(+n);function l(f){var d,p,m,h=(f=k1(f)).length,g,y=!1,x,b=new Array(h),E=new Array(h);for(o==null&&(a=s(x=u())),d=0;d<=h;++d){if(!(d<h&&i(g=f[d],d,f))===y)if(y=!y)p=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),m=d-1;m>=p;--m)a.point(b[m],E[m]);a.lineEnd(),a.areaEnd()}y&&(b[d]=+e(g,d,f),E[d]=+t(g,d,f),a.point(r?+r(g,d,f):b[d],n?+n(g,d,f):E[d]))}if(x)return a=null,x+""||null}function c(){return Gh().defined(i).curve(s).context(o)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Ge(+f),r=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Ge(+f),l):e},l.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Ge(+f),l):r},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Ge(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Ge(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Ge(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Ge(!!f),l):i},l.curve=function(f){return arguments.length?(s=f,o!=null&&(a=s(o)),l):s},l.context=function(f){return arguments.length?(f==null?o=a=null:a=s(o=f),l):o},l}var XB={draw(e,t){let n=Ia(t/zu);e.moveTo(n,0),e.arc(0,0,n,0,_1)}};function D1(e,t){let n=null,r=Hu(i);e=typeof e=="function"?e:Ge(e||XB),t=typeof t=="function"?t:Ge(t===void 0?64:+t);function i(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:Ge(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:Ge(+o),i):t},i.context=function(o){return arguments.length?(n=o??null,i):n},i}function to(){}function pd(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function jh(e){this._context=e}jh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:pd(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:pd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tk(e){return new jh(e)}function KB(e){this._context=e}KB.prototype={areaStart:to,areaEnd:to,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:pd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nk(e){return new KB(e)}function QB(e){this._context=e}QB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:pd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rk(e){return new QB(e)}function JB(e,t){this._basis=new jh(e),this._beta=t}JB.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*o),this._beta*t[a]+(1-this._beta)*(i+u*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var ik=function e(t){function n(r){return t===1?new jh(r):new JB(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function md(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function M1(e,t){this._context=e,this._k=(1-t)/6}M1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:md(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:md(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ok=function e(t){function n(r){return new M1(r,t)}return n.tension=function(r){return e(+r)},n}(0);function N1(e,t){this._context=e,this._k=(1-t)/6}N1.prototype={areaStart:to,areaEnd:to,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:md(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sk=function e(t){function n(r){return new N1(r,t)}return n.tension=function(r){return e(+r)},n}(0);function O1(e,t){this._context=e,this._k=(1-t)/6}O1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:md(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ak=function e(t){function n(r){return new O1(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Wh(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>wn){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>wn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function ZB(e,t){this._context=e,this._alpha=t}ZB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Wh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var uk=function e(t){function n(r){return t?new ZB(r,t):new M1(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function eL(e,t){this._context=e,this._alpha=t}eL.prototype={areaStart:to,areaEnd:to,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Wh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var lk=function e(t){function n(r){return t?new eL(r,t):new N1(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function tL(e,t){this._context=e,this._alpha=t}tL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Wh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ck=function e(t){function n(r){return t?new tL(r,t):new O1(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function nL(e){this._context=e}nL.prototype={areaStart:to,areaEnd:to,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function fk(e){return new nL(e)}function rL(e){return e<0?-1:1}function iL(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(rL(o)+rL(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function oL(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function dk(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function I1(e){this._context=e}I1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:dk(this,this._t0,oL(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,dk(this,oL(this,n=iL(this,e,t)),n);break;default:dk(this,this._t0,n=iL(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function sL(e){this._context=new aL(e)}(sL.prototype=Object.create(I1.prototype)).point=function(e,t){I1.prototype.point.call(this,t,e)};function aL(e){this._context=e}aL.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function pk(e){return new I1(e)}function mk(e){return new sL(e)}function lL(e){this._context=e}lL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=uL(e),i=uL(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function uL(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function hk(e){return new lL(e)}function P1(e,t){this._context=e,this._t=t}P1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function gk(e){return new P1(e,.5)}function yk(e){return new P1(e,0)}function xk(e){return new P1(e,1)}function no(e,t){if(typeof document<"u"&&document.createElement){let n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}var cL=()=>typeof Image<"u"?Image:null;function en(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ps(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var hd=Symbol("implicit");function pc(){var e=new Kf,t=[],n=[],r=hd;function i(o){let s=e.get(o);if(s===void 0){if(r!==hd)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Kf;for(let s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return pc(t,n).unknown(r)},en.apply(i,arguments),i}var Mk={};er(Mk,{interpolate:()=>ir,interpolateArray:()=>PL,interpolateBasis:()=>G1,interpolateBasisClosed:()=>j1,interpolateCubehelix:()=>e6,interpolateCubehelixLong:()=>t6,interpolateDate:()=>V1,interpolateDiscrete:()=>$L,interpolateHcl:()=>QL,interpolateHclLong:()=>JL,interpolateHsl:()=>YL,interpolateHslLong:()=>XL,interpolateHue:()=>BL,interpolateLab:()=>Dk,interpolateNumber:()=>or,interpolateNumberArray:()=>Ed,interpolateObject:()=>Y1,interpolateRgb:()=>Kh,interpolateRgbBasis:()=>OL,interpolateRgbBasisClosed:()=>IL,interpolateRound:()=>Us,interpolateString:()=>X1,interpolateTransformCss:()=>qL,interpolateTransformSvg:()=>GL,interpolateZoom:()=>WL,piecewise:()=>Ec,quantize:()=>n6});function Pa(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function qu(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Bs(){}var Gu=.7,gc=1/Gu,gd="\\s*([+-]?\\d+)\\s*",Vh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$s="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kne=/^#([0-9a-f]{3,8})$/,Qne=new RegExp(`^rgb\\(${gd},${gd},${gd}\\)$`),Jne=new RegExp(`^rgb\\(${$s},${$s},${$s}\\)$`),Zne=new RegExp(`^rgba\\(${gd},${gd},${gd},${Vh}\\)$`),ere=new RegExp(`^rgba\\(${$s},${$s},${$s},${Vh}\\)$`),tre=new RegExp(`^hsl\\(${Vh},${$s},${$s}\\)$`),nre=new RegExp(`^hsla\\(${Vh},${$s},${$s},${Vh}\\)$`),fL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Pa(Bs,ju,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:dL,formatHex:dL,formatHex8:rre,formatHsl:ire,formatRgb:pL,toString:pL});function dL(){return this.rgb().formatHex()}function rre(){return this.rgb().formatHex8()}function ire(){return bL(this).formatHsl()}function pL(){return this.rgb().formatRgb()}function ju(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Kne.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?mL(t):n===3?new tn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Qne.exec(e))?new tn(t[1],t[2],t[3],1):(t=Jne.exec(e))?new tn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Zne.exec(e))?$1(t[1],t[2],t[3],t[4]):(t=ere.exec(e))?$1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=tre.exec(e))?yL(t[1],t[2]/100,t[3]/100,1):(t=nre.exec(e))?yL(t[1],t[2]/100,t[3]/100,t[4]):fL.hasOwnProperty(e)?mL(fL[e]):e==="transparent"?new tn(NaN,NaN,NaN,0):null}function mL(e){return new tn(e>>16&255,e>>8&255,e&255,1)}function $1(e,t,n,r){return r<=0&&(e=t=n=NaN),new tn(e,t,n,r)}function Yh(e){return e instanceof Bs||(e=ju(e)),e?(e=e.rgb(),new tn(e.r,e.g,e.b,e.opacity)):new tn}function ro(e,t,n,r){return arguments.length===1?Yh(e):new tn(e,t,n,r??1)}function tn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Pa(tn,ro,qu(Bs,{brighter(e){return e=e==null?gc:Math.pow(gc,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Gu:Math.pow(Gu,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new tn(hc(this.r),hc(this.g),hc(this.b),L1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hL,formatHex:hL,formatHex8:ore,formatRgb:gL,toString:gL}));function hL(){return`#${mc(this.r)}${mc(this.g)}${mc(this.b)}`}function ore(){return`#${mc(this.r)}${mc(this.g)}${mc(this.b)}${mc((isNaN(this.opacity)?1:this.opacity)*255)}`}function gL(){let e=L1(this.opacity);return`${e===1?"rgb(":"rgba("}${hc(this.r)}, ${hc(this.g)}, ${hc(this.b)}${e===1?")":`, ${e})`}`}function L1(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function mc(e){return e=hc(e),(e<16?"0":"")+e.toString(16)}function yL(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Io(e,t,n,r)}function bL(e){if(e instanceof Io)return new Io(e.h,e.s,e.l,e.opacity);if(e instanceof Bs||(e=ju(e)),!e)return new Io;if(e instanceof Io)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new Io(s,a,u,e.opacity)}function yc(e,t,n,r){return arguments.length===1?bL(e):new Io(e,t,n,r??1)}function Io(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Pa(Io,yc,qu(Bs,{brighter(e){return e=e==null?gc:Math.pow(gc,e),new Io(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Gu:Math.pow(Gu,e),new Io(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new tn(bk(e>=240?e-240:e+120,i,r),bk(e,i,r),bk(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Io(xL(this.h),B1(this.s),B1(this.l),L1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=L1(this.opacity);return`${e===1?"hsl(":"hsla("}${xL(this.h)}, ${B1(this.s)*100}%, ${B1(this.l)*100}%${e===1?")":`, ${e})`}`}}));function xL(e){return e=(e||0)%360,e<0?e+360:e}function B1(e){return Math.max(0,Math.min(1,e||0))}function bk(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var U1=Math.PI/180,z1=180/Math.PI;var H1=18,EL=.96422,vL=1,wL=.82521,SL=4/29,yd=6/29,AL=3*yd*yd,sre=yd*yd*yd;function _L(e){if(e instanceof Ls)return new Ls(e.l,e.a,e.b,e.opacity);if(e instanceof $a)return CL(e);e instanceof tn||(e=Yh(e));var t=Sk(e.r),n=Sk(e.g),r=Sk(e.b),i=Ek((.2225045*t+.7168786*n+.0606169*r)/vL),o,s;return t===n&&n===r?o=s=i:(o=Ek((.4360747*t+.3850649*n+.1430804*r)/EL),s=Ek((.0139322*t+.0971045*n+.7141733*r)/wL)),new Ls(116*i-16,500*(o-i),200*(i-s),e.opacity)}function Wu(e,t,n,r){return arguments.length===1?_L(e):new Ls(e,t,n,r??1)}function Ls(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Pa(Ls,Wu,qu(Bs,{brighter(e){return new Ls(this.l+H1*(e??1),this.a,this.b,this.opacity)},darker(e){return new Ls(this.l-H1*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=EL*vk(t),e=vL*vk(e),n=wL*vk(n),new tn(wk(3.1338561*t-1.6168667*e-.4906146*n),wk(-.9787684*t+1.9161415*e+.033454*n),wk(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Ek(e){return e>sre?Math.pow(e,1/3):e/AL+SL}function vk(e){return e>yd?e*e*e:AL*(e-SL)}function wk(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Sk(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function are(e){if(e instanceof $a)return new $a(e.h,e.c,e.l,e.opacity);if(e instanceof Ls||(e=_L(e)),e.a===0&&e.b===0)return new $a(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*z1;return new $a(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function xc(e,t,n,r){return arguments.length===1?are(e):new $a(e,t,n,r??1)}function $a(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function CL(e){if(isNaN(e.h))return new Ls(e.l,0,0,e.opacity);var t=e.h*U1;return new Ls(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Pa($a,xc,qu(Bs,{brighter(e){return new $a(this.h,this.c,this.l+H1*(e??1),this.opacity)},darker(e){return new $a(this.h,this.c,this.l-H1*(e??1),this.opacity)},rgb(){return CL(this).rgb()}}));var TL=-.14861,Ak=1.78277,_k=-.29227,q1=-.90649,Xh=1.97294,kL=Xh*q1,FL=Xh*Ak,RL=Ak*_k-q1*TL;function ure(e){if(e instanceof bc)return new bc(e.h,e.s,e.l,e.opacity);e instanceof tn||(e=Yh(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(RL*r+kL*t-FL*n)/(RL+kL-FL),o=r-i,s=(Xh*(n-i)-_k*o)/q1,a=Math.sqrt(s*s+o*o)/(Xh*i*(1-i)),u=a?Math.atan2(s,o)*z1-120:NaN;return new bc(u<0?u+360:u,a,i,e.opacity)}function xd(e,t,n,r){return arguments.length===1?ure(e):new bc(e,t,n,r??1)}function bc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Pa(bc,xd,qu(Bs,{brighter(e){return e=e==null?gc:Math.pow(gc,e),new bc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Gu:Math.pow(Gu,e),new bc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*U1,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new tn(255*(t+n*(TL*r+Ak*i)),255*(t+n*(_k*r+q1*i)),255*(t+n*(Xh*r)),this.opacity)}}));function Ck(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function G1(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return Ck((n-r/t)*t,s,i,o,a)}}function j1(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return Ck((n-r/t)*t,i,o,s,a)}}var bd=e=>()=>e;function DL(e,t){return function(n){return e+n*t}}function lre(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Vu(e,t){var n=t-e;return n?DL(e,n>180||n<-180?n-360*Math.round(n/360):n):bd(isNaN(e)?t:e)}function ML(e){return(e=+e)==1?_t:function(t,n){return n-t?lre(t,n,e):bd(isNaN(t)?n:t)}}function _t(e,t){var n=t-e;return n?DL(e,n):bd(isNaN(e)?t:e)}var Kh=function e(t){var n=ML(t);function r(i,o){var s=n((i=ro(i)).r,(o=ro(o)).r),a=n(i.g,o.g),u=n(i.b,o.b),l=_t(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function NL(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=ro(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var OL=NL(G1),IL=NL(j1);function Ed(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function W1(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function PL(e,t){return(W1(t)?Ed:kk)(e,t)}function kk(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=ir(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function V1(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function or(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Y1(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=ir(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Rk=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fk=new RegExp(Rk.source,"g");function cre(e){return function(){return e}}function fre(e){return function(t){return e(t)+""}}function X1(e,t){var n=Rk.lastIndex=Fk.lastIndex=0,r,i,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(r=Rk.exec(e))&&(i=Fk.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:or(r,i)})),n=Fk.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?fre(u[0].x):cre(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function ir(e,t){var n=typeof t,r;return t==null||n==="boolean"?bd(t):(n==="number"?or:n==="string"?(r=ju(t))?(t=r,Kh):X1:t instanceof ju?Kh:t instanceof Date?V1:W1(t)?Ed:Array.isArray(t)?kk:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Y1:or)(e,t)}function $L(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function BL(e,t){var n=Vu(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Us(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var LL=180/Math.PI,K1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Tk(e,t,n,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*LL,skewX:Math.atan(u)*LL,scaleX:s,scaleY:a}}var Q1;function UL(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?K1:Tk(t.a,t.b,t.c,t.d,t.e,t.f)}function zL(e){return e==null?K1:(Q1||(Q1=document.createElementNS("http://www.w3.org/2000/svg","g")),Q1.setAttribute("transform",e),(e=Q1.transform.baseVal.consolidate())?(e=e.matrix,Tk(e.a,e.b,e.c,e.d,e.e,e.f)):K1)}function HL(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,p,m){if(l!==f||c!==d){var h=p.push("translate(",null,t,null,n);m.push({i:h-4,x:or(l,f)},{i:h-2,x:or(c,d)})}else(f||d)&&p.push("translate("+f+t+d+n)}function s(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:or(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:or(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,p,m){if(l!==f||c!==d){var h=p.push(i(p)+"scale(",null,",",null,")");m.push({i:h-4,x:or(l,f)},{i:h-2,x:or(c,d)})}else(f!==1||d!==1)&&p.push(i(p)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),s(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(p){for(var m=-1,h=d.length,g;++m<h;)f[(g=d[m]).i]=g.x(p);return f.join("")}}}var qL=HL(UL,"px, ","px)","deg)"),GL=HL(zL,", ",")",")");var dre=1e-12;function jL(e){return((e=Math.exp(e))+1/e)/2}function pre(e){return((e=Math.exp(e))-1/e)/2}function mre(e){return((e=Math.exp(2*e))-1)/(e+1)}var WL=function e(t,n,r){function i(o,s){var a=o[0],u=o[1],l=o[2],c=s[0],f=s[1],d=s[2],p=c-a,m=f-u,h=p*p+m*m,g,y;if(h<dre)y=Math.log(d/l)/t,g=function(w){return[a+w*p,u+w*m,l*Math.exp(t*w*y)]};else{var x=Math.sqrt(h),b=(d*d-l*l+r*h)/(2*l*n*x),E=(d*d-l*l-r*h)/(2*d*n*x),v=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(E*E+1)-E);y=(S-v)/t,g=function(w){var _=w*y,A=jL(v),F=l/(n*x)*(A*mre(t*_+v)-pre(v));return[a+F*p,u+F*m,l*A/jL(t*_+v)]}}return g.duration=y*1e3*t/Math.SQRT2,g}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return e(s,a,u)},i}(Math.SQRT2,2,4);function VL(e){return function(t,n){var r=e((t=yc(t)).h,(n=yc(n)).h),i=_t(t.s,n.s),o=_t(t.l,n.l),s=_t(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var YL=VL(Vu),XL=VL(_t);function Dk(e,t){var n=_t((e=Wu(e)).l,(t=Wu(t)).l),r=_t(e.a,t.a),i=_t(e.b,t.b),o=_t(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}function KL(e){return function(t,n){var r=e((t=xc(t)).h,(n=xc(n)).h),i=_t(t.c,n.c),o=_t(t.l,n.l),s=_t(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var QL=KL(Vu),JL=KL(_t);function ZL(e){return function t(n){n=+n;function r(i,o){var s=e((i=xd(i)).h,(o=xd(o)).h),a=_t(i.s,o.s),u=_t(i.l,o.l),l=_t(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var e6=ZL(Vu),t6=ZL(_t);function Ec(e,t){t===void 0&&(t=e,e=ir);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}function n6(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}function Nk(e){return function(){return e}}function vd(e){return+e}var r6=[0,1];function Un(e){return e}function Ok(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Nk(isNaN(t)?NaN:.5)}function hre(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function gre(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=Ok(i,r),o=n(s,o)):(r=Ok(r,i),o=n(o,s)),function(a){return o(r(a))}}function yre(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=Ok(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var u=Mo(e,a,1,r)-1;return o[u](i[u](a))}}function zs(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function vc(){var e=r6,t=r6,n=ir,r,i,o,s=Un,a,u,l;function c(){var d=Math.min(e.length,t.length);return s!==Un&&(s=hre(e[0],e[d-1])),a=d>2?yre:gre,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((l||(l=a(t,e.map(r),or)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,vd),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Us,c()},f.clamp=function(d){return arguments.length?(s=d?!0:Un,c()):s!==Un},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,p){return r=d,i=p,c()}}function Qh(){return vc()(Un,Un)}function wd(e,t,n,r){var i=Fr(e,t,n),o;switch(r=Ci(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=mh(i,s))&&(r.precision=o),ed(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=hh(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=ph(i))&&(r.precision=o-(r.type==="%")*2);break}}return Ru(r)}function Fi(e){var t=e.domain;return e.ticks=function(n){var r=t();return Ql(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return wd(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],u,l,c=10;for(a<s&&(l=s,s=a,a=l,l=i,i=o,o=l);c-- >0;){if(l=lh(s,a,n),l===u)return r[i]=s,r[o]=a,t(r);if(l>0)s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l;else if(l<0)s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function Jh(){var e=Qh();return e.copy=function(){return zs(e,Jh())},en.apply(e,arguments),Fi(e)}function Zh(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,vd),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Zh(e).unknown(t)},e=arguments.length?Array.from(e,vd):[0,1],Fi(n)}function eg(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}function i6(e){return Math.log(e)}function o6(e){return Math.exp(e)}function xre(e){return-Math.log(-e)}function bre(e){return-Math.exp(-e)}function Ere(e){return isFinite(e)?+("1e"+e):e<0?0:e}function vre(e){return e===10?Ere:e===Math.E?Math.exp:t=>Math.pow(e,t)}function wre(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function s6(e){return(t,n)=>-e(-t,n)}function tg(e){let t=e(i6,o6),n=t.domain,r=10,i,o;function s(){return i=wre(r),o=vre(r),n()[0]<0?(i=s6(i),o=s6(o),e(xre,bre)):e(i6,o6),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{let u=n(),l=u[0],c=u[u.length-1],f=c<l;f&&([l,c]=[c,l]);let d=i(l),p=i(c),m,h,g=a==null?10:+a,y=[];if(!(r%1)&&p-d<g){if(d=Math.floor(d),p=Math.ceil(p),l>0){for(;d<=p;++d)for(m=1;m<r;++m)if(h=d<0?m/o(-d):m*o(d),!(h<l)){if(h>c)break;y.push(h)}}else for(;d<=p;++d)for(m=r-1;m>=1;--m)if(h=d>0?m/o(-d):m*o(d),!(h<l)){if(h>c)break;y.push(h)}y.length*2<g&&(y=Ql(l,c,g))}else y=Ql(d,p,Math.min(p-d,g)).map(o);return f?y.reverse():y},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=Ci(u)).precision==null&&(u.trim=!0),u=Ru(u)),a===1/0)return u;let l=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=()=>n(eg(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function ng(){let e=tg(vc()).domain([1,10]);return e.copy=()=>zs(e,ng()).base(e.base()),en.apply(e,arguments),e}function a6(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function u6(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function rg(e){var t=1,n=e(a6(t),u6(t));return n.constant=function(r){return arguments.length?e(a6(t=+r),u6(t)):t},Fi(n)}function ig(){var e=rg(vc());return e.copy=function(){return zs(e,ig()).constant(e.constant())},en.apply(e,arguments)}function l6(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Sre(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Are(e){return e<0?-e*e:e*e}function og(e){var t=e(Un,Un),n=1;function r(){return n===1?e(Un,Un):n===.5?e(Sre,Are):e(l6(n),l6(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Fi(t)}function Sd(){var e=og(vc());return e.copy=function(){return zs(e,Sd()).exponent(e.exponent())},en.apply(e,arguments),e}function Ik(){return Sd.apply(null,arguments).exponent(.5)}function sg(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=fh(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[Mo(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(nr),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return sg().domain(e).range(t).unknown(r)},en.apply(o,arguments)}function ag(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(u){return u!=null&&u<=u?i[Mo(r,u,0,n)]:o}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},s.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return r.slice()},s.copy=function(){return ag().domain([e,t]).range(i).unknown(o)},en.apply(Fi(s),arguments)}function ug(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[Mo(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return ug().domain(e).range(t).unknown(n)},en.apply(i,arguments)}function _re(e){return new Date(e)}function Cre(e){return e instanceof Date?+e:+new Date(+e)}function J1(e,t,n,r,i,o,s,a,u,l){var c=Qh(),f=c.invert,d=c.domain,p=l(".%L"),m=l(":%S"),h=l("%I:%M"),g=l("%I %p"),y=l("%a %d"),x=l("%b %d"),b=l("%B"),E=l("%Y");function v(S){return(u(S)<S?p:a(S)<S?m:s(S)<S?h:o(S)<S?g:r(S)<S?i(S)<S?y:x:n(S)<S?b:E)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,Cre)):d().map(_re)},c.ticks=function(S){var w=d();return e(w[0],w[w.length-1],S??10)},c.tickFormat=function(S,w){return w==null?v:l(w)},c.nice=function(S){var w=d();return(!S||typeof S.range!="function")&&(S=t(w[0],w[w.length-1],S??10)),S?d(eg(w,S)):c},c.copy=function(){return zs(c,J1(e,t,n,r,i,o,s,a,u,l))},c}function Z1(){return en.apply(J1(k2,F2,Rr,ka,Ji,ti,Mu,Tu,rr,sd).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eb(){return en.apply(J1(_2,C2,Tr,Fa,Zi,Qi,Nu,Du,rr,ad).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function tb(){var e=0,t=1,n,r,i,o,s=Un,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(s=f,l):s};function c(f){return function(d){var p,m;return arguments.length?([p,m]=d,s=f(p,m),l):[s(0),s(1)]}}return l.range=c(ir),l.rangeRound=c(Us),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function Ba(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Ad(){var e=Fi(tb()(Un));return e.copy=function(){return Ba(e,Ad())},Ps.apply(e,arguments)}function nb(){var e=tg(tb()).domain([1,10]);return e.copy=function(){return Ba(e,nb()).base(e.base())},Ps.apply(e,arguments)}function rb(){var e=rg(tb());return e.copy=function(){return Ba(e,rb()).constant(e.constant())},Ps.apply(e,arguments)}function lg(){var e=og(tb());return e.copy=function(){return Ba(e,lg()).exponent(e.exponent())},Ps.apply(e,arguments)}function Pk(){return lg.apply(null,arguments).exponent(.5)}function ib(){var e=0,t=.5,n=1,r=1,i,o,s,a,u,l=Un,c,f=!1,d;function p(h){return isNaN(h=+h)?d:(h=.5+((h=+c(h))-o)*(r*h<r*o?a:u),l(f?Math.max(0,Math.min(1,h)):h))}p.domain=function(h){return arguments.length?([e,t,n]=h,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,p):[e,t,n]},p.clamp=function(h){return arguments.length?(f=!!h,p):f},p.interpolator=function(h){return arguments.length?(l=h,p):l};function m(h){return function(g){var y,x,b;return arguments.length?([y,x,b]=g,l=Ec(h,[y,x,b]),p):[l(0),l(.5),l(1)]}}return p.range=m(ir),p.rangeRound=m(Us),p.unknown=function(h){return arguments.length?(d=h,p):d},function(h){return c=h,i=h(e),o=h(t),s=h(n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,p}}function cg(){var e=Fi(ib()(Un));return e.copy=function(){return Ba(e,cg())},Ps.apply(e,arguments)}function ob(){var e=tg(ib()).domain([.1,1,10]);return e.copy=function(){return Ba(e,ob()).base(e.base())},Ps.apply(e,arguments)}function sb(){var e=rg(ib());return e.copy=function(){return Ba(e,sb()).constant(e.constant())},Ps.apply(e,arguments)}function fg(){var e=og(ib());return e.copy=function(){return Ba(e,fg()).exponent(e.exponent())},Ps.apply(e,arguments)}function $k(){return fg.apply(null,arguments).exponent(.5)}function nn(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}var Bk=nn("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");var Lk=nn("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");var Uk=nn("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");var zk=nn("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0");var Hk=nn("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");var qk=nn("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2");var Gk=nn("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc");var jk=nn("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");var Wk=nn("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");var Vk=nn("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function dg(e,t,n){let r=e-t+n*2;return e?r>0?r:1:0}var Fre="identity",Sc="linear",Hs="log",_d="pow",Cd="sqrt",pg="symlog",Yu="time",Xu="utc",Po="sequential",Ac="diverging",wc="quantile",mg="quantize",hg="threshold",ub="ordinal",lb="point",Xk="band",cb="bin-ordinal",fn="continuous",gg="discrete",yg="discretizing",io="interpolating",Kk="temporal";function Rre(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Tre(e){return function(t){let n=e.range(),r=t[0],i=t[1],o=-1,s,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),s=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function Qk(){let e=pc().unknown(void 0),t=e.domain,n=e.range,r=[0,1],i,o,s=!1,a=0,u=0,l=.5;delete e.unknown;function c(){let f=t().length,d=r[1]<r[0],p=r[1-d],m=dg(f,a,u),h=r[d-0];i=(p-h)/(m||1),s&&(i=Math.floor(i)),h+=(p-h-i*(f-a))*l,o=i*(1-a),s&&(h=Math.round(h),o=Math.round(o));let g=jt(f).map(y=>h+i*y);return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;let d=r[1]<r[0],p=d?n().reverse():n(),m=p.length-1,h=+f[0],g=+f[1],y,x,b;if(!(h!==h||g!==g)&&(g<h&&(b=h,h=g,g=b),!(g<p[0]||h>r[1-d])))return y=Math.max(0,Kl(p,h)-1),x=h===g?y:Kl(p,g)-1,h-p[y]>o+1e-10&&++y,d&&(b=y,y=m-x,x=m-b),y>x?void 0:t().slice(y,x+1)},e.invert=function(f){let d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return Qk().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(u).align(l)},c()}function p6(e){let t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return p6(t())},e}function Dre(){return p6(Qk().paddingInner(1))}var Mre=Array.prototype.map;function Nre(e){return Mre.call(e,Gt)}var Ore=Array.prototype.slice;function m6(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Mo(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=Nre(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Ore.call(r),n):t.slice()},n.tickFormat=function(r,i){return wd(e[0],Te(e),r??10,i)},n.copy=function(){return m6().domain(n.domain()).range(n.range())},n}var ab=new Map,h6=Symbol("vega_scale");function Jk(e){return e[h6]=!0,e}function Zk(e){return e&&e[h6]===!0}function Ire(e,t,n){let r=function(){let o=t();return o.invertRange||(o.invertRange=o.invert?Rre(o):o.invertExtent?Tre(o):void 0),o.type=e,Jk(o)};return r.metadata=Jt(Q(n)),r}function Ue(e,t,n){return arguments.length>1?(ab.set(e,Ire(e,t,n)),this):eF(e)?ab.get(e):void 0}Ue(Fre,Zh);Ue(Sc,Jh,fn);Ue(Hs,ng,[fn,Hs]);Ue(_d,Sd,fn);Ue(Cd,Ik,fn);Ue(pg,ig,fn);Ue(Yu,Z1,[fn,Kk]);Ue(Xu,eb,[fn,Kk]);Ue(Po,Ad,[fn,io]);Ue(`${Po}-${Sc}`,Ad,[fn,io]);Ue(`${Po}-${Hs}`,nb,[fn,io,Hs]);Ue(`${Po}-${_d}`,lg,[fn,io]);Ue(`${Po}-${Cd}`,Pk,[fn,io]);Ue(`${Po}-${pg}`,rb,[fn,io]);Ue(`${Ac}-${Sc}`,cg,[fn,io]);Ue(`${Ac}-${Hs}`,ob,[fn,io,Hs]);Ue(`${Ac}-${_d}`,fg,[fn,io]);Ue(`${Ac}-${Cd}`,$k,[fn,io]);Ue(`${Ac}-${pg}`,sb,[fn,io]);Ue(wc,sg,[yg,wc]);Ue(mg,ag,yg);Ue(hg,ug,yg);Ue(cb,m6,[gg,yg]);Ue(ub,pc,gg);Ue(Xk,Qk,gg);Ue(lb,Dre,gg);function eF(e){return ab.has(e)}function _c(e,t){let n=ab.get(e);return n&&n.metadata[t]}function xg(e){return _c(e,fn)}function Ku(e){return _c(e,gg)}function fb(e){return _c(e,yg)}function tF(e){return _c(e,Hs)}function Pre(e){return _c(e,Kk)}function nF(e){return _c(e,io)}function rF(e){return _c(e,wc)}var $re=["clamp","base","constant","exponent"];function db(e,t){let n=t[0],r=Te(t)-n;return function(i){return e(n+i*r)}}function kd(e,t,n){return Ec(bg(t||"rgb",n),e)}function pb(e,t){let n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function mb(e,t,n){let r=n-t,i,o,s;return!r||!Number.isFinite(r)?St(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=Ue(o)().domain([t,n]).range([0,1]),$re.forEach(a=>e[a]?s[a](e[a]()):0),s)}function bg(e,t){let n=Mk[Bre(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Bre(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}var Lre={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Ure={accent:Lk,category10:Bk,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Uk,observable10:zk,paired:Hk,pastel1:qk,pastel2:Gk,set1:jk,set2:Wk,set3:Vk,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function g6(e){if(M(e))return e;let t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function y6(e,t){for(let n in e)Eg(n,t(e[n]))}var c6={};y6(Ure,g6);y6(Lre,e=>kd(g6(e)));function Eg(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(c6[e]=t,this):c6[e]}var vg="symbol",zre="discrete",x6="gradient",Hre=e=>M(e)?e.map(t=>String(t)):String(e),qre=(e,t)=>e[1]-t[1],Gre=(e,t)=>t[1]-e[1];function hb(e,t,n){let r;return ke(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Aa(e.domain())/n||1)+1))),X(t)&&(r=t.step,t=t.interval),V(t)&&(t=e.type===Yu?Ra(t):e.type==Xu?Ta(t):U("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function iF(e,t,n){let r=e.range(),i=r[0],o=Te(r),s=qre;if(i>o&&(r=o,o=i,i=r,s=Gre),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){let a=[t[0],Te(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function gb(e,t){return e.bins?iF(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function oF(e,t,n,r,i,o){let s=t.type,a=Hre;if(s===Yu||i===Yu)a=e.timeFormat(r);else if(s===Xu||i===Xu)a=e.utcFormat(r);else if(tF(s)){let u=e.formatFloat(r);if(o||t.bins)a=u;else{let l=b6(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){let u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(a=e.format(r));return a}function b6(e,t,n){let r=gb(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/o));return l*i<i-.5&&(l*=i),l<=s};return n?r.filter(a):a}var Yk={[wc]:"quantiles",[mg]:"thresholds",[hg]:"domain"},E6={[wc]:"quantiles",[mg]:"domain"};function sF(e,t){return e.bins?Vre(e.bins):e.type===Hs?b6(e,t,!0):Yk[e.type]?Wre(e[Yk[e.type]]()):gb(e,t)}function jre(e,t,n){let r=t[E6[t.type]](),i=r.length,o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,3*10,n)}function Wre(e){let t=[-1/0].concat(e);return t.max=1/0,t}function Vre(e){let t=e.slice(0,-1);return t.max=Te(e),t}var Yre=e=>Yk[e.type]||e.bins;function aF(e,t,n,r,i,o,s){let a=E6[t.type]&&o!==Yu&&o!==Xu?jre(e,t,i):oF(e,t,n,i,o,s);return r===vg&&Yre(t)?Xre(a):r===zre?Kre(a):Qre(a)}var Xre=e=>(t,n,r)=>{let i=f6(r[n+1],f6(r.max,1/0)),o=d6(t,e),s=d6(i,e);return o&&s?o+" \u2013 "+s:s?"< "+s:"\u2265 "+o},f6=(e,t)=>e??t,Kre=e=>(t,n)=>n?e(t):null,Qre=e=>t=>e(t),d6=(e,t)=>Number.isFinite(e)?t(e):null;function v6(e){let t=e.domain(),n=t.length-1,r=+t[0],i=+Te(t),o=i-r;if(e.type===hg){let s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}function Jre(e,t,n,r){let i=r||t.type;return V(n)&&Pre(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Yu?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Xu?e.utcFormat("%A, %d %B %Y, %X UTC"):aF(e,t,5,null,n,r,!0)}function uF(e,t,n){n=n||{};let r=Math.max(3,n.maxlen||7),i=Jre(e,t,n.format,n.formatType);if(fb(t.type)){let o=sF(t).slice(1).map(i),s=o.length;return`${s} boundar${s===1?"y":"ies"}: ${o.join(", ")}`}else if(Ku(t.type)){let o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return`${s} value${s===1?"":"s"}: ${a}`}else{let o=t.domain();return`values from ${i(o[0])} to ${i(Te(o))}`}}var W6=0;function Zre(){W6=0}var Cb="p_";function _F(e){return e&&e.gradient}function V6(e,t,n){let r=e.gradient,i=e.id,o=r==="radial"?Cb:"";return i||(i=e.id="gradient_"+W6++,r==="radial"?(e.x1=qs(e.x1,.5),e.y1=qs(e.y1,.5),e.r1=qs(e.r1,0),e.x2=qs(e.x2,.5),e.y2=qs(e.y2,.5),e.r2=qs(e.r2,.5),o=Cb):(e.x1=qs(e.x1,0),e.y1=qs(e.y1,0),e.x2=qs(e.x2,1),e.y2=qs(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function qs(e,t){return e??t}function CF(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}var w6={basis:{curve:tk},"basis-closed":{curve:nk},"basis-open":{curve:rk},bundle:{curve:ik,tension:"beta",value:.85},cardinal:{curve:ok,tension:"tension",value:0},"cardinal-open":{curve:ak,tension:"tension",value:0},"cardinal-closed":{curve:sk,tension:"tension",value:0},"catmull-rom":{curve:uk,tension:"alpha",value:.5},"catmull-rom-closed":{curve:lk,tension:"alpha",value:.5},"catmull-rom-open":{curve:ck,tension:"alpha",value:.5},linear:{curve:dc},"linear-closed":{curve:fk},monotone:{horizontal:mk,vertical:pk},natural:{curve:hk},step:{curve:gk},"step-after":{curve:xk},"step-before":{curve:yk}};function kF(e,t,n){var r=ee(w6,e)&&w6[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}var eie={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},tie=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,nie=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,rie=/^((\s+,?\s*)|(,\s*))/,iie=/^[01]/;function Dc(e){let t=[];return(e.match(tie)||[]).forEach(r=>{let i=r[0],o=i.toLowerCase(),s=eie[o],a=oie(o,s,r.slice(1).trim()),u=a.length;if(u<s||u&&u%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,s)]),u!==s){o==="m"&&(i=i==="M"?"L":"l");for(let l=s;l<u;l+=s)t.push([i,...a.slice(l,l+s)])}}),t}function oie(e,t,n){let r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){let s=e==="a"&&(o===3||o===4)?iie:nie,a=n.slice(i).match(s);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);let u=n.slice(i).match(rie);u!==null&&(i+=u[0].length)}return r}var nl=Math.PI/180,sie=1e-14,Cc=Math.PI/2,Gs=Math.PI*2,Fd=Math.sqrt(3)/2,lF={},cF={},Y6=[].join;function aie(e,t,n,r,i,o,s,a,u){let l=Y6.call(arguments);if(lF[l])return lF[l];let c=s*nl,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);let p=d*(a-e)*.5+f*(u-t)*.5,m=d*(u-t)*.5-f*(a-e)*.5,h=p*p/(n*n)+m*m/(r*r);h>1&&(h=Math.sqrt(h),n*=h,r*=h);let g=d/n,y=f/n,x=-f/r,b=d/r,E=g*a+y*u,v=x*a+b*u,S=g*e+y*t,w=x*e+b*t,A=1/((S-E)*(S-E)+(w-v)*(w-v))-.25;A<0&&(A=0);let F=Math.sqrt(A);o==i&&(F=-F);let R=.5*(E+S)-F*(w-v),D=.5*(v+w)+F*(S-E),O=Math.atan2(v-D,E-R),k=Math.atan2(w-D,S-R)-O;k<0&&o===1?k+=Gs:k>0&&o===0&&(k-=Gs);let C=Math.ceil(Math.abs(k/(Cc+.001))),N=[];for(let I=0;I<C;++I){let L=O+I*k/C,te=O+(I+1)*k/C;N[I]=[R,D,L,te,n,r,f,d]}return lF[l]=N}function uie(e){let t=Y6.call(e);if(cF[t])return cF[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7];let c=l*s,f=-u*a,d=u*s,p=l*a,m=Math.cos(i),h=Math.sin(i),g=Math.cos(o),y=Math.sin(o),x=.5*(o-i),b=Math.sin(x*.5),E=8/3*b*b/Math.sin(x),v=n+m-E*h,S=r+h+E*m,w=n+g,_=r+y,A=w+E*y,F=_-E*g;return cF[t]=[c*v+f*S,d*v+p*S,c*A+f*F,d*A+p*F,c*w+f*_,d*w+p*_]}var oo=["l",0,0,0,0,0,0,0];function lie(e,t,n){let r=oo[0]=e[0];if(r==="a"||r==="A")oo[1]=t*e[1],oo[2]=n*e[2],oo[3]=e[3],oo[4]=e[4],oo[5]=e[5],oo[6]=t*e[6],oo[7]=n*e[7];else if(r==="h"||r==="H")oo[1]=t*e[1];else if(r==="v"||r==="V")oo[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)oo[i]=(i%2==1?t:n)*e[i];return oo}function Td(e,t,n,r,i,o){var s,a=null,u=0,l=0,c=0,f=0,d,p,m,h,g=0,y=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var x=0,b=t.length;x<b;++x){switch(s=t[x],(i!==1||o!==1)&&(s=lie(s,i,o)),s[0]){case"l":u+=s[1],l+=s[2],e.lineTo(u+n,l+r);break;case"L":u=s[1],l=s[2],e.lineTo(u+n,l+r);break;case"h":u+=s[1],e.lineTo(u+n,l+r);break;case"H":u=s[1],e.lineTo(u+n,l+r);break;case"v":l+=s[1],e.lineTo(u+n,l+r);break;case"V":l=s[1],e.lineTo(u+n,l+r);break;case"m":u+=s[1],l+=s[2],g=u,y=l,e.moveTo(u+n,l+r);break;case"M":u=s[1],l=s[2],g=u,y=l,e.moveTo(u+n,l+r);break;case"c":d=u+s[5],p=l+s[6],c=u+s[3],f=l+s[4],e.bezierCurveTo(u+s[1]+n,l+s[2]+r,c+n,f+r,d+n,p+r),u=d,l=p;break;case"C":u=s[5],l=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+s[3],p=l+s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+s[1]+n,l+s[2]+r,d+n,p+r),c=u+s[1],f=l+s[2],u=d,l=p;break;case"S":d=s[3],p=s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,s[1]+n,s[2]+r,d+n,p+r),u=d,l=p,c=s[1],f=s[2];break;case"q":d=u+s[3],p=l+s[4],c=u+s[1],f=l+s[2],e.quadraticCurveTo(c+n,f+r,d+n,p+r),u=d,l=p;break;case"Q":d=s[3],p=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,d+n,p+r),u=d,l=p,c=s[1],f=s[2];break;case"t":d=u+s[1],p=l+s[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-m,f=2*l-h):a[0]==="q"&&(c=2*u-c,f=2*l-f),m=c,h=f,e.quadraticCurveTo(c+n,f+r,d+n,p+r),u=d,l=p,c=u+s[1],f=l+s[2];break;case"T":d=s[1],p=s[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,p+r),u=d,l=p;break;case"a":S6(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+u+n,s[7]+l+r]),u+=s[6],l+=s[7];break;case"A":S6(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),u=s[6],l=s[7];break;case"z":case"Z":u=g,l=y,e.closePath();break}a=s}}function S6(e,t,n,r){let i=aie(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){let s=uie(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}var A6=.5773502691896257,_6={circle:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Gs)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fd*n,i=r-n*A6,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fd*n,i=r-n*A6;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fd*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fd*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fd*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fd*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function X6(e){return ee(_6,e)?_6[e]:cie(e)}var fF={};function cie(e){if(!ee(fF,e)){let t=Dc(e);fF[e]={draw:function(n,r){Td(n,t,0,0,Math.sqrt(r)/2)}}}return fF[e]}var Qu=.448084975506;function fie(e){return e.x}function die(e){return e.y}function pie(e){return e.width}function mie(e){return e.height}function La(e){return typeof e=="function"?e:()=>+e}function yb(e,t,n){return Math.max(t,Math.min(e,n))}function K6(){var e=fie,t=die,n=pie,r=mie,i=La(0),o=i,s=i,a=i,u=null;function l(c,f,d){var p,m=f??+e.call(this,c),h=d??+t.call(this,c),g=+n.call(this,c),y=+r.call(this,c),x=Math.min(g,y)/2,b=yb(+i.call(this,c),0,x),E=yb(+o.call(this,c),0,x),v=yb(+s.call(this,c),0,x),S=yb(+a.call(this,c),0,x);if(u||(u=p=fc()),b<=0&&E<=0&&v<=0&&S<=0)u.rect(m,h,g,y);else{var w=m+g,_=h+y;u.moveTo(m+b,h),u.lineTo(w-E,h),u.bezierCurveTo(w-Qu*E,h,w,h+Qu*E,w,h+E),u.lineTo(w,_-S),u.bezierCurveTo(w,_-Qu*S,w-Qu*S,_,w-S,_),u.lineTo(m+v,_),u.bezierCurveTo(m+Qu*v,_,m,_-Qu*v,m,_-v),u.lineTo(m,h+b),u.bezierCurveTo(m,h+Qu*b,m+Qu*b,h,m+b,h),u.closePath()}if(p)return u=null,p+""||null}return l.x=function(c){return arguments.length?(e=La(c),l):e},l.y=function(c){return arguments.length?(t=La(c),l):t},l.width=function(c){return arguments.length?(n=La(c),l):n},l.height=function(c){return arguments.length?(r=La(c),l):r},l.cornerRadius=function(c,f,d,p){return arguments.length?(i=La(c),o=f!=null?La(f):i,a=d!=null?La(d):i,s=p!=null?La(p):o,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function Q6(){var e,t,n,r,i=null,o,s,a,u;function l(f,d,p){let m=p/2;if(o){var h=a-d,g=f-s;if(h||g){var y=Math.hypot(h,g),x=(h/=y)*u,b=(g/=y)*u,E=Math.atan2(g,h);i.moveTo(s-x,a-b),i.lineTo(f-h*m,d-g*m),i.arc(f,d,m,E-Math.PI,E),i.lineTo(s+x,a+b),i.arc(s,a,u,E,E+Math.PI)}else i.arc(f,d,m,0,Gs);i.closePath()}else o=1;s=f,a=d,u=m}function c(f){var d,p=f.length,m,h=!1,g;for(i==null&&(i=g=fc()),d=0;d<=p;++d)!(d<p&&r(m=f[d],d,f))===h&&(h=!h)&&(o=0),h&&l(+e(m,d,f),+t(m,d,f),+n(m,d,f));if(g)return i=null,g+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function Og(e,t){return e??t}var Ig=e=>e.x||0,Pg=e=>e.y||0,hie=e=>e.width||0,gie=e=>e.height||0,yie=e=>(e.x||0)+(e.width||0),xie=e=>(e.y||0)+(e.height||0),bie=e=>e.startAngle||0,Eie=e=>e.endAngle||0,vie=e=>e.padAngle||0,wie=e=>e.innerRadius||0,Sie=e=>e.outerRadius||0,Aie=e=>e.cornerRadius||0,_ie=e=>Og(e.cornerRadiusTopLeft,e.cornerRadius)||0,Cie=e=>Og(e.cornerRadiusTopRight,e.cornerRadius)||0,kie=e=>Og(e.cornerRadiusBottomRight,e.cornerRadius)||0,Fie=e=>Og(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Rie=e=>Og(e.size,64),Tie=e=>e.size||1,Hb=e=>e.defined!==!1,Die=e=>X6(e.shape||"circle"),Mie=ek().startAngle(bie).endAngle(Eie).padAngle(vie).innerRadius(wie).outerRadius(Sie).cornerRadius(Aie),Nie=T1().x(Ig).y1(Pg).y0(xie).defined(Hb),Oie=T1().y(Pg).x1(Ig).x0(yie).defined(Hb),Iie=Gh().x(Ig).y(Pg).defined(Hb),Pie=K6().x(Ig).y(Pg).width(hie).height(gie).cornerRadius(_ie,Cie,kie,Fie),$ie=D1().type(Die).size(Rie),Bie=Q6().x(Ig).y(Pg).defined(Hb).size(Tie);function FF(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Lie(e,t){return Mie.context(e)(t)}function Uie(e,t){let n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Oie:Nie).curve(kF(r,n.orient,n.tension)).context(e)(t)}function zie(e,t){let n=t[0],r=n.interpolate||"linear";return Iie.curve(kF(r,n.orient,n.tension)).context(e)(t)}function Od(e,t,n,r){return Pie.context(e)(t,n,r)}function Hie(e,t){return(t.mark.shape||t.shape).context(e)(t)}function qie(e,t){return $ie.context(e)(t)}function Gie(e,t){return Bie.context(e)(t)}var J6=1;function Z6(){J6=1}function RF(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+J6++),s=i.clipping[o]||(i.clipping[o]={id:o});return Ee(r)?s.path=r(null):FF(n)?s.path=Od(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function It(e){this.clear(),e&&this.union(e)}It.prototype={clone(){return new It(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){let r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*r-u*i+l,u*r+a*i+c,a*r-u*s+l,u*r+a*s+c,a*o-u*i+l,u*o+a*i+c,a*o-u*s+l,u*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function $g(e){this.mark=e,this.bounds=this.bounds||new It}function Bg(e){$g.call(this,e),this.items=this.items||[]}Z(Bg,$g);var kb=class{constructor(t){this._pending=0,this._loader=t||ud()}pending(){return this._pending}sanitizeURL(t){let n=this;return C6(n),n._loader.sanitize(t,{context:"href"}).then(r=>(wg(n),r)).catch(()=>(wg(n),null))}loadImage(t){let n=this,r=cL();return C6(n),n._loader.sanitize(t,{context:"image"}).then(i=>{let o=i.href;if(!o||!r)throw{url:o};let s=new r,a=ee(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>wg(n),s.onerror=()=>wg(n),s.src=o,s}).catch(i=>(wg(n),{complete:!1,width:0,height:0,src:i&&i.url||""}))}ready(){let t=this;return new Promise(n=>{function r(i){t.pending()?setTimeout(()=>{r(!0)},10):n(i)}r(!1)})}};function C6(e){e._pending+=1}function wg(e){e._pending-=1}function js(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){let r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?jie(t,r):0))}return e}function jie(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}var Wie=Gs-1e-8,qb,xb,bb,Rc,gF,Eb,yF,xF,Ju=(e,t)=>qb.add(e,t),vb=(e,t)=>Ju(xb=e,bb=t),k6=e=>Ju(e,qb.y1),F6=e=>Ju(qb.x1,e),kc=(e,t)=>gF*e+yF*t,Fc=(e,t)=>Eb*e+xF*t,dF=(e,t)=>Ju(kc(e,t),Fc(e,t)),pF=(e,t)=>vb(kc(e,t),Fc(e,t));function Lg(e,t){return qb=e,t?(Rc=t*nl,gF=xF=Math.cos(Rc),Eb=Math.sin(Rc),yF=-Eb):(gF=xF=1,Rc=Eb=yF=0),Vie}var Vie={beginPath(){},closePath(){},moveTo:pF,lineTo:pF,rect(e,t,n,r){Rc?(dF(e+n,t),dF(e+n,t+r),dF(e,t+r),pF(e,t)):(Ju(e+n,t+r),vb(e,t))},quadraticCurveTo(e,t,n,r){let i=kc(e,t),o=Fc(e,t),s=kc(n,r),a=Fc(n,r);R6(xb,i,s,k6),R6(bb,o,a,F6),vb(s,a)},bezierCurveTo(e,t,n,r,i,o){let s=kc(e,t),a=Fc(e,t),u=kc(n,r),l=Fc(n,r),c=kc(i,o),f=Fc(i,o);T6(xb,s,u,c,k6),T6(bb,a,l,f,F6),vb(c,f)},arc(e,t,n,r,i,o){if(r+=Rc,i+=Rc,xb=n*Math.cos(i)+e,bb=n*Math.sin(i)+t,Math.abs(i-r)>Wie)Ju(e-n,t-n),Ju(e+n,t+n);else{let s=l=>Ju(n*Math.cos(l)+e,n*Math.sin(l)+t),a,u;if(s(r),s(i),i!==r)if(r=r%Gs,r<0&&(r+=Gs),i=i%Gs,i<0&&(i+=Gs),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=Gs,a=r-r%Cc,u=0;u<4&&a>i;++u,a-=Cc)s(a);else for(a=r-r%Cc+Cc,u=0;u<4&&a<i;++u,a=a+Cc)s(a)}}};function R6(e,t,n,r){let i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function T6(e,t,n,r,i){let o=r-e+3*t-3*n,s=e+n-2*t,a=e-t,u=0,l=0,c;Math.abs(o)>sie?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),u=(-s+c)/o,l=(-s-c)/o)):u=.5*a/s,0<u&&u<1&&i(D6(u,e,t,n,r)),0<l&&l<1&&i(D6(l,e,t,n,r))}function D6(e,t,n,r,i){let o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}var tl=(tl=no(1,1))?tl.getContext("2d"):null,bF=new It;function TF(e){return function(t,n){if(!tl)return!0;e(tl,t),bF.clear().union(t.bounds).intersect(n).round();let{x1:r,y1:i,x2:o,y2:s}=bF;for(let a=i;a<=s;++a)for(let u=r;u<=o;++u)if(tl.isPointInPath(u,a))return!0;return!1}}function DF(e,t){return t.contains(e.x||0,e.y||0)}function e8(e,t){let n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(bF.set(n,r,n+i,r+o))}function t8(e,t){let n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return Rd(t,n,r,i,o)}function Rd(e,t,n,r,i){let{x1:o,y1:s,x2:a,y2:u}=e,l=r-t,c=i-n,f=0,d=1,p,m,h,g;for(g=0;g<4;++g){if(g===0&&(p=-l,m=-(o-t)),g===1&&(p=l,m=a-t),g===2&&(p=-c,m=-(s-n)),g===3&&(p=c,m=u-n),Math.abs(p)<1e-10&&m<0)return!1;if(h=m/p,p<0){if(h>d)return!1;h>f&&(f=h)}else if(p>0){if(h<f)return!1;h<d&&(d=h)}}return!0}function Dd(e,t){e.globalCompositeOperation=t.blend||"source-over"}function $o(e,t){return e??t}function M6(e,t){let n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Yie(e,t,n){let r=n.width(),i=n.height(),o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+$o(t.x1,.5)*r,n.y1+$o(t.y1,.5)*i,Math.max(r,i)*$o(t.r1,0),n.x1+$o(t.x2,.5)*r,n.y1+$o(t.y2,.5)*i,Math.max(r,i)*$o(t.r2,.5));else{let s=$o(t.x1,0),a=$o(t.y1,0),u=$o(t.x2,1),l=$o(t.y2,0);if(s===u||a===l||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+l*i);else{let c=no(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=M6(f.createLinearGradient(s,a,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return M6(o,t.stops)}function n8(e,t,n){return _F(n)?Yie(e,n,t.bounds):n}function Fb(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=n8(e,t,t.fill),!0):!1}var Xie=[];function Md(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=n8(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Xie),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Kie(e,t){return e.zindex-t.zindex||e.index-t.index}function MF(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Kie)}function Lo(e,t){var n=e.items,r,i;if(!n||!n.length)return;let o=MF(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function Rb(e,t){var n=e.items,r,i;if(!n||!n.length)return null;let o=MF(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function NF(e){return function(t,n,r){Lo(n,i=>{(!r||r.intersects(i.bounds))&&r8(e,t,i,i)})}}function Qie(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&r8(e,t,n.items[0],n.items)}}function r8(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Dd(t,n),n.fill&&Fb(t,n,i)&&t.fill(),n.stroke&&Md(t,n,i)&&t.stroke()))}function Gb(e){return e=e||cn,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,Rb(n,a=>{let u=a.bounds;if(!(u&&!u.contains(o,s)||!u)&&e(t,a,r,i,o,s))return a})}}function Ug(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,u=s.stroke&&n.isPointInStroke,l,c;return u&&(l=s.strokeWidth,c=s.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o)}}function OF(e){return Gb(Ug(e))}function Tc(e,t){return"translate("+e+","+t+")"}function IF(e){return"rotate("+e+")"}function Jie(e,t){return"scale("+e+","+t+")"}function i8(e){return Tc(e.x||0,e.y||0)}function Zie(e){return Tc(e.x||0,e.y||0)+(e.angle?" "+IF(e.angle):"")}function eoe(e){return Tc(e.x||0,e.y||0)+(e.angle?" "+IF(e.angle):"")+(e.scaleX||e.scaleY?" "+Jie(e.scaleX||1,e.scaleY||1):"")}function PF(e,t,n){function r(s,a){s("transform",Zie(a)),s("d",t(null,a))}function i(s,a){return t(Lg(s,a.angle),a),js(s,a).translate(a.x||0,a.y||0)}function o(s,a){var u=a.x||0,l=a.y||0,c=a.angle||0;s.translate(u,l),c&&s.rotate(c*=nl),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:NF(o),pick:OF(o),isect:n||TF(o)}}var toe=PF("arc",Lie);function noe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function roe(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function ioe(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function $F(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(Lg(u),c),js(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}let s=Ug(o);function a(u,l,c,f,d,p){var m=l.items,h=l.bounds;return!m||!m.length||h&&!h.contains(d,p)?null:(c*=u.pixelRatio,f*=u.pixelRatio,s(u,m,c,f)?m[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Qie(o),pick:a,isect:DF,tip:n}}var ooe=$F("area",Uie,noe);function soe(e,t){var n=t.clip;e.save(),Ee(n)?(e.beginPath(),n(e),e.clip()):o8(e,t.group)}function o8(e,t){e.beginPath(),FF(t)?Od(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function s8(e){let t=$o(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function aoe(e,t){e("transform",i8(t))}function a8(e,t){let n=s8(t);e("d",Od(null,t,n,n))}function uoe(e,t){e("class","background"),e("aria-hidden",!0),a8(e,t)}function loe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?a8(e,t):e("d","")}function coe(e,t,n){let r=t.clip?RF(n,t,t):null;e("clip-path",r)}function foe(e,t){if(!t.clip&&t.items){let n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),js(e,t),e.translate(t.x||0,t.y||0)}function Fg(e,t,n,r){let i=s8(t);e.beginPath(),Od(e,t,(n||0)+i,(r||0)+i)}var doe=Ug(Fg),poe=Ug(Fg,!1),moe=Ug(Fg,!0);function hoe(e,t,n,r){Lo(t,i=>{let o=i.x||0,s=i.y||0,a=i.strokeForeground,u=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&u&&(Fg(e,i,o,s),Dd(e,i),i.fill&&Fb(e,i,u)&&e.fill(),i.stroke&&!a&&Md(e,i,u)&&e.stroke()),e.save(),e.translate(o,s),i.clip&&o8(e,i),n&&n.translate(-o,-s),Lo(i,l=>{(l.marktype==="group"||r==null||r.includes(l.marktype))&&this.draw(e,l,n,r)}),n&&n.translate(o,s),e.restore(),a&&i.stroke&&u&&(Fg(e,i,o,s),Dd(e,i),Md(e,i,u)&&e.stroke())})}function goe(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;let s=n*e.pixelRatio,a=r*e.pixelRatio;return Rb(t,u=>{let l,c,f,d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;let p=c+(u.width||0),m=f+(u.height||0),h=u.clip;if(h&&(i<c||i>p||o<f||o>m))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,h&&FF(u)&&!moe(e,u,s,a))return e.restore(),null;let g=u.strokeForeground,y=t.interactive!==!1;return y&&g&&u.stroke&&poe(e,u,s,a)?(e.restore(),u):(l=Rb(u,x=>yoe(x,c,f)?this.pick(x,n,r,c,f):null),!l&&y&&(u.fill||!g&&u.stroke)&&doe(e,u,s,a)&&(l=u),e.restore(),l||null)})}function yoe(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var xoe={type:"group",tag:"g",nested:!1,attr:aoe,bound:foe,draw:hoe,pick:goe,isect:e8,content:coe,background:uoe,foreground:loe},Rg={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function BF(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function LF(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function UF(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function jb(e,t){return e==="center"?t/2:e==="right"?t:0}function Wb(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function boe(e,t,n){let r=BF(t,n),i=LF(t,r),o=UF(t,r),s=(t.x||0)-jb(t.align,i),a=(t.y||0)-Wb(t.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,Rg["xmlns:xlink"],"xlink:href"),e("transform",Tc(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function Eoe(e,t){let n=t.image,r=LF(t,n),i=UF(t,n),o=(t.x||0)-jb(t.align,r),s=(t.y||0)-Wb(t.baseline,i);return e.set(o,s,o+r,s+i)}function voe(e,t,n){Lo(t,r=>{if(n&&!n.intersects(r.bounds))return;let i=BF(r,this),o=LF(r,i),s=UF(r,i);if(o===0||s===0)return;let a=(r.x||0)-jb(r.align,o),u=(r.y||0)-Wb(r.baseline,s),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(Dd(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,u,o,s))})}var woe={type:"image",tag:"image",nested:!1,attr:boe,bound:Eoe,draw:voe,pick:Gb(),isect:cn,get:BF,xOffset:jb,yOffset:Wb},Soe=$F("line",zie,roe);function Aoe(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",eoe(t)),e("d",t.path)}function wb(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*nl,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Dc(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),Td(e,u,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):Td(e,u,r,i,o,s)}function _oe(e,t){return wb(Lg(e,t.angle),t)?e.set(0,0,0,0):js(e,t,!0)}var Coe={type:"path",tag:"path",nested:!1,attr:Aoe,bound:_oe,draw:NF(wb),pick:OF(wb),isect:TF(wb)};function koe(e,t){e("d",Od(null,t))}function Foe(e,t){var n,r;return js(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function N6(e,t){e.beginPath(),Od(e,t)}var Roe={type:"rect",tag:"path",nested:!1,attr:koe,bound:Foe,draw:NF(N6),pick:OF(N6),isect:e8};function Toe(e,t){e("transform",i8(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Doe(e,t){var n,r;return js(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function u8(e,t,n){var r,i,o,s;return t.stroke&&Md(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function Moe(e,t,n){Lo(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&u8(e,r,i)&&(Dd(e,r),e.stroke())}})}function Noe(e,t,n,r){return e.isPointInStroke?u8(e,t,1)&&e.isPointInStroke(n,r):!1}var Ooe={type:"rule",tag:"line",nested:!1,attr:Toe,bound:Doe,draw:Moe,pick:Gb(Noe),isect:t8},Ioe=PF("shape",Hie),Poe=PF("symbol",qie,DF),O6=t2(),ii={height:Ws,measureWidth:zF,estimateWidth:Tb,width:Tb,canvas:l8};l8(!0);function l8(e){ii.width=e&&tl?zF:Tb}function Tb(e,t){return c8(il(e,t),Ws(e))}function c8(e,t){return~~(.8*e.length*t)}function zF(e,t){return Ws(e)<=0||!(t=il(e,t))?0:f8(t,Yb(e))}function f8(e,t){let n=`(${t}) ${e}`,r=O6.get(n);return r===void 0&&(tl.font=t,r=tl.measureText(e).width,O6.set(n,r)),r}function Ws(e){return e.fontSize!=null?+e.fontSize||0:11}function rl(e){return e.lineHeight!=null?e.lineHeight:Ws(e)+2}function $oe(e){return M(e)?e.length>1?e:e[0]:e}function zg(e){return $oe(e.lineBreak&&e.text&&!M(e.text)?e.text.split(e.lineBreak):e.text)}function Vb(e){let t=zg(e);return(M(t)?t.length-1:0)*rl(e)}function il(e,t){let n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Loe(e,n):n}function Boe(e){if(ii.width===zF){let t=Yb(e);return n=>f8(n,t)}else if(ii.width===Tb){let t=Ws(e);return n=>c8(n,t)}else return t=>ii.width(e,t)}function Loe(e,t){var n=+e.limit,r=Boe(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",o=e.dir==="rtl",s=0,a=t.length,u;if(n-=r(i),o){for(;s<a;)u=s+a>>>1,r(t.slice(u))>n?s=u+1:a=u;return i+t.slice(s)}else{for(;s<a;)u=1+(s+a>>>1),r(t.slice(0,u))<n?s=u:a=u-1;return t.slice(0,s)+i}}function Hg(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Yb(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Ws(e)+"px "+Hg(e,t)}function HF(e){var t=e.baseline,n=Ws(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*rl(e):t==="line-bottom"?.29*n-.5*rl(e):0)}var Uoe={left:"start",center:"middle",right:"end"},_g=new It;function Xb(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Cc,t+=r*Math.cos(i),n+=r*Math.sin(i)),_g.x1=t,_g.y1=n,_g}function zoe(e,t){var n=t.dx||0,r=(t.dy||0)+HF(t),i=Xb(t),o=i.x1,s=i.y1,a=t.angle||0,u;e("text-anchor",Uoe[t.align]||"start"),a?(u=Tc(o,s)+" "+IF(a),(n||r)&&(u+=" "+Tc(n,r))):u=Tc(o+n,s+r),e("transform",u)}function qF(e,t,n){var r=ii.height(t),i=t.align,o=Xb(t),s=o.x1,a=o.y1,u=t.dx||0,l=(t.dy||0)+HF(t)-Math.round(.8*r),c=zg(t),f;if(M(c)?(r+=rl(t)*(c.length-1),f=c.reduce((d,p)=>Math.max(d,ii.width(t,p)),0)):f=ii.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=s,l+=a,u+f,l+r),t.angle&&!n)e.rotate(t.angle*nl,s,a);else if(n===2)return e.rotatedPoints(t.angle*nl,s,a);return e}function Hoe(e,t,n){Lo(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=Yb(r),e.textAlign=r.align||"left",o=Xb(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*nl),s=a=0),s+=r.dx||0,a+=(r.dy||0)+HF(r),c=zg(r),Dd(e,r),M(c))for(l=rl(r),u=0;u<c.length;++u)f=il(r,c[u]),r.fill&&Fb(e,r,i)&&e.fillText(f,s,a),r.stroke&&Md(e,r,i)&&e.strokeText(f,s,a),a+=l;else f=il(r,c),r.fill&&Fb(e,r,i)&&e.fillText(f,s,a),r.stroke&&Md(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})}function qoe(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=Xb(t),a=s.x1,u=s.y1,l=qF(_g,t,1),c=-t.angle*nl,f=Math.cos(c),d=Math.sin(c),p=f*i-d*o+(a-f*a+d*u),m=d*i+f*o+(u-d*a-f*u);return l.contains(p,m)}function Goe(e,t){let n=qF(_g,e,2);return Rd(t,n[0],n[1],n[2],n[3])||Rd(t,n[0],n[1],n[4],n[5])||Rd(t,n[4],n[5],n[6],n[7])||Rd(t,n[2],n[3],n[6],n[7])}var joe={type:"text",tag:"text",nested:!1,attr:zoe,bound:qF,draw:Hoe,pick:Gb(qoe),isect:Goe},Woe=$F("trail",Gie,ioe),Ir={arc:toe,area:ooe,group:xoe,image:woe,line:Soe,path:Coe,rect:Roe,rule:Ooe,shape:Ioe,symbol:Poe,text:joe,trail:Woe};function EF(e,t,n){var r=Ir[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new It),e,n)}var I6={mark:null};function d8(e,t,n){var r=Ir[e.marktype],i=r.bound,o=e.items,s=o&&o.length,a,u,l,c;if(r.nested)return s?l=o[0]:(I6.mark=e,l=I6),c=EF(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new It,s)for(a=0,u=o.length;a<u;++a)t.union(EF(o[a],i,n));return e.bounds=t}var Voe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function p8(e,t){return JSON.stringify(e,Voe,t)}function m8(e){let t=typeof e=="string"?JSON.parse(e):e;return h8(t)}function h8(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&h8(n[i]);return t&&d8(e),e}var Tg=class{constructor(t){arguments.length?this.root=m8(t):(this.root=P6({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Bg(this.root)])}toJSON(t){return p8(this.root,t||0)}mark(t,n,r){n=n||this.root.items[0];let i=P6(t,n);return n.items[r]=i,i.zindex&&(i.group.zdirty=!0),i}};function P6(e,t){let n={bounds:new It,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Zu(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function GF(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function pn(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=Zu(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function so(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function g8(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function qg(e,t){let n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Yoe(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=Ir[i.marktype]).tip){for(s=qg(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}var Dg=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||ud(),this._tooltip=n||Xoe}initialize(t,n,r){return this._el=t,this._obj=r||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,r){for(let i=t?t.length:0;--i>=0;)if(t[i].type===n&&(!r||t[i].handler===r))return i;return-1}handlers(t){let n=this._handlers,r=[];if(t)r.push(...n[this.eventName(t)]);else for(let i in n)r.push(...n[i]);return r}eventName(t){let n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,r){this._loader.sanitize(r,{context:"href"}).then(i=>{let o=new MouseEvent(t.type,t),s=Zu(null,"a");for(let a in i)s.setAttribute(a,i[a]);s.dispatchEvent(o)}).catch(()=>{})}handleTooltip(t,n,r){if(n&&n.tooltip!=null){n=Yoe(n,t,this.canvas(),this._origin);let i=r&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,i)}}getItemBoundingClientRect(t){let n=this.canvas();if(!n)return;let r=n.getBoundingClientRect(),i=this._origin,o=t.bounds,s=o.width(),a=o.height(),u=o.x1+i[0]+r.left,l=o.y1+i[1]+r.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,l+=t.y||0;return{x:u,y:l,width:s,height:a,left:u,top:l,right:u+s,bottom:l+a}}};function Xoe(e,t,n,r){e.element().setAttribute("title",r||"")}var Mc=class{constructor(t){this._el=null,this._bgcolor=null,this._loader=new kb(t)}initialize(t,n,r,i,o){return this._el=t,this.resize(n,r,i,o)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,r,i){return this._width=t,this._height=n,this._origin=r||[0,0],this._scale=i||1,this}dirty(){}render(t,n){let r=this;return r._call=function(){r._render(t,n)},r._call(),r._call=null,r}_render(){}renderAsync(t,n){let r=this.render(t,n);return this._ready?this._ready.then(()=>r):Promise.resolve(r)}_load(t,n){var r=this,i=r._loader[t](n);if(!r._ready){let o=r._call;r._ready=r._loader.ready().then(s=>{s&&o(),r._ready=null})}return i}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}},Koe="keydown",Qoe="keypress",Joe="keyup",y8="dragenter",Sb="dragleave",x8="dragover",vF="pointerdown",Zoe="pointerup",Db="pointermove",Ab="pointerout",b8="pointerover",wF="mousedown",ese="mouseup",E8="mousemove",Mb="mouseout",v8="mouseover",Nb="click",tse="dblclick",nse="wheel",w8="mousewheel",Ob="touchstart",Ib="touchmove",Pb="touchend",rse=[Koe,Qoe,Joe,y8,Sb,x8,vF,Zoe,Db,Ab,b8,wF,ese,E8,Mb,v8,Nb,tse,nse,w8,Ob,Ib,Pb],SF=Db,Cg=Mb,AF=Nb,ol=class extends Dg{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=rse,this.pointermove=B6([Db,E8],[b8,v8],[Ab,Mb]),this.dragover=B6([x8],[y8],[Sb]),this.pointerout=L6([Ab,Mb]),this.dragleave=L6([Sb])}initialize(t,n,r){return this._canvas=t&&GF(t,"canvas"),[Nb,wF,vF,Db,Ab,Sb].forEach(i=>$6(this,i)),super.initialize(t,n,r)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(w8,t)}pointerdown(t){this._down=this._active,this.fire(vF,t)}mousedown(t){this._down=this._active,this.fire(wF,t)}click(t){this._down===this._active&&(this.fire(Nb,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Ob,t,!0)}touchmove(t){this.fire(Ib,t,!0)}touchend(t){this.fire(Pb,t,!0),this._touch=null}fire(t,n,r){let i=r?this._touch:this._active,o=this._handlers[t];if(n.vegaType=t,t===AF&&i&&i.href?this.handleHref(n,i,i.href):(t===SF||t===Cg)&&this.handleTooltip(n,i,t!==Cg),o)for(let s=0,a=o.length;s<a;++s)o[s].handler.call(this._obj,n,i)}on(t,n){let r=this.eventName(t),i=this._handlers;return this._handlerIndex(i[r],t,n)<0&&($6(this,t),(i[r]||(i[r]=[])).push({type:t,handler:n})),this}off(t,n){let r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&i.splice(o,1),this}pickEvent(t){let n=qg(t,this._canvas),r=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-r[0],n[1]-r[1])}pick(t,n,r,i,o){let s=this.context();return Ir[t.marktype].pick.call(this,s,t,n,r,i,o)}},ise=e=>e===Ob||e===Ib||e===Pb?[Ob,Ib,Pb]:[e];function $6(e,t){ise(t).forEach(n=>ose(e,n))}function ose(e,t){let n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function Ag(e,t,n){t.forEach(r=>e.fire(r,n))}function B6(e,t,n){return function(r){let i=this._active,o=this.pickEvent(r);o===i?Ag(this,e,r):((!i||!i.exit)&&Ag(this,n,r),this._active=o,Ag(this,t,r),Ag(this,e,r))}}function L6(e){return function(t){Ag(this,e,t),this._active=null}}function sse(){return typeof window<"u"&&window.devicePixelRatio||1}function ase(e,t,n,r,i,o){let s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=s?sse():i;e.width=t*u,e.height=n*u;for(let l in o)a[l]=o[l];return s&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1]),e}var Nd=class extends Mc{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new It,this._tempb=new It}initialize(t,n,r,i,o,s){return this._options=s||{},this._canvas=this._options.externalContext?null:no(1,1,this._options.type),t&&this._canvas&&(so(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,r,i,o)}resize(t,n,r,i){if(super.resize(t,n,r,i),this._canvas)ase(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{let o=this._options.externalContext;o||U("CanvasRenderer is missing a valid canvas or context"),o.scale(this._scale,this._scale),o.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){let n=this._tempb.clear().union(t.bounds),r=t.mark.group;for(;r;)n.translate(r.x||0,r.y||0),r=r.mark.group;this._dirty.union(n)}_render(t,n){let r=this.context(),i=this._origin,o=this._width,s=this._height,a=this._dirty,u=use(i,o,s);r.save();let l=this._redraw||a.empty()?(this._redraw=!1,u.expand(1)):lse(r,u.intersect(a),i);return this.clear(-i[0],-i[1],o,s),this.draw(r,t,l,n),r.restore(),a.clear(),this}draw(t,n,r,i){if(n.marktype!=="group"&&i!=null&&!i.includes(n.marktype))return;let o=Ir[n.marktype];n.clip&&soe(t,n),o.draw.call(this,t,n,r,i),n.clip&&t.restore()}clear(t,n,r,i){let o=this._options,s=this.context();o.type!=="pdf"&&!o.externalContext&&s.clearRect(t,n,r,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,n,r,i))}},use=(e,t,n)=>new It().set(0,0,t,n).translate(-e[0],-e[1]);function lse(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}var $b=class extends Dg{constructor(t,n){super(t,n);let r=this;r._hrefHandler=mF(r,(i,o)=>{o&&o.href&&r.handleHref(i,o,o.href)}),r._tooltipHandler=mF(r,(i,o)=>{r.handleTooltip(i,o,i.type!==Cg)})}initialize(t,n,r){let i=this._svg;return i&&(i.removeEventListener(AF,this._hrefHandler),i.removeEventListener(SF,this._tooltipHandler),i.removeEventListener(Cg,this._tooltipHandler)),this._svg=i=t&&GF(t,"svg"),i&&(i.addEventListener(AF,this._hrefHandler),i.addEventListener(SF,this._tooltipHandler),i.addEventListener(Cg,this._tooltipHandler)),super.initialize(t,n,r)}canvas(){return this._svg}on(t,n){let r=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[r],t,n)<0){let s={type:t,handler:n,listener:mF(this,n)};(i[r]||(i[r]=[])).push(s),this._svg&&this._svg.addEventListener(r,s.listener)}return this}off(t,n){let r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&(this._svg&&this._svg.removeEventListener(r,i[o].listener),i.splice(o,1)),this}},mF=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)},S8="aria-hidden",jF="aria-label",WF="role",VF="aria-roledescription",A8="graphics-object",YF="graphics-symbol",_8=(e,t,n)=>({[WF]:e,[VF]:t,[jF]:n||void 0}),cse=Jt(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),U6={axis:{desc:"axis",caption:pse},legend:{desc:"legend",caption:mse},"title-text":{desc:"title",caption:e=>`Title text '${H6(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${H6(e)}'`}},z6={ariaRole:WF,ariaRoleDescription:VF,description:jF};function C8(e,t){let n=t.aria===!1;if(e(S8,n||void 0),n||t.description==null)for(let r in z6)e(z6[r],void 0);else{let r=t.mark.marktype;e(jF,t.description),e(WF,t.ariaRole||(r==="group"?A8:YF)),e(VF,t.ariaRoleDescription||`${r} mark`)}}function k8(e){return e.aria===!1?{[S8]:!0}:cse[e.role]?null:U6[e.role]?dse(e,U6[e.role]):fse(e)}function fse(e){let t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return _8(n?A8:YF,`${t} mark container`,e.description)}function dse(e,t){try{let n=e.items[0],r=t.caption||(()=>"");return _8(t.role||YF,t.desc,n.description||r(n))}catch{return null}}function H6(e){return Q(e.text).join(" ")}function pse(e){let t=e.datum,n=e.orient,r=t.title?F8(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Ku(a)?"discrete":a} scale with ${uF(s,o,e)}`}function mse(e){let t=e.datum,n=t.title?F8(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return gse(r)+(n?` titled '${n}'`:"")+` for ${hse(o)} with ${uF(u,a,e)}`}function F8(e){try{return Q(Te(e.items).items[0].text).join(" ")}catch{return null}}function hse(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Te(e)}function gse(e){return e.length?e[0].toUpperCase()+e.slice(1):e}var R8=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),yse=e=>R8(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function XF(){let e="",t="",n="",r=[],i=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},s=(u,l)=>(l!=null&&(t+=` ${u}="${yse(l)}"`),a),a={open(u){o(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(let d of c)for(let p in d)s(p,d[p]);return a},close(){let u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),a},attr:s,text:u=>(n+=R8(u),a),toString:()=>e};return a}var T8=e=>D8(XF(),e)+"";function D8(e,t){if(e.open(t.tagName),t.hasAttributes()){let n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){let n=t.childNodes;for(let r of n)r.nodeType===3?e.text(r.nodeValue):D8(e,r)}return e.close()}var Bb={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Lb={blend:"mix-blend-mode"},M8={fill:"none","stroke-miterlimit":10},Sg=0,q6="http://www.w3.org/2000/xmlns/",dn=Rg.xmlns,Mg=class extends Mc{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,r,i,o){return this._defs={},this._clearDefs(),t&&(this._svg=pn(t,0,"svg",dn),this._svg.setAttributeNS(q6,"xmlns",dn),this._svg.setAttributeNS(q6,"xmlns:xlink",Rg["xmlns:xlink"]),this._svg.setAttribute("version",Rg.version),this._svg.setAttribute("class","marks"),so(t,1),this._root=pn(this._svg,Sg,"g",dn),el(this._root,M8),so(this._svg,Sg+1)),this.background(this._bgcolor),super.initialize(t,n,r,i,o)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svg&&(el(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){let t=this._svg,n=this._bgcolor;if(!t)return null;let r;n&&(t.removeAttribute("style"),r=pn(t,Sg,"rect",dn),el(r,{width:this._width,height:this._height,fill:n}));let i=T8(t);return n&&(t.removeChild(r),this._svg.style.setProperty("background-color",n)),i}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),so(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;let t=this._dirty;if(!t.length||!this._dirtyID)return!0;let n=++this._dirtyID,r,i,o,s,a,u,l;for(a=0,u=t.length;a<u;++a)if(r=t[a],i=r.mark,i.marktype!==o&&(o=i.marktype,s=Ir[o]),i.zdirty&&i.dirty!==n&&(this._dirtyAll=!1,G6(r,n),i.items.forEach(c=>{c.dirty=n})),!i.zdirty){if(r.exit){s.nested&&i.items.length?(l=i.items[0],l._svg&&this._update(s,l._svg,l)):r._svg&&(l=r._svg.parentNode,l&&l.removeChild(r._svg)),r._svg=null;continue}r=s.nested?i.items[0]:r,r._update!==n&&(!r._svg||!r._svg.ownerSVGElement?(this._dirtyAll=!1,G6(r,n)):this._update(s,r._svg,r),r._update=n)}return!this._dirtyAll}mark(t,n,r,i){if(!this.isDirty(n))return n._svg;let o=this._svg,s=n.marktype,a=Ir[s],u=n.interactive===!1?"none":null,l=a.tag==="g",c=j6(n,t,r,"g",o);if(s!=="group"&&i!=null&&!i.includes(s))return so(c,0),n._svg;c.setAttribute("class",g8(n));let f=k8(n);for(let h in f)Or(c,h,f[h]);l||Or(c,"pointer-events",u),Or(c,"clip-path",n.clip?RF(this,n,n.group):null);let d=null,p=0,m=h=>{let g=this.isDirty(h),y=j6(h,c,d,a.tag,o);g&&(this._update(a,y,h),l&&Ese(this,y,h,i)),d=y,++p};return a.nested?n.items.length&&m(n.items[0]):Lo(n,m),so(c,p),c}_update(t,n,r){Ua=n,sr=n.__values__,C8(kg,r),t.attr(kg,r,this);let i=wse[t.type];i&&i.call(this,t,n,r),Ua&&this.style(Ua,r)}style(t,n){if(n!=null){for(let r in Bb){let i=r==="font"?Hg(n):n[r];if(i===sr[r])continue;let o=Bb[r];i==null?t.removeAttribute(o):(_F(i)&&(i=V6(i,this._defs.gradient,N8())),t.setAttribute(o,i+"")),sr[r]=i}for(let r in Lb)_b(t,Lb[r],n[r])}}defs(){let t=this._svg,n=this._defs,r=n.el,i=0;for(let o in n.gradient)r||(n.el=r=pn(t,Sg+1,"defs",dn)),i=xse(r,n.gradient[o],i);for(let o in n.clipping)r||(n.el=r=pn(t,Sg+1,"defs",dn)),i=bse(r,n.clipping[o],i);r&&(i===0?(t.removeChild(r),n.el=null):so(r,i))}_clearDefs(){let t=this._defs;t.gradient={},t.clipping={}}};function G6(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function xse(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=pn(e,n++,"pattern",dn);el(s,{id:Cb+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=pn(s,0,"rect",dn),el(s,{width:1,height:1,fill:`url(${N8()}#${t.id})`}),e=pn(e,n++,"radialGradient",dn),el(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=pn(e,n++,"linearGradient",dn),el(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=pn(e,r,"stop",dn),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return so(e,r),n}function bse(e,t,n){let r;return e=pn(e,n,"clipPath",dn),e.setAttribute("id",t.id),t.path?(r=pn(e,0,"path",dn),r.setAttribute("d",t.path)):(r=pn(e,0,"rect",dn),el(r,{x:0,y:0,width:t.width,height:t.height})),so(e,1),n+1}function Ese(e,t,n,r){t=t.lastChild.previousSibling;let i,o=0;Lo(n,s=>{i=e.mark(t,s,i,r),++o}),so(t,1+o)}function j6(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=Zu(s,r,dn),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){let a=Zu(s,"path",dn);o.appendChild(a),a.__data__=e;let u=Zu(s,"g",dn);o.appendChild(u),u.__data__=e;let l=Zu(s,"path",dn);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||vse(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function vse(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}var Ua=null,sr=null,wse={group(e,t,n){let r=Ua=t.childNodes[2];sr=r.__values__,e.foreground(kg,n,this),sr=t.__values__,Ua=t.childNodes[1],e.content(kg,n,this);let i=Ua=t.childNodes[0];e.background(kg,n,this);let o=n.mark.interactive===!1?"none":null;if(o!==sr.events&&(Or(r,"pointer-events",o),Or(i,"pointer-events",o),sr.events=o),n.strokeForeground&&n.stroke){let s=n.fill;Or(r,"display",null),this.style(i,n),Or(i,"stroke",null),s&&(n.fill=null),sr=r.__values__,this.style(r,n),s&&(n.fill=s),Ua=null}else Or(r,"display","none")},image(e,t,n){n.smooth===!1?(_b(t,"image-rendering","optimizeSpeed"),_b(t,"image-rendering","pixelated")):_b(t,"image-rendering",null)},text(e,t,n){let r=zg(n),i,o,s,a;M(r)?(o=r.map(u=>il(n,u)),i=o.join(`
`),i!==sr.text&&(so(t,0),s=t.ownerDocument,a=rl(n),o.forEach((u,l)=>{let c=Zu(s,"tspan",dn);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),sr.text=i)):(o=il(n,r),o!==sr.text&&(t.textContent=o,sr.text=o)),Or(t,"font-family",Hg(n)),Or(t,"font-size",Ws(n)+"px"),Or(t,"font-style",n.fontStyle),Or(t,"font-variant",n.fontVariant),Or(t,"font-weight",n.fontWeight)}};function kg(e,t,n){t!==sr[e]&&(n?Sse(Ua,e,t,n):Or(Ua,e,t),sr[e]=t)}function _b(e,t,n){n!==sr[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),sr[t]=n)}function el(e,t){for(let n in t)Or(e,n,t[n])}function Or(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Sse(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function N8(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}var Ub=class extends Mc{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){let n=XF();n.open("svg",ve({},Rg,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));let r=this._bgcolor;return r&&r!=="transparent"&&r!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:r}).close(),n.open("g",M8,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){let r=Ir[n.marktype],i=r.tag,o=[C8,r.attr];t.open("g",{class:g8(n),"clip-path":n.clip?RF(this,n,n.group):null},k8(n),{"pointer-events":i!=="g"&&n.interactive===!1?"none":null});let s=a=>{let u=this.href(a);if(u&&t.open("a",u),t.open(i,this.attr(n,a,o,i!=="g"?i:null)),i==="text"){let l=zg(a);if(M(l)){let c={x:0,dy:rl(a)};for(let f=0;f<l.length;++f)t.open("tspan",f?c:null).text(il(a,l[f])).close()}else t.text(il(a,l))}else if(i==="g"){let l=a.strokeForeground,c=a.fill,f=a.stroke;l&&f&&(a.stroke=null),t.open("path",this.attr(n,a,r.background,"bgrect")).close(),t.open("g",this.attr(n,a,r.content)),Lo(a,d=>this.mark(t,d)),t.close(),l&&f?(c&&(a.fill=null),a.stroke=f,t.open("path",this.attr(n,a,r.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,r.foreground,"bgfore")).close()}t.close(),u&&t.close()};return r.nested?n.items&&n.items.length&&s(n.items[0]):Lo(n,s),t.close()}href(t){let n=t.href,r;if(n){if(r=this._hrefs&&this._hrefs[n])return r;this.sanitizeURL(n).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[n]=i})}return null}attr(t,n,r,i){let o={},s=(a,u,l,c)=>{o[c||a]=u};return Array.isArray(r)?r.forEach(a=>a(s,n,this)):r(s,n,this),i&&Ase(o,n,t,i,this._defs),o}defs(t){let n=this._defs.gradient,r=this._defs.clipping;if(Object.keys(n).length+Object.keys(r).length!==0){t.open("defs");for(let o in n){let s=n[o],a=s.stops;s.gradient==="radial"?(t.open("pattern",{id:Cb+o,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+o+")"}).close(),t.close(),t.open("radialGradient",{id:o,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):t.open("linearGradient",{id:o,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let u=0;u<a.length;++u)t.open("stop",{offset:a[u].offset,"stop-color":a[u].color}).close();t.close()}for(let o in r){let s=r[o];t.open("clipPath",{id:o}),s.path?t.open("path",{d:s.path}).close():t.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),t.close()}t.close()}}};function Ase(e,t,n,r,i){let o;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=Hg(t),e["font-size"]=Ws(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(let s in Bb){let a=t[s],u=Bb[s];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(_F(a)&&(a=V6(a,i.gradient,"")),e[u]=a)}for(let s in Lb){let a=t[s];a!=null&&(o=o||[],o.push(`${Lb[s]}: ${a};`))}return o&&(e.style=o.join(" ")),e}var Bo={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function _se(e){Bo.svgMarkTypes=e.svgMarkTypes??["text"],Bo.svgOnTop=e.svgOnTop??!0,Bo.debug=e.debug??!1}var Ng=class extends Mc{constructor(t){super(t),this._svgRenderer=new Mg(t),this._canvasRenderer=new Nd(t)}initialize(t,n,r,i,o){this._root_el=pn(t,0,"div");let s=pn(this._root_el,0,"div"),a=pn(this._root_el,1,"div");return this._root_el.style.position="relative",Bo.debug||(s.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=Bo.svgOnTop?a:s,this._canvasEl=Bo.svgOnTop?s:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,r,i,o),this._svgRenderer.initialize(this._svgEl,n,r,i,o),super.initialize(t,n,r,i,o)}dirty(t){return Bo.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){let i=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(o=>!Bo.svgMarkTypes.includes(o));this._svgRenderer.render(t,Bo.svgMarkTypes),this._canvasRenderer.render(t,i)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svgRenderer.resize(t,n,r,i),this._canvasRenderer.resize(t,n,r,i),this}background(t){return Bo.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}},zb=class extends ol{constructor(t,n){super(t,n)}initialize(t,n,r){let i=pn(pn(t,0,"div"),Bo.svgOnTop?0:1,"div");return super.initialize(i,n,r)}},O8="canvas",I8="hybrid",P8="png",$8="svg",B8="none",za={Canvas:O8,PNG:P8,SVG:$8,Hybrid:I8,None:B8},Nc={};Nc[O8]=Nc[P8]={renderer:Nd,headless:Nd,handler:ol};Nc[$8]={renderer:Mg,headless:Ub,handler:$b};Nc[I8]={renderer:Ng,headless:Ng,handler:zb};Nc[B8]={};function Gg(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Nc[e]=t,this):Nc[e]}function KF(e,t,n){let r=[],i=new It().union(t),o=e.marktype;return o?L8(e,i,n,r):o==="group"?U8(e,i,n,r):U("Intersect scene must be mark node or group item.")}function L8(e,t,n,r){if(Cse(e,t,n)){let i=e.items,o=e.marktype,s=i.length,a=0;if(o==="group")for(;a<s;++a)U8(i[a],t,n,r);else for(let u=Ir[o].isect;a<s;++a){let l=i[a];z8(l,t,u)&&r.push(l)}}return r}function Cse(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function U8(e,t,n,r){n&&n(e.mark)&&z8(e,t,Ir.group.isect)&&r.push(e);let i=e.items,o=i&&i.length;if(o){let s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let u=0;u<o;++u)L8(i[u],t,n,r);t.translate(s,a)}return r}function z8(e,t,n){let r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}var hF=new It;function QF(e){let t=e.clip;if(Ee(t))t(Lg(hF.clear()));else if(t)hF.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(hF)}var kse=1e-9;function JF(e,t,n){return e===t?!0:n==="path"?H8(e,t):e instanceof Date&&t instanceof Date?+e==+t:ke(e)&&ke(t)?Math.abs(e-t)<=kse:!e||!t||!X(e)&&!X(t)?e==t:Fse(e,t)}function H8(e,t){return JF(Dc(e),Dc(t))}function Fse(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!JF(e[i],t[i],i))return!1;return typeof e==typeof t}function Rse(){Z6(),Zre()}var $d="top",Uo="left",zo="right",ul="bottom",Tse="top-left",Dse="top-right",Mse="bottom-left",Nse="bottom-right",tR="start",ZF="middle",Pr="end",Ose="x",Ise="y",eE="group",nR="axis",rR="title",Pse="frame",$se="scope",iR="legend",J8="row-header",Z8="row-footer",e5="row-title",t5="column-header",n5="column-footer",r5="column-title",Bse="padding",Lse="symbol",i5="fit",o5="fit-x",s5="fit-y",Use="pad",oR="none",Kb="all",eR="each",sR="flush",sl="column",al="row";function a5(e){B.call(this,null,e)}Z(a5,B,{transform(e,t){let n=t.dataflow,r=e.mark,i=r.marktype,o=Ir[i],s=o.bound,a=r.bounds,u;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=Qb(r,s),r.items.forEach(l=>{l.bounds.clear().union(a)});else if(i===eE||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),r.items.forEach(l=>a.union(Qb(l,s))),r.role){case nR:case iR:case rR:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(Qb(l,s))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(Qb(l,s))}),u&&(a.clear(),r.items.forEach(l=>a.union(l.bounds)));return QF(r),t.modifies("bounds")}});function Qb(e,t,n){return t(e.bounds.clear(),e,n)}var q8=":vega_identifier:";function aR(e){B.call(this,0,e)}aR.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};Z(aR,B,{transform(e,t){let n=zse(t.dataflow),r=e.as,i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function zse(e){return e._signals[q8]||(e._signals[q8]=e.add(0))}function u5(e){B.call(this,null,e)}Z(u5,B,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Hse(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);let r=n.marktype===eE?Bg:$g;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Hse(e){let t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function l5(e){B.call(this,null,e)}var G8={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!c5(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},c5=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),j8=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(c5(i,o=e[n].bounds,t))return!0},qse=e=>{let t=e.bounds;return t.width()>1&&t.height()>1},Gse=(e,t,n)=>{var r=e.range(),i=new It;return t===$d||t===ul?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},W8=e=>(e.forEach(t=>t.opacity=1),e),V8=(e,t)=>e.reflow(t.modified()).modifies("opacity");Z(l5,B,{transform(e,t){let n=G8[e.method]||G8.parity,r=e.separation||0,i=t.materialize(t.SOURCE).source,o,s;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(W8(i),t=V8(t,e)),t;if(i=i.filter(qse),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=W8(i),t=V8(t,e),o.length>=3&&j8(o,r)){do o=n(o,r);while(o.length>=3&&j8(o,r));o.length<3&&!Te(i).opacity&&(o.length>1&&(Te(o).opacity=0),Te(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=Gse(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{s(u)||(u.opacity=0)}));let a=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function f5(e){B.call(this,null,e)}Z(f5,B,{transform(e,t){let n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){let r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});var ar=new It;function Pd(e,t,n){return e[t]===n?0:(e[t]=n,1)}function jse(e){var t=e.items[0].orient;return t===Uo||t===zo}function Wse(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Vse(e,t,n,r){var i=t.items[0],o=i.datum,s=i.translate!=null?i.translate:.5,a=i.orient,u=Wse(o),l=i.range,c=i.offset,f=i.position,d=i.minExtent,p=i.maxExtent,m=o.title&&i.items[u[2]].items[0],h=i.titlePadding,g=i.bounds,y=m&&Vb(m),x=0,b=0,E,v;switch(ar.clear().union(g),g.clear(),(E=u[0])>-1&&g.union(i.items[E].bounds),(E=u[1])>-1&&g.union(i.items[E].bounds),a){case $d:x=f||0,b=-c,v=Math.max(d,Math.min(p,-g.y1)),g.add(0,-v).add(l,0),m&&Jb(e,m,v,h,y,0,-1,g);break;case Uo:x=-c,b=f||0,v=Math.max(d,Math.min(p,-g.x1)),g.add(-v,0).add(0,l),m&&Jb(e,m,v,h,y,1,-1,g);break;case zo:x=n+c,b=f||0,v=Math.max(d,Math.min(p,g.x2)),g.add(0,0).add(v,l),m&&Jb(e,m,v,h,y,1,1,g);break;case ul:x=f||0,b=r+c,v=Math.max(d,Math.min(p,g.y2)),g.add(0,0).add(l,v),m&&Jb(e,m,v,h,0,0,1,g);break;default:x=i.x,b=i.y}return js(g.translate(x,b),i),Pd(i,"x",x+s)|Pd(i,"y",b+s)&&(i.bounds=ar,e.dirty(i),i.bounds=g,e.dirty(i)),i.mark.bounds.clear().union(g)}function Jb(e,t,n,r,i,o,s,a){let u=t.bounds;if(t.auto){let l=s*(n+i+r),c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}var Y8=(e,t)=>Math.floor(Math.min(e,t)),X8=(e,t)=>Math.ceil(Math.max(e,t));function Yse(e){var t=e.items,n=t.length,r=0,i,o;let s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===eE)switch(i.role){case nR:case iR:case rR:break;case J8:s.rowheaders.push(...o);break;case Z8:s.rowfooters.push(...o);break;case t5:s.colheaders.push(...o);break;case n5:s.colfooters.push(...o);break;case e5:s.rowtitle=o[0];break;case r5:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function Xse(e){return new It().set(0,0,e.width||0,e.height||0)}function Kse(e){let t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Ct(e,t,n){let r=X(e)?e[t]:e;return r??(n!==void 0?n:0)}function K8(e){return e<0?Math.ceil(-e):0}function d5(e,t,n){var r=!n.nodirty,i=n.bounds===sR?Xse:Kse,o=ar.set(0,0,0,0),s=Ct(n.align,sl),a=Ct(n.align,al),u=Ct(n.padding,sl),l=Ct(n.padding,al),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,p=Array(d),m=Array(c),h=0,g=Array(d),y=Array(f),x=0,b=Array(d),E=Array(d),v=Array(d),S,w,_,A,F,R,D,O,T,k,C;for(w=0;w<c;++w)m[w]=0;for(w=0;w<f;++w)y[w]=0;for(w=0;w<d;++w)R=t[w],F=v[w]=i(R),R.x=R.x||0,b[w]=0,R.y=R.y||0,E[w]=0,_=w%c,A=~~(w/c),h=Math.max(h,D=Math.ceil(F.x2)),x=Math.max(x,O=Math.ceil(F.y2)),m[_]=Math.max(m[_],D),y[A]=Math.max(y[A],O),p[w]=u+K8(F.x1),g[w]=l+K8(F.y1),r&&e.dirty(t[w]);for(w=0;w<d;++w)w%c===0&&(p[w]=0),w<c&&(g[w]=0);if(s===eR)for(_=1;_<c;++_){for(C=0,w=_;w<d;w+=c)C<p[w]&&(C=p[w]);for(w=_;w<d;w+=c)p[w]=C+m[_-1]}else if(s===Kb){for(C=0,w=0;w<d;++w)w%c&&C<p[w]&&(C=p[w]);for(w=0;w<d;++w)w%c&&(p[w]=C+h)}else for(s=!1,_=1;_<c;++_)for(w=_;w<d;w+=c)p[w]+=m[_-1];if(a===eR)for(A=1;A<f;++A){for(C=0,w=A*c,S=w+c;w<S;++w)C<g[w]&&(C=g[w]);for(w=A*c;w<S;++w)g[w]=C+y[A-1]}else if(a===Kb){for(C=0,w=c;w<d;++w)C<g[w]&&(C=g[w]);for(w=c;w<d;++w)g[w]=C+x}else for(a=!1,A=1;A<f;++A)for(w=A*c,S=w+c;w<S;++w)g[w]+=y[A-1];for(T=0,w=0;w<d;++w)T=p[w]+(w%c?T:0),b[w]+=T-t[w].x;for(_=0;_<c;++_)for(k=0,w=_;w<d;w+=c)k+=g[w],E[w]+=k-t[w].y;if(s&&Ct(n.center,sl)&&f>1)for(w=0;w<d;++w)F=s===Kb?h:m[w%c],T=F-v[w].x2-t[w].x-b[w],T>0&&(b[w]+=T/2);if(a&&Ct(n.center,al)&&c!==1)for(w=0;w<d;++w)F=a===Kb?x:y[~~(w/c)],k=F-v[w].y2-t[w].y-E[w],k>0&&(E[w]+=k/2);for(w=0;w<d;++w)o.union(v[w].translate(b[w],E[w]));switch(T=Ct(n.anchor,Ose),k=Ct(n.anchor,Ise),Ct(n.anchor,sl)){case Pr:T-=o.width();break;case ZF:T-=o.width()/2}switch(Ct(n.anchor,al)){case Pr:k-=o.height();break;case ZF:k-=o.height()/2}for(T=Math.round(T),k=Math.round(k),o.clear(),w=0;w<d;++w)t[w].mark.bounds.clear();for(w=0;w<d;++w)R=t[w],R.x+=b[w]+=T,R.y+=E[w]+=k,o.union(R.mark.bounds.union(R.bounds.translate(b[w],E[w]))),r&&e.dirty(R);return o}function Qse(e,t,n){var r=Yse(t),i=r.marks,o=n.bounds===sR?Jse:Zse,s=n.offset,a=n.columns||i.length,u=a<=0?1:Math.ceil(i.length/a),l=u*a,c,f,d,p,m,h,g;let y=d5(e,i,n);y.empty()&&y.set(0,0,0,0),r.rowheaders&&(h=Ct(n.headerBand,al,null),c=Zb(e,r.rowheaders,i,a,u,-Ct(s,"rowHeader"),Y8,0,o,"x1",0,a,1,h)),r.colheaders&&(h=Ct(n.headerBand,sl,null),f=Zb(e,r.colheaders,i,a,a,-Ct(s,"columnHeader"),Y8,1,o,"y1",0,1,a,h)),r.rowfooters&&(h=Ct(n.footerBand,al,null),d=Zb(e,r.rowfooters,i,a,u,Ct(s,"rowFooter"),X8,0,o,"x2",a-1,a,1,h)),r.colfooters&&(h=Ct(n.footerBand,sl,null),p=Zb(e,r.colfooters,i,a,a,Ct(s,"columnFooter"),X8,1,o,"y2",l-a,1,a,h)),r.rowtitle&&(m=Ct(n.titleAnchor,al),g=Ct(s,"rowTitle"),g=m===Pr?d+g:c-g,h=Ct(n.titleBand,al,.5),Q8(e,r.rowtitle,g,0,y,h)),r.coltitle&&(m=Ct(n.titleAnchor,sl),g=Ct(s,"columnTitle"),g=m===Pr?p+g:f-g,h=Ct(n.titleBand,sl,.5),Q8(e,r.coltitle,g,1,y,h))}function Jse(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Zse(e,t){return e.bounds[t]}function Zb(e,t,n,r,i,o,s,a,u,l,c,f,d,p){var m=n.length,h=0,g=0,y,x,b,E,v,S,w,_,A;if(!m)return h;for(y=c;y<m;y+=f)n[y]&&(h=s(h,u(n[y],l)));if(!t.length)return h;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),h+=o,x=0,E=t.length;x<E;++x)e.dirty(t[x]),t[x].mark.bounds.clear();for(y=c,x=0,E=t.length;x<E;++x,y+=f){for(S=t[x],v=S.mark.bounds,b=y;b>=0&&(w=n[b])==null;b-=d);a?(_=p==null?w.x:Math.round(w.bounds.x1+p*w.bounds.width()),A=h):(_=h,A=p==null?w.y:Math.round(w.bounds.y1+p*w.bounds.height())),v.union(S.bounds.translate(_-(S.x||0),A-(S.y||0))),S.x=_,S.y=A,e.dirty(S),g=s(g,v[l])}return g}function Q8(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function eae(e,t){let n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function tae(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function nae(e,t,n,r,i,o,s){let a=eae(n,t),u=tae(e,a("offset",0)),l=a("anchor",tR),c=l===Pr?1:l===ZF?.5:0,f={align:eR,bounds:a("bounds",sR),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Uo:f.anchor={x:Math.floor(r.x1)-u,column:Pr,y:c*(s||r.height()+2*r.y1),row:l};break;case zo:f.anchor={x:Math.ceil(r.x2)+u,y:c*(s||r.height()+2*r.y1),row:l};break;case $d:f.anchor={y:Math.floor(i.y1)-u,row:Pr,x:c*(o||i.width()+2*i.x1),column:l};break;case ul:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case Tse:f.anchor={x:u,y:u};break;case Dse:f.anchor={x:o-u,y:u,column:Pr};break;case Mse:f.anchor={x:u,y:s-u,row:Pr};break;case Nse:f.anchor={x:o-u,y:s-u,column:Pr,row:Pr};break}return f}function rae(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),oae(e,n,n.items[0].items[0]),o=iae(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),r.type===Lse&&sae(n.items[0].items[0].items[0].items),i!==oR&&(n.x=s=0,n.y=a=0),n.width=u,n.height=l,js(o.set(s,a,s+u,a+l),n),n.mark.bounds.clear().union(o),n}function iae(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function oae(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&jg(e,n,i,o);else{var s=t.items[1].items[0],a=s.anchor,u=t.titlePadding||0,l=r-s.x,c=r-s.y;switch(s.orient){case Uo:i+=Math.ceil(s.bounds.width())+u;break;case zo:case ul:break;default:o+=s.bounds.height()+u}switch((i||o)&&jg(e,n,i,o),s.orient){case Uo:c+=Id(t,n,s,a,1,1);break;case zo:l+=Id(t,n,s,Pr,0,0)+u,c+=Id(t,n,s,a,1,1);break;case ul:l+=Id(t,n,s,a,0,0),c+=Id(t,n,s,Pr,-1,0,1)+u;break;default:l+=Id(t,n,s,a,0,0)}(l||c)&&jg(e,s,l,c),(l=Math.round(s.bounds.x1-r))<0&&(jg(e,n,-l,0),jg(e,s,-l,0))}}function Id(e,t,n,r,i,o,s){let a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(o||!u)&&!s?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,p=i<=0?0:Vb(n);return Math.round(r===tR?f:r===Pr?d-p:.5*(c-p))}function jg(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function sae(e){let t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function aae(e,t,n,r,i){var o=t.items[0],s=o.frame,a=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],p=a===Uo||a===zo?r:n,m=0,h=0,g=0,y=0,x=0,b;if(s!==eE?a===Uo?(m=i.y2,p=i.y1):a===zo?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):a===Uo&&(m=r,p=0),b=u===tR?m:u===Pr?p:(m+p)/2,d&&d.text){switch(a){case $d:case ul:x=f.bounds.height()+c;break;case Uo:y=f.bounds.width()+c;break;case zo:y=-f.bounds.width()-c;break}ar.clear().union(d.bounds),ar.translate(y-(d.x||0),x-(d.y||0)),Pd(d,"x",y)|Pd(d,"y",x)&&(e.dirty(d),d.bounds.clear().union(ar),d.mark.bounds.clear().union(ar),e.dirty(d)),ar.clear().union(d.bounds)}else ar.clear();switch(ar.union(f.bounds),a){case $d:h=b,g=i.y1-ar.height()-l;break;case Uo:h=i.x1-ar.width()-l,g=b;break;case zo:h=i.x2+ar.width()+l,g=b;break;case ul:h=b,g=i.y2+l;break;default:h=o.x,g=o.y}return Pd(o,"x",h)|Pd(o,"y",g)&&(ar.translate(h,g),e.dirty(o),o.bounds.clear().union(ar),t.bounds.clear().union(ar),e.dirty(o)),o.bounds}function p5(e){B.call(this,null,e)}Z(p5,B,{transform(e,t){let n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Qse(n,r,e.layout),lae(n,r,e)}),uae(e.mark.group)?t.reflow():t}});function uae(e){return e&&e.mark.role!=="legend-entry"}function lae(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new It().set(0,0,i,o),a=s.clone(),u=s.clone(),l=[],c,f,d,p,m,h;for(m=0,h=r.length;m<h;++m)switch(f=r[m],f.role){case nR:p=jse(f)?a:u,p.union(Vse(e,f,i,o));break;case rR:c=f;break;case iR:l.push(rae(e,f));break;case Pse:case $se:case J8:case Z8:case e5:case t5:case n5:case r5:a.union(f.bounds),u.union(f.bounds);break;default:s.union(f.bounds)}if(l.length){let g={};l.forEach(y=>{d=y.orient||zo,d!==oR&&(g[d]||(g[d]=[])).push(y)});for(let y in g){let x=g[y];d5(e,x,nae(x,y,n.legends,a,u,i,o))}l.forEach(y=>{let x=y.bounds;if(x.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=x,e.dirty(y)),n.autosize&&(n.autosize.type===i5||n.autosize.type===o5||n.autosize.type===s5))switch(y.orient){case Uo:case zo:s.add(x.x1,0).add(x.x2,0);break;case $d:case ul:s.add(0,x.y1).add(0,x.y2)}else s.union(x)})}s.union(a).union(u),c&&s.union(aae(e,c,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),cae(e,t,s,n)}function cae(e,t,n,r){let i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1)),d=Math.max(0,Math.ceil(n.x2-u)),p=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Bse){let m=e.padding();s-=m.left+m.right,a-=m.top+m.bottom}o===oR?(l=0,f=0,u=s,c=a):o===i5?(u=Math.max(0,s-l-d),c=Math.max(0,a-f-p)):o===o5?(u=Math.max(0,s-l-d),a=c+f+p):o===s5?(s=u+l+d,c=Math.max(0,a-f-p)):o===Use&&(s=u+l+d,a=c+f+p),e._resizeView(s,a,u,c,[l,f],i.resize)}var pR={};er(pR,{axisticks:()=>y5,datajoin:()=>x5,encode:()=>b5,legendentries:()=>E5,linkpath:()=>cR,pie:()=>fR,scale:()=>_5,sortitems:()=>k5,stack:()=>dR});function y5(e){B.call(this,null,e)}Z(y5,B,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=hb(o,s,e.minstep),u=e.format||oF(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?iF(o,e.values,a):gb(o,a);return i&&(r.rem=i),i=l.map((c,f)=>Le({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(Le({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function x5(e){B.call(this,null,e)}function fae(){return Le({})}function dae(e){let t=ku().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}Z(x5,B,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||fae,o=e.key||he,s=this.value;return M(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&U("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=dae(o)),t.visit(t.ADD,a=>{let u=o(a),l=s.get(u);l?l.exit?(s.empty--,r.add.push(l)):r.mod.push(l):(l=i(a),s.set(u,l),r.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{let u=o(a),l=s.get(u);l&&(l.datum=a,r.mod.push(l))}),t.visit(t.REM,a=>{let u=o(a),l=s.get(u);a===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}});function b5(e){B.call(this,null,e)}Z(b5,B,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(M(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=i.update||va,u=i.enter||va,l=i.exit||va,c=(o&&!s?i[o]:a)||va;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==va&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==va&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),s||c!==va){let f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{let p=u(d,e)||r;(c(d,e)||p)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function E5(e){B.call(this,[],e)}Z(E5,B,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||vg,s=e.scale,a=+e.limit,u=hb(s,e.count==null?5:e.count,e.minstep),l=!!e.values||o===vg,c=e.format||aF(n,s,u,o,e.formatSpecifier,e.formatType,l),f=e.values||sF(s,u),d,p,m,h,g;return i&&(r.rem=i),o===vg?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),g=!0):i=f,Ee(m=e.size)?(!e.values&&s(i[0])===0&&(i=i.slice(1)),h=i.reduce((y,x)=>Math.max(y,m(x,e)),0)):m=St(h=m||8),i=i.map((y,x)=>Le({index:x,label:c(y,x,i),value:y,offset:h,size:m(y,e)})),g&&(g=f[i.length],i.push(Le({index:i.length,label:`\u2026${f.length-i.length} entries`,value:g,offset:h,size:m(g,e)})))):o===x6?(d=s.domain(),p=mb(s,d[0],Te(d)),f.length<3&&!e.values&&d[0]!==Te(d)&&(f=[d[0],Te(d)]),i=f.map((y,x)=>Le({index:x,label:c(y,x,f),value:y,perc:p(y)}))):(m=f.length-1,p=v6(s),i=f.map((y,x)=>Le({index:x,label:c(y,x,f),value:y,perc:x?p(y):0,perc2:x===m?1:p(f[x+1])}))),r.source=i,r.add=i,this.value=i,r}});var pae=e=>e.source.x,mae=e=>e.source.y,hae=e=>e.target.x,gae=e=>e.target.y;function cR(e){B.call(this,{},e)}cR.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};Z(cR,B,{transform(e,t){var n=e.sourceX||pae,r=e.sourceY||mae,i=e.targetX||hae,o=e.targetY||gae,s=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=m5.get(u+"-"+a)||m5.get(u);return l||U("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=l(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(s)}});var v5=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,yae=(e,t,n,r)=>v5(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),w5=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.hypot(i,o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},xae=(e,t,n,r)=>w5(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),S5=(e,t,n,r)=>{let i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},bae=(e,t,n,r)=>S5(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Eae=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,vae=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,wae=(e,t,n,r)=>{let i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},Sae=(e,t,n,r)=>{let i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Aae=(e,t,n,r)=>{let i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},_ae=(e,t,n,r)=>{let i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a},m5=ku({line:v5,"line-radial":yae,arc:w5,"arc-radial":xae,curve:S5,"curve-radial":bae,"orthogonal-horizontal":Eae,"orthogonal-vertical":vae,"orthogonal-radial":wae,"diagonal-horizontal":Sae,"diagonal-vertical":Aae,"diagonal-radial":_ae});function fR(e){B.call(this,null,e)}fR.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};Z(fR,B,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||Rs,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=s,d=(a-s)/Zf(l),p=jt(c),m,h,g;for(e.sort&&p.sort((y,x)=>l[y]-l[x]),m=0;m<c;++m)g=l[p[m]],h=u[p[m]],h[r]=f,h[i]=f+=g*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});var Cae=5;function kae(e){let t=e.type;return!e.bins&&(t===Sc||t===_d||t===Cd)}function A5(e){return xg(e)&&e!==Po}var Fae=Jt(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function _5(e){B.call(this,null,e),this.modified(!0)}Z(_5,B,{transform(e,t){var n=t.dataflow,r=this.value,i=Rae(e);(!r||i!==r.type)&&(this.value=r=Ue(i)());for(i in e)if(!Fae[i]){if(i==="padding"&&A5(r.type))continue;Ee(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return Iae(r,e,Oae(r,e,Dae(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Rae(e){var t=e.type,n="",r;return t===Po?Po+"-"+Sc:(Tae(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?Po+"-":r===3?Ac+"-":""),(n+t||Sc).toLowerCase())}function Tae(e){let t=e.type;return xg(t)&&t!==Yu&&t!==Xu&&(e.scheme||e.range&&e.range.length&&e.range.every(V))}function Dae(e,t,n){let r=Mae(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,s=t.zero||t.zero===void 0&&kae(e),a,u;if(!i)return 0;if((s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;let l=u>i[a]?a+1:u<i[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return A5(o)&&t.padding&&i[0]!==Te(i)&&(i=Nae(o,i,t.range,t.padding,t.exponent,t.constant)),e.domain(C5(o,i,n)),o===ub&&e.unknown(t.domainImplicit?hd:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&hb(e,t.nice)||null),i.length}function Mae(e,t,n){return t?(e.domain(C5(e.type,t,n)),t.length):-1}function Nae(e,t,n,r,i,o){var s=Math.abs(Te(n)-n[0]),a=s/(s-2*r),u=e===Hs?Zm(t,null,a):e===Cd?Xf(t,null,a,.5):e===_d?Xf(t,null,a,i||1):e===pg?eh(t,null,a,o||1):Jm(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function C5(e,t,n){if(tF(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+Y(t))}return t}function Oae(e,t,n){let r=t.bins;if(r&&!M(r)){let i=e.domain(),o=i[0],s=Te(i),a=r.step,u=r.start==null?o:r.start,l=r.stop==null?s:r.stop;a||U("Scale bins parameter missing step property."),u<o&&(u=a*Math.ceil(o/a)),l>s&&(l=a*Math.floor(s/a)),r=jt(u,l+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===cb&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function Iae(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=Pae(r,t,n);else if(t.scheme&&(o=$ae(r,t,n),Ee(o))){if(e.interpolator)return e.interpolator(o);U(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&nF(r))return e.interpolator(kd(lR(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(bg(t.interpolate,t.interpolateGamma)):Ee(e.round)?e.round(i):Ee(e.rangeRound)&&e.interpolate(i?Us:ir),o&&e.range(lR(o,t.reverse))}function Pae(e,t,n){e!==Xk&&e!==lb&&U("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===lb?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*dg(n,i,r)]}function $ae(e,t,n){var r=t.schemeExtent,i,o;return M(t.scheme)?o=kd(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=Eg(i),o||U(`Unrecognized scheme name: ${t.scheme}`)),n=e===hg?n+1:e===cb?n-1:e===wc||e===mg?+t.schemeCount||Cae:n,nF(e)?h5(o,r,t.reverse):Ee(o)?pb(h5(o,r),n):e===ub?o:o.slice(0,n)}function h5(e,t,n){return Ee(e)&&(t||n)?db(e,lR(t||[0,1],n)):e}function lR(e,t){return t?e.slice().reverse():e}function k5(e){B.call(this,null,e)}Z(k5,B,{transform(e,t){let n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Is(e.sort)),this.modified(n),t}});var g5="zero",F5="center",R5="normalize",T5=["y0","y1"];function dR(e){B.call(this,null,e)}dR.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:g5,values:[g5,F5,R5]},{name:"as",type:"string",array:!0,length:2,default:T5}]};Z(dR,B,{transform(e,t){var n=e.as||T5,r=n[0],i=n[1],o=Is(e.sort),s=e.field||Rs,a=e.offset===F5?Bae:e.offset===R5?Lae:Uae,u,l,c,f;for(u=zae(t.source,e.groupby,o,s),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,s,r,i);return t.reflow(e.modified()).modifies(n)}});function Bae(e,t,n,r,i){for(var o=(t-e.sum)/2,s=e.length,a=0,u;a<s;++a)u=e[a],u[r]=o,u[i]=o+=Math.abs(n(u))}function Lae(e,t,n,r,i){for(var o=1/e.sum,s=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[r]=s,c[i]=s=o*(l+=Math.abs(n(c)))}function Uae(e,t,n,r,i){for(var o=0,s=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[r]=s,c[i]=s+=l):(c[r]=o,c[i]=o+=l)}function zae(e,t,n,r){var i=[],o=h=>h(c),s,a,u,l,c,f,d,p,m;if(t==null)i.push(e.slice());else for(s={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(o),d=s[f],d||(s[f]=d=[],i.push(d)),d.push(c);for(f=0,m=0,l=i.length;f<l;++f){for(d=i[f],a=0,p=0,u=d.length;a<u;++a)p+=Math.abs(r(d[a]));d.sum=p,p>m&&(m=p),n&&d.sort(n)}return i.max=m,i}var DT={};er(DT,{contour:()=>ST,geojson:()=>_T,geopath:()=>CT,geopoint:()=>kT,geoshape:()=>FT,graticule:()=>RT,heatmap:()=>TT,isocontour:()=>vT,kde2d:()=>wT,projection:()=>U4});var le=1e-6,Oc=1e-12,Ce=Math.PI,at=Ce/2,Bd=Ce/4,Wt=Ce*2,ut=180/Ce,_e=Ce/180,Ae=Math.abs,ao=Math.atan,Pt=Math.atan2,ue=Math.cos,Wg=Math.ceil,tE=Math.exp;var nE=Math.hypot,Ic=Math.log,rE=Math.pow,ae=Math.sin,ur=Math.sign||function(e){return e>0?1:e<0?-1:0},lt=Math.sqrt,Ld=Math.tan;function iE(e){return e>1?0:e<-1?Ce:Math.acos(e)}function bt(e){return e>1?at:e<-1?-at:Math.asin(e)}function Et(){}function oE(e,t){e&&M5.hasOwnProperty(e.type)&&M5[e.type](e,t)}var D5={Feature:function(e,t){oE(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)oE(n[r].geometry,t)}},M5={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){mR(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)mR(n[r],t,0)},Polygon:function(e,t){N5(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)N5(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)oE(n[r],t)}};function mR(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function N5(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)mR(e[n],t,1);t.polygonEnd()}function oi(e,t){e&&D5.hasOwnProperty(e.type)?D5[e.type](e,t):oE(e,t)}var Vg=new At,sE=new At,O5,I5,hR,gR,yR,Ho={point:Et,lineStart:Et,lineEnd:Et,polygonStart:function(){Vg=new At,Ho.lineStart=Hae,Ho.lineEnd=qae},polygonEnd:function(){var e=+Vg;sE.add(e<0?Wt+e:e),this.lineStart=this.lineEnd=this.point=Et},sphere:function(){sE.add(Wt)}};function Hae(){Ho.point=Gae}function qae(){P5(O5,I5)}function Gae(e,t){Ho.point=P5,O5=e,I5=t,e*=_e,t*=_e,hR=e,gR=ue(t=t/2+Bd),yR=ae(t)}function P5(e,t){e*=_e,t*=_e,t=t/2+Bd;var n=e-hR,r=n>=0?1:-1,i=r*n,o=ue(t),s=ae(t),a=yR*s,u=gR*o+a*ue(i),l=a*r*ae(i);Vg.add(Pt(l,u)),hR=e,gR=o,yR=s}function xR(e){return sE=new At,oi(e,Ho),sE*2}function Pc(e){return[Pt(e[1],e[0]),bt(e[2])]}function uo(e){var t=e[0],n=e[1],r=ue(n);return[r*ue(t),r*ae(t),ae(n)]}function Yg(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ha(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function aE(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Xg(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function $c(e){var t=lt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Rt,si,$t,Ti,Bc,U5,z5,Ud,Kg,ll,Ga,qa={point:bR,lineStart:$5,lineEnd:B5,polygonStart:function(){qa.point=q5,qa.lineStart=jae,qa.lineEnd=Wae,Kg=new At,Ho.polygonStart()},polygonEnd:function(){Ho.polygonEnd(),qa.point=bR,qa.lineStart=$5,qa.lineEnd=B5,Vg<0?(Rt=-($t=180),si=-(Ti=90)):Kg>le?Ti=90:Kg<-le&&(si=-90),Ga[0]=Rt,Ga[1]=$t},sphere:function(){Rt=-($t=180),si=-(Ti=90)}};function bR(e,t){ll.push(Ga=[Rt=e,$t=e]),t<si&&(si=t),t>Ti&&(Ti=t)}function H5(e,t){var n=uo([e*_e,t*_e]);if(Ud){var r=Ha(Ud,n),i=[r[1],-r[0],0],o=Ha(i,r);$c(o),o=Pc(o);var s=e-Bc,a=s>0?1:-1,u=o[0]*ut*a,l,c=Ae(s)>180;c^(a*Bc<u&&u<a*e)?(l=o[1]*ut,l>Ti&&(Ti=l)):(u=(u+360)%360-180,c^(a*Bc<u&&u<a*e)?(l=-o[1]*ut,l<si&&(si=l)):(t<si&&(si=t),t>Ti&&(Ti=t))),c?e<Bc?Ri(Rt,e)>Ri(Rt,$t)&&($t=e):Ri(e,$t)>Ri(Rt,$t)&&(Rt=e):$t>=Rt?(e<Rt&&(Rt=e),e>$t&&($t=e)):e>Bc?Ri(Rt,e)>Ri(Rt,$t)&&($t=e):Ri(e,$t)>Ri(Rt,$t)&&(Rt=e)}else ll.push(Ga=[Rt=e,$t=e]);t<si&&(si=t),t>Ti&&(Ti=t),Ud=n,Bc=e}function $5(){qa.point=H5}function B5(){Ga[0]=Rt,Ga[1]=$t,qa.point=bR,Ud=null}function q5(e,t){if(Ud){var n=e-Bc;Kg.add(Ae(n)>180?n+(n>0?360:-360):n)}else U5=e,z5=t;Ho.point(e,t),H5(e,t)}function jae(){Ho.lineStart()}function Wae(){q5(U5,z5),Ho.lineEnd(),Ae(Kg)>le&&(Rt=-($t=180)),Ga[0]=Rt,Ga[1]=$t,Ud=null}function Ri(e,t){return(t-=e)<0?t+360:t}function Vae(e,t){return e[0]-t[0]}function L5(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function ER(e){var t,n,r,i,o,s,a;if(Ti=$t=-(Rt=si=1/0),ll=[],oi(e,qa),n=ll.length){for(ll.sort(Vae),t=1,r=ll[0],o=[r];t<n;++t)i=ll[t],L5(r,i[0])||L5(r,i[1])?(Ri(r[0],i[1])>Ri(r[0],r[1])&&(r[1]=i[1]),Ri(i[0],r[1])>Ri(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(a=Ri(r[1],i[0]))>s&&(s=a,Rt=i[0],$t=r[1])}return ll=Ga=null,Rt===1/0||si===1/0?[[NaN,NaN],[NaN,NaN]]:[[Rt,si],[$t,Ti]]}var Qg,uE,lE,cE,fE,dE,pE,mE,vR,wR,SR,W5,V5,$r,Br,Lr,qo={sphere:Et,point:AR,lineStart:G5,lineEnd:j5,polygonStart:function(){qo.lineStart=Kae,qo.lineEnd=Qae},polygonEnd:function(){qo.lineStart=G5,qo.lineEnd=j5}};function AR(e,t){e*=_e,t*=_e;var n=ue(t);Jg(n*ue(e),n*ae(e),ae(t))}function Jg(e,t,n){++Qg,lE+=(e-lE)/Qg,cE+=(t-cE)/Qg,fE+=(n-fE)/Qg}function G5(){qo.point=Yae}function Yae(e,t){e*=_e,t*=_e;var n=ue(t);$r=n*ue(e),Br=n*ae(e),Lr=ae(t),qo.point=Xae,Jg($r,Br,Lr)}function Xae(e,t){e*=_e,t*=_e;var n=ue(t),r=n*ue(e),i=n*ae(e),o=ae(t),s=Pt(lt((s=Br*o-Lr*i)*s+(s=Lr*r-$r*o)*s+(s=$r*i-Br*r)*s),$r*r+Br*i+Lr*o);uE+=s,dE+=s*($r+($r=r)),pE+=s*(Br+(Br=i)),mE+=s*(Lr+(Lr=o)),Jg($r,Br,Lr)}function j5(){qo.point=AR}function Kae(){qo.point=Jae}function Qae(){Y5(W5,V5),qo.point=AR}function Jae(e,t){W5=e,V5=t,e*=_e,t*=_e,qo.point=Y5;var n=ue(t);$r=n*ue(e),Br=n*ae(e),Lr=ae(t),Jg($r,Br,Lr)}function Y5(e,t){e*=_e,t*=_e;var n=ue(t),r=n*ue(e),i=n*ae(e),o=ae(t),s=Br*o-Lr*i,a=Lr*r-$r*o,u=$r*i-Br*r,l=nE(s,a,u),c=bt(l),f=l&&-c/l;vR.add(f*s),wR.add(f*a),SR.add(f*u),uE+=c,dE+=c*($r+($r=r)),pE+=c*(Br+(Br=i)),mE+=c*(Lr+(Lr=o)),Jg($r,Br,Lr)}function _R(e){Qg=uE=lE=cE=fE=dE=pE=mE=0,vR=new At,wR=new At,SR=new At,oi(e,qo);var t=+vR,n=+wR,r=+SR,i=nE(t,n,r);return i<Oc&&(t=dE,n=pE,r=mE,uE<le&&(t=lE,n=cE,r=fE),i=nE(t,n,r),i<Oc)?[NaN,NaN]:[Pt(n,t)*ut,bt(r/i)*ut]}function Zg(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function CR(e,t){return Ae(e)>Ce&&(e-=Math.round(e/Wt)*Wt),[e,t]}CR.invert=CR;function kR(e,t,n){return(e%=Wt)?t||n?Zg(K5(e),Q5(t,n)):K5(e):t||n?Q5(t,n):CR}function X5(e){return function(t,n){return t+=e,Ae(t)>Ce&&(t-=Math.round(t/Wt)*Wt),[t,n]}}function K5(e){var t=X5(e);return t.invert=X5(-e),t}function Q5(e,t){var n=ue(e),r=ae(e),i=ue(t),o=ae(t);function s(a,u){var l=ue(u),c=ue(a)*l,f=ae(a)*l,d=ae(u),p=d*n+c*r;return[Pt(f*i-p*o,c*n-d*r),bt(p*i+f*o)]}return s.invert=function(a,u){var l=ue(u),c=ue(a)*l,f=ae(a)*l,d=ae(u),p=d*i-f*o;return[Pt(f*i+d*o,c*n+p*r),bt(p*n-c*r)]},s}function J5(e){e=kR(e[0]*_e,e[1]*_e,e.length>2?e[2]*_e:0);function t(n){return n=e(n[0]*_e,n[1]*_e),n[0]*=ut,n[1]*=ut,n}return t.invert=function(n){return n=e.invert(n[0]*_e,n[1]*_e),n[0]*=ut,n[1]*=ut,n},t}function e4(e,t,n,r,i,o){if(n){var s=ue(t),a=ae(t),u=r*n;i==null?(i=t+r*Wt,o=t-u/2):(i=Z5(s,i),o=Z5(s,o),(r>0?i<o:i>o)&&(i+=r*Wt));for(var l,c=i;r>0?c>o:c<o;c-=u)l=Pc([s,-a*ue(c),-a*ae(c)]),e.point(l[0],l[1])}}function Z5(e,t){t=uo(t),t[0]-=e,$c(t);var n=iE(-t[1]);return((-t[2]<0?-n:n)+Wt-le)%Wt}function hE(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Et,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function zd(e,t){return Ae(e[0]-t[0])<le&&Ae(e[1]-t[1])<le}function gE(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function yE(e,t,n,r,i){var o=[],s=[],a,u;if(e.forEach(function(m){if(!((h=m.length-1)<=0)){var h,g=m[0],y=m[h],x;if(zd(g,y)){if(!g[2]&&!y[2]){for(i.lineStart(),a=0;a<h;++a)i.point((g=m[a])[0],g[1]);i.lineEnd();return}y[0]+=2*le}o.push(x=new gE(g,m,null,!0)),s.push(x.o=new gE(g,null,x,!1)),o.push(x=new gE(y,m,null,!1)),s.push(x.o=new gE(y,null,x,!0))}}),!!o.length){for(s.sort(t),t4(o),t4(s),a=0,u=s.length;a<u;++a)s[a].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,p=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(a=0,u=c.length;a<u;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(p)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,p=!p}while(!d.v);i.lineEnd()}}}function t4(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function FR(e){return Ae(e[0])<=Ce?e[0]:ur(e[0])*((Ae(e[0])+Ce)%Wt-Ce)}function n4(e,t){var n=FR(t),r=t[1],i=ae(r),o=[ae(n),-ue(n),0],s=0,a=0,u=new At;i===1?r=at+le:i===-1&&(r=-at-le);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,p=f[d-1],m=FR(p),h=p[1]/2+Bd,g=ae(h),y=ue(h),x=0;x<d;++x,m=E,g=S,y=w,p=b){var b=f[x],E=FR(b),v=b[1]/2+Bd,S=ae(v),w=ue(v),_=E-m,A=_>=0?1:-1,F=A*_,R=F>Ce,D=g*S;if(u.add(Pt(D*A*ae(F),y*w+D*ue(F))),s+=R?_+A*Wt:_,R^m>=n^E>=n){var O=Ha(uo(p),uo(b));$c(O);var T=Ha(o,O);$c(T);var k=(R^_>=0?-1:1)*bt(T[2]);(r>k||r===k&&(O[0]||O[1]))&&(a+=R^_>=0?1:-1)}}return(s<-le||s<le&&u<-Oc)^a&1}function xE(e,t,n,r){return function(i){var o=t(i),s=hE(),a=t(s),u=!1,l,c,f,d={point:p,lineStart:h,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=x,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=p,d.lineStart=h,d.lineEnd=g,c=Jf(c);var E=n4(l,r);c.length?(u||(i.polygonStart(),u=!0),yE(c,eue,E,n,i)):E&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(E,v){e(E,v)&&i.point(E,v)}function m(E,v){o.point(E,v)}function h(){d.point=m,o.lineStart()}function g(){d.point=p,o.lineEnd()}function y(E,v){f.push([E,v]),a.point(E,v)}function x(){a.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),a.lineEnd();var E=a.clean(),v=s.result(),S,w=v.length,_,A,F;if(f.pop(),l.push(f),f=null,!!w){if(E&1){if(A=v[0],(_=A.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point((F=A[S])[0],F[1]);i.lineEnd()}return}w>1&&E&2&&v.push(v.pop().concat(v.shift())),c.push(v.filter(Zae))}}return d}}function Zae(e){return e.length>1}function eue(e,t){return((e=e.x)[0]<0?e[1]-at-le:at-e[1])-((t=t.x)[0]<0?t[1]-at-le:at-t[1])}var RR=xE(function(){return!0},tue,rue,[-Ce,-at]);function tue(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?Ce:-Ce,u=Ae(o-t);Ae(u-Ce)<le?(e.point(t,n=(n+s)/2>0?at:-at),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&u>=Ce&&(Ae(t-r)<le&&(t-=r*le),Ae(o-a)<le&&(o-=a*le),n=nue(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function nue(e,t,n,r){var i,o,s=ae(e-n);return Ae(s)>le?ao((ae(t)*(o=ue(r))*ae(n)-ae(r)*(i=ue(t))*ae(e))/(i*o*s)):(t+r)/2}function rue(e,t,n,r){var i;if(e==null)i=n*at,r.point(-Ce,i),r.point(0,i),r.point(Ce,i),r.point(Ce,0),r.point(Ce,-i),r.point(0,-i),r.point(-Ce,-i),r.point(-Ce,0),r.point(-Ce,i);else if(Ae(e[0]-t[0])>le){var o=e[0]<t[0]?Ce:-Ce;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function r4(e){var t=ue(e),n=2*_e,r=t>0,i=Ae(t)>le;function o(c,f,d,p){e4(p,e,n,d,c,f)}function s(c,f){return ue(c)*ue(f)>t}function a(c){var f,d,p,m,h;return{lineStart:function(){m=p=!1,h=1},point:function(g,y){var x=[g,y],b,E=s(g,y),v=r?E?0:l(g,y):E?l(g+(g<0?Ce:-Ce),y):0;if(!f&&(m=p=E)&&c.lineStart(),E!==p&&(b=u(f,x),(!b||zd(f,b)||zd(x,b))&&(x[2]=1)),E!==p)h=0,E?(c.lineStart(),b=u(x,f),c.point(b[0],b[1])):(b=u(f,x),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^E){var S;!(v&d)&&(S=u(x,f,!0))&&(h=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}E&&(!f||!zd(f,x))&&c.point(x[0],x[1]),f=x,p=E,d=v},lineEnd:function(){p&&c.lineEnd(),f=null},clean:function(){return h|(m&&p)<<1}}}function u(c,f,d){var p=uo(c),m=uo(f),h=[1,0,0],g=Ha(p,m),y=Yg(g,g),x=g[0],b=y-x*x;if(!b)return!d&&c;var E=t*y/b,v=-t*x/b,S=Ha(h,g),w=Xg(h,E),_=Xg(g,v);aE(w,_);var A=S,F=Yg(w,A),R=Yg(A,A),D=F*F-R*(Yg(w,w)-1);if(!(D<0)){var O=lt(D),T=Xg(A,(-F-O)/R);if(aE(T,w),T=Pc(T),!d)return T;var k=c[0],C=f[0],N=c[1],I=f[1],L;C<k&&(L=k,k=C,C=L);var te=C-k,ie=Ae(te-Ce)<le,oe=ie||te<le;if(!ie&&I<N&&(L=N,N=I,I=L),oe?ie?N+I>0^T[1]<(Ae(T[0]-k)<le?N:I):N<=T[1]&&T[1]<=I:te>Ce^(k<=T[0]&&T[0]<=C)){var Se=Xg(A,(-F+O)/R);return aE(Se,w),[T,Pc(Se)]}}}function l(c,f){var d=r?e:Ce-e,p=0;return c<-d?p|=1:c>d&&(p|=2),f<-d?p|=4:f>d&&(p|=8),p}return xE(s,a,o,r?[0,-e]:[-Ce,e-Ce])}function i4(e,t,n,r,i,o){var s=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-s,p=l-a,m;if(m=n-s,!(!d&&m>0)){if(m/=d,d<0){if(m<c)return;m<f&&(f=m)}else if(d>0){if(m>f)return;m>c&&(c=m)}if(m=i-s,!(!d&&m<0)){if(m/=d,d<0){if(m>f)return;m>c&&(c=m)}else if(d>0){if(m<c)return;m<f&&(f=m)}if(m=r-a,!(!p&&m>0)){if(m/=p,p<0){if(m<c)return;m<f&&(f=m)}else if(p>0){if(m>f)return;m>c&&(c=m)}if(m=o-a,!(!p&&m<0)){if(m/=p,p<0){if(m>f)return;m>c&&(c=m)}else if(p>0){if(m<c)return;m<f&&(f=m)}return c>0&&(e[0]=s+c*d,e[1]=a+c*p),f<1&&(t[0]=s+f*d,t[1]=a+f*p),!0}}}}}var e0=1e9,bE=-e0;function t0(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var p=0,m=0;if(l==null||(p=s(l,f))!==(m=s(c,f))||u(l,c)<0^f>0)do d.point(p===0||p===3?e:n,p>1?r:t);while((p=(p+f+4)%4)!==m);else d.point(c[0],c[1])}function s(l,c){return Ae(l[0]-e)<le?c>0?0:3:Ae(l[0]-n)<le?c>0?2:1:Ae(l[1]-t)<le?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=s(l,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=hE(),d,p,m,h,g,y,x,b,E,v,S,w={point:_,lineStart:D,lineEnd:O,polygonStart:F,polygonEnd:R};function _(k,C){i(k,C)&&c.point(k,C)}function A(){for(var k=0,C=0,N=p.length;C<N;++C)for(var I=p[C],L=1,te=I.length,ie=I[0],oe,Se,Oe=ie[0],we=ie[1];L<te;++L)oe=Oe,Se=we,ie=I[L],Oe=ie[0],we=ie[1],Se<=r?we>r&&(Oe-oe)*(r-Se)>(we-Se)*(e-oe)&&++k:we<=r&&(Oe-oe)*(r-Se)<(we-Se)*(e-oe)&&--k;return k}function F(){c=f,d=[],p=[],S=!0}function R(){var k=A(),C=S&&k,N=(d=Jf(d)).length;(C||N)&&(l.polygonStart(),C&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),N&&yE(d,a,k,o,l),l.polygonEnd()),c=l,d=p=m=null}function D(){w.point=T,p&&p.push(m=[]),v=!0,E=!1,x=b=NaN}function O(){d&&(T(h,g),y&&E&&f.rejoin(),d.push(f.result())),w.point=_,E&&c.lineEnd()}function T(k,C){var N=i(k,C);if(p&&m.push([k,C]),v)h=k,g=C,y=N,v=!1,N&&(c.lineStart(),c.point(k,C));else if(N&&E)c.point(k,C);else{var I=[x=Math.max(bE,Math.min(e0,x)),b=Math.max(bE,Math.min(e0,b))],L=[k=Math.max(bE,Math.min(e0,k)),C=Math.max(bE,Math.min(e0,C))];i4(I,L,e,t,n,r)?(E||(c.lineStart(),c.point(I[0],I[1])),c.point(L[0],L[1]),N||c.lineEnd(),S=!1):N&&(c.lineStart(),c.point(k,C),S=!1)}x=k,b=C,E=N}return w}}function o4(e,t,n){var r=jt(e,t-le,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function s4(e,t,n){var r=jt(e,t-le,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function EE(){var e,t,n,r,i,o,s,a,u=10,l=u,c=90,f=360,d,p,m,h,g=2.5;function y(){return{type:"MultiLineString",coordinates:x()}}function x(){return jt(Wg(r/c)*c,n,c).map(m).concat(jt(Wg(a/f)*f,s,f).map(h)).concat(jt(Wg(t/u)*u,e,u).filter(function(b){return Ae(b%c)>le}).map(d)).concat(jt(Wg(o/l)*l,i,l).filter(function(b){return Ae(b%f)>le}).map(p))}return y.lines=function(){return x().map(function(b){return{type:"LineString",coordinates:b}})},y.outline=function(){return{type:"Polygon",coordinates:[m(r).concat(h(s).slice(1),m(n).reverse().slice(1),h(a).reverse().slice(1))]}},y.extent=function(b){return arguments.length?y.extentMajor(b).extentMinor(b):y.extentMinor()},y.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],a=+b[0][1],s=+b[1][1],r>n&&(b=r,r=n,n=b),a>s&&(b=a,a=s,s=b),y.precision(g)):[[r,a],[n,s]]},y.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],o=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),o>i&&(b=o,o=i,i=b),y.precision(g)):[[t,o],[e,i]]},y.step=function(b){return arguments.length?y.stepMajor(b).stepMinor(b):y.stepMinor()},y.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],y):[c,f]},y.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],y):[u,l]},y.precision=function(b){return arguments.length?(g=+b,d=o4(o,i,90),p=s4(t,e,g),m=o4(a,s,90),h=s4(r,n,g),y):g},y.extentMajor([[-180,-90+le],[180,90-le]]).extentMinor([[-180,-80-le],[180,80+le]])}var cl=e=>e;var TR=new At,DR=new At,a4,u4,MR,NR,fl={point:Et,lineStart:Et,lineEnd:Et,polygonStart:function(){fl.lineStart=iue,fl.lineEnd=sue},polygonEnd:function(){fl.lineStart=fl.lineEnd=fl.point=Et,TR.add(Ae(DR)),DR=new At},result:function(){var e=TR/2;return TR=new At,e}};function iue(){fl.point=oue}function oue(e,t){fl.point=l4,a4=MR=e,u4=NR=t}function l4(e,t){DR.add(NR*e-MR*t),MR=e,NR=t}function sue(){l4(a4,u4)}var OR=fl;var Hd=1/0,vE=Hd,n0=-Hd,wE=n0,aue={point:uue,lineStart:Et,lineEnd:Et,polygonStart:Et,polygonEnd:Et,result:function(){var e=[[Hd,vE],[n0,wE]];return n0=wE=-(vE=Hd=1/0),e}};function uue(e,t){e<Hd&&(Hd=e),e>n0&&(n0=e),t<vE&&(vE=t),t>wE&&(wE=t)}var qd=aue;var IR=0,PR=0,r0=0,SE=0,AE=0,Gd=0,$R=0,BR=0,i0=0,d4,p4,Vs,Ys,Go={point:Lc,lineStart:c4,lineEnd:f4,polygonStart:function(){Go.lineStart=fue,Go.lineEnd=due},polygonEnd:function(){Go.point=Lc,Go.lineStart=c4,Go.lineEnd=f4},result:function(){var e=i0?[$R/i0,BR/i0]:Gd?[SE/Gd,AE/Gd]:r0?[IR/r0,PR/r0]:[NaN,NaN];return IR=PR=r0=SE=AE=Gd=$R=BR=i0=0,e}};function Lc(e,t){IR+=e,PR+=t,++r0}function c4(){Go.point=lue}function lue(e,t){Go.point=cue,Lc(Vs=e,Ys=t)}function cue(e,t){var n=e-Vs,r=t-Ys,i=lt(n*n+r*r);SE+=i*(Vs+e)/2,AE+=i*(Ys+t)/2,Gd+=i,Lc(Vs=e,Ys=t)}function f4(){Go.point=Lc}function fue(){Go.point=pue}function due(){m4(d4,p4)}function pue(e,t){Go.point=m4,Lc(d4=Vs=e,p4=Ys=t)}function m4(e,t){var n=e-Vs,r=t-Ys,i=lt(n*n+r*r);SE+=i*(Vs+e)/2,AE+=i*(Ys+t)/2,Gd+=i,i=Ys*e-Vs*t,$R+=i*(Vs+e),BR+=i*(Ys+t),i0+=i*3,Lc(Vs=e,Ys=t)}var LR=Go;function _E(e){this._context=e}_E.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Wt);break}}},result:Et};var zR=new At,UR,h4,g4,o0,s0,CE={point:Et,lineStart:function(){CE.point=mue},lineEnd:function(){UR&&y4(h4,g4),CE.point=Et},polygonStart:function(){UR=!0},polygonEnd:function(){UR=null},result:function(){var e=+zR;return zR=new At,e}};function mue(e,t){CE.point=y4,h4=o0=e,g4=s0=t}function y4(e,t){o0-=e,s0-=t,zR.add(lt(o0*o0+s0*s0)),o0=e,s0=t}var HR=CE;var x4,kE,b4,E4,jd=class{constructor(t){this._append=t==null?v4:hue(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==b4||this._append!==kE){let r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,b4=r,kE=this._append,E4=this._,this._=i}this._+=E4;break}}}result(){let t=this._;return this._="",t.length?t:null}};function v4(e){let t=1;this._+=e[0];for(let n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function hue(e){let t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return v4;if(t!==x4){let n=10**t;x4=t,kE=function(i){let o=1;this._+=i[0];for(let s=i.length;o<s;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return kE}function FE(e,t){let n=3,r=4.5,i,o;function s(a){return a&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),oi(a,i(o))),o.result()}return s.area=function(a){return oi(a,i(OR)),OR.result()},s.measure=function(a){return oi(a,i(HR)),HR.result()},s.bounds=function(a){return oi(a,i(qd)),qd.result()},s.centroid=function(a){return oi(a,i(LR)),LR.result()},s.projection=function(a){return arguments.length?(i=a==null?(e=null,cl):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new jd(n)):new _E(t=a),typeof r!="function"&&o.pointRadius(r),s):t},s.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(o.pointRadius(+a),+a),s):r},s.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{let u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(o=new jd(n)),s},s.projection(e).digits(n).context(t)}function Uc(e){return function(t){var n=new qR;for(var r in e)n[r]=e[r];return n.stream=t,n}}function qR(){}qR.prototype={constructor:qR,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function GR(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),oi(n,e.stream(qd)),t(qd.result()),r!=null&&e.clipExtent(r),e}function zc(e,t,n){return GR(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,u])},n)}function Wd(e,t,n){return zc(e,[[0,0],t],n)}function Vd(e,t,n){return GR(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function Yd(e,t,n){return GR(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var w4=16,gue=ue(30*_e);function jR(e,t){return+t?xue(e,t):yue(e)}function yue(e){return Uc({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function xue(e,t){function n(r,i,o,s,a,u,l,c,f,d,p,m,h,g){var y=l-r,x=c-i,b=y*y+x*x;if(b>4*t&&h--){var E=s+d,v=a+p,S=u+m,w=lt(E*E+v*v+S*S),_=bt(S/=w),A=Ae(Ae(S)-1)<le||Ae(o-f)<le?(o+f)/2:Pt(v,E),F=e(A,_),R=F[0],D=F[1],O=R-r,T=D-i,k=x*O-y*T;(k*k/b>t||Ae((y*O+x*T)/b-.5)>.3||s*d+a*p+u*m<gue)&&(n(r,i,o,s,a,u,R,D,A,E/=w,v/=w,S,h,g),g.point(R,D),n(R,D,A,E,v,S,l,c,f,d,p,m,h,g))}}return function(r){var i,o,s,a,u,l,c,f,d,p,m,h,g={point:y,lineStart:x,lineEnd:E,polygonStart:function(){r.polygonStart(),g.lineStart=v},polygonEnd:function(){r.polygonEnd(),g.lineStart=x}};function y(_,A){_=e(_,A),r.point(_[0],_[1])}function x(){f=NaN,g.point=b,r.lineStart()}function b(_,A){var F=uo([_,A]),R=e(_,A);n(f,d,c,p,m,h,f=R[0],d=R[1],c=_,p=F[0],m=F[1],h=F[2],w4,r),r.point(f,d)}function E(){g.point=y,r.lineEnd()}function v(){x(),g.point=S,g.lineEnd=w}function S(_,A){b(i=_,A),o=f,s=d,a=p,u=m,l=h,g.point=b}function w(){n(f,d,c,p,m,h,o,s,i,a,u,l,w4,r),g.lineEnd=E,E()}return g}}var bue=Uc({point:function(e,t){this.stream.point(e*_e,t*_e)}});function Eue(e){return Uc({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function vue(e,t,n,r,i){function o(s,a){return s*=r,a*=i,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}function S4(e,t,n,r,i,o){if(!o)return vue(e,t,n,r,i);var s=ue(o),a=ae(o),u=s*e,l=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,p=(a*t+s*n)/e;function m(h,g){return h*=r,g*=i,[u*h-l*g+t,n-l*h-u*g]}return m.invert=function(h,g){return[r*(c*h-f*g+d),i*(p-f*h-c*g)]},m}function Bt(e){return RE(function(){return e})()}function RE(e){var t,n=150,r=480,i=250,o=0,s=0,a=0,u=0,l=0,c,f=0,d=1,p=1,m=null,h=RR,g=null,y,x,b,E=cl,v=.5,S,w,_,A,F;function R(k){return _(k[0]*_e,k[1]*_e)}function D(k){return k=_.invert(k[0],k[1]),k&&[k[0]*ut,k[1]*ut]}R.stream=function(k){return A&&F===k?A:A=bue(Eue(c)(h(S(E(F=k)))))},R.preclip=function(k){return arguments.length?(h=k,m=void 0,T()):h},R.postclip=function(k){return arguments.length?(E=k,g=y=x=b=null,T()):E},R.clipAngle=function(k){return arguments.length?(h=+k?r4(m=k*_e):(m=null,RR),T()):m*ut},R.clipExtent=function(k){return arguments.length?(E=k==null?(g=y=x=b=null,cl):t0(g=+k[0][0],y=+k[0][1],x=+k[1][0],b=+k[1][1]),T()):g==null?null:[[g,y],[x,b]]},R.scale=function(k){return arguments.length?(n=+k,O()):n},R.translate=function(k){return arguments.length?(r=+k[0],i=+k[1],O()):[r,i]},R.center=function(k){return arguments.length?(o=k[0]%360*_e,s=k[1]%360*_e,O()):[o*ut,s*ut]},R.rotate=function(k){return arguments.length?(a=k[0]%360*_e,u=k[1]%360*_e,l=k.length>2?k[2]%360*_e:0,O()):[a*ut,u*ut,l*ut]},R.angle=function(k){return arguments.length?(f=k%360*_e,O()):f*ut},R.reflectX=function(k){return arguments.length?(d=k?-1:1,O()):d<0},R.reflectY=function(k){return arguments.length?(p=k?-1:1,O()):p<0},R.precision=function(k){return arguments.length?(S=jR(w,v=k*k),T()):lt(v)},R.fitExtent=function(k,C){return zc(R,k,C)},R.fitSize=function(k,C){return Wd(R,k,C)},R.fitWidth=function(k,C){return Vd(R,k,C)},R.fitHeight=function(k,C){return Yd(R,k,C)};function O(){var k=S4(n,0,0,d,p,f).apply(null,t(o,s)),C=S4(n,r-k[0],i-k[1],d,p,f);return c=kR(a,u,l),w=Zg(t,C),_=Zg(c,w),S=jR(w,v),T()}function T(){return A=F=null,R}return function(){return t=e.apply(this,arguments),R.invert=t.invert&&D,O()}}function Xd(e){var t=0,n=Ce/3,r=RE(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*_e,n=o[1]*_e):[t*ut,n*ut]},i}function A4(e){var t=ue(e);function n(r,i){return[r*t,ae(i)/t]}return n.invert=function(r,i){return[r/t,bt(i*t)]},n}function _4(e,t){var n=ae(e),r=(n+ae(t))/2;if(Ae(r)<le)return A4(e);var i=1+n*(2*r-n),o=lt(i)/r;function s(a,u){var l=lt(i-2*r*ae(u))/r;return[l*ae(a*=r),o-l*ue(a)]}return s.invert=function(a,u){var l=o-u,c=Pt(a,Ae(l))*ur(l);return l*r<0&&(c-=Ce*ur(a)*ur(l)),[c/r,bt((i-(a*a+l*l)*r*r)/(2*r))]},s}function dl(){return Xd(_4).scale(155.424).center([0,33.6442])}function a0(){return dl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function wue(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function WR(){var e,t,n=a0(),r,i=dl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=dl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,p){u=[d,p]}};function c(d){var p=d[0],m=d[1];return u=null,r.point(p,m),u||(o.point(p,m),u)||(a.point(p,m),u)}c.invert=function(d){var p=n.scale(),m=n.translate(),h=(d[0]-m[0])/p,g=(d[1]-m[1])/p;return(g>=.12&&g<.234&&h>=-.425&&h<-.214?i:g>=.166&&g<.234&&h>=-.214&&h<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=wue([n.stream(t=d),i.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var p=n.scale(),m=+d[0],h=+d[1];return r=n.translate(d).clipExtent([[m-.455*p,h-.238*p],[m+.455*p,h+.238*p]]).stream(l),o=i.translate([m-.307*p,h+.201*p]).clipExtent([[m-.425*p+le,h+.12*p+le],[m-.214*p-le,h+.234*p-le]]).stream(l),a=s.translate([m-.205*p,h+.212*p]).clipExtent([[m-.214*p+le,h+.166*p+le],[m-.115*p-le,h+.234*p-le]]).stream(l),f()},c.fitExtent=function(d,p){return zc(c,d,p)},c.fitSize=function(d,p){return Wd(c,d,p)},c.fitWidth=function(d,p){return Vd(c,d,p)},c.fitHeight=function(d,p){return Yd(c,d,p)};function f(){return e=t=null,c}return c.scale(1070)}function TE(e){return function(t,n){var r=ue(t),i=ue(n),o=e(r*i);return o===1/0?[2,0]:[o*i*ae(t),o*ae(n)]}}function Xs(e){return function(t,n){var r=lt(t*t+n*n),i=e(r),o=ae(i),s=ue(i);return[Pt(t*o,r*s),bt(r&&n*o/r)]}}var VR=TE(function(e){return lt(2/(1+e))});VR.invert=Xs(function(e){return 2*bt(e/2)});function YR(){return Bt(VR).scale(124.75).clipAngle(180-.001)}var XR=TE(function(e){return(e=iE(e))&&e/ae(e)});XR.invert=Xs(function(e){return e});function KR(){return Bt(XR).scale(79.4188).clipAngle(180-.001)}function Kd(e,t){return[e,Ic(Ld((at+t)/2))]}Kd.invert=function(e,t){return[e,2*ao(tE(t))-at]};function QR(){return JR(Kd).scale(961/Wt)}function JR(e){var t=Bt(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null,a,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=u=l=null:(s=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):s==null?null:[[s,a],[u,l]]};function c(){var f=Ce*r(),d=t(J5(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Kd?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,u),l]]:[[s,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function DE(e){return Ld((at+e)/2)}function C4(e,t){var n=ue(e),r=e===t?ae(e):Ic(n/ue(t))/Ic(DE(t)/DE(e)),i=n*rE(DE(e),r)/r;if(!r)return Kd;function o(s,a){i>0?a<-at+le&&(a=-at+le):a>at-le&&(a=at-le);var u=i/rE(DE(a),r);return[u*ae(r*s),i-u*ue(r*s)]}return o.invert=function(s,a){var u=i-a,l=ur(r)*lt(s*s+u*u),c=Pt(s,Ae(u))*ur(u);return u*r<0&&(c-=Ce*ur(s)*ur(u)),[c/r,2*ao(rE(i/l,1/r))-at]},o}function ZR(){return Xd(C4).scale(109.5).parallels([30,30])}function Qd(e,t){return[e,t]}Qd.invert=Qd;function eT(){return Bt(Qd).scale(152.63)}function k4(e,t){var n=ue(e),r=e===t?ae(e):(n-ue(t))/(t-e),i=n/r+e;if(Ae(r)<le)return Qd;function o(s,a){var u=i-a,l=r*s;return[u*ae(l),i-u*ue(l)]}return o.invert=function(s,a){var u=i-a,l=Pt(s,Ae(u))*ur(u);return u*r<0&&(l-=Ce*ur(s)*ur(u)),[l/r,i-ur(r)*lt(s*s+u*u)]},o}function tT(){return Xd(k4).scale(131.154).center([0,13.9389])}var u0=1.340264,l0=-.081106,c0=893e-6,f0=.003796,ME=lt(3)/2,Sue=12;function nT(e,t){var n=bt(ME*ae(t)),r=n*n,i=r*r*r;return[e*ue(n)/(ME*(u0+3*l0*r+i*(7*c0+9*f0*r))),n*(u0+l0*r+i*(c0+f0*r))]}nT.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,s,a,u;o<Sue&&(a=n*(u0+l0*r+i*(c0+f0*r))-t,u=u0+3*l0*r+i*(7*c0+9*f0*r),n-=s=a/u,r=n*n,i=r*r*r,!(Ae(s)<Oc));++o);return[ME*e*(u0+3*l0*r+i*(7*c0+9*f0*r))/ue(n),bt(ae(n)/ME)]};function rT(){return Bt(nT).scale(177.158)}function iT(e,t){var n=ue(t),r=ue(e)*n;return[n*ae(e)/r,ae(t)/r]}iT.invert=Xs(ao);function oT(){return Bt(iT).scale(144.049).clipAngle(60)}function sT(){var e=1,t=0,n=0,r=1,i=1,o=0,s,a,u=null,l,c,f,d=1,p=1,m=Uc({point:function(E,v){var S=b([E,v]);this.stream.point(S[0],S[1])}}),h=cl,g,y;function x(){return d=e*r,p=e*i,g=y=null,b}function b(E){var v=E[0]*d,S=E[1]*p;if(o){var w=S*s-v*a;v=v*s+S*a,S=w}return[v+t,S+n]}return b.invert=function(E){var v=E[0]-t,S=E[1]-n;if(o){var w=S*s+v*a;v=v*s-S*a,S=w}return[v/d,S/p]},b.stream=function(E){return g&&y===E?g:g=m(h(y=E))},b.postclip=function(E){return arguments.length?(h=E,u=l=c=f=null,x()):h},b.clipExtent=function(E){return arguments.length?(h=E==null?(u=l=c=f=null,cl):t0(u=+E[0][0],l=+E[0][1],c=+E[1][0],f=+E[1][1]),x()):u==null?null:[[u,l],[c,f]]},b.scale=function(E){return arguments.length?(e=+E,x()):e},b.translate=function(E){return arguments.length?(t=+E[0],n=+E[1],x()):[t,n]},b.angle=function(E){return arguments.length?(o=E%360*_e,a=ae(o),s=ue(o),x()):o*ut},b.reflectX=function(E){return arguments.length?(r=E?-1:1,x()):r<0},b.reflectY=function(E){return arguments.length?(i=E?-1:1,x()):i<0},b.fitExtent=function(E,v){return zc(b,E,v)},b.fitSize=function(E,v){return Wd(b,E,v)},b.fitWidth=function(E,v){return Vd(b,E,v)},b.fitHeight=function(E,v){return Yd(b,E,v)},b}function aT(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}aT.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(Ae(i)>le&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function uT(){return Bt(aT).scale(175.295)}function lT(e,t){return[ue(t)*ae(e),ae(t)]}lT.invert=Xs(bt);function cT(){return Bt(lT).scale(249.5).clipAngle(90+le)}function fT(e,t){var n=ue(t),r=1+ue(e)*n;return[n*ae(e)/r,ae(t)/r]}fT.invert=Xs(function(e){return 2*ao(e)});function dT(){return Bt(fT).scale(250).clipAngle(142)}function pT(e,t){return[Ic(Ld((at+t)/2)),-e]}pT.invert=function(e,t){return[-t,2*ao(tE(e))-at]};function mT(){var e=JR(pT),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var F4=Math.abs;var OE=Math.cos;var d0=Math.sin;var R4=1e-6;var pl=Math.PI,NE=pl/2,p6e=pl/4;var hT=T4(2),m6e=T4(pl),h6e=pl*2,g6e=180/pl,y6e=pl/180;function gT(e){return e>1?NE:e<-1?-NE:Math.asin(e)}function T4(e){return e>0?Math.sqrt(e):0}function Aue(e,t){var n=e*d0(t),r=30,i;do t-=i=(t+d0(t)-n)/(1+OE(t));while(F4(i)>R4&&--r>0);return t/2}function _ue(e,t,n){function r(i,o){return[e*i*OE(o=Aue(n,o)),t*d0(o)]}return r.invert=function(i,o){return o=gT(o/t),[i/(e*OE(o)),gT((2*o+d0(2*o))/n)]},r}var D4=_ue(hT/NE,hT,pl);function yT(){return Bt(D4).scale(169.529)}var Cue=FE(),PE=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function kue(e,t){return function n(){let r=t();return r.type=e,r.path=FE().projection(r),r.copy=r.copy||function(){let i=n();return PE.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},Jk(r)}}function p0(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(IE[e]=kue(e,t),this):IE[e]||null}function xT(e){return e&&e.path||Cue}var IE={albers:a0,albersusa:WR,azimuthalequalarea:YR,azimuthalequidistant:KR,conicconformal:ZR,conicequalarea:dl,conicequidistant:tT,equalEarth:rT,equirectangular:eT,gnomonic:oT,identity:sT,mercator:QR,mollweide:yT,naturalEarth1:uT,orthographic:cT,stereographic:dT,transversemercator:mT};for(let e in IE)p0(e,IE[e]);function Fue(){}var ja=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function O4(){var e=1,t=1,n=a;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),Rue(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var p=0,m=c.length,h;p<m;++p)if(Tue((h=c[p])[0],d)!==-1){h.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=[],d=[],p,m,h,g,y,x;for(p=m=-1,g=u[0]>=l,ja[g<<1].forEach(b);++p<e-1;)h=g,g=u[p+1]>=l,ja[h|g<<1].forEach(b);for(ja[g<<0].forEach(b);++m<t-1;){for(p=-1,g=u[m*e+e]>=l,y=u[m*e]>=l,ja[g<<1|y<<2].forEach(b);++p<e-1;)h=g,g=u[m*e+e+p+1]>=l,x=y,y=u[m*e+p+1]>=l,ja[h|g<<1|y<<2|x<<3].forEach(b);ja[g|y<<3].forEach(b)}for(p=-1,y=u[m*e]>=l,ja[y<<2].forEach(b);++p<e-1;)x=y,y=u[m*e+p+1]>=l,ja[y<<2|x<<3].forEach(b);ja[y<<3].forEach(b);function b(E){var v=[E[0][0]+p,E[0][1]+m],S=[E[1][0]+p,E[1][1]+m],w=s(v),_=s(S),A,F;(A=d[w])?(F=f[_])?(delete d[A.end],delete f[F.start],A===F?(A.ring.push(S),c(A.ring)):f[A.start]=d[F.end]={start:A.start,end:F.end,ring:A.ring.concat(F.ring)}):(delete d[A.end],A.ring.push(S),d[A.end=_]=A):(A=f[_])?(F=d[w])?(delete f[A.start],delete d[F.end],A===F?(A.ring.push(S),c(A.ring)):f[F.start]=d[A.end]={start:F.start,end:A.end,ring:F.ring.concat(A.ring)}):(delete f[A.start],A.ring.unshift(v),f[A.start=w]=A):f[w]=d[_]={start:w,end:_,ring:[v,S]}}}function s(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],p=f[1],m=d|0,h=p|0,g,y=l[h*e+m];d>0&&d<e&&m===d&&(g=l[h*e+m-1],f[0]=d+(c-g)/(y-g)-.5),p>0&&p<t&&h===p&&(g=l[(h-1)*e+m],f[1]=p+(c-g)/(y-g)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||U("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?a:Fue,r):n===a},r}function Rue(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Tue(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=Due(e,t[n]))return i;return 0}function Due(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var u=e[o],l=u[0],c=u[1],f=e[a],d=f[0],p=f[1];if(Mue(u,f,t))return 0;c>r!=p>r&&n<(d-l)*(r-c)/(p-c)+l&&(i=-i)}return i}function Mue(e,t,n){var r;return Nue(e,t,n)&&Oue(e[r=+(e[0]===t[0])],n[r],t[r])}function Nue(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function Oue(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function I4(e,t,n){return function(r){var i=kr(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=t?Fr(o,s,e):a/(e+1);return jt(o+u,s,u)}}function vT(e){B.call(this,null,e)}vT.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};Z(vT,B,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||Ot,o=O4().smooth(e.smooth!==!1),s=e.thresholds||Iue(r,i,e),a=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{let c=i(l),f=o.size([c.width,c.height])(c.values,M(s)?s:s(c.values));Pue(f,c,l,e),f.forEach(d=>{u.push(uc(l,Le(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Iue(e,t,n){let r=I4(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Ki(t(i).values)))}function Pue(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(Ee(i)&&(i=i(n,r)),Ee(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;let s=(ke(i)?i:i[0])||1,a=(ke(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(P4(t,s,a,u,l))}function P4(e,t,n,r,i){let o=e.x1||0,s=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-s)*n+i}return function(f){return f.coordinates.forEach(u),f}}function M4(e,t,n){let r=e>=0?e:s1(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function bT(e){return Ee(e)?e:St(+e)}function $4(){var e=u=>u[0],t=u=>u[1],n=Rs,r=[-1,-1],i=960,o=500,s=2;function a(u,l){let c=M4(r[0],u,e)>>s,f=M4(r[1],u,t)>>s,d=c?c+2:0,p=f?f+2:0,m=2*d+(i>>s),h=2*p+(o>>s),g=new Float32Array(m*h),y=new Float32Array(m*h),x=g;u.forEach(E=>{let v=d+(+e(E)>>s),S=p+(+t(E)>>s);v>=0&&v<m&&S>=0&&S<h&&(g[v+S*m]+=+n(E))}),c>0&&f>0?(Jd(m,h,g,y,c),Zd(m,h,y,g,f),Jd(m,h,g,y,c),Zd(m,h,y,g,f),Jd(m,h,g,y,c),Zd(m,h,y,g,f)):c>0?(Jd(m,h,g,y,c),Jd(m,h,y,g,c),Jd(m,h,g,y,c),x=y):f>0&&(Zd(m,h,g,y,f),Zd(m,h,y,g,f),Zd(m,h,g,y,f),x=y);let b=l?Math.pow(2,-2*s):1/Zf(x);for(let E=0,v=m*h;E<v;++E)x[E]*=b;return{values:x,scale:1<<s,width:m,height:h,x1:d,y1:p,x2:d+(i>>s),y2:p+(o>>s)}}return a.x=function(u){return arguments.length?(e=bT(u),a):e},a.y=function(u){return arguments.length?(t=bT(u),a):t},a.weight=function(u){return arguments.length?(n=bT(u),a):n},a.size=function(u){if(!arguments.length)return[i,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||U("invalid size"),i=l,o=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||U("invalid cell size"),s=Math.floor(Math.log(u)/Math.LN2),a):1<<s},a.bandwidth=function(u){return arguments.length?(u=Q(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&U("invalid bandwidth"),r=u,a):r},a}function Jd(e,t,n,r,i){let o=(i<<1)+1;for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[a+s*e]),a>=i&&(a>=o&&(u-=n[a-o+s*e]),r[a-i+s*e]=u/Math.min(a+1,e-1+o-a,o))}function Zd(e,t,n,r,i){let o=(i<<1)+1;for(let s=0;s<e;++s)for(let a=0,u=0;a<t+i;++a)a<t&&(u+=n[s+a*e]),a>=i&&(a>=o&&(u-=n[s+(a-o)*e]),r[s+(a-i)*e]=u/Math.min(a+1,t-1+o-a,o))}function wT(e){B.call(this,null,e)}wT.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var $ue=["x","y","weight","size","cellSize","bandwidth"];function B4(e,t){return $ue.forEach(n=>t[n]!=null?e[n](t[n]):0),e}Z(wT,B,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=Bue(r,e.groupby),o=(e.groupby||[]).map(xt),s=B4($4(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=i.map(c=>Le(l({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Bue(e,t){var n=[],r=c=>c(a),i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function ST(e){B.call(this,null,e)}ST.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};Z(ST,B,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=O4().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||I4(e.count||10,e.nice,!!i),s=e.size,a,u;return i||(i=t.materialize(t.SOURCE).source,a=B4($4(),e)(i,!0),u=P4(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=M(o)?o:o(i),i=r.size(s)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Le),n}});var ET="Feature",AT="FeatureCollection",Lue="MultiPoint";function _T(e){B.call(this,null,e)}_T.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};Z(_T,B,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&Ot,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(ln(a))||o&&t.modified(ln(o))||s&&t.modified(ln(s)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,c=>n.push(a(c))),o&&s&&(t.visit(u,c=>{var f=o(c),d=s(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:ET,geometry:{type:Lue,coordinates:r}})),this.value={type:AT,features:n}}});function CT(e){B.call(this,null,e)}CT.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};Z(CT,B,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Ot,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=xT(e.projection),n.materialize().reflow()):s=i===Ot||t.modified(i.fields)?n.ADD_MOD:n.ADD;let a=Uue(r,e.pointRadius);return n.visit(s,u=>u[o]=r(i(u))),r.pointRadius(a),n.modifies(o)}});function Uue(e,t){let n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function kT(e){B.call(this,null,e)}kT.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};Z(kT,B,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],u;function l(c){let f=n([r(c),i(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function FT(e){B.call(this,null,e)}FT.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};Z(FT,B,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=zue(xT(e.projection),e.field||bn("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}});function zue(e,t,n){let r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}function RT(e){B.call(this,[],e),this.generator=EE()}RT.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};Z(RT,B,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(let o in e)Ee(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(t1(n[0],i)):t.add.push(Le(i)),n[0]=i,t}});function TT(e){B.call(this,null,e)}TT.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};Z(TT,B,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||Ot,o=que(e.opacity,e),s=Hue(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Ki(n.map(l=>Ki(i(l).values))):0};return n.forEach(l=>{let c=i(l),f=ve({},l,u);r||(f.$max=Ki(c.values||[])),l[a]=Gue(c,f,s.dep?s:St(s(f)),o.dep?o:St(o(f)))}),t.reflow(!0).modifies(a)}});function Hue(e,t){let n;return Ee(e)?(n=r=>ro(e(r,t)),n.dep=L4(e)):n=St(ro(e||"#888")),n}function que(e,t){let n;return Ee(e)?(n=r=>e(r,t),n.dep=L4(e)):e?n=St(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function L4(e){if(!Ee(e))return!1;let t=Jt(ln(e));return t.$x||t.$y||t.$value||t.$max}function Gue(e,t,n,r){let i=e.width,o=e.height,s=e.x1||0,a=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,f=c?g=>c[g]:To,d=no(u-s,l-a),p=d.getContext("2d"),m=p.getImageData(0,0,u-s,l-a),h=m.data;for(let g=a,y=0;g<l;++g){t.$y=g-a;for(let x=s,b=g*i;x<u;++x,y+=4){t.$x=x-s,t.$value=f(x+b);let E=n(t);h[y+0]=E.r,h[y+1]=E.g,h[y+2]=E.b,h[y+3]=~~(255*r(t))}}return p.putImageData(m,0,0),d}function U4(e){B.call(this,null,e),this.modified(!0)}Z(U4,B,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Wue(e.type),PE.forEach(r=>{e[r]!=null&&N4(n,r,e[r])})):PE.forEach(r=>{e.modified(r)&&N4(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&jue(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function jue(e,t){let n=Vue(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Wue(e){let t=p0((e||"mercator").toLowerCase());return t||U("Unrecognized projection type: "+e),t()}function N4(e,t,n){Ee(e[t])&&e[t](n)}function Vue(e){return e=Q(e),e.length===1?e[0]:{type:AT,features:e.reduce((t,n)=>t.concat(Yue(n)),[])}}function Yue(e){return e.type===AT?e.features:Q(e).filter(t=>t!=null).map(t=>t.type===ET?t:{type:ET,geometry:t})}var jT={};er(jT,{force:()=>GT});function MT(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,s=n.length,a,u=0,l=0;for(o=0;o<s;++o)a=n[o],u+=a.x,l+=a.y;for(u=(u/s-e)*r,l=(l/s-t)*r,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=l}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function z4(e){let t=+this._x.call(null,e),n=+this._y.call(null,e);return H4(this.cover(t,n),t,n,e)}function H4(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,s={data:r},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,p,m,h,g,y,x;if(!o)return e._root=s,e;for(;o.length;)if((h=t>=(f=(a+l)/2))?a=f:l=f,(g=n>=(d=(u+c)/2))?u=d:c=d,i=o,!(o=o[y=g<<1|h]))return i[y]=s,e;if(p=+e._x.call(null,o.data),m=+e._y.call(null,o.data),t===p&&n===m)return s.next=o,i?i[y]=s:e._root=s,e;do i=i?i[y]=new Array(4):e._root=new Array(4),(h=t>=(f=(a+l)/2))?a=f:l=f,(g=n>=(d=(u+c)/2))?u=d:c=d;while((y=g<<1|h)===(x=(m>=d)<<1|p>=f));return i[x]=o,i[y]=s,e}function q4(e){var t,n,r=e.length,i,o,s=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)H4(this,s[n],a[n],e[n]);return this}function G4(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s=i-n||1,a=this._root,u,l;n>e||e>=i||r>t||t>=o;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=a,a=u,s*=2,l){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function j4(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function W4(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Sn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function V4(e,t,n){var r,i=this._x0,o=this._y0,s,a,u,l,c=this._x1,f=this._y1,d=[],p=this._root,m,h;for(p&&d.push(new Sn(p,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);m=d.pop();)if(!(!(p=m.node)||(s=m.x0)>c||(a=m.y0)>f||(u=m.x1)<i||(l=m.y1)<o))if(p.length){var g=(s+u)/2,y=(a+l)/2;d.push(new Sn(p[3],g,y,u,l),new Sn(p[2],s,y,g,l),new Sn(p[1],g,a,u,y),new Sn(p[0],s,a,g,y)),(h=(t>=y)<<1|e>=g)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-h],d[d.length-1-h]=m)}else{var x=e-+this._x.call(null,p.data),b=t-+this._y.call(null,p.data),E=x*x+b*b;if(E<n){var v=Math.sqrt(n=E);i=e-v,o=t-v,c=e+v,f=t+v,r=p.data}}return r}function Y4(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,s=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,p,m,h,g,y;if(!n)return this;if(n.length)for(;;){if((m=c>=(d=(s+u)/2))?s=d:u=d,(h=f>=(p=(a+l)/2))?a=p:l=p,t=n,!(n=n[g=h<<1|m]))return this;if(!n.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(r=t,y=g)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[g]=o:delete t[g],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=o,this)}function X4(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function K4(){return this._root}function Q4(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function J4(e){var t=[],n,r=this._root,i,o,s,a,u;for(r&&t.push(new Sn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&r.length){var l=(o+a)/2,c=(s+u)/2;(i=r[3])&&t.push(new Sn(i,l,c,a,u)),(i=r[2])&&t.push(new Sn(i,o,c,l,u)),(i=r[1])&&t.push(new Sn(i,l,s,a,c)),(i=r[0])&&t.push(new Sn(i,o,s,l,c))}return this}function Z4(e){var t=[],n=[],r;for(this._root&&t.push(new Sn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,u=r.x1,l=r.y1,c=(s+u)/2,f=(a+l)/2;(o=i[0])&&t.push(new Sn(o,s,a,c,f)),(o=i[1])&&t.push(new Sn(o,c,a,u,f)),(o=i[2])&&t.push(new Sn(o,s,f,c,l)),(o=i[3])&&t.push(new Sn(o,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function eU(e){return e[0]}function tU(e){return arguments.length?(this._x=e,this):this._x}function nU(e){return e[1]}function rU(e){return arguments.length?(this._y=e,this):this._y}function Hc(e,t,n){var r=new NT(t??eU,n??nU,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function NT(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function iU(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ur=Hc.prototype=NT.prototype;Ur.copy=function(){var e=new NT(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=iU(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=iU(r));return e};Ur.add=z4;Ur.addAll=q4;Ur.cover=G4;Ur.data=j4;Ur.extent=W4;Ur.find=V4;Ur.remove=Y4;Ur.removeAll=X4;Ur.root=K4;Ur.size=Q4;Ur.visit=J4;Ur.visitAfter=Z4;Ur.x=tU;Ur.y=rU;function rn(e){return function(){return e}}function jo(e){return(e()-.5)*1e-6}function Xue(e){return e.x+e.vx}function Kue(e){return e.y+e.vy}function OT(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=rn(e==null?1:+e));function s(){for(var l,c=t.length,f,d,p,m,h,g,y=0;y<o;++y)for(f=Hc(t,Xue,Kue).visitAfter(a),l=0;l<c;++l)d=t[l],h=n[d.index],g=h*h,p=d.x+d.vx,m=d.y+d.vy,f.visit(x);function x(b,E,v,S,w){var _=b.data,A=b.r,F=h+A;if(_){if(_.index>d.index){var R=p-_.x-_.vx,D=m-_.y-_.vy,O=R*R+D*D;O<F*F&&(R===0&&(R=jo(r),O+=R*R),D===0&&(D=jo(r),O+=D*D),O=(F-(O=Math.sqrt(O)))/O*i,d.vx+=(R*=O)*(F=(A*=A)/(g+A)),d.vy+=(D*=O)*F,_.vx-=R*(F=1-F),_.vy-=D*F)}return}return E>p+F||S<p-F||v>m+F||w<m-F}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return s.initialize=function(l,c){t=l,r=c,u()},s.iterations=function(l){return arguments.length?(o=+l,s):o},s.strength=function(l){return arguments.length?(i=+l,s):i},s.radius=function(l){return arguments.length?(e=typeof l=="function"?l:rn(+l),u(),s):e},s}function Que(e){return e.index}function oU(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function IT(e){var t=Que,n=f,r,i=rn(30),o,s,a,u,l,c=1;e==null&&(e=[]);function f(g){return 1/Math.min(a[g.source.index],a[g.target.index])}function d(g){for(var y=0,x=e.length;y<c;++y)for(var b=0,E,v,S,w,_,A,F;b<x;++b)E=e[b],v=E.source,S=E.target,w=S.x+S.vx-v.x-v.vx||jo(l),_=S.y+S.vy-v.y-v.vy||jo(l),A=Math.sqrt(w*w+_*_),A=(A-o[b])/A*g*r[b],w*=A,_*=A,S.vx-=w*(F=u[b]),S.vy-=_*F,v.vx+=w*(F=1-F),v.vy+=_*F}function p(){if(s){var g,y=s.length,x=e.length,b=new Map(s.map((v,S)=>[t(v,S,s),v])),E;for(g=0,a=new Array(y);g<x;++g)E=e[g],E.index=g,typeof E.source!="object"&&(E.source=oU(b,E.source)),typeof E.target!="object"&&(E.target=oU(b,E.target)),a[E.source.index]=(a[E.source.index]||0)+1,a[E.target.index]=(a[E.target.index]||0)+1;for(g=0,u=new Array(x);g<x;++g)E=e[g],u[g]=a[E.source.index]/(a[E.source.index]+a[E.target.index]);r=new Array(x),m(),o=new Array(x),h()}}function m(){if(s)for(var g=0,y=e.length;g<y;++g)r[g]=+n(e[g],g,e)}function h(){if(s)for(var g=0,y=e.length;g<y;++g)o[g]=+i(e[g],g,e)}return d.initialize=function(g,y){s=g,l=y,p()},d.links=function(g){return arguments.length?(e=g,p(),d):e},d.id=function(g){return arguments.length?(t=g,d):t},d.iterations=function(g){return arguments.length?(c=+g,d):c},d.strength=function(g){return arguments.length?(n=typeof g=="function"?g:rn(+g),m(),d):n},d.distance=function(g){return arguments.length?(i=typeof g=="function"?g:rn(+g),h(),d):i},d}var Jue={value:()=>{}};function aU(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new $E(n)}function $E(e){this._=e}function Zue(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}$E.prototype=aU.prototype={constructor:$E,on:function(e,t){var n=this._,r=Zue(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=ele(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=sU(n[i],e.name,t);else if(t==null)for(i in n)n[i]=sU(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $E(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function ele(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function sU(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Jue,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var PT=aU;var ep=0,h0=0,m0=0,lU=1e3,BE,g0,LE=0,qc=0,UE=0,y0=typeof performance=="object"&&performance.now?performance:Date,cU=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function b0(){return qc||(cU(tle),qc=y0.now()+UE)}function tle(){qc=0}function x0(){this._call=this._time=this._next=null}x0.prototype=zE.prototype={constructor:x0,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?b0():+n)+(t==null?0:+t),!this._next&&g0!==this&&(g0?g0._next=this:BE=this,g0=this),this._call=e,this._time=n,$T()},stop:function(){this._call&&(this._call=null,this._time=1/0,$T())}};function zE(e,t,n){var r=new x0;return r.restart(e,t,n),r}function fU(){b0(),++ep;for(var e=BE,t;e;)(t=qc-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ep}function uU(){qc=(LE=y0.now())+UE,ep=h0=0;try{fU()}finally{ep=0,rle(),qc=0}}function nle(){var e=y0.now(),t=e-LE;t>lU&&(UE-=t,LE=e)}function rle(){for(var e,t=BE,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:BE=n);g0=e,$T(r)}function $T(e){if(!ep){h0&&(h0=clearTimeout(h0));var t=e-qc;t>24?(e<1/0&&(h0=setTimeout(uU,e-y0.now()-UE)),m0&&(m0=clearInterval(m0))):(m0||(LE=y0.now(),m0=setInterval(nle,lU)),ep=1,cU(uU))}}function BT(e,t,n){var r=new x0,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?b0():+a,r._restart(function u(l){l+=i,r._restart(u,i+=s,a),o(l)},s,a)},r.restart(e,t,n),r)}function dU(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function pU(e){return e.x}function mU(e){return e.y}var ile=10,ole=Math.PI*(3-Math.sqrt(5));function LT(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=zE(f),l=PT("tick","end"),c=dU();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(h){var g,y=e.length,x;h===void 0&&(h=1);for(var b=0;b<h;++b)for(n+=(o-n)*i,a.forEach(function(E){E(n)}),g=0;g<y;++g)x=e[g],x.fx==null?x.x+=x.vx*=s:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=s:(x.y=x.fy,x.vy=0);return t}function p(){for(var h=0,g=e.length,y;h<g;++h){if(y=e[h],y.index=h,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var x=ile*Math.sqrt(.5+h),b=h*ole;y.x=x*Math.cos(b),y.y=x*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function m(h){return h.initialize&&h.initialize(e,c),h}return p(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(h){return arguments.length?(e=h,p(),a.forEach(m),t):e},alpha:function(h){return arguments.length?(n=+h,t):n},alphaMin:function(h){return arguments.length?(r=+h,t):r},alphaDecay:function(h){return arguments.length?(i=+h,t):+i},alphaTarget:function(h){return arguments.length?(o=+h,t):o},velocityDecay:function(h){return arguments.length?(s=1-h,t):1-s},randomSource:function(h){return arguments.length?(c=h,a.forEach(m),t):c},force:function(h,g){return arguments.length>1?(g==null?a.delete(h):a.set(h,m(g)),t):a.get(h)},find:function(h,g,y){var x=0,b=e.length,E,v,S,w,_;for(y==null?y=1/0:y*=y,x=0;x<b;++x)w=e[x],E=h-w.x,v=g-w.y,S=E*E+v*v,S<y&&(_=w,y=S);return _},on:function(h,g){return arguments.length>1?(l.on(h,g),t):l.on(h)}}}function UT(){var e,t,n,r,i=rn(-30),o,s=1,a=1/0,u=.81;function l(p){var m,h=e.length,g=Hc(e,pU,mU).visitAfter(f);for(r=p,m=0;m<h;++m)t=e[m],g.visit(d)}function c(){if(e){var p,m=e.length,h;for(o=new Array(m),p=0;p<m;++p)h=e[p],o[h.index]=+i(h,p,e)}}function f(p){var m=0,h,g,y=0,x,b,E;if(p.length){for(x=b=E=0;E<4;++E)(h=p[E])&&(g=Math.abs(h.value))&&(m+=h.value,y+=g,x+=g*h.x,b+=g*h.y);p.x=x/y,p.y=b/y}else{h=p,h.x=h.data.x,h.y=h.data.y;do m+=o[h.data.index];while(h=h.next)}p.value=m}function d(p,m,h,g){if(!p.value)return!0;var y=p.x-t.x,x=p.y-t.y,b=g-m,E=y*y+x*x;if(b*b/u<E)return E<a&&(y===0&&(y=jo(n),E+=y*y),x===0&&(x=jo(n),E+=x*x),E<s&&(E=Math.sqrt(s*E)),t.vx+=y*p.value*r/E,t.vy+=x*p.value*r/E),!0;if(p.length||E>=a)return;(p.data!==t||p.next)&&(y===0&&(y=jo(n),E+=y*y),x===0&&(x=jo(n),E+=x*x),E<s&&(E=Math.sqrt(s*E)));do p.data!==t&&(b=o[p.data.index]*r/E,t.vx+=y*b,t.vy+=x*b);while(p=p.next)}return l.initialize=function(p,m){e=p,n=m,c()},l.strength=function(p){return arguments.length?(i=typeof p=="function"?p:rn(+p),c(),l):i},l.distanceMin=function(p){return arguments.length?(s=p*p,l):Math.sqrt(s)},l.distanceMax=function(p){return arguments.length?(a=p*p,l):Math.sqrt(a)},l.theta=function(p){return arguments.length?(u=p*p,l):Math.sqrt(u)},l}function zT(e){var t=rn(.1),n,r,i;typeof e!="function"&&(e=rn(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:rn(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:rn(+a),s(),o):e},o}function HT(e){var t=rn(.1),n,r,i;typeof e!="function"&&(e=rn(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:rn(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:rn(+a),s(),o):e},o}var hU={center:MT,collide:OT,nbody:UT,link:IT,x:zT,y:HT},E0="forces",qT=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],sle=["static","iterations"],gU=["x","y","vx","vy"];function GT(e){B.call(this,null,e)}GT.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:gU}]};Z(GT,B,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(qT),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&yU(n,e,0,t)):(this.value=n=ule(t.source,e),n.on("tick",ale(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(sle)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){let n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==E0||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,s;i<o;++i)if(r[i].name==="links"&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(gU)}});function ale(e,t){return()=>e.touch(t).run()}function ule(e,t){let n=LT(e),r=n.stop,i=n.restart,o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),yU(n,t,!0).on("end",()=>o=!0)}function yU(e,t,n,r){var i=Q(t.forces),o,s,a,u;for(o=0,s=qT.length;o<s;++o)a=qT[o],a!==E0&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)u=E0+o,a=n||t.modified(E0,o)?cle(i[o]):r&&lle(i[o],r)?e.force(u):null,a&&e.force(u,a);for(s=e.numForces||0;o<s;++o)e.force(E0+o,null);return e.numForces=i.length,e}function lle(e,t){var n,r;for(n in e)if(Ee(r=e[n])&&t.modified(ln(r)))return 1;return 0}function cle(e){var t,n;ee(hU,e.force)||U("Unrecognized force: "+e.force),t=hU[e.force]();for(n in e)Ee(t[n])&&fle(t[n],e[n],e);return t}function fle(e,t,n){e(Ee(t)?r=>t(r,n):t)}var wD={};er(wD,{nest:()=>hD,pack:()=>gD,partition:()=>yD,stratify:()=>xD,tree:()=>bD,treelinks:()=>ED,treemap:()=>vD});function dle(e,t){return e.parent===t.parent?1:2}function ple(e){return e.reduce(mle,0)/e.length}function mle(e,t){return e+t.x}function hle(e){return 1+e.reduce(gle,0)}function gle(e,t){return Math.max(e,t.y)}function yle(e){for(var t;t=e.children;)e=t[0];return e}function xle(e){for(var t;t=e.children;)e=t[t.length-1];return e}function WT(){var e=dle,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(d){var p=d.children;p?(d.x=ple(p),d.y=hle(p)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var u=yle(o),l=xle(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function ble(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function xU(){return this.eachAfter(ble)}function bU(e,t){let n=-1;for(let r of this)e.call(t,r,++n,this);return this}function EU(e,t){for(var n=this,r=[n],i,o,s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function vU(e,t){for(var n=this,r=[n],i=[],o,s,a,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function wU(e,t){let n=-1;for(let r of this)if(e.call(t,r,++n,this))return r}function SU(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function AU(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function _U(e){for(var t=this,n=Ele(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Ele(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function CU(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function kU(){return Array.from(this)}function FU(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function RU(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*TU(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function tp(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Sle)):t===void 0&&(t=wle);for(var n=new Wa(e),r,i=[n],o,s,a,u;r=i.pop();)if((s=t(r.data))&&(u=(s=Array.from(s)).length))for(r.children=s,a=u-1;a>=0;--a)i.push(o=s[a]=new Wa(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(VT)}function vle(){return tp(this).eachBefore(Ale)}function wle(e){return e.children}function Sle(e){return Array.isArray(e)?e[1]:null}function Ale(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function VT(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Wa(e){this.data=e,this.depth=this.height=0,this.parent=null}Wa.prototype=tp.prototype={constructor:Wa,count:xU,each:bU,eachAfter:vU,eachBefore:EU,find:wU,sum:SU,sort:AU,path:_U,ancestors:CU,descendants:kU,leaves:FU,links:RU,copy:vle,[Symbol.iterator]:TU};function np(e){return e==null?null:YT(e)}function YT(e){if(typeof e!="function")throw new Error;return e}function Va(){return 0}function ml(e){return function(){return e}}function DU(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function MU(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function NU(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function OU(e,t){for(var n=0,r=(e=NU(Array.from(e),t)).length,i=[],o,s;n<r;)o=e[n],s&&IU(s,o)?++n:(s=Cle(i=_le(i,o)),n=0);return s}function _le(e,t){var n,r;if(XT(t,e))return[t];for(n=0;n<e.length;++n)if(HE(t,e[n])&&XT(v0(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(HE(v0(e[n],e[r]),t)&&HE(v0(e[n],t),e[r])&&HE(v0(e[r],t),e[n])&&XT(PU(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function HE(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function IU(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function XT(e,t){for(var n=0;n<t.length;++n)if(!IU(e,t[n]))return!1;return!0}function Cle(e){switch(e.length){case 1:return kle(e[0]);case 2:return v0(e[0],e[1]);case 3:return PU(e[0],e[1],e[2])}}function kle(e){return{x:e.x,y:e.y,r:e.r}}function v0(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,u=o-n,l=s-r,c=a-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+s+l/f*c)/2,r:(f+i+a)/2}}function PU(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-s,p=r-l,m=i-a,h=i-c,g=u-o,y=f-o,x=r*r+i*i-o*o,b=x-s*s-a*a+u*u,E=x-l*l-c*c+f*f,v=p*m-d*h,S=(m*E-h*b)/(v*2)-r,w=(h*g-m*y)/v,_=(p*b-d*E)/(v*2)-i,A=(d*y-p*g)/v,F=w*w+A*A-1,R=2*(o+S*w+_*A),D=S*S+_*_-o*o,O=-(Math.abs(F)>1e-6?(R+Math.sqrt(R*R-4*F*D))/(2*F):D/R);return{x:r+S+w*O,y:i+_+A*O,r:O}}function $U(e,t,n){var r=e.x-t.x,i,o,s=e.y-t.y,a,u,l=r*r+s*s;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(i=(l+u-o)/(2*l),a=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(l+o-u)/(2*l),a=Math.sqrt(Math.max(0,o/l-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function BU(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function LU(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function qE(e){this._=e,this.next=null,this.previous=null}function UU(e,t){if(!(o=(e=MU(e)).length))return 0;var n,r,i,o,s,a,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;$U(r,n,i=e[2]),n=new qE(n),r=new qE(r),i=new qE(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(u=3;u<o;++u){$U(n._,r._,i=e[u]),i=new qE(i),l=r.next,c=n.previous,f=r._.r,d=n._.r;do if(f<=d){if(BU(l._,i._)){r=l,n.next=r,r.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(BU(c._,i._)){n=c,n.next=r,r.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,s=LU(n);(i=i.next)!==r;)(a=LU(i))<s&&(n=i,s=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=OU(n,t),u=0;u<o;++u)n=e[u],n.x-=i.x,n.y-=i.y;return i.r}function Fle(e){return Math.sqrt(e.value)}function QT(){var e=null,t=1,n=1,r=Va;function i(o){let s=DU();return o.x=t/2,o.y=n/2,e?o.eachBefore(zU(e)).eachAfter(KT(r,.5,s)).eachBefore(HU(1)):o.eachBefore(zU(Fle)).eachAfter(KT(Va,1,s)).eachAfter(KT(r,o.r/Math.min(t,n),s)).eachBefore(HU(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=np(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:ml(+o),i):r},i}function zU(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function KT(e,t,n){return function(r){if(i=r.children){var i,o,s=i.length,a=e(r)*t||0,u;if(a)for(o=0;o<s;++o)i[o].r+=a;if(u=UU(i,n),a)for(o=0;o<s;++o)i[o].r-=a;r.r=u+a}}}function HU(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function GE(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Wo(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(r-t)/e.value;++a<u;)s=o[a],s.y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*l}function JT(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),r&&s.eachBefore(GE),s}function o(s,a){return function(u){u.children&&Wo(u,u.x0,s*(u.depth+1)/a,u.x1,s*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i}var Rle={depth:-1},qU={},ZT={};function Tle(e){return e.id}function Dle(e){return e.parentId}function jE(){var e=Tle,t=Dle,n;function r(i){var o=Array.from(i),s=e,a=t,u,l,c,f,d,p,m,h,g=new Map;if(n!=null){let y=o.map((E,v)=>Mle(n(E,v,i))),x=y.map(GU),b=new Set(y).add("");for(let E of x)b.has(E)||(b.add(E),y.push(E),x.push(GU(E)),o.push(ZT));s=(E,v)=>y[v],a=(E,v)=>x[v]}for(c=0,u=o.length;c<u;++c)l=o[c],p=o[c]=new Wa(l),(m=s(l,c,i))!=null&&(m+="")&&(h=p.id=m,g.set(h,g.has(h)?qU:p)),(m=a(l,c,i))!=null&&(m+="")&&(p.parent=m);for(c=0;c<u;++c)if(p=o[c],m=p.parent){if(d=g.get(m),!d)throw new Error("missing: "+m);if(d===qU)throw new Error("ambiguous: "+m);d.children?d.children.push(p):d.children=[p],p.parent=d}else{if(f)throw new Error("multiple roots");f=p}if(!f)throw new Error("no root");if(n!=null){for(;f.data===ZT&&f.children.length===1;)f=f.children[0],--u;for(let y=o.length-1;y>=0&&(p=o[y],p.data===ZT);--y)p.data=null}if(f.parent=Rle,f.eachBefore(function(y){y.depth=y.parent.depth+1,--u}).eachBefore(VT),f.parent=null,u>0)throw new Error("cycle");return f}return r.id=function(i){return arguments.length?(e=np(i),r):e},r.parentId=function(i){return arguments.length?(t=np(i),r):t},r.path=function(i){return arguments.length?(n=np(i),r):n},r}function Mle(e){e=`${e}`;let t=e.length;return eD(e,t-1)&&!eD(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function GU(e){let t=e.length;if(t<2)return"";for(;--t>1&&!eD(e,t););return e.slice(0,t)}function eD(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function Nle(e,t){return e.parent===t.parent?1:2}function tD(e){var t=e.children;return t?t[0]:e.t}function nD(e){var t=e.children;return t?t[t.length-1]:e.t}function Ole(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Ile(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function Ple(e,t,n){return e.a.parent===t.parent?e.a:n}function WE(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}WE.prototype=Object.create(Wa.prototype);function $le(e){for(var t=new WE(e,0),n,r=[t],i,o,s,a;n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new WE(o[s],s)),i.parent=n;return(t.parent=new WE(null,0)).children=[t],t}function rD(){var e=Nle,t=1,n=1,r=null;function i(l){var c=$le(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)l.eachBefore(u);else{var f=l,d=l,p=l;l.eachBefore(function(x){x.x<f.x&&(f=x),x.x>d.x&&(d=x),x.depth>p.depth&&(p=x)});var m=f===d?1:e(f,d)/2,h=m-f.x,g=t/(d.x+m+h),y=n/(p.depth||1);l.eachBefore(function(x){x.x=(x.x+h)*g,x.y=x.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Ile(l);var p=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-p):l.z=p}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,p=l,m=c,h=d.parent.children[0],g=d.m,y=p.m,x=m.m,b=h.m,E;m=nD(m),d=tD(d),m&&d;)h=tD(h),p=nD(p),p.a=l,E=m.z+x-d.z-g+e(m._,d._),E>0&&(Ole(Ple(m,l,f),l,E),g+=E,y+=E),x+=m.m,g+=d.m,b+=h.m,y+=p.m;m&&!nD(p)&&(p.t=m,p.m+=x-y),d&&!tD(h)&&(h.t=d,h.m+=g-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function Ya(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(i-n)/e.value;++a<u;)s=o[a],s.x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*l}var iD=(1+Math.sqrt(5))/2;function oD(e,t,n,r,i,o){for(var s=[],a=t.children,u,l,c=0,f=0,d=a.length,p,m,h=t.value,g,y,x,b,E,v,S;c<d;){p=i-n,m=o-r;do g=a[f++].value;while(!g&&f<d);for(y=x=g,v=Math.max(m/p,p/m)/(h*e),S=g*g*v,E=Math.max(x/S,S/y);f<d;++f){if(g+=l=a[f].value,l<y&&(y=l),l>x&&(x=l),S=g*g*v,b=Math.max(x/S,S/y),b>E){g-=l;break}E=b}s.push(u={value:g,dice:p<m,children:a.slice(c,f)}),u.dice?Wo(u,n,r,i,h?r+=m*g/h:o):Ya(u,n,r,h?n+=p*g/h:i,o),h-=g,c=f}return s}var w0=function e(t){function n(r,i,o,s,a){oD(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(iD);function sD(){var e=w0,t=!1,n=1,r=1,i=[0],o=Va,s=Va,a=Va,u=Va,l=Va;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(GE),d}function f(d){var p=i[d.depth],m=d.x0+p,h=d.y0+p,g=d.x1-p,y=d.y1-p;g<m&&(m=g=(m+g)/2),y<h&&(h=y=(h+y)/2),d.x0=m,d.y0=h,d.x1=g,d.y1=y,d.children&&(p=i[d.depth+1]=o(d)/2,m+=l(d)-p,h+=s(d)-p,g-=a(d)-p,y-=u(d)-p,g<m&&(m=g=(m+g)/2),y<h&&(h=y=(h+y)/2),e(d,m,h,g,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=YT(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:ml(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s=typeof d=="function"?d:ml(+d),c):s},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:ml(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:ml(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:ml(+d),c):l},c}function aD(e,t,n,r,i){var o=e.children,s,a=o.length,u,l=new Array(a+1);for(l[0]=u=s=0;s<a;++s)l[s+1]=u+=o[s].value;c(0,a,e.value,t,n,r,i);function c(f,d,p,m,h,g,y){if(f>=d-1){var x=o[f];x.x0=m,x.y0=h,x.x1=g,x.y1=y;return}for(var b=l[f],E=p/2+b,v=f+1,S=d-1;v<S;){var w=v+S>>>1;l[w]<E?v=w+1:S=w}E-l[v-1]<l[v]-E&&f+1<v&&--v;var _=l[v]-b,A=p-_;if(g-m>y-h){var F=p?(m*A+g*_)/p:g;c(f,v,_,m,h,F,y),c(v,d,A,F,h,g,y)}else{var R=p?(h*A+y*_)/p:y;c(f,v,_,m,h,g,R),c(v,d,A,m,R,g,y)}}}function uD(e,t,n,r,i){(e.depth&1?Ya:Wo)(e,t,n,r,i)}var lD=function e(t){function n(r,i,o,s,a){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,p,m=u.length,h=r.value;++d<m;){for(l=u[d],c=l.children,f=l.value=0,p=c.length;f<p;++f)l.value+=c[f].value;l.dice?Wo(l,i,o,s,h?o+=(a-o)*l.value/h:a):Ya(l,i,o,h?i+=(s-i)*l.value/h:s,a),h-=l.value}else r._squarify=u=oD(t,r,i,o,s,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(iD);function cD(e,t,n){let r={};return e.each(i=>{let o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function hD(e){B.call(this,null,e)}hD.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};var Ble=e=>e.values;Z(hD,B,{transform(e,t){t.source||U("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&ac(s.data)&&i.rem.push(s.data)}),this.value=o=tp({values:Q(e.keys).reduce((s,a)=>(s.key(a),s),Lle()).entries(i.source)},Ble),n&&o.each(s=>{s.children&&(s=Le(s.data),i.add.push(s),i.source.push(s))}),cD(o,he,he)),i.source.root=o,i}});function Lle(){let e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;let s=i.length,a=e[o++],u={},l={},c=-1,f,d,p;for(;++c<s;)f=a(d=i[c])+"",(p=u[f])?p.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function r(i,o){if(++o>e.length)return i;let s=[];for(let a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function Xa(e){B.call(this,null,e)}var Ule=(e,t)=>e.parent===t.parent?1:2;Z(Xa,B,{transform(e,t){(!t.source||!t.source.root)&&U(this.constructor.name+" transform requires a backing tree data source.");let n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(Is(e.sort,s=>s.data)),zle(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Ule:Rs);try{this.value=n(i)}catch(s){U(s)}return i.each(s=>Hle(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function zle(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function Hle(e,t,n){let r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}var fD=["x","y","r","depth","children"];function gD(e){Xa.call(this,e)}gD.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:fD.length,default:fD}]};Z(gD,Xa,{layout:QT,params:["radius","size","padding"],fields:fD});var dD=["x0","y0","x1","y1","depth","children"];function yD(e){Xa.call(this,e)}yD.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:dD.length,default:dD}]};Z(yD,Xa,{layout:JT,params:["size","round","padding"],fields:dD});function xD(e){B.call(this,null,e)}xD.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};Z(xD,B,{transform(e,t){t.source||U("Stratify transform requires an upstream data source.");let n=this.value,r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?cD(jE().id(e.key).parentId(e.parentKey)(i.source),e.key,cn):cD(jE()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});var jU={tidy:rD,cluster:WT},pD=["x","y","depth","children"];function bD(e){Xa.call(this,e)}bD.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:pD.length,default:pD}]};Z(bD,Xa,{layout(e){let t=e||"tidy";if(ee(jU,t))return jU[t]();U("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:pD});function ED(e){B.call(this,[],e)}ED.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};Z(ED,B,{transform(e,t){let n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||U("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[he(s)]=1),r.each(s=>{let a=s.data,u=s.parent&&s.parent.data;u&&o[he(a)]&&o[he(u)]&&i.add.push(Le({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[he(s)]=1),n.forEach(s=>{(o[he(s.source)]||o[he(s.target)])&&i.mod.push(s)})),i}});var WU={binary:aD,dice:Wo,slice:Ya,slicedice:uD,squarify:w0,resquarify:lD},mD=["x0","y0","x1","y1","depth","children"];function vD(e){Xa.call(this,e)}vD.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:mD.length,default:mD}]};Z(vD,Xa,{layout(){let e=sD();return e.ratio=t=>{let n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ee(WU,t)?e.tile(WU[t]):U("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:mD});var ND={};er(ND,{label:()=>MD});var SD=4278190080;function qle(e,t){let n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Gle(e,t,n,r,i){let o=e.width,s=e.height,a=r||i,u=no(o,s).getContext("2d"),l=no(o,s).getContext("2d"),c=a&&no(o,s).getContext("2d");n.forEach(_=>VE(u,_,!1)),VE(l,t,!1),a&&VE(c,t,!0);let f=AD(u,o,s),d=AD(l,o,s),p=a&&AD(c,o,s),m=e.bitmap(),h=a&&e.bitmap(),g,y,x,b,E,v,S,w;for(y=0;y<s;++y)for(g=0;g<o;++g)E=y*o+g,v=f[E]&SD,w=d[E]&SD,S=a&&p[E]&SD,(v||S||w)&&(x=e(g),b=e(y),!i&&(v||w)&&m.set(x,b),a&&(v||S)&&h.set(x,b));return[m,h]}function AD(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function VE(e,t,n){if(!t.length)return;let r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>VE(e,o.items,n))}):Ir[r].draw(e,{items:n?t.map(jle):t})}function jle(e){let t=uc(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}var Ka=5,zr=31,S0=32,hl=new Uint32Array(S0+1),Vo=new Uint32Array(S0+1);Vo[0]=0;hl[0]=~Vo[0];for(let e=1;e<=S0;++e)Vo[e]=Vo[e-1]<<1|1,hl[e]=~Vo[e];function Wle(e,t){let n=new Uint32Array(~~((e*t+S0)/S0));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{let a=s*e+o;return n[a>>>Ka]&1<<(a&zr)},set:(o,s)=>{let a=s*e+o;r(a>>>Ka,1<<(a&zr))},clear:(o,s)=>{let a=s*e+o;i(a>>>Ka,~(1<<(a&zr)))},getRange:(o,s,a,u)=>{let l=u,c,f,d,p;for(;l>=s;--l)if(c=l*e+o,f=l*e+a,d=c>>>Ka,p=f>>>Ka,d===p){if(n[d]&hl[c&zr]&Vo[(f&zr)+1])return!0}else{if(n[d]&hl[c&zr]||n[p]&Vo[(f&zr)+1])return!0;for(let m=d+1;m<p;++m)if(n[m])return!0}return!1},setRange:(o,s,a,u)=>{let l,c,f,d,p;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Ka,d=c>>>Ka,f===d)r(f,hl[l&zr]&Vo[(c&zr)+1]);else for(r(f,hl[l&zr]),r(d,Vo[(c&zr)+1]),p=f+1;p<d;++p)r(p,4294967295)},clearRange:(o,s,a,u)=>{let l,c,f,d,p;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Ka,d=c>>>Ka,f===d)i(f,Vo[l&zr]|hl[(c&zr)+1]);else for(i(f,Vo[l&zr]),i(d,hl[(c&zr)+1]),p=f+1;p<d;++p)i(p,0)},outOfBounds:(o,s,a,u)=>o<0||s<0||u>=t||a>=e}}function Vle(e,t,n){let r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>Wle(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}function Yle(e,t,n,r){let i=e.width,o=e.height;return function(s){let a=s.datum.datum.items[r].items,u=a.length,l=s.datum.fontSize,c=ii.width(s.datum,s.datum.text),f=0,d,p,m,h,g,y,x;for(let b=0;b<u;++b)d=a[b].x,m=a[b].y,p=a[b].x2===void 0?d:a[b].x2,h=a[b].y2===void 0?m:a[b].y2,g=(d+p)/2,y=(m+h)/2,x=Math.abs(p-d+h-m),x>=f&&(f=x,s.x=g,s.y=y);return g=c/2,y=l/2,d=s.x-g,p=s.x+g,m=s.y-y,h=s.y+y,s.align="center",d<0&&p<=i?s.align="left":0<=d&&i<p&&(s.align="right"),s.baseline="middle",m<0&&h<=o?s.baseline="top":0<=m&&o<h&&(s.baseline="bottom"),!0}}function YE(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function gl(e,t,n,r,i,o,s,a){let u=i*o/(r*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return s.outOfBounds(l,f,c,d)||s.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function Xle(e,t,n,r){let i=e.width,o=e.height,s=t[0],a=t[1];function u(l,c,f,d,p){let m=e.invert(l),h=e.invert(c),g=f,y=o,x;if(!YE(m,h,d,p,i,o)&&!gl(e,m,h,p,d,g,s,a)&&!gl(e,m,h,p,d,p,s,null)){for(;y-g>=1;)x=(g+y)/2,gl(e,m,h,p,d,x,s,a)?y=x:g=x;if(g>f)return[m,h,g,!0]}}return function(l){let c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,p=ii.width(l.datum,l.datum.text),m=n?d:0,h=!1,g=!1,y=0,x,b,E,v,S,w,_,A,F,R,D,O,T,k,C,N,I;for(let L=0;L<f;++L){for(x=c[L].x,E=c[L].y,b=c[L].x2===void 0?x:c[L].x2,v=c[L].y2===void 0?E:c[L].y2,x>b&&(I=x,x=b,b=I),E>v&&(I=E,E=v,v=I),F=e(x),D=e(b),R=~~((F+D)/2),O=e(E),k=e(v),T=~~((O+k)/2),_=R;_>=F;--_)for(A=T;A>=O;--A)N=u(_,A,m,p,d),N&&([l.x,l.y,m,h]=N);for(_=R;_<=D;++_)for(A=T;A<=k;++A)N=u(_,A,m,p,d),N&&([l.x,l.y,m,h]=N);!h&&!n&&(C=Math.abs(b-x+v-E),S=(x+b)/2,w=(E+v)/2,C>=y&&!YE(S,w,p,d,i,o)&&!gl(e,S,w,d,p,d,s,null)&&(y=C,l.x=S,l.y=w,g=!0))}return h||g?(S=p/2,w=d/2,s.setRange(e(l.x-S),e(l.y-w),e(l.x+S),e(l.y+w)),l.align="center",l.baseline="middle",!0):!1}}var Kle=[-1,-1,1,1],Qle=[-1,1,-1,1];function Jle(e,t,n,r){let i=e.width,o=e.height,s=t[0],a=t[1],u=e.bitmap();return function(l){let c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,p=ii.width(l.datum,l.datum.text),m=[],h=n?d:0,g=!1,y=!1,x=0,b,E,v,S,w,_,A,F,R,D,O,T;for(let k=0;k<f;++k){for(b=c[k].x,v=c[k].y,E=c[k].x2===void 0?b:c[k].x2,S=c[k].y2===void 0?v:c[k].y2,m.push([e((b+E)/2),e((v+S)/2)]);m.length;)if([A,F]=m.pop(),!(s.get(A,F)||a.get(A,F)||u.get(A,F))){u.set(A,F);for(let C=0;C<4;++C)w=A+Kle[C],_=F+Qle[C],u.outOfBounds(w,_,w,_)||m.push([w,_]);if(w=e.invert(A),_=e.invert(F),R=h,D=o,!YE(w,_,p,d,i,o)&&!gl(e,w,_,d,p,R,s,a)&&!gl(e,w,_,d,p,d,s,null)){for(;D-R>=1;)O=(R+D)/2,gl(e,w,_,d,p,O,s,a)?D=O:R=O;R>h&&(l.x=w,l.y=_,h=R,g=!0)}}!g&&!n&&(T=Math.abs(E-b+S-v),w=(b+E)/2,_=(v+S)/2,T>=x&&!YE(w,_,p,d,i,o)&&!gl(e,w,_,d,p,d,s,null)&&(x=T,l.x=w,l.y=_,y=!0))}return g||y?(w=p/2,_=d/2,s.setRange(e(l.x-w),e(l.y-_),e(l.x+w),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}var Zle=["right","center","left"],ece=["bottom","middle","top"];function tce(e,t,n,r){let i=e.width,o=e.height,s=t[0],a=t[1],u=r.length;return function(l){let c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d=l.textWidth??0,p,m,h,g,y,x,b,E,v,S,w,_,A,F,R;for(let D=0;D<u;++D){if(p=(n[D]&3)-1,m=(n[D]>>>2&3)-1,h=p===0&&m===0||r[D]<0,g=p&&m?Math.SQRT1_2:1,y=r[D]<0?-1:1,x=c[1+p]+r[D]*p*g,w=c[4+m]+y*f*m/2+r[D]*m*g,E=w-f/2,v=w+f/2,_=e(x),F=e(E),R=e(v),!d)if(VU(_,_,F,R,s,a,x,x,E,v,c,h))d=ii.width(l.datum,l.datum.text);else continue;if(S=x+y*d*p/2,x=S-d/2,b=S+d/2,_=e(x),A=e(b),VU(_,A,F,R,s,a,x,b,E,v,c,h))return l.x=p?p*y<0?b:x:S,l.y=m?m*y<0?v:E:w,l.align=Zle[p*y+1],l.baseline=ece[m*y+1],s.setRange(_,F,A,R),!0}return!1}}function VU(e,t,n,r,i,o,s,a,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o||i).getRange(e,n,t,r))}var _D=0,CD=4,kD=8,FD=0,RD=1,TD=2,nce={"top-left":_D+FD,top:_D+RD,"top-right":_D+TD,left:CD+FD,middle:CD+RD,right:CD+TD,"bottom-left":kD+FD,bottom:kD+RD,"bottom-right":kD+TD},rce={naive:Yle,"reduced-search":Xle,floodfill:Jle};function ice(e,t,n,r,i,o,s,a,u,l,c){if(!e.length)return e;let f=Math.max(r.length,i.length),d=oce(r,f),p=sce(i,f),m=ace(e[0].datum),h=m==="group"&&e[0].datum.items[u].marktype,g=h==="area",y=uce(m,h,a,u),x=l===null||l===1/0,b=g&&c==="naive",E=-1,v=-1,S=e.map(F=>{let R=x?ii.width(F,F.text):void 0;return E=Math.max(E,R),v=Math.max(v,F.fontSize),{datum:F,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(F),textWidth:R}});l=l===null||l===1/0?Math.max(E,v)+Math.max(...r):l;let w=Vle(t[0],t[1],l),_;if(!b){n&&S.sort((D,O)=>n(D.datum,O.datum));let F=!1;for(let D=0;D<p.length&&!F;++D)F=p[D]===5||d[D]<0;let R=(m&&s||g)&&e.map(D=>D.datum);_=o.length||R?Gle(w,R||[],o,F,g):qle(w,s&&S)}let A=g?rce[c](w,_,s,u):tce(w,_,p,d);return S.forEach(F=>F.opacity=+A(F)),S}function oce(e,t){let n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function sce(e,t){let n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=nce[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function ace(e){return e&&e.mark&&e.mark.marktype}function uce(e,t,n,r){let i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{let s=o.datum.items[r].items;return i(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{let s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}var DD=["x","y","opacity","align","baseline"],YU=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function MD(e){B.call(this,null,e)}MD.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:YU},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:DD.length,default:DD}]};Z(MD,B,{transform(e,t){function n(o){let s=e[o];return Ee(s)&&t.modified(s.fields)}let r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&U("Size parameter should be specified as a [width, height] array.");let i=e.as||DD;return ice(t.materialize(t.SOURCE).source||[],e.size,e.sort,Q(e.offset==null?1:e.offset),Q(e.anchor||YU),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{let s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});var $D={};er($D,{loess:()=>ID,regression:()=>PD});function XU(e,t){var n=[],r=function(c){return c(a)},i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function ID(e){B.call(this,null,e)}ID.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};Z(ID,B,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=t.materialize(t.SOURCE).source,i=XU(r,e.groupby),o=(e.groupby||[]).map(xt),s=o.length,a=e.as||[xt(e.x),xt(e.y)],u=[];i.forEach(l=>{EC(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{let f={};for(let d=0;d<s;++d)f[o[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(Le(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});var OD={constant:x1,linear:E1,log:gC,exp:yC,pow:xC,quad:v1,poly:bC},lce=(e,t)=>e==="poly"?t:e==="quad"?2:1;function PD(e){B.call(this,null,e)}PD.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(OD)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};Z(PD,B,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=t.materialize(t.SOURCE).source,i=XU(r,e.groupby),o=(e.groupby||[]).map(xt),s=e.method||"linear",a=e.order==null?3:e.order,u=lce(s,a),l=e.as||[xt(e.x),xt(e.y)],c=OD[s],f=[],d=e.extent;ee(OD,s)||U("Invalid regression method: "+s),d!=null&&s==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(p=>{if(p.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}let h=c(p,e.x,e.y,a);if(e.params){f.push(Le({keys:p.dims,coef:h.coef,rSquared:h.rSquared}));return}let g=d||kr(p,e.x),y=x=>{let b={};for(let E=0;E<o.length;++E)b[o[E]]=p.dims[E];b[l[0]]=x[0],b[l[1]]=x[1],f.push(Le(b))};s==="linear"||s==="constant"?g.forEach(x=>y([x,h.predict(x)])):dd(h.predict,g,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var UD={};er(UD,{voronoi:()=>LD});var je=11102230246251565e-32,on=134217729,A0=(3+8*je)*je;function Gc(e,t,n,r,i){let o,s,a,u,l=t[0],c=r[0],f=0,d=0;c>l==c>-l?(o=l,l=t[++f]):(o=c,c=r[++d]);let p=0;if(f<e&&d<n)for(c>l==c>-l?(s=l+o,a=o-(s-l),l=t[++f]):(s=c+o,a=o-(s-c),c=r[++d]),o=s,a!==0&&(i[p++]=a);f<e&&d<n;)c>l==c>-l?(s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f]):(s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d]),o=s,a!==0&&(i[p++]=a);for(;f<e;)s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f],o=s,a!==0&&(i[p++]=a);for(;d<n;)s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d],o=s,a!==0&&(i[p++]=a);return(o!==0||p===0)&&(i[p++]=o),p}function _0(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function J(e){return new Float64Array(e)}var cce=(3+16*je)*je,fce=(2+12*je)*je,dce=(9+64*je)*je*je,rp=J(4),KU=J(8),QU=J(12),JU=J(16),Hr=J(4);function pce(e,t,n,r,i,o,s){let a,u,l,c,f,d,p,m,h,g,y,x,b,E,v,S,w,_,A=e-i,F=n-i,R=t-o,D=r-o;E=A*D,d=on*A,p=d-(d-A),m=A-p,d=on*D,h=d-(d-D),g=D-h,v=m*g-(E-p*h-m*h-p*g),S=R*F,d=on*R,p=d-(d-R),m=R-p,d=on*F,h=d-(d-F),g=F-h,w=m*g-(S-p*h-m*h-p*g),y=v-w,f=v-y,rp[0]=v-(y+f)+(f-w),x=E+y,f=x-E,b=E-(x-f)+(y-f),y=b-S,f=b-y,rp[1]=b-(y+f)+(f-S),_=x+y,f=_-x,rp[2]=x-(_-f)+(y-f),rp[3]=_;let O=_0(4,rp),T=fce*s;if(O>=T||-O>=T||(f=e-A,a=e-(A+f)+(f-i),f=n-F,l=n-(F+f)+(f-i),f=t-R,u=t-(R+f)+(f-o),f=r-D,c=r-(D+f)+(f-o),a===0&&u===0&&l===0&&c===0)||(T=dce*s+A0*Math.abs(O),O+=A*c+D*a-(R*l+F*u),O>=T||-O>=T))return O;E=a*D,d=on*a,p=d-(d-a),m=a-p,d=on*D,h=d-(d-D),g=D-h,v=m*g-(E-p*h-m*h-p*g),S=u*F,d=on*u,p=d-(d-u),m=u-p,d=on*F,h=d-(d-F),g=F-h,w=m*g-(S-p*h-m*h-p*g),y=v-w,f=v-y,Hr[0]=v-(y+f)+(f-w),x=E+y,f=x-E,b=E-(x-f)+(y-f),y=b-S,f=b-y,Hr[1]=b-(y+f)+(f-S),_=x+y,f=_-x,Hr[2]=x-(_-f)+(y-f),Hr[3]=_;let k=Gc(4,rp,4,Hr,KU);E=A*c,d=on*A,p=d-(d-A),m=A-p,d=on*c,h=d-(d-c),g=c-h,v=m*g-(E-p*h-m*h-p*g),S=R*l,d=on*R,p=d-(d-R),m=R-p,d=on*l,h=d-(d-l),g=l-h,w=m*g-(S-p*h-m*h-p*g),y=v-w,f=v-y,Hr[0]=v-(y+f)+(f-w),x=E+y,f=x-E,b=E-(x-f)+(y-f),y=b-S,f=b-y,Hr[1]=b-(y+f)+(f-S),_=x+y,f=_-x,Hr[2]=x-(_-f)+(y-f),Hr[3]=_;let C=Gc(k,KU,4,Hr,QU);E=a*c,d=on*a,p=d-(d-a),m=a-p,d=on*c,h=d-(d-c),g=c-h,v=m*g-(E-p*h-m*h-p*g),S=u*l,d=on*u,p=d-(d-u),m=u-p,d=on*l,h=d-(d-l),g=l-h,w=m*g-(S-p*h-m*h-p*g),y=v-w,f=v-y,Hr[0]=v-(y+f)+(f-w),x=E+y,f=x-E,b=E-(x-f)+(y-f),y=b-S,f=b-y,Hr[1]=b-(y+f)+(f-S),_=x+y,f=_-x,Hr[2]=x-(_-f)+(y-f),Hr[3]=_;let N=Gc(C,QU,4,Hr,JU);return JU[N-1]}function ip(e,t,n,r,i,o){let s=(t-o)*(n-i),a=(e-i)*(r-o),u=s-a,l=Math.abs(s+a);return Math.abs(u)>=cce*l?u:-pce(e,t,n,r,i,o,l)}var W4e=(7+56*je)*je,V4e=(3+28*je)*je,Y4e=(26+288*je)*je*je,X4e=J(4),K4e=J(4),Q4e=J(4),J4e=J(4),Z4e=J(4),eUe=J(4),tUe=J(4),nUe=J(4),rUe=J(4),iUe=J(8),oUe=J(8),sUe=J(8),aUe=J(4),uUe=J(8),lUe=J(8),cUe=J(8),fUe=J(12),dUe=J(192),pUe=J(192);var gUe=(10+96*je)*je,yUe=(4+48*je)*je,xUe=(44+576*je)*je*je,bUe=J(4),EUe=J(4),vUe=J(4),wUe=J(4),SUe=J(4),AUe=J(4),_Ue=J(4),CUe=J(4),kUe=J(8),FUe=J(8),RUe=J(8),TUe=J(8),DUe=J(8),MUe=J(8),NUe=J(8),OUe=J(8),IUe=J(8),PUe=J(4),$Ue=J(4),BUe=J(4),LUe=J(8),UUe=J(16),zUe=J(16),HUe=J(16),qUe=J(32),GUe=J(32),jUe=J(48),WUe=J(64),VUe=J(1152),YUe=J(1152);var JUe=(16+224*je)*je,ZUe=(5+72*je)*je,e9e=(71+1408*je)*je*je,t9e=J(4),n9e=J(4),r9e=J(4),i9e=J(4),o9e=J(4),s9e=J(4),a9e=J(4),u9e=J(4),l9e=J(4),c9e=J(4),f9e=J(24),d9e=J(24),p9e=J(24),m9e=J(24),h9e=J(24),g9e=J(24),y9e=J(24),x9e=J(24),b9e=J(24),E9e=J(24),v9e=J(1152),w9e=J(1152),S9e=J(1152),A9e=J(1152),_9e=J(1152),C9e=J(2304),k9e=J(2304),F9e=J(3456),R9e=J(5760),T9e=J(8),D9e=J(8),M9e=J(8),N9e=J(16),O9e=J(24),I9e=J(48),P9e=J(48),$9e=J(96),B9e=J(192),L9e=J(384),U9e=J(384),z9e=J(384),H9e=J(768);var q9e=J(96),G9e=J(96),j9e=J(96),W9e=J(1152);var e9=Math.pow(2,-52),XE=new Uint32Array(512),sp=class e{static from(t,n=bce,r=Ece){let i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){let a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new e(o)}constructor(t){let n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;let r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){let{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1,a=1/0,u=1/0,l=-1/0,c=-1/0;for(let A=0;A<s;A++){let F=t[2*A],R=t[2*A+1];F<a&&(a=F),R<u&&(u=R),F>l&&(l=F),R>c&&(c=R),this._ids[A]=A}let f=(a+l)/2,d=(u+c)/2,p,m,h;for(let A=0,F=1/0;A<s;A++){let R=BD(f,d,t[2*A],t[2*A+1]);R<F&&(p=A,F=R)}let g=t[2*p],y=t[2*p+1];for(let A=0,F=1/0;A<s;A++){if(A===p)continue;let R=BD(g,y,t[2*A],t[2*A+1]);R<F&&R>0&&(m=A,F=R)}let x=t[2*m],b=t[2*m+1],E=1/0;for(let A=0;A<s;A++){if(A===p||A===m)continue;let F=yce(g,y,x,b,t[2*A],t[2*A+1]);F<E&&(h=A,E=F)}let v=t[2*h],S=t[2*h+1];if(E===1/0){for(let R=0;R<s;R++)this._dists[R]=t[2*R]-t[0]||t[2*R+1]-t[1];op(this._ids,this._dists,0,s-1);let A=new Uint32Array(s),F=0;for(let R=0,D=-1/0;R<s;R++){let O=this._ids[R],T=this._dists[O];T>D&&(A[F++]=O,D=T)}this.hull=A.subarray(0,F),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(ip(g,y,x,b,v,S)<0){let A=m,F=x,R=b;m=h,x=v,b=S,h=A,v=F,S=R}let w=xce(g,y,x,b,v,S);this._cx=w.x,this._cy=w.y;for(let A=0;A<s;A++)this._dists[A]=BD(t[2*A],t[2*A+1],w.x,w.y);op(this._ids,this._dists,0,s-1),this._hullStart=p;let _=3;r[p]=n[h]=m,r[m]=n[p]=h,r[h]=n[m]=p,i[p]=0,i[m]=1,i[h]=2,o.fill(-1),o[this._hashKey(g,y)]=p,o[this._hashKey(x,b)]=m,o[this._hashKey(v,S)]=h,this.trianglesLen=0,this._addTriangle(p,m,h,-1,-1,-1);for(let A=0,F,R;A<this._ids.length;A++){let D=this._ids[A],O=t[2*D],T=t[2*D+1];if(A>0&&Math.abs(O-F)<=e9&&Math.abs(T-R)<=e9||(F=O,R=T,D===p||D===m||D===h))continue;let k=0;for(let te=0,ie=this._hashKey(O,T);te<this._hashSize&&(k=o[(ie+te)%this._hashSize],!(k!==-1&&k!==r[k]));te++);k=n[k];let C=k,N;for(;N=r[C],ip(O,T,t[2*C],t[2*C+1],t[2*N],t[2*N+1])>=0;)if(C=N,C===k){C=-1;break}if(C===-1)continue;let I=this._addTriangle(C,D,r[C],-1,-1,i[C]);i[D]=this._legalize(I+2),i[C]=I,_++;let L=r[C];for(;N=r[L],ip(O,T,t[2*L],t[2*L+1],t[2*N],t[2*N+1])<0;)I=this._addTriangle(L,D,N,i[D],-1,i[L]),i[D]=this._legalize(I+2),r[L]=L,_--,L=N;if(C===k)for(;N=n[C],ip(O,T,t[2*N],t[2*N+1],t[2*C],t[2*C+1])<0;)I=this._addTriangle(N,D,C,-1,i[C],i[N]),this._legalize(I+2),i[N]=I,r[C]=C,_--,C=N;this._hullStart=n[D]=C,r[C]=n[L]=D,r[D]=L,o[this._hashKey(O,T)]=D,o[this._hashKey(t[2*C],t[2*C+1])]=C}this.hull=new Uint32Array(_);for(let A=0,F=this._hullStart;A<_;A++)this.hull[A]=F,F=r[F];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(hce(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){let{_triangles:n,_halfedges:r,coords:i}=this,o=0,s=0;for(;;){let a=r[t],u=t-t%3;if(s=u+(t+2)%3,a===-1){if(o===0)break;t=XE[--o];continue}let l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[s],p=n[t],m=n[c],h=n[f];if(gce(i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*m],i[2*m+1],i[2*h],i[2*h+1])){n[t]=h,n[a]=d;let y=r[f];if(y===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,y),this._link(a,r[s]),this._link(s,f);let x=l+(a+1)%3;o<XE.length&&(XE[o++]=x)}else{if(o===0)break;t=XE[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){let a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}};function hce(e,t){let n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function BD(e,t,n,r){let i=e-n,o=t-r;return i*i+o*o}function gce(e,t,n,r,i,o,s,a){let u=e-s,l=t-a,c=n-s,f=r-a,d=i-s,p=o-a,m=u*u+l*l,h=c*c+f*f,g=d*d+p*p;return u*(f*g-h*p)-l*(c*g-h*d)+m*(c*p-f*d)<0}function yce(e,t,n,r,i,o){let s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),p=(l*c-a*f)*d,m=(s*f-u*c)*d;return p*p+m*m}function xce(e,t,n,r,i,o){let s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),p=e+(l*c-a*f)*d,m=t+(s*f-u*c)*d;return{x:p,y:m}}function op(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){let o=e[i],s=t[o],a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{let i=n+r>>1,o=n+1,s=r;C0(e,i,o),t[e[n]]>t[e[r]]&&C0(e,n,r),t[e[o]]>t[e[r]]&&C0(e,o,r),t[e[n]]>t[e[o]]&&C0(e,n,o);let a=e[o],u=t[a];for(;;){do o++;while(t[e[o]]<u);do s--;while(t[e[s]]>u);if(s<o)break;C0(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(op(e,t,o,r),op(e,t,n,s-1)):(op(e,t,n,s-1),op(e,t,o,r))}}function C0(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function bce(e){return e[0]}function Ece(e){return e[1]}var lo=class{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;let i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>1e-6||Math.abs(this._y1-o)>1e-6)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}};var yl=class{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}};var k0=class{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){let{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,o,s,a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,g=0,y=r.length,x,b;h<y;h+=3,g+=2){let E=r[h]*2,v=r[h+1]*2,S=r[h+2]*2,w=t[E],_=t[E+1],A=t[v],F=t[v+1],R=t[S],D=t[S+1],O=A-w,T=F-_,k=R-w,C=D-_,N=(O*C-T*k)*2;if(Math.abs(N)<1e-9){if(o===void 0){o=s=0;for(let L of n)o+=t[L*2],s+=t[L*2+1];o/=n.length,s/=n.length}let I=1e9*Math.sign((o-w)*C-(s-_)*k);x=(w+R)/2-I*C,b=(_+D)/2+I*k}else{let I=1/N,L=O*O+T*T,te=k*k+C*C;x=w+(C*L-T*te)*I,b=_+(O*te-k*L)*I}a[g]=x,a[g+1]=b}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],p,m=t[2*u+1];i.fill(0);for(let h=0;h<n.length;++h)u=n[h],l=c,f=d,p=m,c=u*4,d=t[2*u],m=t[2*u+1],i[l+2]=i[c]=p-m,i[l+3]=i[c+1]=d-f}render(t){let n=t==null?t=new lo:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){let d=r[c];if(d<c)continue;let p=Math.floor(c/3)*2,m=Math.floor(d/3)*2,h=s[p],g=s[p+1],y=s[m],x=s[m+1];this._renderSegment(h,g,y,x,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];let f=Math.floor(i[l]/3)*2,d=s[f],p=s[f+1],m=u*4,h=this._project(d,p,a[m+2],a[m+3]);h&&this._renderSegment(d,p,h[0],h[1],t)}return n&&n.value()}renderBounds(t){let n=t==null?t=new lo:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){let r=n==null?n=new lo:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){let{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){let i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){let n=new yl;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s,a=this._regioncode(t,n),u=this._regioncode(r,i);a===0&&u===0?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,u))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){let n=this._clip(t);if(n)for(let r of this.delaunay.neighbors(t)){let i=this._clip(r);if(i){e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,u=i.length;a<u;a+=2)if(n[o]===i[a]&&n[o+1]===i[a+1]&&n[(o+2)%s]===i[(a+u-2)%u]&&n[(o+3)%s]===i[(a+u-1)%u]){yield r;break e}}}}_cell(t){let{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(s===-1)return null;let a=[],u=s;do{let l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==s&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];let n=this._cell(t);if(n===null)return null;let{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){let r=n.length,i=null,o,s,a=n[r-2],u=n[r-1],l,c=this._regioncode(a,u),f,d=0;for(let p=0;p<r;p+=2)if(o=a,s=u,a=n[p],u=n[p+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,i?i.push(a,u):i=[a,u];else{let m,h,g,y,x;if(l===0){if((m=this._clipSegment(o,s,a,u,l,c))===null)continue;[h,g,y,x]=m}else{if((m=this._clipSegment(a,u,o,s,c,l))===null)continue;[y,x,h,g]=m,f=d,d=this._edgecode(h,g),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(h,g):i=[h,g]}f=d,d=this._edgecode(y,x),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(y,x):i=[y,x]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){let a=o<s;for(a&&([t,n,r,i,o,s]=[r,i,t,n,s,o]);;){if(o===0&&s===0)return a?[r,i,t,n]:[t,n,r,i];if(o&s)return null;let u,l,c=o||s;c&8?(u=t+(r-t)*(this.ymax-n)/(i-n),l=this.ymax):c&4?(u=t+(r-t)*(this.ymin-n)/(i-n),l=this.ymin):c&2?(l=n+(i-n)*(this.xmax-t)/(r-t),u=this.xmax):(l=n+(i-n)*(this.xmin-t)/(r-t),u=this.xmin),o?(t=u,n=l,o=this._regioncode(t,n)):(r=u,i=l,s=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,s){let a=Array.from(n),u;if((u=this._project(a[0],a[1],r,i))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}return o}_project(t,n,r,i){let o=1/0,s,a,u;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(u=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(u=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,u=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,u=n+(o=s)*i)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){let r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};var vce=2*Math.PI,ap=Math.pow;function wce(e){return e[0]}function Sce(e){return e[1]}function Ace(e){let{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){let i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}function _ce(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var up=class e{static from(t,n=wce,r=Sce,i){return new e("length"in t?Cce(t,n,r,i):Float64Array.from(kce(t,n,r,i)))}constructor(t){this._delaunator=new sp(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){let t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Ace(t)){this.collinear=Int32Array.from({length:n.length/2},(d,p)=>p).sort((d,p)=>n[2*d]-n[2*p]||n[2*d+1]-n[2*p+1]);let u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,p=n.length/2;d<p;++d){let m=_ce(n[2*d],n[2*d+1],f);n[2*d]=m[0],n[2*d+1]=m[1]}this._delaunator=new sp(n)}else delete this.collinear;let r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){let c=o[u%3===2?u-2:u+1];(r[u]===-1||s[c]===-1)&&(s[c]=u)}for(let u=0,l=i.length;u<l;++u)a[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new k0(this,t)}*neighbors(t){let{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){let f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}let u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=s[l],l=l%3===2?l-2:l+1,s[l]!==t)return;if(l=o[l],l===-1){let f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;let i=r,o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){let{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=ap(n-l[t*2],2)+ap(r-l[t*2+1],2),d=i[t],p=d;do{let m=u[p],h=ap(n-l[m*2],2)+ap(r-l[m*2+1],2);if(h<f&&(f=h,c=m),p=p%3===2?p-2:p+1,u[p]!==t)break;if(p=a[p],p===-1){if(p=o[(s[t]+1)%o.length],p!==m&&ap(n-l[p*2],2)+ap(r-l[p*2+1],2)<f)return p;break}}while(p!==d);return c}render(t){let n=t==null?t=new lo:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){let u=i[s];if(u<s)continue;let l=o[s]*2,c=o[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;let r=t==null?t=new lo:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){let a=i[o],u=i[o+1];t.moveTo(a+n,u),t.arc(a,u,n,0,vce)}return r&&r.value()}renderHull(t){let n=t==null?t=new lo:void 0,{hull:r,points:i}=this,o=r[0]*2,s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){let u=2*r[a];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){let t=new yl;return this.renderHull(t),t.value()}renderTriangle(t,n){let r=n==null?n=new lo:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,u=o[t+2]*2;return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){let{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){let n=new yl;return this.renderTriangle(t,n),n.value()}};function Cce(e,t,n,r){let i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){let a=e[s];o[s*2]=t.call(r,a,s,e),o[s*2+1]=n.call(r,a,s,e)}return o}function*kce(e,t,n,r){let i=0;for(let o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function LD(e){B.call(this,null,e)}LD.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var Fce=[-1e5,-1e5,1e5,1e5];Z(LD,B,{transform(e,t){let n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Fce;let o=this.value=up.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){let u=o.cellPolygon(s);r[s][n]=u&&!Tce(u)?Rce(u):null}return t.reflow(e.modified()).modifies(n)}});function Rce(e){let t=e[0][0],n=e[0][1],r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}function Tce(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}var qD={};er(qD,{wordcloud:()=>HD});var zD=Math.PI/180,F0=64,KE=2048;function Dce(){var e=[256,256],t,n,r,i,o,s,a,u=t9,l=[],c=Math.random,f={};f.layout=function(){for(var m=d(no()),h=$ce((e[0]>>5)*e[1]),g=null,y=l.length,x=-1,b=[],E=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:o(S),rotate:s(S),size:~~(r(S)+1e-14),padding:a(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,w)=>w.size-S.size);++x<y;){var v=E[x];v.x=e[0]*(c()+.5)>>1,v.y=e[1]*(c()+.5)>>1,Mce(m,v,E,x),v.hasText&&p(h,v,g)&&(b.push(v),g?Oce(g,v):g=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=e[0]>>1,v.y-=e[1]>>1)}return b};function d(m){m.width=m.height=1;var h=Math.sqrt(m.getContext("2d").getImageData(0,0,1,1).data.length>>2);m.width=(F0<<5)/h,m.height=KE/h;var g=m.getContext("2d");return g.fillStyle=g.strokeStyle="red",g.textAlign="center",{context:g,ratio:h}}function p(m,h,g){for(var y=h.x,x=h.y,b=Math.hypot(e[0],e[1]),E=u(e),v=c()<.5?1:-1,S=-v,w,_,A;(w=E(S+=v))&&(_=~~w[0],A=~~w[1],!(Math.min(Math.abs(_),Math.abs(A))>=b));)if(h.x=y+_,h.y=x+A,!(h.x+h.x0<0||h.y+h.y0<0||h.x+h.x1>e[0]||h.y+h.y1>e[1])&&(!g||!Nce(h,m,e[0]))&&(!g||Ice(h,g))){for(var F=h.sprite,R=h.width>>5,D=e[0]>>5,O=h.x-(R<<4),T=O&127,k=32-T,C=h.y1-h.y0,N=(h.y+h.y0)*D+(O>>5),I,L=0;L<C;L++){I=0;for(var te=0;te<=R;te++)m[N+te]|=I<<k|(te<R?(I=F[L*R+te])>>>T:0);N+=D}return h.sprite=null,!0}return!1}return f.words=function(m){return arguments.length?(l=m,f):l},f.size=function(m){return arguments.length?(e=[+m[0],+m[1]],f):e},f.font=function(m){return arguments.length?(n=jc(m),f):n},f.fontStyle=function(m){return arguments.length?(i=jc(m),f):i},f.fontWeight=function(m){return arguments.length?(o=jc(m),f):o},f.rotate=function(m){return arguments.length?(s=jc(m),f):s},f.text=function(m){return arguments.length?(t=jc(m),f):t},f.spiral=function(m){return arguments.length?(u=Bce[m]||m,f):u},f.fontSize=function(m){return arguments.length?(r=jc(m),f):r},f.padding=function(m){return arguments.length?(a=jc(m),f):a},f.random=function(m){return arguments.length?(c=m,f):c},f}function Mce(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(F0<<5)/o,KE/o);var s=0,a=0,u=0,l=n.length,c,f,d,p,m;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var h=Math.sin(t.rotate*zD),g=Math.cos(t.rotate*zD),y=c*g,x=c*h,b=d*g,E=d*h;c=Math.max(Math.abs(y+E),Math.abs(y-E))+31>>5<<5,d=~~Math.max(Math.abs(x+b),Math.abs(x-b))}else c=c+31>>5<<5;if(d>u&&(u=d),s+c>=F0<<5&&(s=0,a+=u,u=0),a+d>=KE)break;i.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&i.rotate(t.rotate*zD),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var v=i.getImageData(0,0,(F0<<5)/o,KE/o).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,p=0;p<d*f;p++)S[p]=0;if(s=t.xoff,s==null)return;a=t.yoff;var w=0,_=-1;for(m=0;m<d;m++){for(p=0;p<c;p++){var A=f*m+(p>>5),F=v[(a+m)*(F0<<5)+(s+p)<<2]?1<<31-p%32:0;S[A]|=F,w|=F}w?_=m:(t.y0++,d--,m--,a++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function Nce(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=o&127,a=32-s,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>s:0))&t[l+d])return!0;l+=n}return!1}function Oce(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Ice(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function t9(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Pce(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function $ce(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function jc(e){return typeof e=="function"?e:function(){return e}}var Bce={archimedean:t9,rectangular:Pce},n9=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Lce=["text","font","rotate","fontSize","fontStyle","fontWeight"];function HD(e){B.call(this,Dce(),e)}HD.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:n9}]};Z(HD,B,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&U("Wordcloud size dimensions must be non-zero.");function n(m){let h=e[m];return Ee(h)&&t.modified(h.fields)}let r=e.modified();if(!(r||t.changed(t.ADD_REM)||Lce.some(n)))return;let i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||n9,a=e.fontSize||14,u;if(Ee(a)?u=e.fontSizeRange:a=St(a),u){let m=a,h=Ue("sqrt")().domain(kr(i,m)).range(u);a=g=>h(m(g))}i.forEach(m=>{m[s[0]]=NaN,m[s[1]]=NaN,m[s[3]]=0});let l=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Nr).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,p=l.length;for(let m=0,h,g;m<p;++m)h=l[m],g=h.datum,g[s[0]]=h.x+f,g[s[1]]=h.y+d,g[s[2]]=h.font,g[s[3]]=h.size,g[s[4]]=h.style,g[s[5]]=h.weight,g[s[6]]=h.rotate;return t.reflow(r).modifies(s)}});var WD={};er(WD,{crossfilter:()=>GD,resolvefilter:()=>jD});var Uce=e=>new Uint8Array(e),zce=e=>new Uint16Array(e),R0=e=>new Uint32Array(e);function Hce(){let e=8,t=[],n=R0(0),r=QE(0,e),i=QE(0,e);return{data:()=>t,seen:()=>n=qce(n,t.length),add(o){for(let s=0,a=t.length,u=o.length,l;s<u;++s)l=o[s],l._index=a++,t.push(l)},remove(o,s){let a=t.length,u=Array(a-o),l=t,c,f,d;for(f=0;!s[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){let a=r.length;(o>a||s>e)&&(e=Math.max(s,e),r=QE(o,e,r),i=QE(o,e))}}}function qce(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function QE(e,t,n){let r=(t<257?Uce:t<65537?zce:R0)(e);return n&&r.set(n),r}function r9(e,t,n){let r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){let s=this,a=s.bisect(s.range,i.value),u=i.index,l=a[0],c=a[1],f=u.length,d;for(d=0;d<l;++d)o[u[d]]|=r;for(d=c;d<f;++d)o[u[d]]|=r;return s}}}function i9(){let e=R0(0),t=[],n=0;function r(a,u,l){if(!u.length)return[];let c=n,f=u.length,d=R0(f),p=Array(f),m,h,g;for(g=0;g<f;++g)p[g]=a(u[g]),d[g]=g;if(p=Gce(p,d),c)m=t,h=e,t=Array(c+f),e=R0(c+f),jce(l,m,h,c,p,d,f,t,e);else{if(l>0)for(g=0;g<f;++g)d[g]+=l;t=p,e=d}return n=c+f,{index:d,value:p}}function i(a,u){let l=n,c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function o(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function s(a,u){let l;return u?l=u.length:(u=t,l=n),[m2(u,a[0],0,l),Kl(u,a[1],0,l)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>e,size:()=>n}}function Gce(e,t){return e.sort.call(t,(n,r)=>{let i=e[n],o=e[r];return i<o?-1:i>o?1:0}),Nx(e,t)}function jce(e,t,n,r,i,o,s,a,u){let l=0,c=0,f;for(f=0;l<r&&c<s;++f)t[l]<i[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=i[c],u[f]=o[c++]+e);for(;l<r;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<s;++c,++f)a[f]=i[c],u[f]=o[c]+e}function GD(e){B.call(this,Hce(),e),this._indices=null,this._dims=null}GD.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};Z(GD,B,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){let n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length,a=0,u,l;for(;a<s;++a)u=n[a].fname,l=i[u]||(i[u]=i9()),o.push(r9(l,a,r[a]));return this.eval(e,t)},reinit(e,t){let n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,p=i.length,m={},h,g,y,x,b,E,v,S,w;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(E={},x=t.mod,v=0,S=x.length;v<S;++v)E[x[v]._index]=1;for(v=0;v<p;++v)w=r[v],(!s[v]||e.modified("fields",v)||t.modified(w.fields))&&(y=w.fname,(h=m[y])||(o[y]=g=i9(),m[y]=h=g.insert(w,t.source,0)),s[v]=r9(g,v,i[v]).onAdd(h,u));for(v=0,S=a.data().length;v<S;++v)b[v]||(l[v]!==u[v]?f.push(v):E[v]&&u[v]!==c&&d.push(v));return a.mask=(1<<p)-1,n},eval(e,t){let n=t.materialize().fork(),r=this._dims.length,i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){let r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length,d=i.size(),p,m,h;i.resize(c,f),i.add(r);let g=i.curr(),y=i.prev(),x=i.all();for(p=0;p<f;++p)m=a[p].fname,h=u[m]||(u[m]=s[m].insert(a[p],r,d)),o[p].onAdd(h,g);for(;d<c;++d)y[d]=x,g[d]!==x&&l.push(d)},modify(e,t){let n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod,a,u,l;for(a=0,u=s.length;a<u;++a)l=s[a]._index,i[l]!==o&&n.push(l)},remove(e,t,n){let r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},l=n.rem,c=t.rem,f,d,p,m;for(f=0,d=c.length;f<d;++f)p=c[f]._index,u[p]=1,s[p]=m=o[p],o[p]=a,m!==a&&l.push(p);for(p in r)r[p].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){let r=this._indices,i=this.value;e.runAfter(()=>{let o=i.remove(t,n);for(let s in r)r[s].reindex(o)})},update(e,t,n){let r=this._dims,i=e.query,o=t.stamp,s=r.length,a=0,u,l;for(n.filters=0,l=0;l<s;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,a=0;l<s;++l)e.modified("query",l)&&(a|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){let i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],p=l[0],m=l[1],h=e.one,g,y,x;if(f<p)for(g=f,y=Math.min(p,d);g<y;++g)x=u[g],o[x]!==n&&(a[x]=s[x],o[x]=n,r.push(x)),s[x]^=h;else if(f>p)for(g=p,y=Math.min(f,m);g<y;++g)x=u[g],o[x]!==n&&(a[x]=s[x],o[x]=n,r.push(x)),s[x]^=h;if(d>m)for(g=Math.max(f,m),y=d;g<y;++g)x=u[g],o[x]!==n&&(a[x]=s[x],o[x]=n,r.push(x)),s[x]^=h;else if(d<m)for(g=Math.max(p,d),y=m;g<y;++g)x=u[g],o[x]!==n&&(a[x]=s[x],o[x]=n,r.push(x)),s[x]^=h;e.range=t.slice()},incrementOne(e,t,n,r){let i=this.value,o=i.curr(),s=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],p=e.one,m,h,g;if(l<f)for(m=l,h=Math.min(f,c);m<h;++m)g=s[m],o[g]^=p,n.push(g);else if(l>f)for(m=f,h=Math.min(l,d);m<h;++m)g=s[m],o[g]^=p,r.push(g);if(c>d)for(m=Math.max(l,d),h=c;m<h;++m)g=s[m],o[g]^=p,n.push(g);else if(c<d)for(m=Math.max(f,c),h=d;m<h;++m)g=s[m],o[g]^=p,r.push(g);e.range=t.slice()}});function jD(e){B.call(this,null,e)}jD.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};Z(jD,B,{transform(e,t){let n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;let o=t.fork(t.ALL),s=r.data(),a=r.curr(),u=r.prev(),l=c=>a[c]&n?null:s[c];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,c=>{let f=a[c]&n;return!f&&f^u[c]&n?s[c]:null}),o.filter(o.REM,c=>{let f=a[c]&n;return f&&!(f^(f^u[c]&n))?s[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(a[c]&n)===i?s[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});var Wce="RawCode",Ja="Literal",Vce="Property",Yce="Identifier",Xce="ArrayExpression",Kce="BinaryExpression",JD="CallExpression",Qce="ConditionalExpression",Jce="LogicalExpression",Zce="MemberExpression",efe="ObjectExpression",tfe="UnaryExpression";function Yo(e){this.type=e}Yo.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=nfe(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function nfe(e){switch(e.type){case Xce:return e.elements;case Kce:case Jce:return[e.left,e.right];case JD:return[e.callee].concat(e.arguments);case Qce:return[e.test,e.consequent,e.alternate];case Zce:return[e.object,e.property];case efe:return e.properties;case Vce:return[e.key,e.value];case tfe:return[e.argument];case Yce:case Ja:case Wce:default:return[]}}var Ks,pe,q,lr,it,ev=1,O0=2,Wc=3,xl=4,tv=5,Yc=6,ai=7,I0=8,rfe=9;Ks={};Ks[ev]="Boolean";Ks[O0]="<end>";Ks[Wc]="Identifier";Ks[xl]="Keyword";Ks[tv]="Null";Ks[Yc]="Numeric";Ks[ai]="Punctuator";Ks[I0]="String";Ks[rfe]="RegularExpression";var ife="ArrayExpression",ofe="BinaryExpression",sfe="CallExpression",afe="ConditionalExpression",d9="Identifier",ufe="Literal",lfe="LogicalExpression",cfe="MemberExpression",ffe="ObjectExpression",dfe="Property",pfe="UnaryExpression",An="Unexpected token %0",mfe="Unexpected number",hfe="Unexpected string",gfe="Unexpected identifier",yfe="Unexpected reserved word",xfe="Unexpected end of input",KD="Invalid regular expression",VD="Invalid regular expression: missing /",p9="Octal literals are not allowed in strict mode.",bfe="Duplicate data property in object literal not allowed in strict mode",zn="ILLEGAL",M0="Disabled.",Efe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),vfe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function nv(e,t){if(!e)throw new Error("ASSERT: "+t)}function Qa(e){return e>=48&&e<=57}function ZD(e){return"0123456789abcdefABCDEF".includes(e)}function D0(e){return"01234567".includes(e)}function wfe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function N0(e){return e===10||e===13||e===8232||e===8233}function P0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Efe.test(String.fromCharCode(e))}function ZE(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&vfe.test(String.fromCharCode(e))}var Sfe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function m9(){for(;q<lr;){let e=pe.charCodeAt(q);if(wfe(e)||N0(e))++q;else break}}function QD(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)q<lr&&ZD(pe[q])?(r=pe[q++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Qe({},An,zn);return String.fromCharCode(i)}function Afe(){var e,t,n,r;for(e=pe[q],t=0,e==="}"&&Qe({},An,zn);q<lr&&(e=pe[q++],!!ZD(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Qe({},An,zn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function h9(){var e,t;for(e=pe.charCodeAt(q++),t=String.fromCharCode(e),e===92&&(pe.charCodeAt(q)!==117&&Qe({},An,zn),++q,e=QD("u"),(!e||e==="\\"||!P0(e.charCodeAt(0)))&&Qe({},An,zn),t=e);q<lr&&(e=pe.charCodeAt(q),!!ZE(e));)++q,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),pe.charCodeAt(q)!==117&&Qe({},An,zn),++q,e=QD("u"),(!e||e==="\\"||!ZE(e.charCodeAt(0)))&&Qe({},An,zn),t+=e);return t}function _fe(){var e,t;for(e=q++;q<lr;){if(t=pe.charCodeAt(q),t===92)return q=e,h9();if(ZE(t))++q;else break}return pe.slice(e,q)}function Cfe(){var e,t,n;return e=q,t=pe.charCodeAt(q)===92?h9():_fe(),t.length===1?n=Wc:Sfe.hasOwnProperty(t)?n=xl:t==="null"?n=tv:t==="true"||t==="false"?n=ev:n=Wc,{type:n,value:t,start:e,end:q}}function YD(){var e=q,t=pe.charCodeAt(q),n,r=pe[q],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++q,{type:ai,value:String.fromCharCode(t),start:e,end:q};default:if(n=pe.charCodeAt(q+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return q+=2,{type:ai,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:q};case 33:case 61:return q+=2,pe.charCodeAt(q)===61&&++q,{type:ai,value:pe.slice(e,q),start:e,end:q}}}if(s=pe.substr(q,4),s===">>>=")return q+=4,{type:ai,value:s,start:e,end:q};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return q+=3,{type:ai,value:o,start:e,end:q};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".includes(r)||i==="=>")return q+=2,{type:ai,value:i,start:e,end:q};if(i==="//"&&Qe({},An,zn),"<>=!+-*%&|^/".includes(r))return++q,{type:ai,value:r,start:e,end:q};Qe({},An,zn)}function kfe(e){let t="";for(;q<lr&&ZD(pe[q]);)t+=pe[q++];return t.length===0&&Qe({},An,zn),P0(pe.charCodeAt(q))&&Qe({},An,zn),{type:Yc,value:parseInt("0x"+t,16),start:e,end:q}}function Ffe(e){let t="0"+pe[q++];for(;q<lr&&D0(pe[q]);)t+=pe[q++];return(P0(pe.charCodeAt(q))||Qa(pe.charCodeAt(q)))&&Qe({},An,zn),{type:Yc,value:parseInt(t,8),octal:!0,start:e,end:q}}function o9(){var e,t,n;if(n=pe[q],nv(Qa(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=q,e="",n!=="."){if(e=pe[q++],n=pe[q],e==="0"){if(n==="x"||n==="X")return++q,kfe(t);if(D0(n))return Ffe(t);n&&Qa(n.charCodeAt(0))&&Qe({},An,zn)}for(;Qa(pe.charCodeAt(q));)e+=pe[q++];n=pe[q]}if(n==="."){for(e+=pe[q++];Qa(pe.charCodeAt(q));)e+=pe[q++];n=pe[q]}if(n==="e"||n==="E")if(e+=pe[q++],n=pe[q],(n==="+"||n==="-")&&(e+=pe[q++]),Qa(pe.charCodeAt(q)))for(;Qa(pe.charCodeAt(q));)e+=pe[q++];else Qe({},An,zn);return P0(pe.charCodeAt(q))&&Qe({},An,zn),{type:Yc,value:parseFloat(e),start:t,end:q}}function Rfe(){var e="",t,n,r,i,o=!1;for(t=pe[q],nv(t==="'"||t==='"',"String literal must starts with a quote"),n=q,++q;q<lr;)if(r=pe[q++],r===t){t="";break}else if(r==="\\")if(r=pe[q++],!r||!N0(r.charCodeAt(0)))switch(r){case"u":case"x":pe[q]==="{"?(++q,e+=Afe()):e+=QD(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:D0(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),q<lr&&D0(pe[q])&&(o=!0,i=i*8+"01234567".indexOf(pe[q++]),"0123".includes(r)&&q<lr&&D0(pe[q])&&(i=i*8+"01234567".indexOf(pe[q++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&pe[q]===`
`&&++q;else{if(N0(r.charCodeAt(0)))break;e+=r}return t!==""&&Qe({},An,zn),{type:I0,value:e,octal:o,start:n,end:q}}function Tfe(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Qe({},KD)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Qe({},KD)}try{return new RegExp(e,t)}catch{return null}}function Dfe(){var e,t,n,r,i;for(e=pe[q],nv(e==="/","Regular expression literal must start with a slash"),t=pe[q++],n=!1,r=!1;q<lr;)if(e=pe[q++],t+=e,e==="\\")e=pe[q++],N0(e.charCodeAt(0))&&Qe({},VD),t+=e;else if(N0(e.charCodeAt(0)))Qe({},VD);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Qe({},VD),i=t.substr(1,t.length-2),{value:i,literal:t}}function Mfe(){var e,t,n;for(t="",n="";q<lr&&(e=pe[q],!!ZE(e.charCodeAt(0)));)++q,e==="\\"&&q<lr?Qe({},An,zn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Qe({},KD,n),{value:n,literal:t}}function Nfe(){var e,t,n,r;return it=null,m9(),e=q,t=Dfe(),n=Mfe(),r=Tfe(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:q}}function Ofe(e){return e.type===Wc||e.type===xl||e.type===ev||e.type===tv}function g9(){if(m9(),q>=lr)return{type:O0,start:q,end:q};let e=pe.charCodeAt(q);return P0(e)?Cfe():e===40||e===41||e===59?YD():e===39||e===34?Rfe():e===46?Qa(pe.charCodeAt(q+1))?o9():YD():Qa(e)?o9():YD()}function ui(){let e=it;return q=e.end,it=g9(),q=e.end,e}function y9(){let e=q;it=g9(),q=e}function Ife(e){let t=new Yo(ife);return t.elements=e,t}function s9(e,t,n){let r=new Yo(e==="||"||e==="&&"?lfe:ofe);return r.operator=e,r.left=t,r.right=n,r}function Pfe(e,t){let n=new Yo(sfe);return n.callee=e,n.arguments=t,n}function $fe(e,t,n){let r=new Yo(afe);return r.test=e,r.consequent=t,r.alternate=n,r}function eM(e){let t=new Yo(d9);return t.name=e,t}function T0(e){let t=new Yo(ufe);return t.value=e.value,t.raw=pe.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function a9(e,t,n){let r=new Yo(cfe);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Bfe(e){let t=new Yo(ffe);return t.properties=e,t}function u9(e,t,n){let r=new Yo(dfe);return r.key=t,r.value=n,r.kind=e,r}function Lfe(e,t){let n=new Yo(pfe);return n.operator=e,n.argument=t,n.prefix=!0,n}function Qe(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(nv(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=q,n.description=i,n}function rv(e){e.type===O0&&Qe(e,xfe),e.type===Yc&&Qe(e,mfe),e.type===I0&&Qe(e,hfe),e.type===Wc&&Qe(e,gfe),e.type===xl&&Qe(e,yfe),Qe(e,An,e.value)}function cr(e){let t=ui();(t.type!==ai||t.value!==e)&&rv(t)}function vt(e){return it.type===ai&&it.value===e}function XD(e){return it.type===xl&&it.value===e}function Ufe(){let e=[];for(q=it.start,cr("[");!vt("]");)vt(",")?(ui(),e.push(null)):(e.push(Vc()),vt("]")||cr(","));return ui(),Ife(e)}function l9(){q=it.start;let e=ui();return e.type===I0||e.type===Yc?(e.octal&&Qe(e,p9),T0(e)):eM(e.value)}function zfe(){var e,t,n,r;if(q=it.start,e=it,e.type===Wc)return n=l9(),cr(":"),r=Vc(),u9("init",n,r);if(e.type===O0||e.type===ai)rv(e);else return t=l9(),cr(":"),r=Vc(),u9("init",t,r)}function Hfe(){var e=[],t,n,r,i={},o=String;for(q=it.start,cr("{");!vt("}");)t=zfe(),t.key.type===d9?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Qe({},bfe):i[r]=!0,e.push(t),vt("}")||cr(",");return cr("}"),Bfe(e)}function qfe(){cr("(");let e=tM();return cr(")"),e}var Gfe={if:1};function jfe(){var e,t,n;if(vt("("))return qfe();if(vt("["))return Ufe();if(vt("{"))return Hfe();if(e=it.type,q=it.start,e===Wc||Gfe[it.value])n=eM(ui().value);else if(e===I0||e===Yc)it.octal&&Qe(it,p9),n=T0(ui());else{if(e===xl)throw new Error(M0);e===ev?(t=ui(),t.value=t.value==="true",n=T0(t)):e===tv?(t=ui(),t.value=null,n=T0(t)):vt("/")||vt("/=")?(n=T0(Nfe()),y9()):rv(ui())}return n}function Wfe(){let e=[];if(cr("("),!vt(")"))for(;q<lr&&(e.push(Vc()),!vt(")"));)cr(",");return cr(")"),e}function Vfe(){q=it.start;let e=ui();return Ofe(e)||rv(e),eM(e.value)}function Yfe(){return cr("."),Vfe()}function Xfe(){cr("[");let e=tM();return cr("]"),e}function Kfe(){var e,t,n;for(e=jfe();;)if(vt("."))n=Yfe(),e=a9(".",e,n);else if(vt("("))t=Wfe(),e=Pfe(e,t);else if(vt("["))n=Xfe(),e=a9("[",e,n);else break;return e}function c9(){let e=Kfe();if(it.type===ai&&(vt("++")||vt("--")))throw new Error(M0);return e}function JE(){var e,t;if(it.type!==ai&&it.type!==xl)t=c9();else{if(vt("++")||vt("--"))throw new Error(M0);if(vt("+")||vt("-")||vt("~")||vt("!"))e=ui(),t=JE(),t=Lfe(e.value,t);else{if(XD("delete")||XD("void")||XD("typeof"))throw new Error(M0);t=c9()}}return t}function f9(e){let t=0;if(e.type!==ai&&e.type!==xl)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Qfe(){var e,t,n,r,i,o,s,a,u,l;if(e=it,u=JE(),r=it,i=f9(r),i===0)return u;for(r.prec=i,ui(),t=[e,it],s=JE(),o=[u,r,s];(i=f9(it))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=s9(a,u,s),o.push(n);r=ui(),r.prec=i,o.push(r),t.push(it),n=JE(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=s9(o[l-1].value,o[l-2],n),l-=2;return n}function Vc(){var e,t,n;return e=Qfe(),vt("?")&&(ui(),t=Vc(),cr(":"),n=Vc(),e=$fe(e,t,n)),e}function tM(){let e=Vc();if(vt(","))throw new Error(M0);return e}function iv(e){pe=e,q=0,lr=pe.length,it=null,y9();let t=tM();if(it.type!==O0)throw new Error("Unexpect token after expression.");return t}var nM={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function rM(e){function t(s,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,u){return l=>t(s,l,a,u)}let r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&U("Missing arguments to clamp function."),s.length>3&&U("Too many arguments to clamp function.");let a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),btoa:"btoa",atob:"atob",regexp:o,test:n("test",o),if:function(s){s.length<3&&U("Missing arguments to if function."),s.length>3&&U("Too many arguments to if function.");let a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Jfe(e){let t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function ov(e){e=e||{};let t=e.allowed?Jt(e.allowed):{},n=e.forbidden?Jt(e.forbidden):{},r=e.constants||nM,i=(e.functions||rM)(f),o=e.globalvar,s=e.fieldvar,a=Ee(o)?o:m=>`${o}["${m}"]`,u={},l={},c=0;function f(m){if(V(m))return m;let h=d[m.type];return h==null&&U("Unsupported type: "+m.type),h(m)}let d={Literal:m=>m.raw,Identifier:m=>{let h=m.name;return c>0?h:ee(n,h)?U("Illegal identifier: "+h):ee(r,h)?r[h]:ee(t,h)?h:(u[h]=1,a(h))},MemberExpression:m=>{let h=!m.computed,g=f(m.object);h&&(c+=1);let y=f(m.property);return g===s&&(l[Jfe(y)]=1),h&&(c-=1),g+(h?"."+y:"["+y+"]")},CallExpression:m=>{m.callee.type!=="Identifier"&&U("Illegal callee type: "+m.callee.type);let h=m.callee.name,g=m.arguments,y=ee(i,h)&&i[h];return y||U("Unrecognized function: "+h),Ee(y)?y(g):y+"("+g.map(f).join(",")+")"},ArrayExpression:m=>"["+m.elements.map(f).join(",")+"]",BinaryExpression:m=>"("+f(m.left)+" "+m.operator+" "+f(m.right)+")",UnaryExpression:m=>"("+m.operator+f(m.argument)+")",ConditionalExpression:m=>"("+f(m.test)+"?"+f(m.consequent)+":"+f(m.alternate)+")",LogicalExpression:m=>"("+f(m.left)+m.operator+f(m.right)+")",ObjectExpression:m=>"{"+m.properties.map(f).join(",")+"}",Property:m=>{c+=1;let h=f(m.key);return c-=1,h+":"+f(m.value)}};function p(m){let h={code:f(m),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},h}return p.functions=i,p.constants=r,p}var x9=Symbol("vega_selection_getter");function w9(e){return(!e.getter||!e.getter[x9])&&(e.getter=bn(e.field),e.getter[x9]=!0),e.getter}var oM="intersect",b9="union",Zfe="vlMulti",ede="vlPoint",E9="or",tde="and",Qs="_vgsid_",$0=bn(Qs),nde="E",rde="R",ide="R-E",ode="R-LE",sde="R-RE",ade="E-LT",ude="E-LTE",lde="E-GT",cde="E-GTE",fde="E-VALID",dde="E-ONE",sv="index:unit";function v9(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,s,a;o<i;++o)if(a=n[o],s=w9(a)(e),Do(s)&&(s=Gt(s)),Do(r[o])&&(r[o]=Gt(r[o])),M(r[o])&&Do(r[o][0])&&(r[o]=r[o].map(Gt)),a.type===nde){if(M(r[o])?!r[o].includes(s):s!==r[o])return!1}else if(a.type===rde){if(!Fu(s,r[o]))return!1}else if(a.type===sde){if(!Fu(s,r[o],!0,!1))return!1}else if(a.type===ide){if(!Fu(s,r[o],!1,!1))return!1}else if(a.type===ode){if(!Fu(s,r[o],!1,!0))return!1}else if(a.type===ade){if(s>=r[o])return!1}else if(a.type===ude){if(s>r[o])return!1}else if(a.type===lde){if(s<=r[o])return!1}else if(a.type===cde){if(s<r[o])return!1}else if(a.type===fde){if(s===null||isNaN(s))return!1}else if(a.type===dde&&r[o].indexOf(s)===-1)return!1;return!0}function S9(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[sv]&&r[sv].value:void 0,s=n===oM,a=i.length,u=0,l,c,f,d,p;u<a;++u)if(l=i[u],o&&s){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(p=v9(t,l),c[d]=p?-1:++f,p&&o.size===1)return!0;if(!p&&f===o.get(d).count)return!1}else if(p=v9(t,l),s^p)return p;return a&&s}var A9=_i($0),pde=A9.left,mde=A9.right;function _9(e,t,n){let r=this.context.data[e],i=r?r.values.value:[],o=r?r[sv]&&r[sv].value:void 0,s=n===oM,a=$0(t),u=pde(i,a);if(u===i.length||$0(i[u])!==a)return!1;if(o&&s){if(o.size===1)return!0;if(mde(i,a)-u<o.size)return!1}return!0}function C9(e,t){return e.map(n=>ve(t.fields?{values:t.fields.map(r=>w9(r)(n.datum))}:{[Qs]:$0(n.datum)},t))}function k9(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],s={},a={},u={},l,c,f,d,p,m,h,g,y,x,b=o.length,E=0,v,S;E<b;++E)if(l=o[E],d=l.unit,c=l.fields,f=l.values,c&&f){for(v=0,S=c.length;v<S;++v)p=c[v],h=s[p.field]||(s[p.field]={}),g=h[d]||(h[d]=[]),u[p.field]=y=p.type.charAt(0),x=iM[`${y}_union`],h[d]=x(g,Q(f[v]));n&&(g=a[d]||(a[d]=[]),g.push(Q(f).reduce((w,_,A)=>(w[c[A].field]=_,w),{})))}else p=Qs,m=$0(l),h=s[p]||(s[p]={}),g=h[d]||(h[d]=[]),g.push(m),n&&(g=a[d]||(a[d]=[]),g.push({[Qs]:m}));if(t=t||b9,s[Qs]?s[Qs]=iM[`${Qs}_${t}`](...Object.values(s[Qs])):Object.keys(s).forEach(w=>{s[w]=Object.keys(s[w]).map(_=>s[w][_]).reduce((_,A)=>_===void 0?A:iM[`${u[w]}_${t}`](_,A))}),o=Object.keys(a),n&&o.length){let w=r?ede:Zfe;s[w]=t===b9?{[E9]:o.reduce((_,A)=>(_.push(...a[A]),_),[])}:{[tde]:o.map(_=>({[E9]:a[_]}))}}return s}var iM={[`${Qs}_union`]:Bx,[`${Qs}_intersect`]:$x,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=Gt(t[0]),r=Gt(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Gt(t[0]),r=Gt(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}},hde=":",gde="@";function av(e,t,n,r){t[0].type!==Ja&&U("First argument to selection functions must be a string literal.");let i=t[0].value,o=t.length>=2&&Te(t).value,s="unit",a=gde+s,u=hde+i;o===oM&&!ee(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),ee(r,u)||(r[u]=n.getData(i).tuplesRef())}function D9(e){let t=this.context.data[e];return t?t.values.value:[]}function yde(e,t,n){let r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function xde(e,t){let n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(cn).insert(t)),1}function bde(e,t,n){if(e){let r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}var B0=e=>function(t,n){let r=this.context.dataflow.locale();return t===null?"null":r[e](n)(t)},Ede=B0("format"),M9=B0("timeFormat"),vde=B0("utcFormat"),wde=B0("timeParse"),Sde=B0("utcParse"),uv=new Date(2e3,0,1);function lv(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(uv.setYear(2e3),uv.setMonth(e),uv.setDate(t),M9.call(this,uv,n))}function Ade(e){return lv.call(this,e,1,"%B")}function _de(e){return lv.call(this,e,1,"%b")}function Cde(e){return lv.call(this,0,2+e,"%A")}function kde(e){return lv.call(this,0,2+e,"%a")}var Fde=":",Rde="@",aM="%",N9="$";function cM(e,t,n,r){t[0].type!==Ja&&U("First argument to data functions must be a string literal.");let i=t[0].value,o=Fde+i;if(!ee(o,r))try{r[o]=n.getData(i).tuplesRef()}catch{}}function Tde(e,t,n,r){t[0].type!==Ja&&U("First argument to indata must be a string literal."),t[1].type!==Ja&&U("Second argument to indata must be a string literal.");let i=t[0].value,o=t[1].value,s=Rde+o;ee(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function qr(e,t,n,r){if(t[0].type===Ja)F9(n,r,t[0].value);else for(e in n.scales)F9(n,r,e)}function F9(e,t,n){let r=aM+n;if(!ee(t,r))try{t[r]=e.scaleRef(n)}catch{}}function Js(e,t){if(V(e)){let n=t.scales[e];return n&&Zk(n.value)?n.value:void 0}else if(Ee(e))return Zk(e)?e:void 0}function Dde(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=qr,n._range=qr,n._scale=qr;let r=i=>"_["+(i.type===Ja?Y(aM+i.value):Y(aM)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function fM(e,t){return function(n,r,i){if(n){let o=Js(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}var Mde=fM("area",xR),Nde=fM("bounds",ER),Ode=fM("centroid",_R);function Ide(e,t){let n=Js(e,(t||this).context);return n&&n.scale()}function Pde(e){let t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function dM(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function $de(){return dM(this.context.dataflow,"warn",arguments)}function Bde(){return dM(this.context.dataflow,"info",arguments)}function Lde(){return dM(this.context.dataflow,"debug",arguments)}function sM(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function uM(e){let t=ro(e),n=sM(t.r),r=sM(t.g),i=sM(t.b);return .2126*n+.7152*r+.0722*i}function Ude(e,t){let n=uM(e),r=uM(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function zde(){let e=[].slice.call(arguments);return e.unshift({}),ve(...e)}function O9(e,t){return e===t||e!==e&&t!==t?!0:M(e)?M(t)&&e.length===t.length?Hde(e,t):!1:X(e)&&X(t)?I9(e,t):!1}function Hde(e,t){for(let n=0,r=e.length;n<r;++n)if(!O9(e[n],t[n]))return!1;return!0}function I9(e,t){for(let n in e)if(!O9(e[n],t[n]))return!1;return!0}function R9(e){return t=>I9(e,t)}function qde(e,t,n,r,i,o){let s=this.context.dataflow,a=this.context.data[e],u=a.input,l=s.stamp(),c=a.changes,f,d;if(s._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(a.changes=c=s.changeset(),c.stamp=l,s.runAfter(()=>{a.modified=!0,s.pulse(u,c).run()},!0,1)),n&&(f=n===!0?cn:M(n)||ac(n)?n:R9(n),c.remove(f)),t&&c.insert(t),r&&(f=R9(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function Gde(e){let t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function jde(e){let t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}var T9={};function Wde(e,t){let n=T9[t]||(T9[t]=bn(t));return M(e)?e.map(n):n(e)}function cv(e){return M(e)||ArrayBuffer.isView(e)?e:null}function pM(e){return cv(e)||(V(e)?e:null)}function Vde(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return cv(e).join(...n)}function Yde(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return pM(e).indexOf(...n)}function Xde(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return pM(e).lastIndexOf(...n)}function Kde(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return pM(e).slice(...n)}function Qde(e,t,n){return Ee(n)&&U("Function argument passed to replace."),!V(t)&&!Rx(t)&&U("Please pass a string or RegExp argument to replace."),String(e).replace(t,n)}function Jde(e){return cv(e).slice().reverse()}function Zde(e){return cv(e).slice().sort(Sa)}function epe(e,t,n){return dg(e||0,t||0,n||0)}function tpe(e,t){let n=Js(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function npe(e,t){let n=Js(e,(t||this).context);return n?n.copy():void 0}function rpe(e,t){let n=Js(e,(t||this).context);return n?n.domain():[]}function ipe(e,t,n){let r=Js(e,(n||this).context);return r?M(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function ope(e,t){let n=Js(e,(t||this).context);return n&&n.range?n.range():[]}function spe(e,t,n){let r=Js(e,(n||this).context);return r?r(t):void 0}function ape(e,t,n,r,i){e=Js(e,(i||this).context);let o=CF(t,n),s=e.domain(),a=s[0],u=Te(s),l=Ot;return u-a?l=mb(e,a,u):e=(e.interpolator?Ue("sequential")().interpolator(e.interpolator()):Ue("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==Te(s)&&s.push(u)),s.forEach(c=>o.stop(l(c),e(c))),o}function upe(e,t,n){let r=Js(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function lpe(e){let t=null;return function(n){return n?Td(n,t=t||Dc(e)):e}}var P9=e=>e.data;function $9(e,t){let n=D9.call(t,e);return n.root&&n.root.lookup||{}}function cpe(e,t,n){let r=$9(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(P9):void 0}function fpe(e,t){let n=$9(e,this)[t];return n?n.ancestors().map(P9):void 0}var B9=()=>typeof window<"u"&&window||null;function dpe(){let e=B9();return e?e.screen:{}}function ppe(){let e=B9();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function mpe(){let e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function L9(e,t,n){if(!e)return[];let[r,i]=e,o=new It().set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return KF(s,o,hpe(t))}function hpe(e){let t=null;if(e){let n=Q(e.marktype),r=Q(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}function gpe(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=Q(e);let i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function ype(e){return Q(e).reduce((t,n,r)=>{let[i,o]=n;return t+=r==0?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `},"")}function xpe(e,t,n){let{x:r,y:i,mark:o}=n,s=new It().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(let[u,l]of t)u<s.x1&&(s.x1=u),u>s.x2&&(s.x2=u),l<s.y1&&(s.y1=l),l>s.y2&&(s.y2=l);return s.translate(r,i),L9([[s.x1,s.y1],[s.x2,s.y2]],e,o).filter(u=>bpe(u.x,u.y,t))}function bpe(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){let[s,a]=n[o],[u,l]=n[i];l>t!=a>t&&e<(s-u)*(t-l)/(a-l)+u&&r++}return r&1}var lp={random(){return Nr()},cumulativeNormal:Ph,cumulativeLogNormal:d1,cumulativeUniform:g1,densityNormal:a1,densityLogNormal:f1,densityUniform:h1,quantileNormal:$h,quantileLogNormal:p1,quantileUniform:y1,sampleNormal:Ih,sampleLogNormal:c1,sampleUniform:m1,isArray:M,isBoolean:Zr,isDate:Do,isDefined(e){return e!==void 0},isNumber:ke,isObject:X,isRegExp:Rx,isString:V,isTuple:ac,isValid(e){return e!=null&&e===e},toBoolean:ih,toDate(e){return oh(e)},toNumber:Gt,toString:sh,indexof:Yde,join:Vde,lastindexof:Xde,replace:Qde,reverse:Jde,sort:Zde,slice:Kde,flush:J_,lerp:e2,merge:zde,pad:r2,peek:Te,pluck:Wde,span:Aa,inrange:Fu,truncate:i2,rgb:ro,lab:Wu,hcl:xc,hsl:yc,luminance:uM,contrast:Ude,sequence:jt,format:Ede,utcFormat:vde,utcParse:Sde,utcOffset:G2,utcSequence:W2,timeFormat:M9,timeParse:wde,timeOffset:q2,timeSequence:j2,timeUnitSpecifier:I2,monthFormat:Ade,monthAbbrevFormat:_de,dayFormat:Cde,dayAbbrevFormat:kde,quarter:Y_,utcquarter:X_,week:B2,utcweek:U2,dayofyear:$2,utcdayofyear:L2,warn:$de,info:Bde,debug:Lde,extent(e){return kr(e)},inScope:Pde,intersect:L9,clampRange:K_,pinchDistance:Gde,pinchAngle:jde,screen:dpe,containerSize:mpe,windowSize:ppe,bandspace:epe,setdata:xde,pathShape:lpe,panLinear:G_,panLog:j_,panPow:W_,panSymlog:V_,zoomLinear:Jm,zoomLog:Zm,zoomPow:Xf,zoomSymlog:eh,encode:bde,modify:qde,lassoAppend:gpe,lassoPath:ype,intersectLasso:xpe},Epe=["view","item","group","xy","x","y"],vpe="event.vega.",U9="this.",mM={},z9={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${Y(N9+e)}]`,functions:wpe,constants:nM,visitors:mM},lM=ov(z9);function wpe(e){let t=rM(e);Epe.forEach(n=>t[n]=vpe+n);for(let n in lp)t[n]=U9+n;return ve(t,Dde(e,lp,mM)),t}function Lt(e,t,n){return arguments.length===1?lp[e]:(lp[e]=t,n&&(mM[e]=n),lM&&(lM.functions[e]=U9+e),this)}Lt("bandwidth",tpe,qr);Lt("copy",npe,qr);Lt("domain",rpe,qr);Lt("range",ope,qr);Lt("invert",ipe,qr);Lt("scale",spe,qr);Lt("gradient",ape,qr);Lt("geoArea",Mde,qr);Lt("geoBounds",Nde,qr);Lt("geoCentroid",Ode,qr);Lt("geoShape",upe,qr);Lt("geoScale",Ide,qr);Lt("indata",yde,Tde);Lt("data",D9,cM);Lt("treePath",cpe,cM);Lt("treeAncestors",fpe,cM);Lt("vlSelectionTest",S9,av);Lt("vlSelectionIdTest",_9,av);Lt("vlSelectionResolve",k9,av);Lt("vlSelectionTuples",C9);function Xo(e,t){let n={},r;try{e=V(e)?e:Y(e)+"",r=iv(e)}catch{U("Expression parse error: "+e)}r.visit(o=>{if(o.type!==JD)return;let s=o.callee.name,a=z9.visitors[s];a&&a(s,o.arguments,t,n)});let i=lM(r);return i.globals.forEach(o=>{let s=N9+o;!ee(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:ve({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function Spe(e){let t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}var Ape=Jt(["rule"]),H9=Jt(["group","image","rect"]);function _pe(e,t){let n="";return Ape[t]||(e.x2&&(e.x?(H9[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(H9[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function hM(e){return(e+"").toLowerCase()}function Cpe(e){return hM(e)==="operator"}function kpe(e){return hM(e)==="collect"}function L0(e,t,n){n.endsWith(";")||(n="return("+n+");");let r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Fpe(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var Rpe={operator:(e,t)=>L0(e,["_"],t.code),parameter:(e,t)=>L0(e,["datum","_"],t.code),event:(e,t)=>L0(e,["event"],t.code),handler:(e,t)=>{let n=`var datum=event.item&&event.item.datum;return ${t.code};`;return L0(e,["_","event"],n)},encode:(e,t)=>{let{marktype:n,channels:r}=t,i="var o=item,datum=o.datum,m=0,$;";for(let o in r){let s="o["+Y(o)+"]";i+=`$=${r[o].code};if(${s}!==$)${s}=$,m=1;`}return i+=_pe(r,n),i+="return m;",L0(e,["item","_"],i)},codegen:{get(e){let t=`[${e.map(Y).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n,r=(o,s)=>{let a=t[s],u,l;return o.path?(u=`a${o.path}`,l=`b${o.path}`):((n=n||{})["f"+s]=o,u=`this.f${s}(a)`,l=`this.f${s}(b)`),Fpe(u,l,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function Tpe(e){let t=this;Cpe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Dpe(e){let t=this;if(e.params){let n=t.get(e.id);n||U("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Mpe(e,t){t=t||{};let n=this;for(let r in e){let i=e[r];t[r]=M(i)?i.map(o=>q9(o,n,t)):q9(i,n,t)}return t}function q9(e,t,n){if(!e||!X(e))return e;for(let r=0,i=G9.length,o;r<i;++r)if(o=G9[r],ee(e,o.key))return o.parse(e,t,n);return e}var G9=[{key:"$ref",parse:Npe},{key:"$key",parse:Ipe},{key:"$expr",parse:Ope},{key:"$field",parse:Ppe},{key:"$encode",parse:Bpe},{key:"$compare",parse:$pe},{key:"$context",parse:Lpe},{key:"$subflow",parse:Upe},{key:"$tupleid",parse:zpe}];function Npe(e,t){return t.get(e.$ref)||U("Operator not defined: "+e.$ref)}function Ope(e,t,n){e.$params&&t.parseParameters(e.$params,n);let r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=tr(t.parameterExpression(e.$expr),e.$fields))}function Ipe(e,t){let n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=rh(e.$key,e.$flat,t.expr.codegen))}function Ppe(e,t){if(!e.$field)return null;let n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=bn(e.$field,e.$name,t.expr.codegen))}function $pe(e,t){let n="c:"+e.$compare+"_"+e.$order,r=Q(e.$compare).map(i=>i&&i.$tupleid?he:i);return t.fn[n]||(t.fn[n]=th(r,e.$order,t.expr.codegen))}function Bpe(e,t){let n=e.$encode,r={};for(let i in n){let o=n[i];r[i]=tr(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function Lpe(e,t){return t}function Upe(e,t){let n=e.$subflow;return function(r,i,o){let s=t.fork().parse(n),a=s.get(n.operators[0].id),u=s.signals.parent;return u&&u.set(o),a.detachSubflow=()=>t.detach(s),a}}function zpe(){return he}function Hpe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&U("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function qpe(e){var t=this,n=X(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,s=void 0;r||U("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)}var Gpe={skip:!0};function jpe(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{let s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{let s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function Wpe(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],Gpe)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(cn).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{let a=t.subcontext[s];a&&a.setState(o)})}function fv(e,t,n,r){return new W9(e,t,n,r)}function W9(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||Rpe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function j9(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}W9.prototype=j9.prototype={fork(){let e=new j9(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);let t=Object.keys(e.nodes);for(let n of t)e.nodes[n]._targets=null;for(let n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){let n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),kpe(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(let o in e.data){let s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[hM(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Spe,parseOperator:Tpe,parseOperatorParameters:Dpe,parseParameters:Mpe,parseStream:Hpe,parseUpdate:qpe,getState:jpe,setState:Wpe};function Vpe(e){let t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),t7(t,e.description()))}function t7(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Ype(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}var gM="default";function Xpe(e){let t=e._signals.cursor||(e._signals.cursor=e.add({user:gM,item:null}));e.on(e.events("view","pointermove"),t,(n,r)=>{let i=t.value,o=i?V(i)?i:i.user:gM,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return V(r)||(i=r.item,r=r.user),xM(e,r&&r!==gM?r:i||r),i},{cursor:t})}function xM(e,t){let n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function mv(e,t){var n=e._runtime.data;return ee(n,t)||U("Unrecognized data set: "+t),n[t]}function Kpe(e,t){return arguments.length<2?mv(this,e).values.value:gv.call(this,e,Oa().remove(cn).insert(t))}function gv(e,t){aC(t)||U("Second argument to changes must be a changeset.");let n=mv(this,e);return n.modified=!0,this.pulse(n.input,t)}function Qpe(e,t){return gv.call(this,e,Oa().insert(t))}function Jpe(e,t){return gv.call(this,e,Oa().remove(t))}function n7(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function r7(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function yv(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Zpe(e){var t=yv(e),n=n7(e),r=r7(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function eme(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,s,a;return i&&(a=yv(e),s=t.changedTouches?t.changedTouches[0]:t,o=qg(s,i),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=tme(e,n,o),t}function tme(e,t,n){let r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(s){var a=r,u;if(s){for(u=t;u;u=u.mark.group)if(u.mark.name===s){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;V(s)&&(s=i(s));let a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:St(e),item:St(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}var V9="view",nme="timer",rme="window",ime={trap:!1};function ome(e){let t=ve({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{M(r[o])&&(r[o]=Jt(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function i7(e,t,n,r){e._eventListeners.push({type:n,sources:Q(t),handler:r})}function sme(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function dv(e,t,n){let r=e._eventConfig&&e._eventConfig[t];return r===!1||X(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function ame(e,t,n){var r=this,i=new cd(n),o=function(l,c){r.runAsync(null,()=>{e===V9&&sme(r,t)&&l.preventDefault(),i.receive(eme(r,l,c))})},s;if(e===nme)dv(r,"timer",t)&&r.timer(o,t);else if(e===V9)dv(r,"view",t)&&r.addEventListener(t,o,ime);else if(e===rme?dv(r,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&dv(r,"selector",t)&&(s=Array.from(document.querySelectorAll(e))),!s)r.warn("Can not resolve event source: "+e);else{for(var a=0,u=s.length;a<u;++a)s[a].addEventListener(t,o);i7(r,s,t,o)}return i}function Y9(e){return e.item}function X9(e){return e.item.mark.source}function K9(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function ume(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",Y9),X9,K9(e)),this.on(this.events("view","pointerout",Y9),X9,K9(t)),this}function lme(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),r=this._eventListeners,i,o,s,a,u;for(i=t.length;--i>=0;)t[i].stop();for(i=r.length;--i>=0;)for(s=r[i],o=s.sources.length;--o>=0;)s.sources[o].removeEventListener(s.type,s.handler);for(e&&e.call(this,this._handler,null,null,null),i=n.length;--i>=0;)u=n[i].type,a=n[i].handler,this._handler.off(u,a);return this}function Di(e,t,n){let r=document.createElement(e);for(let i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}var cme="vega-bind",fme="vega-bind-name",dme="vega-bind-radio";function pme(e,t,n){if(!t)return;let r=n.param,i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=nh(r.debounce,i.update))),(r.input==null&&r.element?mme:gme)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function mme(e,t,n,r){let i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),i7(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(hme(i))}}function hme(e){return typeof Event<"u"?new Event(e):{type:e}}function gme(e,t,n,r){let i=r.signal(n.signal),o=Di("div",{class:cme}),s=n.input==="radio"?o:o.appendChild(Di("label"));s.appendChild(Di("span",{class:fme},n.name||n.signal)),t.appendChild(o);let a=yme;switch(n.input){case"checkbox":a=xme;break;case"select":a=bme;break;case"radio":a=Eme;break;case"range":a=vme;break}a(e,s,n,i)}function yme(e,t,n,r){let i=Di("input");for(let o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function xme(e,t,n,r){let i={type:"checkbox",name:n.signal};r&&(i.checked=!0);let o=Di("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function bme(e,t,n,r){let i=Di("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{let u={value:s};hv(s,r)&&(u.selected=!0),i.appendChild(Di("option",u,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,u=n.options.length;a<u;++a)if(hv(n.options[a],s)){i.selectedIndex=a;return}}}function Eme(e,t,n,r){let i=Di("span",{class:dme}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{let u={type:"radio",name:n.signal,value:s};hv(s,r)&&(u.checked=!0);let l=Di("input",u);l.addEventListener("change",()=>e.update(s));let c=Di("label",{},(o[a]||s)+"");return c.prepend(l),i.appendChild(c),l}),e.set=s=>{let a=e.elements,u=a.length;for(let l=0;l<u;++l)hv(a[l].value,s)&&(a[l].checked=!0)}}function vme(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;let i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||Fr(o,i,100),a=Di("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;let u=Di("span",{},+r);t.appendChild(a),t.appendChild(u);let l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function hv(e,t){return e===t||e+""==t+""}function o7(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,n7(e),r7(e),yv(e),i,o).background(e.background())}function bM(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function wme(e,t,n,r){let i=new r(e.loader(),bM(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,yv(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function Sme(e,t){let n=this,r=n._renderType,i=n._eventConfig.bind,o=Gg(r);e=n._el=e?yM(n,e,!0):null,Vpe(n),o||n.error("Unrecognized renderer type: "+r);let s=o.handler||ol,a=e?o.renderer:o.headless;return n._renderer=a?o7(n,n._renderer,e,a):null,n._handler=wme(n,n._handler,e,s),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=yM(n,t,!0):e.appendChild(Di("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=yM(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{pme(n,u.element||t,u)})),n}function yM(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(r){t=null,e.error(r)}return t}var U0=e=>+e||0,Ame=e=>({top:e,bottom:e,left:e,right:e});function Q9(e){return X(e)?{top:U0(e.top),bottom:U0(e.bottom),left:U0(e.left),right:U0(e.right)}:Ame(U0(e))}async function EM(e,t,n,r){let i=Gg(t),o=i&&i.headless;return o||U("Unrecognized renderer type: "+t),await e.runAsync(),o7(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function _me(e,t){e!==za.Canvas&&e!==za.SVG&&e!==za.PNG&&U("Unrecognized image type: "+e);let n=await EM(this,e,t);return e===za.SVG?Cme(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Cme(e,t){let n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function kme(e,t){return(await EM(this,za.Canvas,e,t)).canvas()}async function Fme(e){return(await EM(this,za.SVG,e)).svg()}function Rme(e,t,n){return fv(e,Na,lp,n).parse(t)}function Tme(e){var t=this._runtime.scales;return ee(t,e)||U("Unrecognized scale or projection: "+e),t[e].value}var s7="width",a7="height",vM="padding",J9={skip:!0};function u7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===vM?r.left+r.right:0)}function l7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===vM?r.top+r.bottom:0)}function Dme(e){var t=e._signals,n=t[s7],r=t[a7],i=t[vM];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=u7(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=l7(e,a.size),o()},{size:r});let s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function Mme(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(s7,n,J9),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(a7,r,J9),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(u=>u.resize())},!1,1)}function Nme(e){return this._runtime.getState(e||{data:Ome,signals:Ime,recurse:!0})}function Ome(e,t){return t.modified&&M(t.input.value)&&!e.startsWith("_:vega:_")}function Ime(e,t){return!(e==="parent"||t instanceof Na.proxy)}function Pme(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function $me(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(BT(n,t))}function Bme(e,t,n,r){let i=e.element();i&&i.setAttribute("title",Lme(r))}function Lme(e){return e==null?"":M(e)?c7(e):X(e)&&!Do(e)?Ume(e):e+""}function Ume(e){return Object.keys(e).map(t=>{let n=e[t];return t+": "+(M(n)?c7(n):f7(n))}).join(`
`)}function c7(e){return"["+e.map(f7).join(", ")+"]"}function f7(e){return M(e)?"[\u2026]":X(e)&&!Do(e)?"{\u2026}":e}function zme(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null,t=()=>{e?.();let n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function wM(e,t){let n=this;if(t=t||{},Bu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){let o=ve({},e.locale,t.locale);n.locale(Vx(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||za.Canvas,n._scenegraph=new Tg;let r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Bme,n._redraw=!0,n._handler=new ol().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=ome(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);let i=Rme(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:ve({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=u7(n,n._width),n._viewHeight=l7(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Dme(n),Ype(n),Xpe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function pv(e,t){return ee(e._signals,t)?e._signals[t]:U("Unrecognized signal name: "+Y(t))}function d7(e,t){let n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function Z9(e,t,n,r){let i=d7(n,r);return i||(i=bM(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function e7(e,t,n){let r=d7(t,n);return r&&t._targets.remove(r),e}Z(wM,Bu,{async evaluate(e,t,n){if(await Bu.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Zpe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Mh(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){let t=e!=null?e+"":null;return t!==this._desc&&t7(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){let r=pv(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Q9(e)):Q9(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Gg(e)||U("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Bu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(pv(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Mme,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=bM(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){let t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return Z9(this,e,pv(this,e),t)},removeSignalListener(e,t){return e7(this,pv(this,e),t)},addDataListener(e,t){return Z9(this,e,mv(this,e).values,t)},removeDataListener(e,t){return e7(this,mv(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){let t=xM(this,null);this._globalCursor=!!e,t&&xM(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:$me,events:ame,finalize:lme,hover:ume,data:Kpe,change:gv,insert:Qpe,remove:Jpe,scale:Tme,initialize:Sme,toImageURL:_me,toCanvas:kme,toSVG:Fme,getState:Nme,setState:Pme,_watchPixelRatio:zme});var Hme="view",xv="[",bv="]",p7="{",m7="}",qme=":",h7=",",Gme="@",jme=">",Wme=/[[\]{}]/,Vme={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},g7,y7;function fr(e,t,n){return g7=t||Hme,y7=n||Vme,x7(e.trim()).map(SM)}function Yme(e){return y7[e]}function z0(e,t,n,r,i){let o=e.length,s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function x7(e){let t=[],n=e.length,r=0,i=0;for(;i<n;)i=z0(e,i,h7,xv+p7,bv+m7),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function SM(e){return e[0]==="["?Xme(e):Kme(e)}function Xme(e){let t=e.length,n=1,r;if(n=z0(e,n,bv,xv,bv),n===t)throw"Empty between selector: "+e;if(r=x7(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==jme)throw"Expected '>' after between selector: "+e;r=r.map(SM);let i=SM(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function Kme(e){let t={source:g7},n=[],r=[0,0],i=0,o=0,s=e.length,a=0,u,l;if(e[s-1]===m7){if(a=e.lastIndexOf(p7),a>=0){try{r=Qme(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===Gme&&(i=++a),u=z0(e,a,qme),u<s&&(n.push(e.substring(o,u).trim()),o=a=++u),a=z0(e,a,xv),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),l=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=z0(e,a,bv),a===s)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==xv)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||Wme.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):Yme(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Qme(e){let t=e.split(h7);if(!e.length||t.length>2)throw e;return t.map(n=>{let r=+n;if(r!==r)throw e;return r})}function Jme(e){return X(e)?e:{type:e||"pad"}}var H0=e=>+e||0,Zme=e=>({top:e,bottom:e,left:e,right:e});function ehe(e){return X(e)?e.signal?e:{top:H0(e.top),bottom:H0(e.bottom),left:H0(e.left),right:H0(e.right)}:Zme(H0(e))}var _n=e=>X(e)&&!M(e)?ve({},e):{value:e};function b7(e,t,n,r){return n!=null?(X(n)&&!M(n)||M(n)&&n.length&&X(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Hn(e,t,n){for(let r in t)b7(e,r,t[r]);for(let r in n)b7(e,r,n[r],"update")}function hp(e,t,n){for(let r in t)n&&ee(n,r)||(e[r]=ve(e[r]||{},t[r]));return e}function fp(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var OM="mark",IM="frame",PM="scope",the="axis",nhe="axis-domain",rhe="axis-grid",ihe="axis-label",ohe="axis-tick",she="axis-title",ahe="legend",uhe="legend-band",lhe="legend-entry",che="legend-gradient",B7="legend-label",fhe="legend-symbol",dhe="legend-title",phe="title",mhe="title-text",hhe="title-subtitle";function ghe(e,t,n,r,i){let o={},s={},a,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!fp(u,e)&&AM(o,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===IM?i.group:n===OM?ve({},i.mark,i[t]):null;for(u in c)l=fp(u,e)||(u==="fill"||u==="stroke")&&(fp("fill",e)||fp("stroke",e)),l||AM(o,u,c[u]);Q(r).forEach(f=>{let d=i.style&&i.style[f];for(let p in d)fp(p,e)||AM(o,p,d[p])}),e=ve({},e);for(u in o)c=o[u],c.signal?(a=a||{})[u]=c:s[u]=c;return e.enter=ve(s,e.enter),a&&(e.update=ve(a,e.update)),e}function AM(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}var L7=e=>V(e)?Y(e):e.signal?`(${e.signal})`:U7(e);function kv(e){if(e.gradient!=null)return xhe(e);let t=e.signal?`(${e.signal})`:e.color?yhe(e.color):e.field!=null?U7(e.field):e.value!==void 0?Y(e.value):void 0;return e.scale!=null&&(t=bhe(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${vv(e.exponent)})`),e.mult!=null&&(t+=`*${vv(e.mult)}`),e.offset!=null&&(t+=`+${vv(e.offset)}`),e.round&&(t=`round(${t})`),t}var Ev=(e,t,n,r)=>`(${e}(${[t,n,r].map(kv).join(",")})+'')`;function yhe(e){return e.c?Ev("hcl",e.h,e.c,e.l):e.h||e.s?Ev("hsl",e.h,e.s,e.l):e.l||e.a?Ev("lab",e.l,e.a,e.b):e.r||e.g||e.b?Ev("rgb",e.r,e.g,e.b):null}function xhe(e){let t=[e.start,e.stop,e.count].map(n=>n==null?null:Y(n));for(;t.length&&Te(t)==null;)t.pop();return t.unshift(L7(e.gradient)),`gradient(${t.join(",")})`}function vv(e){return X(e)?"("+kv(e)+")":e}function U7(e){return z7(X(e)?e:{datum:e})}function z7(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):U("Invalid field reference: "+Y(e));return e.signal||(r=V(r)?Xi(r).map(Y).join("]["):z7(r)),t+"["+r+"]"}function bhe(e,t){let n=L7(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+vv(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Ehe(e){let t="";return e.forEach(n=>{let r=kv(n);t+=n.test?`(${n.test})?${r}:`:r}),Te(t)===":"&&(t+="null"),t}function H7(e,t,n,r,i,o){let s={};o=o||{},o.encoders={$encode:s},e=ghe(e,t,n,r,i.config);for(let a in e)s[a]=vhe(e[a],t,o,i);return o}function vhe(e,t,n,r){let i={},o={};for(let s in e)e[s]!=null&&(i[s]=She(whe(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function whe(e){return M(e)?Ehe(e):kv(e)}function She(e,t,n,r){let i=Xo(e,t);return i.$fields.forEach(o=>r[o]=1),ve(n,i.$params),i.$expr}var Ahe="outer",_he=["value","update","init","react","bind"];function E7(e,t){U(e+' for "outer" push: '+Y(t))}function q7(e,t){let n=e.name;if(e.push===Ahe)t.signals[n]||E7("No prior signal definition",n),_he.forEach(r=>{e[r]!==void 0&&E7("Invalid property ",r)});else{let r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function kM(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function Fv(e,t,n,r){return new kM(e,t,n,r)}function Cv(e,t){return Fv("operator",e,t)}function xe(e){let t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function j0(e,t){return t?{$field:e,$name:t}:{$field:e}}var FM=j0("key");function v7(e,t){return{$compare:e,$order:t}}function Che(e,t){let n={$key:e};return t&&(n.$flat=!0),n}var khe="ascending",Fhe="descending";function Rhe(e){return X(e)?(e.order===Fhe?"-":"+")+Rv(e.op,e.field):""}function Rv(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var $M="scope",RM="view";function mn(e){return e&&e.signal}function The(e){return e&&e.expr}function wv(e){if(mn(e))return!0;if(X(e)){for(let t in e)if(wv(e[t]))return!0}return!1}function Ko(e,t){return e??t}function Kc(e){return e&&e.signal||e}var w7="timer";function W0(e,t){return(e.merge?Mhe:e.stream?Nhe:e.type?Ohe:U("Invalid stream specification: "+Y(e)))(e,t)}function Dhe(e){return e===$M?RM:e||RM}function Mhe(e,t){let n=e.merge.map(i=>W0(i,t)),r=BM({merge:n},e,t);return t.addStream(r).id}function Nhe(e,t){let n=W0(e.stream,t),r=BM({stream:n},e,t);return t.addStream(r).id}function Ohe(e,t){let n;e.type===w7?(n=t.event(w7,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Dhe(e.source),e.type);let r=BM({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function BM(e,t,n){let r=t.between;return r&&(r.length!==2&&U('Stream "between" parameter must have 2 entries: '+Y(t)),e.between=[W0(r[0],n),W0(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(Ihe(t.marktype,t.markname,t.markrole)),t.source===$M&&r.push("inScope(event.item)"),r.length&&(e.filter=Xo("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function Ihe(e,t,n){let r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}var Phe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function $he(e,t,n){let r=e.encode,i={target:n},o=e.events,s=e.update,a=[];o||U("Signal update missing events specification."),V(o)&&(o=fr(o,t.isSubscope()?$M:RM)),o=Q(o).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[Lhe(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),r!=null&&(s&&U("Signal encode and update are mutually exclusive."),s="encode(item(),"+Y(r)+")"),i.update=V(s)?Xo(s,t):s.expr!=null?Xo(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:Phe,$params:{$value:t.signalRef(s.signal)}}:U("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(u=>t.addUpdate(ve(Bhe(u,t),i)))}function Bhe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):W0(e,t)}}function Lhe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Uhe(e,t){let n=t.getSignal(e.name),r=e.update;e.init&&(r?U("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Xo(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>$he(i,t,n.id))}var ct=e=>(t,n,r)=>Fv(e,n,t||void 0,r),G7=ct("aggregate"),zhe=ct("axisticks"),j7=ct("bound"),Jo=ct("collect"),S7=ct("compare"),Hhe=ct("datajoin"),W7=ct("encode"),qhe=ct("expression"),Ghe=ct("facet"),jhe=ct("field"),Whe=ct("key"),Vhe=ct("legendentries"),Yhe=ct("load"),Xhe=ct("mark"),Khe=ct("multiextent"),Qhe=ct("multivalues"),Jhe=ct("overlap"),Zhe=ct("params"),V7=ct("prefacet"),ege=ct("projection"),tge=ct("proxy"),nge=ct("relay"),Y7=ct("render"),rge=ct("scale"),Jc=ct("sieve"),ige=ct("sortitems"),X7=ct("viewlayout"),oge=ct("values"),sge=0,K7={min:"min",max:"max",count:"sum"};function age(e,t){let n=e.type||"linear";eF(n)||U("Unrecognized scale type: "+Y(n)),t.addScale(e.name,{type:n,domain:void 0})}function uge(e,t){let n=t.getScale(e.name).params,r;n.domain=Q7(e.domain,e,t),e.range!=null&&(n.range=Z7(e,t,n)),e.interpolate!=null&&xge(e.interpolate,n),e.nice!=null&&(n.nice=yge(e.nice,t)),e.bins!=null&&(n.bins=gge(e.bins,t));for(r in e)ee(n,r)||r==="name"||(n[r]=co(e[r],t))}function co(e,t){return X(e)?e.signal?t.signalRef(e.signal):U("Unsupported object: "+Y(e)):e}function Sv(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>co(n,t))}function Tv(e){U("Can not find data set: "+Y(e))}function Q7(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&U("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(M(e)?lge:e.fields?fge:cge)(e,t,n)}function lge(e,t,n){return e.map(r=>co(r,n))}function cge(e,t,n){let r=n.getData(e.data);return r||Tv(e.data),Ku(t.type)?r.valuesRef(n,e.field,J7(e.sort,!1)):rF(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function fge(e,t,n){let r=e.data,i=e.fields.reduce((o,s)=>(s=V(s)?{data:r,field:s}:M(s)||s.signal?dge(s,n):s,o.push(s),o),[]);return(Ku(t.type)?pge:rF(t.type)?mge:hge)(e,n,i)}function dge(e,t){let n="_:vega:_"+sge++,r=Jo({});if(M(e))r.value={$ingest:e};else if(e.signal){let i="setdata("+Y(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Jc({})]),{data:n,field:"data"}}function pge(e,t,n){let r=J7(e.sort,!0),i,o,s=n.map(l=>{let c=t.getData(l.data);return c||Tv(l.data),c.countsRef(t,l.field,r)}),a={groupby:FM,pulse:s};r&&(i=r.op||"count",o=r.field?Rv(i,r.field):"count",a.ops=[K7[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(G7(a));let u=t.add(Jo({pulse:xe(i)}));return o=t.add(oge({field:FM,sort:t.sortRef(r),pulse:xe(u)})),xe(o)}function J7(e,t){return e&&(!e.field&&!e.op?X(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?U("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!K7[e.op]&&U("Multiple domain scales can not be sorted using "+e.op)),e}function mge(e,t,n){let r=n.map(i=>{let o=t.getData(i.data);return o||Tv(i.data),o.domainRef(t,i.field)});return xe(t.add(Qhe({values:r})))}function hge(e,t,n){let r=n.map(i=>{let o=t.getData(i.data);return o||Tv(i.data),o.extentRef(t,i.field)});return xe(t.add(Khe({extents:r})))}function gge(e,t){return e.signal||M(e)?Sv(e,t):t.objectProperty(e)}function yge(e,t){return e.signal?t.signalRef(e.signal):X(e)?{interval:co(e.interval),step:co(e.step)}:co(e)}function xge(e,t){t.interpolate=co(e.type||e),e.gamma!=null&&(t.interpolateGamma=co(e.gamma))}function Z7(e,t,n){let r=t.config.range,i=e.range;if(i.signal)return t.signalRef(i.signal);if(V(i)){if(r&&ee(r,i))return e=ve({},e,{range:r[i]}),Z7(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Ku(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:U("Unrecognized scale range value: "+Y(i))}else if(i.scheme){n.scheme=M(i.scheme)?Sv(i.scheme,t):co(i.scheme,t),i.extent&&(n.schemeExtent=Sv(i.extent,t)),i.count&&(n.schemeCount=co(i.count,t));return}else if(i.step){n.rangeStep=co(i.step,t);return}else{if(Ku(e.type)&&!M(i))return Q7(i,e,t);M(i)||U("Unsupported range type: "+Y(i))}return i.map(o=>(M(o)?Sv:co)(o,t))}function bge(e,t){let n=t.config.projection||{},r={};for(let i in e)i!=="name"&&(r[i]=TM(e[i],i,t));for(let i in n)r[i]==null&&(r[i]=TM(n[i],i,t));t.addProjection(e.name,r)}function TM(e,t,n){return M(e)?e.map(r=>TM(r,t,n)):X(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:U("Unsupported parameter object: "+Y(e)):e}var Zo="top",gp="left",yp="right",bl="bottom",ez="center",Ege="vertical",vge="start",wge="middle",Sge="end",DM="index",LM="label",Age="offset",mp="perc",_ge="perc2",fo="value",Y0="guide-label",UM="guide-title",Cge="group-title",kge="group-subtitle",A7="symbol",Av="gradient",MM="discrete",NM="size",Fge="shape",Rge="fill",Tge="stroke",Dge="strokeWidth",Mge="strokeDash",Nge="opacity",zM=[NM,Fge,Rge,Tge,Dge,Mge,Nge],X0={name:1,style:1,interactive:1},We={value:0},po={value:1},Dv="group",tz="rect",HM="rule",Oge="symbol",Zc="text";function V0(e){return e.type=Dv,e.interactive=e.interactive||!1,e}function li(e,t){let n=(r,i)=>Ko(e[r],Ko(t[r],i));return n.isVertical=r=>Ege===Ko(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Ko(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Ko(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Ko(e.columns,Ko(t.columns,+n.isVertical(!0))),n}function nz(e,t){let n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Ige(e,t,n){let r=t.config.style[n];return r&&r[e]}function Mv(e,t,n){return`item.anchor === '${vge}' ? ${e} : item.anchor === '${Sge}' ? ${t} : ${n}`}var qM=Mv(Y(gp),Y(yp),Y(ez));function Pge(e){let t=e("tickBand"),n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},X(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function rz(e,t){return t?e?X(e)?Object.assign({},e,{offset:rz(e.offset,t)}):{value:e,offset:t}:t:e}function Mi(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=hp(e.encode,t,X0)):e.interactive=!1,e}function $ge(e,t,n,r){let i=li(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength(),u,l,c,f,d;o?(l=[0,1],c=[0,0],f=s,d=a):(l=[0,0],c=[1,0],f=a,d=s);let p={enter:u={opacity:We,x:We,y:We,width:_n(f),height:_n(d)},update:ve({},u,{opacity:po,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:We}};return Hn(p,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Mi({type:tz,role:che,encode:p},r)}function Bge(e,t,n,r,i){let o=li(e,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength(),l,c,f,d,p="";s?(l="y",f="y2",c="x",d="width",p="1-"):(l="x",f="x2",c="y",d="height");let m={opacity:We,fill:{scale:t,field:fo}};m[l]={signal:p+"datum."+mp,mult:u},m[c]=We,m[f]={signal:p+"datum."+_ge,mult:u},m[d]=_n(a);let h={enter:m,update:ve({},m,{opacity:po}),exit:{opacity:We}};return Hn(h,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Mi({type:tz,role:uhe,key:fo,from:i,encode:h},r)}var Lge=`datum.${mp}<=0?"${gp}":datum.${mp}>=1?"${yp}":"${ez}"`,Uge=`datum.${mp}<=0?"${bl}":datum.${mp}>=1?"${Zo}":"${wge}"`;function _7(e,t,n,r){let i=li(e,t),o=i.isVertical(),s=_n(i.gradientThickness()),a=i.gradientLength(),u=i("labelOverlap"),l,c,f,d,p="",m={enter:l={opacity:We},update:c={opacity:po,text:{field:LM}},exit:{opacity:We}};return Hn(m,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:Ko(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:Uge},f="y",d="x",p="1-"):(l.align=c.align={signal:Lge},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:p+"datum."+mp,mult:a},l[d]=c[d]=s,s.offset=Ko(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+DM}:void 0,Mi({type:Zc,role:B7,style:Y0,key:fo,from:r,encode:m,overlap:u},n)}function zge(e,t,n,r,i){let o=li(e,t),s=n.entries,a=!!(s&&s.interactive),u=s?s.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${Age} : datum.${NM}`,p=l?_n(l):{field:NM},m=`datum.${DM}`,h=`max(1, ${i})`,g,y,x,b,E;p.mult=.5,g={enter:y={opacity:We,x:{signal:d,mult:.5,offset:c},y:p},update:x={opacity:po,x:y.x,y:y.y},exit:{opacity:We}};let v=null,S=null;e.fill||(v=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),Hn(g,{fill:o("symbolFillColor",v),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",S),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),zM.forEach(F=>{e[F]&&(x[F]=y[F]={scale:e[F],field:fo})});let w=Mi({type:Oge,role:fhe,key:fo,from:f,clip:l?!0:void 0,encode:g},n.symbols),_=_n(c);_.offset=o("labelOffset"),g={enter:y={opacity:We,x:{signal:d,offset:_},y:p},update:x={opacity:po,text:{field:LM},x:y.x,y:y.y},exit:{opacity:We}},Hn(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});let A=Mi({type:Zc,role:B7,style:Y0,key:fo,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!l},width:We,height:l?_n(l):We,opacity:We},exit:{opacity:We},update:x={opacity:po,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${h})`,x.row.signal=`${m}%${b}`,x.column.signal=`floor(${m} / ${b})`,E={field:["row",m]}):(x.row.signal=`floor(${m} / ${h})`,x.column.signal=`${m} % ${h}`,E={field:m}),x.column.signal=`(${i})?${x.column.signal}:${m}`,r={facet:{data:r,name:"value",groupby:DM}},V0({role:PM,from:r,encode:hp(g,s,X0),marks:[w,A],name:u,interactive:a,sort:E})}function Hge(e,t){let n=li(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}var GM='item.orient === "left"',jM='item.orient === "right"',Nv=`(${GM} || ${jM})`,qge=`datum.vgrad && ${Nv}`,Gge=Mv('"top"','"bottom"','"middle"'),jge=Mv('"right"','"left"','"center"'),Wge=`datum.vgrad && ${jM} ? (${jge}) : (${Nv} && !(datum.vgrad && ${GM})) ? "left" : ${qM}`,Vge=`item._anchor || (${Nv} ? "middle" : "start")`,Yge=`${qge} ? (${GM} ? -90 : 90) : 0`,Xge=`${Nv} ? (datum.vgrad ? (${jM} ? "bottom" : "top") : ${Gge}) : "top"`;function Kge(e,t,n,r){let i=li(e,t),o={enter:{opacity:We},update:{opacity:po,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:We}};return Hn(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Vge},angle:{signal:Yge},align:{signal:Wge},baseline:{signal:Xge},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Mi({type:Zc,role:dhe,style:UM,from:r,encode:o},n)}function Qge(e,t){let n;return X(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+C7(e.path)+")":e.sphere&&(n="geoShape("+C7(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function C7(e){return X(e)&&e.signal?e.signal:Y(e)}function iz(e){let t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===Dv?PM:t||OM}function Jge(e){return{marktype:e.type,name:e.name||void 0,role:e.role||iz(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Zge(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function WM(e,t){let n=r1(e.type);n||U("Unrecognized transform type: "+Y(e.type));let r=Fv(n.type.toLowerCase(),null,oz(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function oz(e,t,n){let r={},i=e.params.length;for(let o=0;o<i;++o){let s=e.params[o];r[s.name]=e0e(s,t,n)}return r}function e0e(e,t,n){let r=e.type,i=t[e.name];if(r==="index")return t0e(e,t,n);if(i===void 0){e.required&&U("Missing required "+Y(t.type)+" parameter: "+Y(e.name));return}else{if(r==="param")return n0e(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!mn(i)?i.map(o=>k7(e,o,n)):k7(e,i,n)}function k7(e,t,n){let r=e.type;if(mn(t))return R7(r)?U("Expression references can not be signals."):_M(r)?n.fieldRef(t):T7(r)?n.compareRef(t):n.signalRef(t.signal);{let i=e.expr||_M(r);return i&&r0e(t)?n.exprRef(t.expr,t.as):i&&i0e(t)?j0(t.field,t.as):R7(r)?Xo(t,n):o0e(r)?xe(n.getData(t).values):_M(r)?j0(t):T7(r)?n.compareRef(t):t}}function t0e(e,t,n){return V(t.from)||U('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function n0e(e,t,n){let r=t[e.name];return e.array?(M(r)||U("Expected an array of sub-parameters. Instead: "+Y(r)),r.map(i=>F7(e,i,n))):F7(e,r,n)}function F7(e,t,n){let r=e.params.length,i;for(let s=0;s<r;++s){i=e.params[s];for(let a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||U("Unsupported parameter: "+Y(t));let o=ve(oz(i,t,n),i.key);return xe(n.add(Zhe(o)))}var r0e=e=>e&&e.expr,i0e=e=>e&&e.field,o0e=e=>e==="data",R7=e=>e==="expr",_M=e=>e==="field",T7=e=>e==="compare";function s0e(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||U("Only group marks can be faceted."),r.field!=null?s=a=_v(r,n):(e.data?a=xe(n.getData(e.data).aggregate):(o=WM(ve({type:"aggregate",groupby:Q(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=_v(r,n),s=a=xe(n.add(o))),i=n.keyRef(r.groupby,!0))):s=xe(n.add(Jo(null,[{}]))),s||(s=_v(e,n)),{key:i,pulse:s,parent:a}}function _v(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:xe(t.getData(e.data).output)}function Qc(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Qc.fromEntries=function(e,t){let n=t.length,r=t[n-1],i=t[n-2],o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=xe(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new Qc(e,o,i,r,s)};function sz(e){return V(e)?e:null}function D7(e,t,n){let r=Rv(n.op,n.field),i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function q0(e,t,n,r,i,o,s){let a=t[n]||(t[n]={}),u=Rhe(o),l=sz(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){let d=o?{field:FM,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:xe(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(Fv(r,void 0,d)),s&&(t.index[i]=f),c=xe(f),l!=null&&(a[l]=c)}return c}Qc.prototype={countsRef(e,t,n){let r=this,i=r.counts||(r.counts={}),o=sz(t),s,a,u;return o!=null&&(e=r.scope,s=i[o]),s?n&&n.field&&D7(e,s.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:xe(r.output)},n&&n.field&&D7(e,u,n),a=e.add(G7(u)),s=e.add(Jo({pulse:xe(a)})),s={agg:a,ref:xe(s)},o!=null&&(i[o]=s)),s.ref},tuplesRef(){return xe(this.values)},extentRef(e,t){return q0(e,this,"extent","extent",t,!1)},domainRef(e,t){return q0(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return q0(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return q0(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return q0(e,this,"indata","tupleindex",t,!0,!0)}};function a0e(e,t,n){let r=e.from.facet,i=r.name,o=_v(r,t),s;r.name||U("Facet must have a name: "+Y(r)),r.data||U("Facet must reference a data set: "+Y(r)),r.field?s=t.add(V7({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(Ghe({key:t.keyRef(r.groupby),group:xe(t.proxy(n.parent)),pulse:o})):U("Facet must specify groupby or field: "+Y(r));let a=t.fork(),u=a.add(Jo()),l=a.add(Jc({pulse:xe(u)}));a.addData(i,new Qc(a,u,u,l)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function u0e(e,t,n){let r=t.add(V7({pulse:n.pulse})),i=t.fork();i.add(Jc()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function az(e,t,n){let r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,u=t.add(Cv()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(f=>f??"null").join(",")+"),0)",c=Xo(l,t);u.update=c.$expr,u.params=c.$params}function Ov(e,t){let n=iz(e),r=e.type===Dv,i=e.from&&e.from.facet,o=e.overlap,s=e.layout||n===PM||n===IM,a,u,l,c,f,d,p,m=n===OM||s||i,h=s0e(e.from,r,t);u=t.add(Hhe({key:h.key||(e.key?j0(e.key):void 0),pulse:h.pulse,clean:!r}));let g=xe(u);u=l=t.add(Jo({pulse:g})),u=t.add(Xhe({markdef:Jge(e),interactive:Zge(e.interactive,t),clip:Qge(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:xe(u)}));let y=xe(u);u=c=t.add(W7(H7(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{let w=WM(S,t),_=w.metadata;(_.generates||_.changes)&&U("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),w.params.pulse=xe(u),t.add(u=w)}),e.sort&&(u=t.add(ige({sort:t.compareRef(e.sort),pulse:xe(u)})));let x=xe(u);(i||s)&&(s=t.add(X7({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:x})),d=xe(s));let b=t.add(j7({mark:y,pulse:d||x}));p=xe(b),r&&(m&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(x,d||p,g),i?a0e(e,t,h):m?u0e(e,t,h):t.parse(e),t.popState(),m&&(s&&a.push(s),a.push(b))),o&&(p=l0e(o,p,t));let E=t.add(Y7({pulse:p})),v=t.add(Jc({pulse:xe(E)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Qc(t,l,E,v)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&U("Marks only support modify triggers."),az(S,t,f)}))}function l0e(e,t,n){let r=e.method,i=e.bound,o=e.separation,s={separation:mn(o)?n.signalRef(o.signal):o,method:mn(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){let a=i.tolerance;s.boundTolerance=mn(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return xe(n.add(Jhe(s)))}function c0e(e,t){let n=t.config.legend,r=e.encode||{},i=li(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,l={},c=0,f,d,p;zM.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||U("Missing valid scale for legend.");let m=f0e(e,t.scaleType(c)),h={title:e.title!=null,scales:l,type:m,vgrad:m!=="symbol"&&i.isVertical()},g=xe(t.add(Jo(null,[h]))),y={enter:{x:{value:0},y:{value:0}}},x=xe(t.add(Vhe(d={type:m,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return m===Av?(p=[$ge(e,c,n,r.gradient),_7(e,n,r.labels,x)],d.count=d.count||t.signalRef(`max(2,2*floor((${Kc(i.gradientLength())})/100))`)):m===MM?p=[Bge(e,c,n,r.gradient,x),_7(e,n,r.labels,x)]:(f=Hge(e,n),p=[zge(e,n,r,x,Kc(f.columns))],d.size=m0e(e,t,p[0].marks)),p=[V0({role:lhe,from:g,encode:y,marks:p,layout:f,interactive:a})],h.title&&p.push(Kge(e,n,r.title,g)),Ov(V0({role:ahe,from:g,encode:hp(p0e(i,e,n),o,X0),marks:p,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),t)}function f0e(e,t){let n=e.type||A7;return!e.type&&d0e(e)===1&&(e.fill||e.stroke)&&(n=xg(t)?Av:fb(t)?MM:A7),n!==Av?n:fb(t)?MM:Av}function d0e(e){return zM.reduce((t,n)=>t+(e[n]?1:0),0)}function p0e(e,t,n){let r={enter:{},update:{}};return Hn(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function m0e(e,t,n){let r=Kc(M7("size",e,n)),i=Kc(M7("strokeWidth",e,n)),o=Kc(h0e(n[1].encode,t,Y0));return Xo(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function M7(e,t,n){return t[e]?`scale("${t[e]}",datum)`:nz(e,n[0].encode)}function h0e(e,t,n){return nz("fontSize",e)||Ige("fontSize",t,n)}var g0e=`item.orient==="${gp}"?-90:item.orient==="${yp}"?90:0`;function y0e(e,t){e=V(e)?{text:e}:e;let n=li(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],l={},c=xe(t.add(Jo(null,[l])));return u.push(E0e(e,n,x0e(e),c)),e.subtitle&&u.push(v0e(e,n,r.subtitle,c)),Ov(V0({role:phe,from:c,encode:b0e(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function x0e(e){let t=e.encode;return t&&t.title||ve({name:e.name,interactive:e.interactive,style:e.style},t)}function b0e(e,t){let n={enter:{},update:{}};return Hn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:qM},angle:{signal:g0e},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),hp(n,t,X0)}function E0e(e,t,n,r){let i={value:0},o=e.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Hn(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Mi({type:Zc,role:mhe,style:Cge,from:r,encode:s},n)}function v0e(e,t,n,r){let i={value:0},o=e.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Hn(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Mi({type:Zc,role:hhe,style:kge,from:r,encode:s},n)}function w0e(e,t){let n=[];e.transform&&e.transform.forEach(r=>{n.push(WM(r,t))}),e.on&&e.on.forEach(r=>{az(r,t,e.name)}),t.addDataPipeline(e.name,S0e(e,t,n))}function S0e(e,t,n){let r=[],i=null,o=!1,s=!1,a,u,l,c,f;for(e.values?mn(e.values)||wv(e.format)?(r.push(N7(t,e)),r.push(i=Xc())):r.push(i=Xc({$ingest:e.values,$format:e.format})):e.url?wv(e.url)||wv(e.format)?(r.push(N7(t,e)),r.push(i=Xc())):r.push(i=Xc({$request:e.url,$format:e.format})):e.source&&(i=a=Q(e.source).map(d=>xe(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Xc()),r.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?i=c:f.changes&&(i=null);return a&&(l=a.length-1,r[0]=nge({derive:o,pulse:l?a:a[0]}),(o||l)&&r.splice(1,0,Xc())),i||r.push(Xc()),r.push(Jc({})),r}function Xc(e){let t=Jo({},e);return t.metadata={source:!0},t}function N7(e,t){return Yhe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}var uz=e=>e===bl||e===Zo,Iv=(e,t,n)=>mn(e)?k0e(e.signal,t,n):e===gp||e===Zo?t:n,Cn=(e,t,n)=>mn(e)?_0e(e.signal,t,n):uz(e)?t:n,Qo=(e,t,n)=>mn(e)?C0e(e.signal,t,n):uz(e)?n:t,lz=(e,t,n)=>mn(e)?F0e(e.signal,t,n):e===Zo?{value:t}:{value:n},A0e=(e,t,n)=>mn(e)?R0e(e.signal,t,n):e===yp?{value:t}:{value:n},_0e=(e,t,n)=>cz(`${e} === '${Zo}' || ${e} === '${bl}'`,t,n),C0e=(e,t,n)=>cz(`${e} !== '${Zo}' && ${e} !== '${bl}'`,t,n),k0e=(e,t,n)=>VM(`${e} === '${gp}' || ${e} === '${Zo}'`,t,n),F0e=(e,t,n)=>VM(`${e} === '${Zo}'`,t,n),R0e=(e,t,n)=>VM(`${e} === '${yp}'`,t,n),cz=(e,t,n)=>(t=t!=null?_n(t):t,n=n!=null?_n(n):n,O7(t)&&O7(n)?(t=t?t.signal||Y(t.value):null,n=n?n.signal||Y(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[ve({test:e},t)].concat(n||[])),O7=e=>e==null||Object.keys(e).length===1,VM=(e,t,n)=>({signal:`${e} ? (${dp(t)}) : (${dp(n)})`}),T0e=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${gp}' ? (${dp(r)}) : `:"")+(n!=null?`${e} === '${bl}' ? (${dp(n)}) : `:"")+(i!=null?`${e} === '${yp}' ? (${dp(i)}) : `:"")+(t!=null?`${e} === '${Zo}' ? (${dp(t)}) : `:"")+"(null)"}),dp=e=>mn(e)?e.signal:e==null?null:Y(e),D0e=(e,t)=>t===0?0:mn(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},pp=(e,t)=>{let n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function cp(e,t,n,r){let i;if(t&&ee(t,e))return t[e];if(ee(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[UM][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Y0][i]}return null}function I7(e){let t={};for(let n of e)if(n)for(let r in n)t[r]=1;return Object.keys(t)}function M0e(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,u,l;if(mn(s)){let f=I7([n.axisX,n.axisY]),d=I7([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=Cn(s,cp(l,n.axisX,i,r),cp(l,n.axisY,i,r));u={};for(l of d)u[l]=T0e(s.signal,cp(l,n.axisTop,i,r),cp(l,n.axisBottom,i,r),cp(l,n.axisLeft,i,r),cp(l,n.axisRight,i,r))}else a=s===Zo||s===bl?n.axisX:n.axisY,u=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||u||o?ve({},i,a,u,o):i}function N0e(e,t,n,r){let i=li(e,t),o=e.orient,s,a,u={enter:s={opacity:We},update:a={opacity:po},exit:{opacity:We}};Hn(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});let l=P7(e,0),c=P7(e,1);return s.x=a.x=Cn(o,l,We),s.x2=a.x2=Cn(o,c),s.y=a.y=Qo(o,l,We),s.y2=a.y2=Qo(o,c),Mi({type:HM,role:nhe,from:r,encode:u},n)}function P7(e,t){return{scale:e.scale,range:t}}function O0e(e,t,n,r,i){let o=li(e,t),s=e.orient,a=e.gridScale,u=Iv(s,1,-1),l=I0e(e.offset,u),c,f,d,p={enter:c={opacity:We},update:d={opacity:po},exit:f={opacity:We}};Hn(p,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});let m={scale:e.scale,field:fo,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},h=Cn(s,{signal:"height"},{signal:"width"}),g=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},y=a?{scale:a,range:1,mult:u,offset:l}:ve(h,{mult:u,offset:l});return c.x=d.x=Cn(s,m,g),c.y=d.y=Qo(s,m,g),c.x2=d.x2=Qo(s,y),c.y2=d.y2=Cn(s,y),f.x=Cn(s,m),f.y=Qo(s,m),Mi({type:HM,role:rhe,key:fo,from:r,encode:p},n)}function I0e(e,t){if(t!==1)if(!X(e))e=mn(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=ve({},e);for(;n.mult!=null;)if(X(n.mult))n=n.mult=ve({},n.mult);else return n.mult=mn(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function P0e(e,t,n,r,i,o){let s=li(e,t),a=e.orient,u=Iv(a,-1,1),l,c,f,d={enter:l={opacity:We},update:f={opacity:po},exit:c={opacity:We}};Hn(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});let p=_n(i);p.mult=u;let m={scale:e.scale,field:fo,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=l.y=Cn(a,We,m),f.y2=l.y2=Cn(a,p),c.x=Cn(a,m),f.x=l.x=Qo(a,We,m),f.x2=l.x2=Qo(a,p),c.y=Qo(a,m),Mi({type:HM,role:ohe,key:fo,from:r,encode:d},n)}function CM(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function $0e(e,t,n,r,i,o){let s=li(e,t),a=e.orient,u=e.scale,l=Iv(a,-1,1),c=Kc(s("labelFlush")),f=Kc(s("labelFlushOffset")),d=s("labelAlign"),p=s("labelBaseline"),m=c===0||!!c,h,g=_n(i);g.mult=l,g.offset=_n(s("labelPadding")||0),g.offset.mult=l;let y={scale:u,field:fo,band:.5,offset:rz(o.offset,s("labelOffset"))},x=Cn(a,m?CM(u,c,'"left"','"right"','"center"'):{value:"center"},A0e(a,"left","right")),b=Cn(a,lz(a,"bottom","top"),m?CM(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),E=CM(u,c,`-(${f})`,f,0);m=m&&f;let v={opacity:We,x:Cn(a,y,g),y:Qo(a,y,g)},S={enter:v,update:h={opacity:po,text:{field:LM},x:v.x,y:v.y,align:x,baseline:b},exit:{opacity:We,x:v.x,y:v.y}};Hn(S,{dx:!d&&m?Cn(a,E):null,dy:!p&&m?Qo(a,E):null}),Hn(S,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:p});let w=s("labelBound"),_=s("labelOverlap");return _=_||w?{separation:s("labelSeparation"),method:_,order:"datum.index",bound:w?{scale:u,orient:a,tolerance:w}:null}:void 0,h.align!==x&&(h.align=pp(h.align,x)),h.baseline!==b&&(h.baseline=pp(h.baseline,b)),Mi({type:Zc,role:ihe,style:Y0,key:fo,from:r,encode:S,overlap:_},n)}function B0e(e,t,n,r){let i=li(e,t),o=e.orient,s=Iv(o,-1,1),a,u,l={enter:a={opacity:We,anchor:_n(i("titleAnchor",null)),align:{signal:qM}},update:u=ve({},a,{opacity:po,text:_n(e.title)}),exit:{opacity:We}},c={signal:`lerp(range("${e.scale}"), ${Mv(0,1,.5)})`};return u.x=Cn(o,c),u.y=Qo(o,c),a.angle=Cn(o,We,D0e(s,90)),a.baseline=Cn(o,lz(o,bl,Zo),{value:bl}),u.angle=a.angle,u.baseline=a.baseline,Hn(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),L0e(i,o,l,n),l.update.align=pp(l.update.align,a.align),l.update.angle=pp(l.update.angle,a.angle),l.update.baseline=pp(l.update.baseline,a.baseline),Mi({type:Zc,role:she,style:UM,from:r,encode:l},n)}function L0e(e,t,n,r){let i=(a,u)=>a!=null?(n.update[u]=pp(_n(a),n.update[u]),!1):!fp(u,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?_n(s):Cn(t,_n(s),_n(o))}function U0e(e,t){let n=M0e(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=li(e,n),l=Pge(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=xe(t.add(Jo({},[c]))),d=xe(t.add(zhe({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[],m;return c.grid&&p.push(O0e(e,n,r.grid,d,l)),c.ticks&&(m=u("tickSize"),p.push(P0e(e,n,r.ticks,d,m,l))),c.labels&&(m=c.ticks?m:0,p.push($0e(e,n,r.labels,d,m,l))),c.domain&&p.push(N0e(e,n,r.domain,f)),c.title&&p.push(B0e(e,n,r.title,f)),Ov(V0({role:the,from:f,encode:hp(z0e(u,e),i,X0),marks:p,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),t)}function z0e(e,t){let n={enter:{},update:{}};return Hn(n,{orient:e("orient"),offset:e("offset")||0,position:Ko(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function fz(e,t,n){let r=Q(e.signals),i=Q(e.scales);return n||r.forEach(o=>q7(o,t)),Q(e.projections).forEach(o=>bge(o,t)),i.forEach(o=>age(o,t)),Q(e.data).forEach(o=>w0e(o,t)),i.forEach(o=>uge(o,t)),(n||r).forEach(o=>Uhe(o,t)),Q(e.axes).forEach(o=>U0e(o,t)),Q(e.marks).forEach(o=>Ov(o,t)),Q(e.legends).forEach(o=>c0e(o,t)),e.title&&y0e(e.title,t),t.parseLambdas(),t}var H0e=e=>hp({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function q0e(e,t){let n=t.config,r=xe(t.root=t.add(Cv())),i=G0e(e,n);i.forEach(l=>q7(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;let o=t.add(Jo()),s=t.add(W7(H7(H0e(e.encode),Dv,IM,e.style,t,{pulse:xe(o)}))),a=t.add(X7({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:xe(s)}));t.operators.pop(),t.pushState(xe(s),xe(a),null),fz(e,t,i),t.operators.push(a);let u=t.add(j7({mark:r,pulse:xe(a)}));return u=t.add(Y7({pulse:xe(u)})),u=t.add(Jc({pulse:xe(u)})),t.addData("root",new Qc(t,o,o,u)),t}function G0(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function G0e(e,t){let n=s=>Ko(e[s],t[s]),r=[G0("background",n("background")),G0("autosize",Jme(n("autosize"))),G0("padding",ehe(n("padding"))),G0("width",n("width")||0),G0("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return Q(e.signals).forEach(s=>{ee(i,s.name)?s=ve(i[s.name],s):r.push(s),o[s.name]=s}),Q(t.signals).forEach(s=>{!ee(o,s.name)&&!ee(i,s.name)&&r.push(s)}),r}function dz(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function $7(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}dz.prototype=$7.prototype={parse(e){return fz(e,this)},fork(){return new $7(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){let t=e instanceof kM?xe(e):e;return this.add(tge({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(let r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(xe(this.add(Jc({pulse:e})))),this._parent.push(t),this._lookup.push(n?xe(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Te(this._parent)},encode(){return Te(this._encode)},lookup(){return Te(this._lookup)},markpath(){let e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(V(e))return j0(e,t);e.signal||U("Unsupported field reference: "+Y(e));let n=e.signal,r=this.field[n];if(!r){let i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=xe(this.add(jhe(i)))}return r},compareRef(e){let t=!1,n=o=>mn(o)?(t=!0,this.signalRef(o.signal)):The(o)?(t=!0,this.exprRef(o.expr)):o,r=Q(e.field).map(n),i=Q(e.order).map(n);return t?xe(this.add(S7({fields:r,orders:i}))):v7(r,i)},keyRef(e,t){let n=!1,r=o=>mn(o)?(n=!0,xe(i[o.signal])):o,i=this.signals;return e=Q(e).map(r),n?xe(this.add(Whe({fields:e,flat:t}))):Che(e,t)},sortRef(e){if(!e)return e;let t=Rv(e.op,e.field),n=e.order||khe;return n.signal?xe(this.add(S7({fields:t,orders:this.signalRef(n.signal)}))):v7(t,n)},event(e,t){let n=e+":"+t;if(!this.events[n]){let r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ee(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&U("Duplicate signal name: "+Y(e));let n=t instanceof kM?t:this.add(Cv(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||U("Unrecognized signal name: "+Y(e)),this.signals[e]},signalRef(e){return this.signals[e]?xe(this.signals[e]):(ee(this.lambdas,e)||(this.lambdas[e]=this.add(Cv(null))),xe(this.lambdas[e]))},parseLambdas(){let e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){let r=e[t],i=Xo(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!X(e)?e:this.signalRef(e.signal||YM(e))},exprRef(e,t){let n={expr:Xo(e,this)};return t&&(n.expr.$name=t),xe(this.add(qhe(n)))},addBinding(e,t){this.bindings||U("Nested signals do not support binding: "+Y(e)),this.bindings.push(ve({signal:e},t))},addScaleProj(e,t){ee(this.scales,e)&&U("Duplicate scale or projection name: "+Y(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,rge(t))},addProjection(e,t){this.addScaleProj(e,ege(t))},getScale(e){return this.scales[e]||U("Unrecognized scale name: "+Y(e)),this.scales[e]},scaleRef(e){return xe(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ee(this.data,e)&&U("Duplicate data set name: "+Y(e)),this.data[e]=t},getData(e){return this.data[e]||U("Undefined data set name: "+Y(e)),this.data[e]},addDataPipeline(e,t){return ee(this.data,e)&&U("Duplicate data set name: "+Y(e)),this.addData(e,Qc.fromEntries(this,t))}};function YM(e){return(M(e)?j0e:W0e)(e)}function j0e(e){let t=e.length,n="[";for(let r=0;r<t;++r){let i=e[r];n+=(r>0?",":"")+(X(i)?i.signal||YM(i):Y(i))}return n+"]"}function W0e(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+Y(r)+":"+(X(i)?i.signal||YM(i):Y(i));return t+"}"}function V0e(){let e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function pz(e,t,n){return X(e)||U("Input Vega specification must be an object."),t=Ts(V0e(),t,e.config),q0e(e,new dz(t,n)).toRuntime()}var Y0e="5.33.0";ve(Na,XC,uR,pR,DT,jT,ND,wD,$D,UD,qD,WD);function X0e(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var K0e={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Q0e={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},J0e={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e},Z0e=Array.prototype.slice,ef=(e,t,n)=>{let r=n?n(t[0]):t[0];return r[e].apply(r,Z0e.call(t,1))},eye=(e,t,n,r,i,o,s)=>new Date(e,t||0,n??1,r||0,i||0,o||0,s||0),tye={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:eye,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return ef("join",arguments)},indexof:function(){return ef("indexOf",arguments)},lastindexof:function(){return ef("lastIndexOf",arguments)},slice:function(){return ef("slice",arguments)},reverse:e=>e.slice().reverse(),sort:e=>e.slice().sort(Sa),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return ef("substring",arguments,String)},split:function(){return ef("split",arguments,String)},replace:function(){return ef("replace",arguments,String)},trim:e=>String(e).trim(),btoa:e=>btoa(e),atob:e=>atob(e),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)},nye=["view","item","group","xy","x","y"],KM=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&KM.add(setImmediate);var rye={Literal:(e,t)=>t.value,Identifier:(e,t)=>{let n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:K0e[n]||e.params["$"+n]},MemberExpression:(e,t)=>{let n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);let i=e(t.property);if(n&&(e.memberDepth-=1),KM.has(r[i])){console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`);return}return r[i]},CallExpression:(e,t)=>{let n=t.arguments,r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||tye[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>Q0e[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>J0e[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;let i=e(r.key);return e.memberDepth-=1,KM.has(e(r.value))?console.error(`Prevented interpretation of property "${i}" which could lead to insecure code execution`):n[i]=e(r.value),n},{})};function K0(e,t,n,r,i,o){let s=a=>rye[a.type](s,a);return s.memberDepth=0,s.fn=Object.create(t),s.params=n,s.datum=r,s.event=i,s.item=o,nye.forEach(a=>s.fn[a]=function(){return i.vega[a](...arguments)}),s(e)}var mz={operator(e,t){let n=t.ast,r=e.functions;return i=>K0(n,r,i)},parameter(e,t){let n=t.ast,r=e.functions;return(i,o)=>K0(n,r,o,i)},event(e,t){let n=t.ast,r=e.functions;return i=>K0(n,r,void 0,void 0,i)},handler(e,t){let n=t.ast,r=e.functions;return(i,o)=>{let s=o.item&&o.item.datum;return K0(n,r,i,s,o)}},encode(e,t){let{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(s,a)=>{let u=s.datum,l=0,c;for(let f in r)c=K0(r[f].ast,i,a,u,void 0,s),s[f]!==c&&(s[f]=c,l=1);return n!=="rule"&&X0e(s,r,o),l}}};var sI={};er(sI,{accessPathDepth:()=>tf,accessPathWithDatum:()=>Z0,accessWithDatumToUnescapedPath:()=>Je,compile:()=>IW,contains:()=>ge,deepEqual:()=>kn,deleteNestedProperty:()=>J0,duplicate:()=>se,entries:()=>ci,every:()=>Uv,fieldIntersection:()=>Hv,flatAccessWithDatum:()=>tN,getFirstDefined:()=>Be,hasIntersection:()=>zv,hasProperty:()=>j,hash:()=>fe,internalField:()=>rN,isBoolean:()=>bp,isEmpty:()=>Me,isEqual:()=>sye,isInternalField:()=>xz,isNullOrFalse:()=>Lv,isNumeric:()=>ey,keys:()=>P,logicalExpr:()=>xp,mergeDeep:()=>ZM,never:()=>JM,normalize:()=>iS,normalizeAngle:()=>Sl,omit:()=>Ut,pick:()=>Za,prefixGenerator:()=>QM,removePathFromField:()=>eu,replaceAll:()=>es,replacePathInField:()=>sn,resetIdCounter:()=>uye,setEqual:()=>eN,some:()=>vl,stringify:()=>He,titleCase:()=>wl,unique:()=>dr,uniqueId:()=>nN,vals:()=>dt,varName:()=>ze,version:()=>Ywe});var hz={name:"vega-lite",author:'Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version:"5.23.0",collaborators:["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",keywords:["vega","chart","visualization"],main:"build/vega-lite.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",module:"build/src/index",types:"build/src/index.d.ts",bin:{vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},files:["bin","build","src","vega-lite*","tsconfig.json"],scripts:{changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data","build-editor-preview":"scripts/build-editor-preview.sh",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@babel/core":"^7.26.0","@babel/preset-env":"^7.26.0","@babel/preset-typescript":"^7.26.0","@release-it/conventional-changelog":"^9.0.3","@rollup/plugin-alias":"^5.1.1","@rollup/plugin-babel":"^6.0.4","@rollup/plugin-commonjs":"^28.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.3.0","@rollup/plugin-terser":"^0.4.4","@types/d3":"^7.4.3","@types/jest":"^29.5.14","@types/pako":"^2.0.3","@typescript-eslint/eslint-plugin":"^7.17.0","@typescript-eslint/parser":"^7.17.0",ajv:"^8.17.1","ajv-formats":"^3.0.1",cheerio:"^1.0.0","conventional-changelog-cli":"^5.0.0",d3:"^7.9.0","del-cli":"^6.0.0",eslint:"^8.57.0","eslint-config-prettier":"^9.1.0","eslint-plugin-jest":"^27.9.0","eslint-plugin-prettier":"^5.2.1","fast-json-stable-stringify":"~2.1.0","highlight.js":"^11.10.0",jest:"^29.7.0","jest-dev-server":"^10.1.4",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^3.3.3",puppeteer:"^15.0.0","release-it":"17.10.0",rollup:"^4.27.3","rollup-plugin-bundle-size":"^1.0.3",serve:"^14.2.4",terser:"^5.36.0","ts-jest":"^29.2.5","ts-json-schema-generator":"^2.3.0",typescript:"~5.7.2","vega-cli":"^5.30.0","vega-datasets":"^2.11.0","vega-embed":"^6.28.0","vega-tooltip":"^0.35.2","yaml-front-matter":"^4.1.1"},dependencies:{"json-stringify-pretty-compact":"~4.0.0",tslib:"~2.8.1","vega-event-selector":"~3.0.1","vega-expression":"~5.1.1","vega-util":"~1.17.2",yargs:"~17.7.2"},peerDependencies:{vega:"^5.24.0"},engines:{node:">=18"},packageManager:"yarn@1.22.22"};function Pv(e){return j(e,"or")}function $v(e){return j(e,"and")}function Bv(e){return j(e,"not")}function Q0(e,t){if(Bv(e))Q0(e.not,t);else if($v(e))for(let n of e.and)Q0(n,t);else if(Pv(e))for(let n of e.or)Q0(n,t);else t(e)}function El(e,t){return Bv(e)?{not:El(e.not,t)}:$v(e)?{and:e.and.map(n=>El(n,t))}:Pv(e)?{or:e.or.map(n=>El(n,t))}:t(e)}var se=structuredClone;function JM(e){throw new Error(e)}function Za(e,t){let n={};for(let r of t)ee(e,r)&&(n[r]=e[r]);return n}function Ut(e,t){let n={...e};for(let r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>He(e)).join(",")})`};function fe(e){if(ke(e))return e;let t=V(e)?e:He(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function Lv(e){return e===!1||e===null}function ge(e,t){return e.includes(t)}function vl(e,t){let n=0;for(let[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function Uv(e,t){let n=0;for(let[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function ZM(e,...t){for(let n of t)oye(e,n??{});return e}function oye(e,t){for(let n of P(t))wa(e,n,t[n],!0)}function dr(e,t){let n=[],r={},i;for(let o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function sye(e,t){let n=P(e),r=P(t);if(n.length!==r.length)return!1;for(let i of n)if(e[i]!==t[i])return!1;return!0}function eN(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function zv(e,t){for(let n of e)if(t.has(n))return!0;return!1}function QM(e){let t=new Set;for(let n of e){let i=Xi(n).map((s,a)=>a===0?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(let s of o)t.add(s)}return t}function Hv(e,t){return e===void 0||t===void 0?!0:zv(QM(e),QM(t))}function Me(e){return P(e).length===0}var P=Object.keys,dt=Object.values,ci=Object.entries;function bp(e){return e===!0||e===!1}function ze(e){let t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function xp(e,t){return Bv(e)?`!(${xp(e.not,t)})`:$v(e)?`(${e.and.map(n=>xp(n,t)).join(") && (")})`:Pv(e)?`(${e.or.map(n=>xp(n,t)).join(") || (")})`:t(e)}function J0(e,t){if(t.length===0)return!0;let n=t.shift();return n in e&&J0(e[n],t)&&delete e[n],Me(e)}function wl(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Z0(e,t="datum"){let n=Xi(e),r=[];for(let i=1;i<=n.length;i++){let o=`[${n.slice(0,i).map(Y).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function tN(e,t="datum"){return`${t}[${Y(Xi(e).join("."))}]`}function Je(e){return`datum['${e.replaceAll("'","\\'")}']`}function aye(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function sn(e){return`${Xi(e).map(aye).join("\\.")}`}function es(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function eu(e){return`${Xi(e).join(".")}`}function tf(e){return e?Xi(e).length:0}function Be(...e){return e.find(t=>t!==void 0)}var yz=42;function nN(e){let t=++yz;return e?String(e)+t:t}function uye(){yz=42}function rN(e){return xz(e)?e:`__${e}`}function xz(e){return e.startsWith("__")}function Sl(e){if(e!==void 0)return(e%360+360)%360}function ey(e){return ke(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var gz=Object.getPrototypeOf(structuredClone({}));function kn(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,r;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!kn(e[r],t[r]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let o of e.entries())if(!t.has(o[0]))return!1;for(let o of e.entries())if(!kn(o[1],t.get(o[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let o of e.entries())if(!t.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==gz.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==gz.toString)return e.toString()===t.toString();let i=Object.keys(e);if(n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){let o=i[r];if(!kn(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function He(e){let t=[];return function n(r){if(r&&r.toJSON&&typeof r.toJSON=="function"&&(r=r.toJSON()),r===void 0)return;if(typeof r=="number")return isFinite(r)?""+r:"null";if(typeof r!="object")return JSON.stringify(r);let i,o;if(Array.isArray(r)){for(o="[",i=0;i<r.length;i++)i&&(o+=","),o+=n(r[i])||"null";return o+"]"}if(r===null)return"null";if(t.includes(r))throw new TypeError("Converting circular structure to JSON");let s=t.push(r)-1,a=Object.keys(r).sort();for(o="",i=0;i<a.length;i++){let u=a[i],l=n(r[u]);l&&(o&&(o+=","),o+=JSON.stringify(u)+":"+l)}return t.splice(s,1),`{${o}}`}(e)}function j(e,t){return X(e)&&ee(e,t)&&e[t]!==void 0}var fi="row",di="column",Ep="facet",Ve="x",pt="y",pi="x2",Ni="y2",mo="xOffset",Zs="yOffset",pr="radius",ts="radius2",qn="theta",ns="theta2",Gn="latitude",jn="longitude",mr="latitude2",Wn="longitude2",Oi="time",zt="color",hr="fill",gr="stroke",Tt="shape",mi="size",rs="angle",Gr="opacity",Ii="fillOpacity",Pi="strokeOpacity",$i="strokeWidth",Bi="strokeDash",nf="text",Al="order",rf="detail",vp="key",tu="tooltip",wp="href",Sp="url",Ap="description",lye={x:1,y:1,x2:1,y2:1},bz={theta:1,theta2:1,radius:1,radius2:1};function iN(e){return ee(bz,e)}var oN={longitude:1,longitude2:1,latitude:1,latitude2:1};function Gv(e){switch(e){case Gn:return"y";case mr:return"y2";case jn:return"x";case Wn:return"x2"}}function jv(e){return ee(oN,e)}var Ez=P(oN),sN={...lye,...bz,...oN,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function nu(e){return e===zt||e===hr||e===gr}var vz={row:1,column:1,facet:1},Fn=P(vz),aN={...sN,...vz},wz=P(aN),{order:Uze,detail:zze,tooltip:Hze,...Sz}=aN,{row:qze,column:Gze,facet:jze,...Az}=Sz,Wze=P(Sz),Vze=P(Az);function _z(e){return ee(Az,e)}function Wv(e){return ee(aN,e)}var Cz=[pi,Ni,mr,Wn,ns,ts];function Vv(e){return Li(e)!==e}function Li(e){switch(e){case pi:return Ve;case Ni:return pt;case mr:return Gn;case Wn:return jn;case ns:return qn;case ts:return pr}return e}function ho(e){if(iN(e))switch(e){case qn:return"startAngle";case ns:return"endAngle";case pr:return"outerRadius";case ts:return"innerRadius"}return e}function Rn(e){switch(e){case Ve:return pi;case pt:return Ni;case Gn:return mr;case jn:return Wn;case qn:return ns;case pr:return ts}}function Dt(e){switch(e){case Ve:case pi:return"width";case pt:case Ni:return"height"}}function uN(e){switch(e){case Ve:return"xOffset";case pt:return"yOffset";case pi:return"x2Offset";case Ni:return"y2Offset";case qn:return"thetaOffset";case pr:return"radiusOffset";case ns:return"theta2Offset";case ts:return"radius2Offset"}}function _p(e){switch(e){case Ve:return"xOffset";case pt:return"yOffset"}}function kz(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}var Fz=P(sN),{x:Yze,y:Xze,x2:Kze,y2:Qze,xOffset:Jze,yOffset:Zze,latitude:eHe,longitude:tHe,latitude2:nHe,longitude2:rHe,theta:iHe,theta2:oHe,radius:sHe,radius2:aHe,...lN}=sN,Rz=P(lN),cN={x:1,y:1},Vn=P(cN);function Ye(e){return ee(cN,e)}var Yv={theta:1,radius:1},Tz=P(Yv);function _l(e){return e==="width"?Ve:pt}var fN={xOffset:1,yOffset:1},uHe=P(fN);function ru(e){return ee(fN,e)}var Dz={time:1},lHe=P(Dz);function Xv(e){return e in Dz}var{text:cHe,tooltip:fHe,href:dHe,url:pHe,description:mHe,detail:hHe,key:gHe,order:yHe,...Mz}=lN,Nz=P(Mz);function Oz(e){return ee(lN,e)}function Iz(e){switch(e){case zt:case hr:case gr:case mi:case Tt:case Gr:case $i:case Bi:return!0;case Ii:case Pi:case rs:case Oi:return!1}}var Pz={...cN,...Yv,...fN,...Mz},Cp=P(Pz);function an(e){return ee(Pz,e)}function $z(e,t){return fye(e)[t]}var Bz={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:xHe,...cye}=Bz;function fye(e){switch(e){case zt:case hr:case gr:case Ap:case rf:case vp:case tu:case wp:case Al:case Gr:case Ii:case Pi:case $i:case Ep:case fi:case di:return Bz;case Ve:case pt:case mo:case Zs:case Gn:case jn:case Oi:return cye;case pi:case Ni:case mr:case Wn:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case mi:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Bi:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Tt:return{point:"always",geoshape:"always"};case nf:return{text:"always"};case rs:return{point:"always",square:"always",text:"always"};case Sp:return{image:"always"};case qn:return{text:"always",arc:"always"};case pr:return{text:"always",arc:"always"};case ns:case ts:return{arc:"always"}}}function Kv(e){switch(e){case Ve:case pt:case qn:case pr:case mo:case Zs:case mi:case rs:case $i:case Gr:case Ii:case Pi:case Oi:case pi:case Ni:case ns:case ts:return;case Ep:case fi:case di:case Tt:case Bi:case nf:case tu:case wp:case Sp:case Ap:return"discrete";case zt:case hr:case gr:return"flexible";case Gn:case jn:case mr:case Wn:case rf:case vp:case Al:return}}var pye={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Lz={count:1,min:1,max:1};function Ui(e){return j(e,"argmin")}function go(e){return j(e,"argmax")}function kp(e){return V(e)&&ee(pye,e)}var mye=new Set(["count","valid","missing","distinct"]);function Cl(e){return V(e)&&mye.has(e)}function Uz(e){return V(e)&&ge(["min","max"],e)}var zz=new Set(["count","sum","distinct","valid","missing"]),Hz=new Set(["mean","average","median","q1","q3","min","max"]);function Qv(e){return Zr(e)&&(e=Rp(e,void 0)),"bin"+P(e).map(t=>Fp(e[t])?ze(`_${t}_${ci(e[t])}`):ze(`_${t}_${e[t]}`)).join("")}function Ie(e){return e===!0||is(e)&&!e.binned}function mt(e){return e==="binned"||is(e)&&e.binned===!0}function is(e){return X(e)}function Fp(e){return j(e,"param")}function dN(e){switch(e){case fi:case di:case mi:case zt:case hr:case gr:case $i:case Gr:case Ii:case Pi:case Tt:return 6;case Bi:return 4;default:return 10}}function kl(e){return j(e,"expr")}function kt(e,{level:t}={level:0}){let n=P(e||{}),r={};for(let i of n)r[i]=t===0?Tn(e[i]):kt(e[i],{level:t-1});return r}function Jv(e){let{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:p,subtitlePadding:m,...h}=e,g={...h,...a?{fill:a}:{}},y={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...o!==void 0?{angle:o}:{},...s!==void 0?{limit:s}:{}},x={...u?{subtitleColor:u}:{},...l?{subtitleFont:l}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...p?{subtitleLineHeight:p}:{},...m?{subtitlePadding:m}:{}},b=Za(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:g,subtitleMarkConfig:b,nonMarkTitleProperties:y,subtitle:x}}function os(e){return V(e)||M(e)&&V(e[0])}function re(e){return j(e,"signal")}function hi(e){return j(e,"step")}function qz(e){return M(e)?!1:j(e,"fields")&&!j(e,"data")}function Gz(e){return M(e)?!1:j(e,"fields")&&j(e,"data")}function ss(e){return M(e)?!1:j(e,"field")&&j(e,"data")}var hye={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},jz=P(hye),Wz={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Zv=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function ew(e){let t=M(e.condition)?e.condition.map(Vz):Vz(e.condition);return{...Tn(e),condition:t}}function Tn(e){if(kl(e)){let{expr:t,...n}=e;return{signal:t,...n}}return e}function Vz(e){if(kl(e)){let{expr:t,...n}=e;return{signal:t,...n}}return e}function Pe(e){if(kl(e)){let{expr:t,...n}=e;return{signal:t,...n}}return re(e)?e:e!==void 0?{value:e}:void 0}function Yz(e){return re(e)?e.signal:Y(e)}function pN(e){return re(e)?e.signal:Y(e.value)}function jr(e){return re(e)?e.signal:e==null?null:Y(e)}function Xz(e,t,n){for(let r of n){let i=Wr(r,t.markDef,t.config);i!==void 0&&(e[r]=Pe(i))}return e}function mN(e){return[].concat(e.type,e.style??[])}function Ne(e,t,n,r={}){let{vgChannel:i,ignoreVgConfig:o}=r;return i&&j(t,i)?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:Wr(e,t,n,r)}function Wr(e,t,n,{vgChannel:r}={}){let i=tw(e,t,n.style);return Be(r?i:void 0,i,r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function tw(e,t,n){return hN(e,mN(t),n)}function hN(e,t,n){t=Q(t);let r;for(let i of t){let o=n[i];j(o,e)&&(r=o[e])}return r}function nw(e,t){return Q(e).reduce((n,r)=>(n.field.push(K(r,t)),n.order.push(r.sort??"ascending"),n),{field:[],order:[]})}function gN(e,t){let n=[...e];return t.forEach(r=>{for(let i of n)if(kn(i,r))return;n.push(r)}),n}function yN(e,t){return kn(e,t)||!t?e:e?[...Q(e),...Q(t)].join(", "):t}function rw(e,t){let n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((os(n)||re(n))&&(os(r)||re(r)))return{explicit:e.explicit,value:yN(n,r)};if(os(n)||re(n))return{explicit:e.explicit,value:n};if(os(r)||re(r))return{explicit:e.explicit,value:r};if(!os(n)&&!re(n)&&!os(r)&&!re(r))return{explicit:e.explicit,value:gN(n,r)};throw new Error("It should never reach here")}var $={};er($,{ADD_SAME_CHILD_TWICE:()=>Lye,CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN:()=>fxe,CONCAT_CANNOT_SHARE_AXIS:()=>Pye,FACETED_INDEPENDENT_DIFFERENT_SOURCES:()=>Fxe,FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES:()=>Rxe,FACETED_INDEPENDENT_SAME_SOURCE:()=>Txe,FIT_NON_SINGLE:()=>yye,INTERVAL_INITIALIZED_WITH_POS:()=>Nye,INVALID_CHANNEL_FOR_AXIS:()=>Dxe,LEGEND_BINDINGS_MUST_HAVE_PROJECTION:()=>Rye,LINE_WITH_VARYING_SIZE:()=>exe,MORE_THAN_ONE_SORT:()=>kxe,MULTIPLE_TIMER_ANIMATION_SELECTION:()=>xN,MULTI_VIEW_ANIMATION_UNSUPPORTED:()=>of,NEEDS_SAME_SELECTION:()=>Mye,NO_FIELDS_NEEDS_AS:()=>zye,REPLACE_ANGLE_WITH_THETA:()=>Gye,SCALE_BINDINGS_CONTINUOUS:()=>kye,SEQUENTIAL_SCALE_DEPRECATED:()=>Fye,cannotApplySizeToNonOrientedMark:()=>yxe,cannotLookupVariableParameter:()=>Tye,cannotProjectAggregate:()=>Sye,cannotProjectOnChannelWithoutField:()=>wye,cannotStackRangedMark:()=>Mxe,cannotUseRelativeBandSizeWithNonBandScale:()=>pxe,cannotUseScalePropertyWithNonColor:()=>dxe,channelRequiredForBinned:()=>zxe,channelShouldBeDiscrete:()=>ixe,channelShouldBeDiscreteOrDiscretizing:()=>oxe,channelShouldNotBeUsedForBinned:()=>Hxe,columnsNotSupportByRowCol:()=>Iye,containerSizeNonSingle:()=>xye,containerSizeNotCompatibleWithAutosize:()=>bye,customFormatTypeNotAllowed:()=>Hye,differentParse:()=>Bye,discreteChannelCannotEncode:()=>axe,domainRequiredForThresholdScale:()=>qxe,domainSortDropped:()=>Cxe,droppedDay:()=>Pxe,droppingColor:()=>Qye,droppingFit:()=>Eye,emptyFieldDef:()=>Zye,errorBand1DNotSupport:()=>Uxe,errorBarCenterAndExtentAreNotNeeded:()=>$xe,errorBarCenterIsUsedWithWrongExtent:()=>Bxe,errorBarContinuousAxisHasCustomizedAggregate:()=>Lxe,facetChannelDropped:()=>sxe,incompatibleChannel:()=>txe,independentScaleMeansIndependentGuide:()=>_xe,invalidAggregate:()=>Xye,invalidEncodingChannel:()=>rxe,invalidFieldType:()=>Vye,invalidFieldTypeForCountAggregate:()=>Yye,invalidSpec:()=>gye,invalidTimeUnit:()=>Ixe,invalidTransformIgnored:()=>Uye,lineWithRange:()=>lxe,mergeConflictingDomainProperty:()=>Axe,mergeConflictingProperty:()=>Sxe,missingFieldType:()=>Kye,nearestNotSupportForContinuous:()=>Aye,noSameUnitLookup:()=>Dye,noSuchRepeatedValue:()=>Oye,offsetEncodingScaleIgnored:()=>nxe,offsetNestedInsideContinuousPositionScaleDropped:()=>jye,orientOverridden:()=>cxe,primitiveChannelDef:()=>Wye,projectionOverridden:()=>qye,rangeMarkAlignmentCannotBeExpression:()=>uxe,relativeBandSizeNotSupported:()=>Jye,scalePropertyNotWorkWithScaleType:()=>Exe,scaleTypeNotWorkWithChannel:()=>xxe,scaleTypeNotWorkWithFieldDef:()=>bxe,scaleTypeNotWorkWithMark:()=>vxe,selectionAsScaleDomainWithoutField:()=>bN,selectionAsScaleDomainWrongEncodings:()=>EN,selectionNotFound:()=>Cye,selectionNotSupported:()=>_ye,stackNonLinearScale:()=>Nxe,stackNonSummativeAggregate:()=>Oxe,stepDropped:()=>wxe,unaggregateDomainHasNoEffectForRawField:()=>mxe,unaggregateDomainWithNonSharedDomainOp:()=>hxe,unaggregatedDomainWithLogScale:()=>gxe,unknownField:()=>vye,unrecognizedParse:()=>$ye});function gye(e){return`Invalid specification ${He(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}var yye='Autosize "fit" only works for single views and layered views.';function xye(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function bye(e){let t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function Eye(e){return e?`Dropping "fit-${e}" because spec has discrete ${Dt(e)}.`:'Dropping "fit" because spec has discrete size.'}function vye(e){return`Unknown field for ${e}. Cannot calculate view size.`}function wye(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Sye(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Aye(e){return`The "nearest" transform is not supported for ${e} marks.`}function _ye(e){return`Selection not supported for ${e} yet.`}function Cye(e){return`Cannot find a selection named "${e}".`}var kye="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Fye="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",Rye="Legend bindings are only supported for selections over an individual field or encoding channel.";function Tye(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Dye(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}var Mye="The same selection must be used to override scale domains in a layered view.",Nye='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function Oye(e){return`Unknown repeated value "${e}".`}function Iye(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}var xN="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",of="Animation involving facet, layer, or concat is currently unsupported.";function bN(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Y(e)}.`}function EN(e,t,n,r){return(e.length?"Multiple ":"No ")+`matching ${Y(t)} encoding found for selection ${Y(n.param)}. Using "field": ${Y(r)}.`}var Pye="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function $ye(e){return`Unrecognized parse "${e}".`}function Bye(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}var Lye="Attempt to add the same child twice.";function Uye(e){return`Ignoring an invalid transform: ${He(e)}.`}var zye='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function Hye(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function qye(e){let{parentProjection:t,projection:n}=e;return`Layer's shared projection ${He(t)} is overridden by a child projection ${He(n)}.`}var Gye="Arc marks uses theta channel rather than angle, replacing angle with theta.";function jye(e){return`${e}Offset dropped because ${e} is continuous`}function Wye(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${He(n)}}.`}function Vye(e){return`Invalid field type "${e}".`}function Yye(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Xye(e){return`Invalid aggregation operator "${e}".`}function Kye(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function Qye(e,t){let{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Jye(e){return`Position range does not support relative band size for ${e}.`}function Zye(e,t){return`Dropping ${He(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}var exe="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function txe(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function nxe(e){return`${e} encoding has no scale, so specified scale is ignored.`}function rxe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function ixe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function oxe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function sxe(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function axe(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function uxe(e){return`The ${e} for range marks cannot be an expression`}function lxe(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function cxe(e,t){return`Specified orient "${e}" overridden with "${t}".`}var fxe="Custom domain scale cannot be unioned with default field-based domain.";function dxe(e){return`Cannot use the scale property "${e}" with non-color channel.`}function pxe(e){return`Cannot use the relative band size with ${e} scale.`}function mxe(e){return`Using unaggregated domain with raw field has no effect (${He(e)}).`}function hxe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function gxe(e){return`Unaggregated domain is currently unsupported for log scale (${He(e)}).`}function yxe(e){return`Cannot apply size to non-oriented mark "${e}".`}function xxe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function bxe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Exe(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function vxe(e,t){return`Scale type "${t}" does not work with mark "${e}".`}function wxe(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Sxe(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${He(n)} and ${He(r)}). Using ${He(n)}.`}function Axe(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${He(n)} and ${He(r)}). Using the union of the two domains.`}function _xe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Cxe(e){return`Dropping sort property ${He(e)} as unioned domains only support boolean or op "count", "min", and "max".`}var kxe="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Fxe="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Rxe="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Txe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",Dxe="Invalid channel for axis.";function Mxe(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Nxe(e){return`Stack is applied to a non-linear scale (${e}).`}function Oxe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Ixe(e,t){return`Invalid ${e}: ${He(t)}.`}function Pxe(e){return`Dropping day from datetime ${He(e)} as day cannot be combined with other units.`}function $xe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Bxe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Lxe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function Uxe(e){return`1D error band does not support ${e}.`}function zxe(e){return`Channel ${e} is required for "binned" bin.`}function Hxe(e){return`Channel ${e} should not be used with "binned" bin.`}function qxe(e){return`Domain for ${e} is required for threshold scale.`}var Gxe,Kz=Qm(Cx),sf=Kz;Gxe=new WeakMap;function Qz(e){return sf=e,sf}function Jz(){return sf=Kz,sf}function Tp(...e){sf.error(...e)}function z(...e){sf.warn(...e)}function Zz(...e){sf.debug(...e)}function yo(e){if(e&&X(e)){for(let t of iw)if(j(e,t))return!0}return!1}var eH=["january","february","march","april","may","june","july","august","september","october","november","december"],jxe=eH.map(e=>e.substr(0,3)),tH=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Wxe=tH.map(e=>e.substr(0,3));function Vxe(e){if(ey(e)&&(e=+e),ke(e))return e>4&&z($.invalidTimeUnit("quarter",e)),e-1;throw new Error($.invalidTimeUnit("quarter",e))}function Yxe(e){if(ey(e)&&(e=+e),ke(e))return e-1;{let t=e.toLowerCase(),n=eH.indexOf(t);if(n!==-1)return n;let r=t.substr(0,3),i=jxe.indexOf(r);if(i!==-1)return i;throw new Error($.invalidTimeUnit("month",e))}}function Xxe(e){if(ey(e)&&(e=+e),ke(e))return e%7;{let t=e.toLowerCase(),n=tH.indexOf(t);if(n!==-1)return n;let r=t.substr(0,3),i=Wxe.indexOf(r);if(i!==-1)return i;throw new Error($.invalidTimeUnit("day",e))}}function vN(e,t){let n=[];if(t&&e.day!==void 0&&P(e).length>1&&(z($.droppedDay(e)),e=se(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){let r=t?Yxe(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){let r=t?Vxe(e.quarter):e.quarter;n.push(ke(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){let r=t?Xxe(e.day):e.day;n.push(ke(r)?r+1:`${r}+1`)}else n.push(1);for(let r of["hours","minutes","seconds","milliseconds"]){let i=e[r];n.push(typeof i>"u"?0:i)}return n}function as(e){let n=vN(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function nH(e){let n=vN(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function rH(e){let t=vN(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var iH={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},iw=P(iH);function oH(e){return ee(iH,e)}var Kxe={binnedyear:1,binnedyearquarter:1,binnedyearquartermonth:1,binnedyearmonth:1,binnedyearmonthdate:1,binnedyearmonthdatehours:1,binnedyearmonthdatehoursminutes:1,binnedyearmonthdatehoursminutesseconds:1,binnedyearweek:1,binnedyearweekday:1,binnedyearweekdayhours:1,binnedyearweekdayhoursminutes:1,binnedyearweekdayhoursminutesseconds:1,binnedyeardayofyear:1},Qxe={binnedutcyear:1,binnedutcyearquarter:1,binnedutcyearquartermonth:1,binnedutcyearmonth:1,binnedutcyearmonthdate:1,binnedutcyearmonthdatehours:1,binnedutcyearmonthdatehoursminutes:1,binnedutcyearmonthdatehoursminutesseconds:1,binnedutcyearweek:1,binnedutcyearweekday:1,binnedutcyearweekdayhours:1,binnedutcyearweekdayhoursminutes:1,binnedutcyearweekdayhoursminutesseconds:1,binnedutcyeardayofyear:1},tqe={...Kxe,...Qxe};function us(e){return X(e)?e.binned:sH(e)}function sH(e){return e&&e.startsWith("binned")}function wN(e){return e.startsWith("utc")}function Jxe(e){return e.substring(3)}var Zxe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Dp(e){return iw.filter(t=>aH(e,t))}function SN(e){let t=Dp(e);return t[t.length-1]}function aH(e,t){let n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function uH(e,t,{end:n}={end:!1}){let r=Z0(t),i=wN(e)?"utc":"";function o(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let s,a={};for(let u of iw)aH(e,u)&&(a[u]=o(u),s=u);return n&&(a[s]+="+1"),nH(a)}function AN(e){if(!e)return;let t=Dp(e);return`timeUnitSpecifier(${He(t)}, ${He(Zxe)})`}function lH(e,t,n){if(!e)return;let r=AN(e);return`${n||wN(e)?"utc":"time"}Format(${t}, ${r})`}function ht(e){if(!e)return;let t;return V(e)?sH(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:X(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),wN(t.unit)&&(t.utc=!0,t.unit=Jxe(t.unit)),t}function cH(e){let{utc:t,...n}=ht(e);return n.unit?(t?"utc":"")+P(n).map(r=>ze(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+P(n).map(r=>ze(`_${r}_${n[r]}`)).join("")}function ow(e,t=n=>n){let n=ht(e),r=SN(n.unit);if(r&&r!=="day"){let i={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:o,part:s}=_N(r,n.step),a={...i,[s]:+i[s]+o};return`${t(as(a))} - ${t(as(i))}`}}var e1e={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function t1e(e){return ee(e1e,e)}function _N(e,t=1){if(t1e(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function fH(e){return j(e,"param")}function sw(e){return!!e?.field&&e.equal!==void 0}function aw(e){return!!e?.field&&e.lt!==void 0}function uw(e){return!!e?.field&&e.lte!==void 0}function lw(e){return!!e?.field&&e.gt!==void 0}function cw(e){return!!e?.field&&e.gte!==void 0}function fw(e){if(e?.field){if(M(e.range)&&e.range.length===2)return!0;if(re(e.range))return!0}return!1}function dw(e){return!!e?.field&&(M(e.oneOf)||M(e.in))}function n1e(e){return!!e?.field&&e.valid!==void 0}function CN(e){return dw(e)||sw(e)||fw(e)||aw(e)||lw(e)||uw(e)||cw(e)}function ea(e,t){return uf(e,{timeUnit:t,wrapTime:!0})}function r1e(e,t){return e.map(n=>ea(n,t))}function pw(e,t=!0){let{field:n}=e,r=ht(e.timeUnit),{unit:i,binned:o}=r||{},s=K(e,{expr:"datum"}),a=i?`time(${o?s:uH(i,n)})`:s;if(sw(e))return`${a}===${ea(e.equal,i)}`;if(aw(e)){let u=e.lt;return`${a}<${ea(u,i)}`}else if(lw(e)){let u=e.gt;return`${a}>${ea(u,i)}`}else if(uw(e)){let u=e.lte;return`${a}<=${ea(u,i)}`}else if(cw(e)){let u=e.gte;return`${a}>=${ea(u,i)}`}else{if(dw(e))return`indexof([${r1e(e.oneOf,i).join(",")}], ${a}) !== -1`;if(n1e(e))return af(a,e.valid);if(fw(e)){let{range:u}=kt(e),l=re(u)?{signal:`${u.signal}[0]`}:u[0],c=re(u)?{signal:`${u.signal}[1]`}:u[1];if(l!==null&&c!==null&&t)return"inrange("+a+", ["+ea(l,i)+", "+ea(c,i)+"])";let f=[];return l!==null&&f.push(`${a} >= ${ea(l,i)}`),c!==null&&f.push(`${a} <= ${ea(c,i)}`),f.length>0?f.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${He(e)}`)}function af(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function dH(e){return CN(e)&&e.timeUnit?{...e,timeUnit:ht(e.timeUnit)}:e}var Mp={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function pH(e){return e==="quantitative"||e==="temporal"}function mw(e){return e==="ordinal"||e==="nominal"}var xo=Mp.quantitative,ty=Mp.ordinal,ta=Mp.temporal,ny=Mp.nominal,ls=Mp.geojson,dqe=P(Mp);function mH(e){if(e)switch(e=e.toLowerCase(),e){case"q":case xo:return"quantitative";case"t":case ta:return"temporal";case"o":case ty:return"ordinal";case"n":case ny:return"nominal";case ls:return"geojson"}}var Vt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},ry={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},xqe=P(ry);function hH(e,t){let n=ry[e],r=ry[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}var i1e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function kN(e){return i1e[e]}var gH=new Set(["linear","log","pow","sqrt","symlog"]),yH=new Set([...gH,"time","utc"]);function FN(e){return gH.has(e)}var xH=new Set(["quantile","quantize","threshold"]),o1e=new Set([...yH,...xH,"sequential","identity"]),s1e=new Set(["ordinal","bin-ordinal","point","band"]);function ot(e){return s1e.has(e)}function Dn(e){return o1e.has(e)}function bo(e){return yH.has(e)}function iu(e){return xH.has(e)}var bH={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function EH(e){return!V(e)&&j(e,"name")}function RN(e){return j(e,"param")}function vH(e){return j(e,"unionWith")}function wH(e){return X(e)&&"field"in e}var SH={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},bqe=P(SH),{type:Eqe,domain:vqe,range:wqe,rangeMax:Sqe,rangeMin:Aqe,scheme:_qe,...a1e}=SH,AH=P(a1e);function iy(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return bo(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return bo(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return bo(e);case"nice":return bo(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Dn(e)&&!ge(["log","time","utc","threshold","quantile"],e)}}function hw(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return nu(e)?void 0:$.cannotUseScalePropertyWithNonColor(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function _H(e,t){return ge([ty,ny],t)?e===void 0||ot(e):t===ta?ge([Vt.TIME,Vt.UTC,void 0],e):t===xo?FN(e)||iu(e)||e===void 0:!0}function CH(e,t,n=!1){if(!an(e))return!1;switch(e){case Ve:case pt:case mo:case Zs:case qn:case pr:return bo(t)||t==="band"?!0:t==="point"?!n:!1;case Oi:return ge(["linear","band"],t);case mi:case $i:case Gr:case Ii:case Pi:case rs:return bo(t)||iu(t)||ge(["band","point","ordinal"],t);case zt:case hr:case gr:return t!=="band";case Bi:case Tt:return t==="ordinal"||iu(t)}}function kH(e){return X(e)&&"value"in e}var Vr={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},DN=Vr.arc,lf=Vr.area,cf=Vr.bar,FH=Vr.image,ff=Vr.line,Np=Vr.point,RH=Vr.rect,Op=Vr.rule,gw=Vr.text,oy=Vr.tick,TH=Vr.trail,sy=Vr.circle,ay=Vr.square,yw=Vr.geoshape;function yr(e){return["line","area","trail"].includes(e)}function ou(e){return["rect","bar","image","arc","tick"].includes(e)}var DH=new Set(P(Vr));function Yn(e){return j(e,"type")}var u1e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],l1e=["fill","fillOpacity"],MH=[...u1e,...l1e],c1e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},MN=P(c1e),TN=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],NH={area:["line","point"],bar:TN,rect:TN,line:["point"],tick:["bandSize","thickness",...TN]},OH={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},f1e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},xw=P(f1e);function na(e){return j(e,"band")}var IH={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},d1e=5,bw={binSpacing:0,continuousBandSize:d1e,minBandSize:.25,timeUnitBandPosition:.5},PH={...bw,binSpacing:1},$H={...bw,thickness:1};function BH(e){return Yn(e)?e.type:e}function Ew(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function Ip({markDef:e,config:t,scaleChannel:n,scaleType:r,isCountAggregate:i}){if(!r||!Dn(r)||i)return"always-valid";let o=Ew(Ne("invalid",e,t),{isPath:yr(e.type)});return t.scale?.invalid?.[n]!==void 0?"show":o}function LH(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function vw({scaleName:e,scale:t,mode:n}){let r=`domain('${e}')`;if(!t||!e)return;let i=`${r}[0]`,o=`peek(${r})`,s=t.domainHasZero();return s==="definitely"?{scale:e,value:0}:s==="maybe"?{signal:`scale('${e}', inrange(0, ${r}) ? 0 : ${n==="zeroOrMin"?i:o})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?i:o})`}}function ww({scaleChannel:e,channelDef:t,scale:n,scaleName:r,markDef:i,config:o}){let s=n?.get("type"),a=hn(t),u=Cl(a?.aggregate),l=Ip({scaleChannel:e,markDef:i,config:o,scaleType:s,isCountAggregate:u});if(a&&l==="show"){let c=o.scale.invalid?.[e]??"zero-or-min";return{test:af(K(a,{expr:"datum"}),!1),...m1e(c,n,r)}}}function m1e(e,t,n){if(kH(e)){let{value:r}=e;return re(r)?{signal:r.signal}:{value:r}}return vw({scale:t,scaleName:n,mode:"zeroOrMin"})}function $p(e){let{channel:t,channelDef:n,markDef:r,scale:i,scaleName:o,config:s}=e,a=Li(t),u=uy(e),l=ww({scaleChannel:a,channelDef:n,scale:i,scaleName:o,markDef:r,config:s});return l!==void 0?[l,u]:u}function UH(e){let{datum:t}=e;return yo(t)?as(t):`${He(t)}`}function ra(e,t,n,r){let i={};if(t&&(i.scale=t),xr(e)){let{datum:o}=e;yo(o)?i.signal=as(o):re(o)?i.signal=o.signal:kl(o)?i.signal=o.expr:i.value=o}else i.field=K(e,n);if(r){let{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function Pp({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,endSuffix:o="end",bandPosition:s=.5}){let a=!re(s)&&0<s&&s<1?"datum":void 0,u=K(t,{expr:a,suffix:i}),l=n!==void 0?K(n,{expr:a}):K(t,{suffix:o,expr:a}),c={};if(s===0||s===1){c.scale=e;let f=s===0?u:l;c.field=f}else{let f=re(s)?`(1-${s.signal}) * ${u} + ${s.signal} * ${l}`:`${1-s} * ${u} + ${s} * ${l}`;c.signal=`scale("${e}", ${f})`}return r&&(c.offset=r),c}function zH({scaleName:e,fieldDef:t}){let n=K(t,{expr:"datum"}),r=K(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${r}) - scale("${e}", ${n}))`}function uy({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l,bandPosition:c}){if(t){if(be(t)){let f=s?.get("type");if(Mt(t)){c??(c=gi({fieldDef:t,fieldDef2:n,markDef:r,config:i}));let{bin:d,timeUnit:p,type:m}=t;if(Ie(d)||c&&p&&m===ta)return a?.impute?ra(t,o,{binSuffix:"mid"},{offset:u}):c&&!ot(f)?Pp({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):ra(t,o,ia(t,e)?{binSuffix:"range"}:{},{offset:u});if(mt(d)){if(W(n))return Pp({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});{let h=e===Ve?pi:Ni;z($.channelRequiredForBinned(h))}}}return ra(t,o,ot(f)?{binSuffix:"range"}:{},{offset:u,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(un(t)){let f=t.value,d=u?{offset:u}:{};return{...df(e,f),...d}}}return Ee(l)&&(l=l()),l&&{...l,...u?{offset:u}:{}}}function df(e,t){return ge(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ge(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Pe(t)}function oa(e){return e&&e!=="number"&&e!=="time"}function qH(e,t,n){return`${e}(${t}${n?`, ${He(n)}`:""})`}var h1e=" \u2013 ";function Bp({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){if(oa(n))return zi({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});let s=GH(e,r,i),a=su(e);if(t===void 0&&n===void 0&&o.customFormatTypes){if(a==="quantitative"){if(i&&o.normalizedNumberFormatType)return zi({fieldOrDatumDef:e,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return zi({fieldOrDatumDef:e,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if(a==="temporal"&&o.timeFormatType&&W(e)&&e.timeUnit===void 0)return zi({fieldOrDatumDef:e,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(uu(e)){let u=y1e({field:s,timeUnit:W(e)?ht(e.timeUnit)?.unit:void 0,format:t,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:Eo(e)&&e.scale?.type===Vt.UTC});return u?{signal:u}:void 0}if(t=NN({type:a,specifiedFormat:t,config:o,normalizeStack:i}),W(e)&&Ie(e.bin)){let u=K(e,{expr:r,binSuffix:"end"});return{signal:pf(s,u,t,n,o)}}else return t||su(e)==="quantitative"?{signal:`${jH(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function GH(e,t,n){return W(e)?n?`${K(e,{expr:t,suffix:"end"})}-${K(e,{expr:t,suffix:"start"})}`:K(e,{expr:t}):UH(e)}function zi({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(s??(s=GH(e,r,i)),s!=="datum.value"&&W(e)&&Ie(e.bin)){let a=K(e,{expr:r,binSuffix:"end"});return{signal:pf(s,a,t,n,o)}}return{signal:qH(n,s,t)}}function Aw(e,t,n,r,i,o){if(!(V(r)&&oa(r))&&!(n===void 0&&r===void 0&&i.customFormatTypes&&su(e)==="quantitative"&&(i.normalizedNumberFormatType&&au(e)&&e.stack==="normalize"||i.numberFormatType))){if(au(e)&&e.stack==="normalize"&&i.normalizedNumberFormat)return NN({type:"quantitative",config:i,normalizeStack:!0});if(uu(e)){let s=W(e)?ht(e.timeUnit)?.unit:void 0;return s===void 0&&i.customFormatTypes&&i.timeFormatType?void 0:g1e({specifiedFormat:n,timeUnit:s,config:i,omitTimeFormatConfig:o})}return NN({type:t,specifiedFormat:n,config:i})}}function _w(e,t,n){if(e&&(re(e)||e==="number"||e==="time"))return e;if(uu(t)&&n!=="time"&&n!=="utc")return W(t)&&ht(t?.timeUnit)?.utc?"utc":"time"}function NN({type:e,specifiedFormat:t,config:n,normalizeStack:r}){if(V(t))return t;if(e===xo)return r?n.normalizedNumberFormat:n.numberFormat}function g1e({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:r}){return e||(t?{signal:AN(t)}:r?void 0:n.timeFormat)}function jH(e,t){return`format(${e}, "${t||""}")`}function HH(e,t,n,r){return oa(n)?qH(n,e,t):jH(e,(V(t)?t:void 0)??r.numberFormat)}function pf(e,t,n,r,i){if(n===void 0&&r===void 0&&i.customFormatTypes&&i.numberFormatType)return pf(e,t,i.numberFormat,i.numberFormatType,i);let o=HH(e,n,r,i),s=HH(t,n,r,i);return`${af(e,!1)} ? "null" : ${o} + "${h1e}" + ${s}`}function y1e({field:e,timeUnit:t,format:n,formatType:r,rawTimeFormat:i,isUTCScale:o}){return!t||n?!t&&r?`${r}(${e}, '${n}')`:(n=V(n)?n:i,`${o?"utc":"time"}Format(${e}, '${n}')`):lH(t,e,o)}var Fl="min",x1e={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function ON(e){return ee(x1e,e)}function WH(e){return j(e,"encoding")}function br(e){return e&&(e.op==="count"||j(e,"field"))}function Cw(e){return e&&M(e)}function sa(e){return j(e,"row")||j(e,"column")}function kw(e){return j(e,"header")}function lu(e){return j(e,"facet")}function VH(e){return j(e,"param")}function YH(e){return!V(e)&&j(e,"repeat")}function IN(e){let{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function Rw(e){return j(e,"sort")}function gi({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(be(e)&&e.bandPosition!==void 0)return e.bandPosition;if(W(e)){let{timeUnit:i,bin:o}=e;if(i&&!t)return Wr("timeUnitBandPosition",n,r);if(Ie(o))return .5}}function PN({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){let a=Dt(e),u=Ne(s?"size":a,r,i,{vgChannel:a});if(u!==void 0)return u;if(W(t)){let{timeUnit:l,bin:c}=t;if(l&&!n)return{band:Wr("timeUnitBandSize",r,i)};if(Ie(c)&&!ot(o))return{band:1}}if(ou(r.type))return o?ot(o)?i[r.type]?.discreteBandSize||{band:1}:i[r.type]?.continuousBandSize:i[r.type]?.discreteBandSize}function Tw(e,t,n,r){return Ie(e.bin)||e.timeUnit&&Mt(e)&&e.type==="temporal"?gi({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function Dw(e){return j(e,"sort")&&!j(e,"field")}function aa(e){return j(e,"condition")}function Up(e){let t=e?.condition;return!!t&&!M(t)&&W(t)}function Rl(e){let t=e?.condition;return!!t&&!M(t)&&be(t)}function XH(e){let t=e?.condition;return!!t&&(M(t)||un(t))}function W(e){return j(e,"field")||e?.aggregate==="count"}function su(e){return e?.type}function xr(e){return j(e,"datum")}function cs(e){return Mt(e)&&!ly(e)||cy(e)}function $N(e){return Mt(e)&&e.type==="quantitative"&&!e.bin||cy(e)}function cy(e){return xr(e)&&ke(e.datum)}function be(e){return W(e)||xr(e)}function Mt(e){return e&&(j(e,"field")||e.aggregate==="count")&&j(e,"type")}function un(e){return j(e,"value")}function Eo(e){return j(e,"scale")||j(e,"sort")}function au(e){return j(e,"axis")||j(e,"stack")||j(e,"impute")}function KH(e){return j(e,"legend")}function QH(e){return j(e,"format")||j(e,"formatType")}function JH(e){return Ut(e,["legend","axis","header","scale"])}function b1e(e){return j(e,"op")}function K(e,t={}){let n=e.field,r=t.prefix,i=t.suffix,o="";if(v1e(e))n=rN("count");else{let s;if(!t.nofn)if(b1e(e))s=e.op;else{let{bin:a,aggregate:u,timeUnit:l}=e;Ie(a)?(s=Qv(a),i=(t.binSuffix??"")+(t.suffix??"")):u?go(u)?(o=`["${n}"]`,n=`argmax_${u.argmax}`):Ui(u)?(o=`["${n}"]`,n=`argmin_${u.argmin}`):s=String(u):l&&!us(l)&&(s=cH(l),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}s&&(n=n?`${s}_${n}`:s)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?eu(n):t.expr?tN(n,t.expr)+o:sn(n)+o}function ly(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return W(e)&&!!e.bin;case"temporal":return!1}throw new Error($.invalidFieldType(e.type))}function E1e(e){return Eo(e)&&iu(e.scale?.type)}function v1e(e){return e.aggregate==="count"}function w1e(e,t){let{field:n,bin:r,timeUnit:i,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ie(r))return`${n} (binned)`;if(i&&!us(i)){let s=ht(i)?.unit;if(s)return`${n} (${Dp(s).join("-")})`}else if(o)return go(o)?`${n} for max ${o.argmax}`:Ui(o)?`${n} for min ${o.argmin}`:`${wl(o)} of ${n}`;return n}function S1e(e){let{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(go(t))return`${i} for argmax(${t.argmax})`;if(Ui(t))return`${i} for argmin(${t.argmin})`;let o=r&&!us(r)?ht(r):void 0,s=t||o?.unit||o?.maxbins&&"timeunit"||Ie(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}var ZH=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return S1e(e);default:return w1e(e,t)}},eq=ZH;function BN(e){eq=e}function tq(){BN(ZH)}function ua(e,t,{allowDisabling:n,includeDefault:r=!0}){let i=Mw(e)?.title;if(!W(e))return i??e.title;let o=e,s=r?fy(o,t):void 0;return n?Be(i,o.title,s):i??o.title??s}function Mw(e){if(au(e)&&e.axis)return e.axis;if(KH(e)&&e.legend)return e.legend;if(kw(e)&&e.header)return e.header}function fy(e,t){return eq(e,t)}function zp(e){if(QH(e)){let{format:t,formatType:n}=e;return{format:t,formatType:n}}else{let t=Mw(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function A1e(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(Rw(e)&&M(e.sort))return"ordinal";let{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!go(n)&&!Ui(n))return"quantitative";if(Eo(e)&&e.scale?.type)switch(ry[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function hn(e){if(W(e))return e;if(Up(e))return e.condition}function tt(e){if(be(e))return e;if(Rl(e))return e.condition}function LN(e,t,n,r={}){if(V(e)||ke(e)||Zr(e)){let i=V(e)?"string":ke(e)?"number":"boolean";return z($.primitiveChannelDef(t,i,e)),{value:e}}return be(e)?Fw(e,t,n,r):Rl(e)?{...e,condition:Fw(e.condition,t,n,r)}:e}function Fw(e,t,n,r){if(QH(e)){let{format:i,formatType:o,...s}=e;if(oa(o)&&!n.customFormatTypes)return z($.customFormatTypeNotAllowed(t)),Fw(s,t,n,r)}else{let i=au(e)?"axis":KH(e)?"legend":kw(e)?"header":null;if(i&&e[i]){let{format:o,formatType:s,...a}=e[i];if(oa(s)&&!n.customFormatTypes)return z($.customFormatTypeNotAllowed(t)),Fw({...e,[i]:a},t,n,r)}}return W(e)?dy(e,t,r):_1e(e)}function _1e(e){let t=e.type;if(t)return e;let{datum:n}=e;return t=ke(n)?"quantitative":V(n)?"nominal":yo(n)?"temporal":void 0,{...e,type:t}}function dy(e,t,{compositeMark:n=!1}={}){let{aggregate:r,timeUnit:i,bin:o,field:s}=e,a={...e};if(!n&&r&&!kp(r)&&!go(r)&&!Ui(r)&&(z($.invalidAggregate(r)),delete a.aggregate),i&&(a.timeUnit=ht(i)),s&&(a.field=`${s}`),Ie(o)&&(a.bin=Rp(o,t)),mt(o)&&!Ye(t)&&z($.channelShouldNotBeUsedForBinned(t)),Mt(a)){let{type:u}=a,l=mH(u);u!==l&&(a.type=l),u!=="quantitative"&&Cl(r)&&(z($.invalidFieldTypeForCountAggregate(u,r)),a.type="quantitative")}else if(!Vv(t)){let u=A1e(a,t);a.type=u}if(Mt(a)){let{compatible:u,warning:l}=C1e(a,t)||{};u===!1&&z(l)}if(Rw(a)&&V(a.sort)){let{sort:u}=a;if(ON(u))return{...a,sort:{encoding:u}};let l=u.substring(1);if(u.charAt(0)==="-"&&ON(l))return{...a,sort:{encoding:l,order:"descending"}}}if(kw(a)){let{header:u}=a;if(u){let{orient:l,...c}=u;if(l)return{...a,header:{...c,labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l}}}}return a}function Rp(e,t){return Zr(e)?{maxbins:dN(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:dN(t)}:e}var Lp={compatible:!0};function C1e(e,t){let n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case fi:case di:case Ep:return ly(e)?Lp:{compatible:!1,warning:$.channelShouldBeDiscrete(t)};case Ve:case pt:case mo:case Zs:case zt:case hr:case gr:case nf:case rf:case vp:case tu:case wp:case Sp:case rs:case qn:case pr:case Ap:return Lp;case jn:case Wn:case Gn:case mr:return n!==xo?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Lp;case Gr:case Ii:case Pi:case $i:case mi:case ns:case ts:case pi:case Ni:case Oi:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Lp;case Tt:case Bi:return!ly(e)&&!E1e(e)?{compatible:!1,warning:$.channelShouldBeDiscreteOrDiscretizing(t)}:Lp;case Al:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Lp}}function uu(e){let{formatType:t}=zp(e);return t==="time"||!t&&k1e(e)}function k1e(e){return e&&(e.type==="temporal"||W(e)&&!!e.timeUnit)}function uf(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){let o=t&&ht(t)?.unit,s=o||n==="temporal",a;return kl(e)?a=e.expr:re(e)?a=e.signal:yo(e)?(s=!0,a=as(e)):(V(e)||ke(e))&&s&&(a=`datetime(${He(e)})`,oH(o)&&(ke(e)&&e<1e4||V(e)&&isNaN(Date.parse(e)))&&(a=as({[o]:e}))),a?r&&s?`time(${a})`:a:i?void 0:He(e)}function Nw(e,t){let{type:n}=e;return t.map(r=>{let i=W(e)&&!us(e.timeUnit)?e.timeUnit:void 0,o=uf(r,{timeUnit:i,type:n,undefinedIfExprNotRequired:!0});return o!==void 0?{signal:o}:r})}function ia(e,t){return Ie(e.bin)?an(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}var UN={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function cu(e){return e?.condition}var Ow=["domain","grid","labels","ticks","title"],nq={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},zN={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},rq={...zN,style:1,labelExpr:1,encoding:1};function HN(e){return ee(rq,e)}var BGe=P(rq),R1e={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},qN=P(R1e);function gn(e){return j(e,"mark")}var la=class{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return gn(t)?BH(t.mark)===this.name:!1}};function ca(e,t){let n=e&&e[t];return n?M(n)?vl(n,r=>!!r.field):W(n)||Up(n):!1}function GN(e,t){let n=e&&e[t];return n?M(n)?vl(n,r=>!!r.field):W(n)||xr(n)||Rl(n):!1}function Iw(e,t){if(Ye(t)){let n=e[t];if((W(n)||xr(n))&&(mw(n.type)||W(n)&&n.timeUnit)){let r=_p(t);return GN(e,r)}}return!1}function Pw(e){return vl(wz,t=>{if(ca(e,t)){let n=e[t];if(M(n))return vl(n,r=>!!r.aggregate);{let r=hn(n);return r&&!!r.aggregate}}return!1})}function $w(e,t){let n=[],r=[],i=[],o=[],s={};return py(e,(a,u)=>{if(W(a)){let{field:l,aggregate:c,bin:f,timeUnit:d,...p}=a;if(c||d||f){let h=Mw(a)?.title,g=K(a,{forAs:!0}),y={...h?[]:{title:ua(a,t,{allowDisabling:!0})},...p,field:g};if(c){let x;if(go(c)?(x="argmax",g=K({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${g}.${l}`):Ui(c)?(x="argmin",g=K({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${g}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(x=c),x){let b={op:x,as:g};l&&(b.field=l),o.push(b)}}else if(n.push(g),Mt(a)&&Ie(f)){if(r.push({bin:f,field:l,as:g}),n.push(K(a,{binSuffix:"end"})),ia(a,u)&&n.push(K(a,{binSuffix:"range"})),Ye(u)){let x={field:`${g}_end`};s[`${u}2`]=x}y.bin="binned",Vv(u)||(y.type=xo)}else if(d&&!us(d)){i.push({timeUnit:d,field:l,as:g});let x=Mt(a)&&a.type!==ta&&"time";x&&(u===nf||u===tu?y.formatType=x:Oz(u)?y.legend={formatType:x,...y.legend}:Ye(u)&&(y.axis={formatType:x,...y.axis}))}s[u]=y}else n.push(l),s[u]=e[u]}else s[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function T1e(e,t,n){let r=$z(t,n);if(r){if(r==="binned"){let i=e[t===pi?Ve:pt];return!!(W(i)&&W(e[t])&&mt(i.bin))}}else return!1;return!0}function iq(e,t,n,r){let i={};for(let o of P(e))Wv(o)||z($.invalidEncodingChannel(o));for(let o of Fz){if(!e[o])continue;let s=e[o];if(ru(o)){let a=kz(o),u=i[a];if(W(u)&&pH(u.type)&&W(s)&&!u.timeUnit){z($.offsetNestedInsideContinuousPositionScaleDropped(a));continue}}if(o==="angle"&&t==="arc"&&!e.theta&&(z($.REPLACE_ANGLE_WITH_THETA),o=qn),!T1e(e,o,t)){z($.incompatibleChannel(o,t));continue}if(o===mi&&t==="line"&&hn(e[o])?.aggregate){z($.LINE_WITH_VARYING_SIZE);continue}if(o===zt&&(n?"fill"in e:"stroke"in e)){z($.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===rf||o===Al&&!M(s)&&!un(s)||o===tu&&M(s)){if(s){if(o===Al){let a=e[o];if(Dw(a)){i[o]=a;continue}}i[o]=Q(s).reduce((a,u)=>(W(u)?a.push(dy(u,o)):z($.emptyFieldDef(u,o)),a),[])}}else{if(o===tu&&s===null)i[o]=null;else if(!W(s)&&!xr(s)&&!un(s)&&!aa(s)&&!re(s)){z($.emptyFieldDef(s,o));continue}i[o]=LN(s,o,r)}}return i}function Tl(e,t){let n={};for(let r of P(e)){let i=LN(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function oq(e){let t=[];for(let n of P(e))if(ca(e,n)){let r=e[n],i=Q(r);for(let o of i)W(o)?t.push(o):Up(o)&&t.push(o.condition)}return t}function py(e,t,n){if(e)for(let r of P(e)){let i=e[r];if(M(i))for(let o of i)t.call(n,o,r);else t.call(n,i,r)}}function sq(e,t,n,r){return e?P(e).reduce((i,o)=>{let s=e[o];return M(s)?s.reduce((a,u)=>t.call(r,a,u,o),i):t.call(r,i,s,o)},n):n}function Bw(e,t){return P(t).reduce((n,r)=>{switch(r){case Ve:case pt:case wp:case Ap:case Sp:case pi:case Ni:case mo:case Zs:case qn:case ns:case pr:case ts:case Oi:case Gn:case jn:case mr:case Wn:case nf:case Tt:case rs:case tu:return n;case Al:if(e==="line"||e==="trail")return n;case rf:case vp:{let i=t[r];if(M(i)||W(i))for(let o of Q(i))o.aggregate||n.push(K(o,{}));return n}case mi:if(e==="trail")return n;case zt:case hr:case gr:case Gr:case Ii:case Pi:case Bi:case $i:{let i=hn(t[r]);return i&&!i.aggregate&&n.push(K(i,{})),n}}},[])}function aq(e){let{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(M(t)){for(let o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return M(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function my(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};let i=e.map(({fieldPrefix:s,titlePrefix:a})=>{let u=r?` of ${Uw(t)}`:"";return{field:s+t.field,type:t.type,title:re(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),o=oq(n).map(JH);return{tooltip:[...i,...dr(o,fe)]}}function Uw(e){let{title:t,field:n}=e;return Be(t,n)}function Hp(e,t,n,r,i){let{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{let d=Uw(n);return jN(e,a,i,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...o!==void 0?{scale:o}:{},...s!==void 0?{axis:s}:{}},...V(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...r,...f}})}}function jN(e,t,n,r){let{clip:i,color:o,opacity:s}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...s?{opacity:s}:{},...Yn(r.mark)?r.mark:{type:r.mark},style:`${a}-${String(t)}`,...Zr(e[t])?{}:e[t]}}]:[]}function zw(e,t,n){let{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:Lw(o,n),continuousAxisChannelDef2:Lw(s,n),continuousAxisChannelDefError:Lw(a,n),continuousAxisChannelDefError2:Lw(u,n),continuousAxis:i}}function Lw(e,t){if(e?.aggregate){let{aggregate:n,...r}=e;return n!==t&&z($.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}else return e}function Hw(e,t){let{mark:n,encoding:r}=e,{x:i,y:o}=r;if(Yn(n)&&n.orient)return n.orient;if(cs(i)){if(cs(o)){let s=W(i)&&i.aggregate,a=W(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return uu(o)&&!uu(i)?"horizontal":"vertical"}return"horizontal"}else{if(cs(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var hy="boxplot",uq=["box","median","outliers","rule","ticks"],lq=new la(hy,WN);function cq(e){return ke(e)?"tukey":e}function WN(e,{config:t}){e={...e,encoding:Tl(e.encoding,t)};let{mark:n,encoding:r,params:i,projection:o,...s}=e,a=Yn(n)?n:{type:n};i&&z($.selectionNotSupported("boxplot"));let u=a.extent??t.boxplot.extent,l=Ne("size",a,t),c=a.invalid,f=cq(u),{bins:d,timeUnits:p,transform:m,continuousAxisChannelDef:h,continuousAxis:g,groupby:y,aggregate:x,encodingWithoutContinuousAxis:b,ticksOrient:E,boxOrient:v,customTooltipWithoutAggregatedField:S}=M1e(e,u,t),w=eu(h.field),{color:_,size:A,...F}=b,R=xx=>Hp(a,g,h,xx,t.boxplot),D=R(F),O=R(b),T=(X(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",k=R({...F,...A?{size:A}:{},color:{condition:{test:`${Je(`lower_box_${h.field}`)} >= ${Je(`upper_box_${h.field}`)}`,..._||{value:T}}}}),C=my([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],h,b),N={type:"tick",color:"black",opacity:1,orient:E,invalid:c,aria:!1},I=f==="min-max"?C:my([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],h,b),L=[...D({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:I}),...D({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:I}),...D({partName:"ticks",mark:N,positionPrefix:"lower_whisker",extraEncoding:I}),...D({partName:"ticks",mark:N,positionPrefix:"upper_whisker",extraEncoding:I})],te=[...f!=="tukey"?L:[],...O({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:v,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:C}),...k({partName:"median",mark:{type:"tick",invalid:c,...X(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:E,aria:!1},positionPrefix:"mid_box",extraEncoding:C})];if(f==="min-max")return{...s,transform:(s.transform??[]).concat(m),layer:te};let ie=Je(`lower_box_${h.field}`),oe=Je(`upper_box_${h.field}`),Se=`(${oe} - ${ie})`,Oe=`${ie} - ${u} * ${Se}`,we=`${oe} + ${u} * ${Se}`,Qt=Je(h.field),Ro={joinaggregate:fq(h.field),groupby:y},Ai={transform:[{filter:`(${Oe} <= ${Qt}) && (${Qt} <= ${we})`},{aggregate:[{op:"min",field:h.field,as:`lower_whisker_${w}`},{op:"max",field:h.field,as:`upper_whisker_${w}`},{op:"min",field:`lower_box_${h.field}`,as:`lower_box_${w}`},{op:"max",field:`upper_box_${h.field}`,as:`upper_box_${w}`},...x],groupby:y}],layer:L},{tooltip:ce,...Fe}=F,{scale:$e,axis:ne}=h,In=Uw(h),nt=Ut(ne,["title"]),Zn=jN(a,"outliers",t.boxplot,{transform:[{filter:`(${Qt} < ${Oe}) || (${Qt} > ${we})`}],mark:"point",encoding:{[g]:{field:h.field,type:h.type,...In!==void 0?{title:In}:{},...$e!==void 0?{scale:$e}:{},...Me(nt)?{}:{axis:nt}},...Fe,..._?{color:_}:{},...S?{tooltip:S}:{}}})[0],yn,Cs=[...d,...p,Ro];return Zn?yn={transform:Cs,layer:[Zn,Ai]}:(yn=Ai,yn.transform.unshift(...Cs)),{...s,layer:[yn,{transform:m,layer:te}]}}function fq(e){let t=eu(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function M1e(e,t,n){let r=Hw(e,hy),{continuousAxisChannelDef:i,continuousAxis:o}=zw(e,r,hy),s=i.field,a=eu(s),u=cq(t),l=[...fq(s),{op:"median",field:s,as:`mid_box_${a}`},{op:"min",field:s,as:(u==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:s,as:(u==="min-max"?"upper_whisker_":"max_")+a}],c=u==="min-max"||u==="tukey"?[]:[{calculate:`${Je(`upper_box_${a}`)} - ${Je(`lower_box_${a}`)}`,as:`iqr_${a}`},{calculate:`min(${Je(`upper_box_${a}`)} + ${Je(`iqr_${a}`)} * ${t}, ${Je(`max_${a}`)})`,as:`upper_whisker_${a}`},{calculate:`max(${Je(`lower_box_${a}`)} - ${Je(`iqr_${a}`)} * ${t}, ${Je(`min_${a}`)})`,as:`lower_whisker_${a}`}],{[o]:f,...d}=e.encoding,{customTooltipWithoutAggregatedField:p,filteredEncoding:m}=aq(d),{bins:h,timeUnits:g,aggregate:y,groupby:x,encoding:b}=$w(m,n),E=r==="vertical"?"horizontal":"vertical",v=r,S=[...h,...g,{aggregate:[...y,...l],groupby:x},...c];return{bins:h,timeUnits:g,transform:S,groupby:x,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:b,ticksOrient:E,boxOrient:v,customTooltipWithoutAggregatedField:p}}var qw="errorbar",pq=["ticks","rule"],mq=new la(qw,VN);function VN(e,{config:t}){e={...e,encoding:Tl(e.encoding,t)};let{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:l}=YN(e,qw,t);delete o.size;let c=Hp(a,i,r,o,t.errorbar),f=a.thickness,d=a.size,p={type:"tick",orient:s,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},m=[...c({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...m.length>1?{layer:m}:{...m[0]}}}function N1e(e,t){let{encoding:n}=e;if(O1e(n))return{orient:Hw(e,t),inputType:"raw"};let r=I1e(n),i=P1e(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);let a=n.x2,u=n.y2;if(be(a)&&be(u))throw new Error(`${t} cannot have both x2 and y2`);if(be(a)){if(cs(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(be(u)){if(cs(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{let a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(be(u)&&!be(a))throw new Error(`${t} cannot have xError2 without xError`);if(be(c)&&!be(l))throw new Error(`${t} cannot have yError2 without yError`);if(be(a)&&be(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(be(a)){if(cs(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(be(l)){if(cs(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function O1e(e){return(be(e.x)||be(e.y))&&!be(e.x2)&&!be(e.y2)&&!be(e.xError)&&!be(e.xError2)&&!be(e.yError)&&!be(e.yError2)}function I1e(e){return be(e.x2)||be(e.y2)}function P1e(e){return be(e.xError)||be(e.xError2)||be(e.yError)||be(e.yError2)}function YN(e,t,n){let{mark:r,encoding:i,params:o,projection:s,...a}=e,u=Yn(r)?r:{type:r};o&&z($.selectionNotSupported(t));let{orient:l,inputType:c}=N1e(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:h}=zw(e,l,t),{errorBarSpecificAggregate:g,postAggregateCalculates:y,tooltipSummary:x,tooltipTitleWithFieldName:b}=$1e(u,f,d,p,m,c,t,n),{[h]:E,[h==="x"?"x2":"y2"]:v,[h==="x"?"xError":"yError"]:S,[h==="x"?"xError2":"yError2"]:w,..._}=i,{bins:A,timeUnits:F,aggregate:R,groupby:D,encoding:O}=$w(_,n),T=[...R,...g],k=c!=="raw"?[]:D,C=my(x,f,O,b);return{transform:[...a.transform??[],...A,...F,...T.length===0?[]:[{aggregate:T,groupby:k}],...y],groupby:k,continuousAxisChannelDef:f,continuousAxis:h,encodingWithoutContinuousAxis:O,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:C}}function $1e(e,t,n,r,i,o,s,a){let u=[],l=[],c=t.field,f,d=!1;if(o==="raw"){let p=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,m=e.extent?e.extent:p==="mean"?"stderr":"iqr";if(p==="median"!=(m==="iqr")&&z($.errorBarCenterIsUsedWithWrongExtent(p,m,s)),m==="stderr"||m==="stdev")u=[{op:m,field:c,as:`extent_${c}`},{op:p,field:c,as:`center_${c}`}],l=[{calculate:`${Je(`center_${c}`)} + ${Je(`extent_${c}`)}`,as:`upper_${c}`},{calculate:`${Je(`center_${c}`)} - ${Je(`extent_${c}`)}`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:wl(p)},{fieldPrefix:"upper_",titlePrefix:dq(p,m,"+")},{fieldPrefix:"lower_",titlePrefix:dq(p,m,"-")}],d=!0;else{let h,g,y;m==="ci"?(h="mean",g="ci0",y="ci1"):(h="median",g="q1",y="q3"),u=[{op:g,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:h,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:ua({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:ua({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:ua({field:c,aggregate:h,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&z($.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:Je(n.field),as:`upper_${c}`},{calculate:Je(c),as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`${Je(c)} + ${Je(r.field)}`,as:`upper_${c}`}],i?l.push({calculate:`${Je(c)} + ${Je(i.field)}`,as:`lower_${c}`}):l.push({calculate:`${Je(c)} - ${Je(r.field)}`,as:`lower_${c}`}));for(let p of l)f.push({fieldPrefix:p.as.substring(0,6),titlePrefix:es(es(p.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function dq(e,t,n){return`${wl(e)} ${n} ${t}`}var Gw="errorband",hq=["band","borders"],gq=new la(Gw,XN);function XN(e,{config:t}){e={...e,encoding:Tl(e.encoding,t)};let{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=YN(e,Gw,t),l=s,c=Hp(l,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0,d={type:f?"area":"rect"},p={type:f?"line":"rule"},m={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):l.interpolate?z($.errorBand1DNotSupport("interpolate")):l.tension&&z($.errorBand1DNotSupport("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}var yq={};function KN(e,t,n){let r=new la(e,t);yq[e]={normalizer:r,parts:n}}function xq(){return P(yq)}KN(hy,WN,uq);KN(qw,VN,pq);KN(Gw,XN,hq);var bq=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"];var QN={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},JN={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Eq=P(QN),vq=P(JN),B1e={header:1,headerRow:1,headerColumn:1,headerFacet:1},ZN=P(B1e);var jw=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],wq={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},eO={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Bje=P(eO);var Xn="_vgsid_",Sq={point:{on:"click",fields:[Xn],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function gy(e){return e==="legend"||!!e?.legend}function Ww(e){return gy(e)&&X(e)}function qp(e){return!!e?.select}function Vw(e){let t=[];for(let n of e||[]){if(qp(n))continue;let{expr:r,bind:i,...o}=n;if(i&&r){let s={...o,bind:i,init:r};t.push(s)}else{let s={...o,...r?{update:r}:{},...i?{bind:i}:{}};t.push(s)}}return t}function tO(e){return Dl(e)||Gp(e)||yy(e)}function yy(e){return j(e,"concat")}function Dl(e){return j(e,"vconcat")}function Gp(e){return j(e,"hconcat")}function nO({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function yi(e){return j(e,"step")}function rO(e){return j(e,"view")||j(e,"width")||j(e,"height")}var iO=20,L1e={align:1,bounds:1,center:1,columns:1,spacing:1},U1e=P(L1e);function Aq(e,t,n){let r=n[t],i={},{spacing:o,columns:s}=r;o!==void 0&&(i.spacing=o),s!==void 0&&(lu(e)&&!sa(e.facet)||yy(e))&&(i.columns=s),Dl(e)&&(i.columns=1);for(let a of U1e)if(e[a]!==void 0)if(a==="spacing"){let u=e[a];i[a]=ke(u)?u:{row:u.row??o,column:u.column??o}}else i[a]=e[a];return i}function xy(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function by(e,t){let n=jp(e,t);return yi(n)?n.step:kq}function jp(e,t){let n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return Be(n,{step:e.step})}var kq=20,z1e={continuousWidth:200,continuousHeight:200,step:kq};var H1e={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:z1e,mark:OH,arc:{},area:{},bar:PH,circle:{},geoshape:{},image:{},line:{},point:{},rect:bw,rule:{color:"black"},square:{},text:{color:"black"},tick:$H,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:bH,projection:{},legend:wq,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Sq,style:{},title:{},facet:{spacing:iO},concat:{spacing:iO},normalizedNumberFormat:".0%"},fu=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],_q={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Cq={blue:fu[0],orange:fu[1],red:fu[2],teal:fu[3],green:fu[4],yellow:fu[5],purple:fu[6],pink:fu[7],brown:fu[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function q1e(e={}){return{signals:[{name:"color",value:X(e)?{...Cq,...e}:Cq}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function G1e(e){return{signals:[{name:"fontSize",value:X(e)?{..._q,...e}:_q}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function j1e(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function Fq(e){let t=P(e||{}),n={};for(let r of t){let i=e[r];n[r]=cu(i)?ew(i):Tn(i)}return n}function W1e(e){let t=P(e),n={};for(let r of t)n[r]=Fq(e[r]);return n}var V1e=[...xw,...qN,...ZN,"background","padding","legend","lineBreak","scale","style","title","view"];function Yw(e={}){let{color:t,font:n,fontSize:r,selection:i,...o}=e,s=Ts({},se(H1e),n?j1e(n):{},t?q1e(t):{},r?G1e(r):{},o||{});i&&wa(s,"selection",i,!0);let a=Ut(s,V1e);for(let u of["background","lineBreak","padding"])s[u]&&(a[u]=Tn(s[u]));for(let u of xw)s[u]&&(a[u]=kt(s[u]));for(let u of qN)s[u]&&(a[u]=Fq(s[u]));for(let u of ZN)s[u]&&(a[u]=kt(s[u]));if(s.legend&&(a.legend=kt(s.legend)),s.scale){let{invalid:u,...l}=s.scale,c=kt(u,{level:1});a.scale={...kt(l),...P(c).length>0?{invalid:c}:{}}}return s.style&&(a.style=W1e(s.style)),s.title&&(a.title=kt(s.title)),s.view&&(a.view=kt(s.view)),a}var Y1e=new Set(["view",...DH]),X1e=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],K1e={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...NH};function Rq(e){e=se(e);for(let t of X1e)delete e[t];if(e.axis)for(let t in e.axis)cu(e.axis[t])&&delete e.axis[t];if(e.legend)for(let t of bq)delete e.legend[t];if(e.mark){for(let t of MN)delete e.mark[t];e.mark.tooltip&&X(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(Vw(e.params)),delete e.params);for(let t of Y1e){for(let r of MN)delete e[t][r];let n=K1e[t];if(n)for(let r of n)delete e[t][r];J1e(e,t)}for(let t of xq())delete e[t];Q1e(e);for(let t in e)X(e[t])&&Me(e[t])&&delete e[t];return Me(e)?void 0:e}function Q1e(e){let{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=Jv(e.title);Me(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Me(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Me(r)?delete e.title:e.title=r}function J1e(e,t,n,r){let i=r?e[t][r]:e[t];t==="view"&&(n="cell");let o={...i,...e.style[n??t]};Me(o)||(e.style[n??t]=o),r||delete e[t]}function du(e){return j(e,"layer")}function oO(e){return j(e,"repeat")}function Tq(e){return!M(e.repeat)&&j(e.repeat,"layer")}var Ml=class{map(t,n){return lu(t)?this.mapFacet(t,n):oO(t)?this.mapRepeat(t,n):Gp(t)?this.mapHConcat(t,n):Dl(t)?this.mapVConcat(t,n):yy(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(du(t))return this.mapLayer(t,n);if(gn(t))return this.mapUnit(t,n);throw new Error($.invalidSpec(t))}mapLayer(t,n){return{...t,layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(r=>this.map(r,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(r=>this.map(r,n))}}mapConcat(t,n){let{concat:r,...i}=t;return{...i,concat:r.map(o=>this.map(o,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}};var Z1e={zero:1,center:1,normalize:1};function ebe(e){return ee(Z1e,e)}var tbe=new Set([DN,cf,lf,Op,Np,sy,ay,ff,gw,oy]),nbe=new Set([cf,lf,DN]);function Wp(e){return W(e)&&su(e)==="quantitative"&&!e.bin}function Dq(e,t,{orient:n,type:r}){let i=t==="x"?"y":"radius",o=t==="x"&&["bar","area"].includes(r),s=e[t],a=e[i];if(W(s)&&W(a))if(Wp(s)&&Wp(a)){if(s.stack)return t;if(a.stack)return i;let u=W(s)&&!!s.aggregate,l=W(a)&&!!a.aggregate;if(u!==l)return u?t:i;if(o){if(n==="vertical")return i;if(n==="horizontal")return t}}else{if(Wp(s))return t;if(Wp(a))return i}else{if(Wp(s))return o&&n==="vertical"?void 0:t;if(Wp(a))return o&&n==="horizontal"?void 0:i}}function rbe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function Xw(e,t){let n=Yn(e)?e:{type:e},r=n.type;if(!tbe.has(r))return null;let i=Dq(t,"x",n)||Dq(t,"theta",n);if(!i)return null;let o=t[i],s=W(o)?K(o,{}):void 0,a=rbe(i),u=[],l=new Set;if(t[a]){let h=t[a],g=W(h)?K(h,{}):void 0;g&&g!==s&&(u.push(a),l.add(g))}let c=a==="x"?"xOffset":"yOffset",f=t[c],d=W(f)?K(f,{}):void 0;d&&d!==s&&(u.push(c),l.add(d));let p=Rz.reduce((h,g)=>{if(g!=="tooltip"&&ca(t,g)){let y=t[g];for(let x of Q(y)){let b=hn(x);if(b.aggregate)continue;let E=K(b,{});(!E||!l.has(E))&&h.push({channel:g,fieldDef:b})}}return h},[]),m;return o.stack!==void 0?Zr(o.stack)?m=o.stack?"zero":null:m=o.stack:nbe.has(r)&&(m="zero"),!m||!ebe(m)||Pw(t)&&p.length===0?null:(o?.scale?.type&&o?.scale?.type!==Vt.LINEAR&&o?.stack&&z($.stackNonLinearScale(o.scale.type)),be(t[Rn(i)])?(o.stack!==void 0&&z($.cannotStackRangedMark(i)),null):(W(o)&&o.aggregate&&!zz.has(o.aggregate)&&z($.stackNonSummativeAggregate(o.aggregate)),{groupbyChannels:u,groupbyFields:l,fieldChannel:i,impute:o.impute===null?!1:yr(r),stackBy:p,offset:m}))}function Kw(e,t,n){let r=kt(e),i=Ne("orient",r,n);if(r.orient=sbe(r.type,t,i),i!==void 0&&i!==r.orient&&z($.orientOverridden(r.orient,i)),r.type==="bar"&&r.orient){let u=Ne("cornerRadiusEnd",r,n);if(u!==void 0){let l=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:IH[r.orient];for(let c of l)r[c]=u;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}let o=Ne("opacity",r,n),s=Ne("fillOpacity",r,n);return o===void 0&&s===void 0&&(r.opacity=obe(r.type,t)),Ne("cursor",r,n)===void 0&&(r.cursor=ibe(r,t,n)),r}function ibe(e,t,n){return t.href||e.href||Ne("href",e,n)?"pointer":e.cursor}function obe(e,t){if(ge([Np,oy,sy,ay],e)&&!Pw(t))return .7}function Mq(e,t,{graticule:n}){if(n)return!1;let r=Wr("filled",e,t),i=e.type;return Be(r,i!==Np&&i!==ff&&i!==Op)}function sbe(e,t,n){switch(e){case Np:case sy:case ay:case gw:case RH:case FH:return}let{x:r,y:i,x2:o,y2:s}=t;switch(e){case cf:if(W(r)&&(mt(r.bin)||W(i)&&i.aggregate&&!r.aggregate))return"vertical";if(W(i)&&(mt(i.bin)||W(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o)return(W(r)&&r.type===xo&&!Ie(r.bin)||cy(r))&&W(i)&&mt(i.bin)?"horizontal":"vertical";if(!s)return(W(i)&&i.type===xo&&!Ie(i.bin)||cy(i))&&W(r)&&mt(r.bin)?"vertical":"horizontal"}case Op:if(o&&!(W(r)&&mt(r.bin))&&s&&!(W(i)&&mt(i.bin)))return;case lf:if(s)return W(i)&&mt(i.bin)?"horizontal":"vertical";if(o)return W(r)&&mt(r.bin)?"vertical":"horizontal";if(e===Op){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case ff:case oy:{let a=$N(r),u=$N(i);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u)return"vertical";{let l=Mt(r)&&r.type===ta,c=Mt(i)&&i.type===ta;if(l&&!c)return"vertical";if(!l&&c)return"horizontal"}return}}return"vertical"}function abe(e){let{point:t,line:n,...r}=e;return P(r).length>1?r:r.type}function ube(e){for(let t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Ut(e[t],["point","line"])});return e}function sO(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?X(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?X(t.point)?t.point:{}:void 0}function Nq(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}var Qw=class{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(gn(t)){let{mark:r,encoding:i}=t,o=Yn(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!sO(o,n[o.type],i);case"area":return!!sO(o,n[o.type],i)||!!Nq(o,n[o.type])}}return!1}run(t,n,r){let{config:i}=n,{params:o,projection:s,mark:a,name:u,encoding:l,...c}=t,f=Tl(l,i),d=Yn(a)?a:{type:a},p=sO(d,i[d.type],f),m=d.type==="area"&&Nq(d,i[d.type]),h=[{name:u,...o?{params:o}:{},mark:abe({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:Ut(f,["shape"])}],g=Xw(Kw(d,f,i),f),y=f;if(g){let{fieldChannel:x,offset:b}=g;y={...f,[x]:{...f[x],...b?{stack:b}:{}}}}return y=Ut(y,["y2","x2"]),m&&h.push({...s?{projection:s}:{},mark:{type:"line",...Za(d,["clip","interpolate","tension","tooltip"]),...m},encoding:y}),p&&h.push({...s?{projection:s}:{},mark:{type:"point",opacity:1,filled:!0,...Za(d,["clip","tooltip"]),...p},encoding:y}),r({...c,layer:h},{...n,config:ube(i)})}};function Pq(e,t){return t?sa(e)?Bq(e,t):$q(e,t):e}function Jw(e,t){return t?Bq(e,t):e}function aO(e,t,n){let r=t[e];if(YH(r)){if(r.repeat in n)return{...t,[e]:n[r.repeat]};z($.noSuchRepeatedValue(r.repeat));return}return t}function $q(e,t){if(e=aO("field",e,t),e!==void 0){if(e===null)return null;if(Rw(e)&&br(e.sort)){let n=aO("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function Oq(e,t){if(W(e))return $q(e,t);{let n=aO("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function Iq(e,t){if(be(e)){let n=Oq(e,t);if(n)return n;if(aa(e))return{condition:e.condition}}else{if(Rl(e)){let n=Oq(e.condition,t);if(n)return{...e,condition:n};{let{condition:r,...i}=e;return i}}return e}}function Bq(e,t){let n={};for(let r in e)if(j(e,r)){let i=e[r];if(M(i))n[r]=i.map(o=>Iq(o,t)).filter(o=>o);else{let o=Iq(i,t);o!==void 0&&(n[r]=o)}}return n}var Zw=class{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(gn(t)){let{encoding:n,mark:r}=t;if(r==="line"||Yn(r)&&r.type==="line")for(let i of Cz){let o=Li(i),s=n[o];if(n[i]&&(W(s)&&!mt(s.bin)||xr(s)))return!0}}return!1}run(t,n,r){let{encoding:i,mark:o}=t;return z($.lineWithRange(!!i.x2,!!i.y2)),r({...t,mark:X(o)?{...o,type:"rule"}:"rule"},n)}};var eS=class extends Ml{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[lq,mq,gq,new Qw,new Zw]}map(t,n){if(gn(t)){let r=ca(t.encoding,fi),i=ca(t.encoding,di),o=ca(t.encoding,Ep);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){let{parentEncoding:r,parentProjection:i}=n,o=Jw(t.encoding,n.repeater),s={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...o?{encoding:o}:{}};if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);let a=this.mapLayerOrUnit.bind(this);for(let u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(s,n.config))return u.run(s,n,a);return s}mapRepeat(t,n){return Tq(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){let{repeat:r,spec:i,...o}=t,{row:s,column:a,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat({...t,repeat:{...s?{row:s}:{},...a?{column:a}:{}},spec:{repeat:{layer:u},spec:i}},n):{...o,layer:u.map(f=>{let d={...l,layer:f},p=`${(i.name?`${i.name}_`:"")+c}child__layer_${ze(f)}`,m=this.mapLayerOrUnit(i,{...n,repeater:d,repeaterPrefix:p});return m.name=p,m})}}mapNonLayerRepeat(t,n){let{repeat:r,spec:i,data:o,...s}=t;!M(r)&&t.columns&&(t=Ut(t,["columns"]),z($.columnsNotSupportByRowCol("repeat")));let a=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!M(r)&&r.row||[u?u.row:null],f=!M(r)&&r.column||[u?u.column:null],d=M(r)&&r||[u?u.repeat:null];for(let m of d)for(let h of c)for(let g of f){let y={repeat:m,row:h,column:g,layer:u.layer},x=(i.name?`${i.name}_`:"")+l+"child__"+(M(r)?`${ze(m)}`:(r.row?`row_${ze(h)}`:"")+(r.column?`column_${ze(g)}`:"")),b=this.map(i,{...n,repeater:y,repeaterPrefix:x});b.name=x,a.push(Ut(b,["data"]))}let p=M(r)?t.columns:r.column?r.column.length:1;return{data:i.data??o,align:"all",...s,columns:p,concat:a}}mapFacet(t,n){let{facet:r}=t;return sa(r)&&t.columns&&(t=Ut(t,["columns"]),z($.columnsNotSupportByRowCol("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){let{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,u=Uq({parentProjection:s,projection:i}),l=Lq({parentEncoding:o,encoding:Jw(r,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,n){let{row:r,column:i,facet:o,...s}=t.encoding,{mark:a,width:u,projection:l,height:c,view:f,params:d,encoding:p,...m}=t,{facetMapping:h,layout:g}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},n),y=Jw(s,n.repeater);return this.mapFacet({...m,...g,facet:h,spec:{...u?{width:u}:{},...c?{height:c}:{},...f?{view:f}:{},...l?{projection:l}:{},mark:a,encoding:y,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){let{row:r,column:i,facet:o}=t;if(r||i){o&&z($.facetChannelDropped([...r?[fi]:[],...i?[di]:[]]));let s={},a={};for(let u of[fi,di]){let l=t[u];if(l){let{align:c,center:f,spacing:d,columns:p,...m}=l;s[u]=m;for(let h of["align","center","spacing"])l[h]!==void 0&&(a[h]??(a[h]={}),a[h][u]=l[h])}}return{facetMapping:s,layout:a}}else{let{align:s,center:a,spacing:u,columns:l,...c}=o;return{facetMapping:Pq(c,n.repeater),layout:{...s?{align:s}:{},...a?{center:a}:{},...u?{spacing:u}:{},...l?{columns:l}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:r,...i}){let{encoding:o,projection:s,...a}=t,u={...i,parentEncoding:Lq({parentEncoding:n,encoding:o,layer:!0}),parentProjection:Uq({parentProjection:r,projection:s})};return super.mapLayer({...a,...t.name?{name:[u.repeaterPrefix,t.name].filter(l=>l).join("_")}:{}},u)}};function Lq({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){let i=new Set([...P(e),...P(t)]);for(let o of i){let s=t[o],a=e[o];if(be(s)){let u={...a,...s};r[o]=u}else Rl(s)?r[o]={...s,condition:{...a,...s.condition}}:s||s===null?r[o]=s:(n||un(a)||re(a)||be(a)||M(a))&&(r[o]=a)}}else r=t;return!r||Me(r)?void 0:r}function Uq(e){let{parentProjection:t,projection:n}=e;return t&&n&&z($.projectionOverridden({parentProjection:t,projection:n})),n??t}function Ey(e){return j(e,"filter")}function zq(e){return j(e,"stop")}function tS(e){return j(e,"lookup")}function Hq(e){return j(e,"data")}function qq(e){return j(e,"param")}function Gq(e){return j(e,"pivot")}function jq(e){return j(e,"density")}function Wq(e){return j(e,"quantile")}function Vq(e){return j(e,"regression")}function Yq(e){return j(e,"loess")}function Xq(e){return j(e,"sample")}function Kq(e){return j(e,"window")}function Qq(e){return j(e,"joinaggregate")}function Jq(e){return j(e,"flatten")}function Zq(e){return j(e,"calculate")}function nS(e){return j(e,"bin")}function eG(e){return j(e,"impute")}function tG(e){return j(e,"timeUnit")}function nG(e){return j(e,"aggregate")}function rG(e){return j(e,"stack")}function iG(e){return j(e,"fold")}function oG(e){return j(e,"extent")&&!j(e,"density")&&!j(e,"regression")}function sG(e){return e.map(t=>Ey(t)?{filter:El(t.filter,dH)}:t)}var rS=class extends Ml{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=aG(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=aG(t,n),t.encoding){let r={};for(let[i,o]of ci(t.encoding))r[i]=uG(o,n);t={...t,encoding:r}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){let{selection:r,...i}=t;return r?{...i,params:ci(r).map(([o,s])=>{let{init:a,bind:u,empty:l,...c}=s;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[o]=l!=="none";for(let f of dt(n.selectionPredicates[o]??{}))f.empty=l!=="none";return{name:o,value:a,select:c,bind:u}})}:t}};function aG(e,t){let{transform:n,...r}=e;if(n){let i=n.map(o=>{if(Ey(o))return{filter:uO(o,t)};if(nS(o)&&is(o.bin))return{...o,bin:lG(o.bin)};if(tS(o)){let{selection:s,...a}=o.from;return s?{...o,from:{param:s,...a}}:o}return o});return{...r,transform:i}}return e}function uG(e,t){let n=se(e);if(W(n)&&is(n.bin)&&(n.bin=lG(n.bin)),Eo(n)&&n.scale?.domain?.selection){let{selection:r,...i}=n.scale.domain;n.scale.domain={...i,...r?{param:r}:{}}}if(aa(n))if(M(n.condition))n.condition=n.condition.map(r=>{let{selection:i,param:o,test:s,...a}=r;return o?r:{...a,test:uO(r,t)}});else{let{selection:r,param:i,test:o,...s}=uG(n.condition,t);n.condition=i?n.condition:{...s,test:uO(n.condition,t)}}return n}function lG(e){let t=e.extent;if(t?.selection){let{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function uO(e,t){let n=r=>El(r,i=>{var o;let s=t.emptySelections[i]??!0,a={param:i,empty:s};return(o=t.selectionPredicates)[i]??(o[i]=[]),t.selectionPredicates[i].push(a),a});return e.selection?n(e.selection):El(e.test||e.filter,r=>r.selection?n(r.selection):r)}var Vp=class extends Ml{map(t,n){let r=n.selections??[];if(t.params&&!gn(t)){let i=[];for(let o of t.params)qp(o)?r.push(o):i.push(o);t.params=i}return n.selections=r,super.map(t,n)}mapUnit(t,n){let r=n.selections;if(!r||!r.length)return t;let i=(n.path??[]).concat(t.name),o=[];for(let s of r)if(!s.views||!s.views.length)o.push(s);else for(let a of s.views)(V(a)&&(a===t.name||i.includes(a))||M(a)&&a.map(u=>i.indexOf(u)).every((u,l,c)=>u!==-1&&(l===0||u>c[l-1])))&&o.push(s);return o.length&&(t.params=o),t}};for(let e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){let t=Vp.prototype[e];Vp.prototype[e]=function(n,r){return t.call(this,n,lbe(n,r))}}function lbe(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function iS(e,t){t===void 0&&(t=Yw(e.config));let n=pbe(e,t),{width:r,height:i}=e,o=mbe(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}var cbe=new eS,fbe=new rS,dbe=new Vp;function pbe(e,t={}){let n={config:t};return dbe.map(cbe.map(fbe.map(e,n),n),n)}function cG(e){return V(e)?{type:e}:e??{}}function mbe(e,t,n){let{width:r,height:i}=t,o=gn(e)||du(e),s={};o?r=="container"&&i=="container"?(s.type="fit",s.contains="padding"):r=="container"?(s.type="fit-x",s.contains="padding"):i=="container"&&(s.type="fit-y",s.contains="padding"):(r=="container"&&(z($.containerSizeNonSingle("width")),r=void 0),i=="container"&&(z($.containerSizeNonSingle("height")),i=void 0));let a={type:"pad",...s,...n?cG(n.autosize):{},...cG(e.autosize)};if(a.type==="fit"&&!o&&(z($.FIT_NON_SINGLE),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&z($.containerSizeNotCompatibleWithAutosize("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&z($.containerSizeNotCompatibleWithAutosize("height")),!kn(a,{type:"pad"}))return a}function fG(e){return["fit","fit-x","fit-y"].includes(e)}function dG(e){return e?`fit-${_l(e)}`:"fit"}var hbe=["background","padding"];function lO(e,t){let n={};for(let r of hbe)e&&e[r]!==void 0&&(n[r]=Tn(e[r]));return t&&(n.params=e.params),n}var Er=class e{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new e(se(this.explicit),se(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return Be(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(let n of P(t.combine())){let r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}};function vo(e){return{explicit:!0,value:e}}function vr(e){return{explicit:!1,value:e}}function oS(e){return(t,n,r,i)=>{let o=e(t.value,n.value);return o>0?t:o<0?n:Yp(t,n,r,i)}}function Yp(e,t,n,r){return e.explicit&&t.explicit&&z($.mergeConflictingProperty(n,r,e.value,t.value)),e}function xi(e,t,n,r,i=Yp){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:kn(e.value,t.value)?e:i(e,t,n,r)}var sS=class extends Er{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){let t=super.clone();return t.parseNothing=this.parseNothing,t}};function pu(e){return j(e,"url")}function mf(e){return j(e,"values")}function aS(e){return j(e,"name")&&!pu(e)&&!mf(e)&&!fs(e)}function fs(e){return e&&(cO(e)||fO(e)||vy(e))}function cO(e){return j(e,"sequence")}function fO(e){return j(e,"sphere")}function vy(e){return j(e,"graticule")}var Xe;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(Xe||(Xe={}));function dO({invalid:e,isPath:t}){switch(Ew(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function pG(e){let{marks:t,scales:n}=dO(e);return t===n?Xe.Main:n==="include-invalid-values"?Xe.PreFilterInvalid:Xe.PostFilterInvalid}var ye=class{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){z($.ADD_SAME_CHILD_TWICE);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){let n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(let n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){let n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){let t=this._parent,n=t.parent;for(let i of this._children)i.parent=t;this._children=[],t.removeChild(this);let r=t.parent.removeChild(t);this._parent=n,n.addChild(this,r),t.parent=this}},Ht=class extends ye{clone(){let t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${nN()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}};function pO(e){return e.as!==void 0}function mG(e){return`${e}_end`}var wo=class e extends ye{clone(){return new e(null,se(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){let r=n.reduceFieldDef((i,o,s)=>{let{field:a,timeUnit:u}=o;if(u){let l;if(us(u)){if(qe(n)){let{mark:c,markDef:f,config:d}=n,p=gi({fieldDef:o,markDef:f,config:d});(ou(c)||p)&&(l={timeUnit:ht(u),field:a})}}else l={as:K(o,{forAs:!0}),field:a,timeUnit:u};if(qe(n)){let{mark:c,markDef:f,config:d}=n,p=gi({fieldDef:o,markDef:f,config:d});ou(c)&&Ye(s)&&p!==.5&&(l.rectBandPosition=p)}l&&(i[fe(l)]=l)}return i},{});return Me(r)?null:new e(t,r)}static makeFromTransform(t,n){let{timeUnit:r,...i}={...n},o=ht(r),s={...i,timeUnit:o};return new e(t,{[fe(s)]:s})}merge(t){this.timeUnits={...this.timeUnits};for(let n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(let n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){let n={};for(let[r,i]of ci(this.timeUnits)){let o=pO(i)?i.as:`${i.field}_end`;t.has(o)||(n[r]=i)}this.timeUnits=n}producedFields(){return new Set(dt(this.timeUnits).map(t=>pO(t)?t.as:mG(t.field)))}dependentFields(){return new Set(dt(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${fe(this.timeUnits)}`}assemble(){let t=[];for(let n of dt(this.timeUnits)){let{rectBandPosition:r}=n,i=ht(n.timeUnit);if(pO(n)){let{field:o,as:s}=n,{unit:a,utc:u,...l}=i,c=[s,`${s}_end`];t.push({field:sn(o),type:"timeunit",...a?{units:Dp(a)}:{},...u?{timezone:"utc"}:{},...l,as:c}),t.push(...hG(c,r,i))}else if(n){let{field:o}=n,s=o.replaceAll("\\.","."),a=yG({timeUnit:i,field:s}),u=mG(s);t.push({type:"formula",expr:a,as:u}),t.push(...hG([s,u],r,i))}}return t}},hf="offsetted_rect_start",gf="offsetted_rect_end";function yG({timeUnit:e,field:t,reverse:n}){let{unit:r,utc:i}=e,o=SN(r),{part:s,step:a}=_N(o,e.step);return`${i?"utcOffset":"timeOffset"}('${s}', ${Je(t)}, ${n?-a:a})`}function hG([e,t],n,r){if(n!==void 0&&n!==.5){let i=Je(e),o=Je(t);return[{type:"formula",expr:gG([yG({timeUnit:r,field:e,reverse:!0}),i],n+.5),as:`${e}_${hf}`},{type:"formula",expr:gG([i,o],n+.5),as:`${e}_${gf}`}]}return[]}function gG([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}var mu="_tuple_fields",mO=class{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}},gbe={defined:()=>!0,parse:(e,t,n)=>{let r=t.name,i=t.project??(t.project=new mO),o={},s={},a=new Set,u=(m,h)=>{let g=h==="visual"?m.channel:m.field,y=ze(`${r}_${g}`);for(let x=1;a.has(y);x++)y=ze(`${r}_${g}_${x}`);return a.add(y),{[h]:y}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?Q(n.value):null,{fields:d,encodings:p}=X(n.select)?n.select:{};if(!d&&!p&&f){for(let m of f)if(X(m))for(let h of P(m))_z(h)?(p||(p=[])).push(h):l==="interval"?(z($.INTERVAL_INITIALIZED_WITH_POS),p=c.encodings):(d??(d=[])).push(h)}!d&&!p&&(p=c.encodings,"fields"in c&&(d=c.fields));for(let m of p??[]){let h=e.fieldDef(m);if(h){let g=h.field;if(h.aggregate){z($.cannotProjectAggregate(m,h.aggregate));continue}else if(!g){z($.cannotProjectOnChannelWithoutField(m));continue}if(h.timeUnit&&!us(h.timeUnit)){g=e.vgField(m);let y={timeUnit:h.timeUnit,as:g,field:h.field};s[fe(y)]=y}if(!o[g]){let y=l==="interval"&&an(m)&&Dn(e.getScaleComponent(m).get("type"))?"R":h.bin?"R-RE":"E",x={field:g,channel:m,type:y,index:i.items.length};x.signals={...u(x,"data"),...u(x,"visual")},i.items.push(o[g]=x),i.hasField[g]=o[g],i.hasSelectionId=i.hasSelectionId||g===Xn,jv(m)?(x.geoChannel=m,x.channel=Gv(m),i.hasChannel[x.channel]=o[g]):i.hasChannel[m]=o[g]}}else z($.cannotProjectOnChannelWithoutField(m))}for(let m of d??[]){if(i.hasField[m])continue;let h={type:"E",field:m,index:i.items.length};h.signals={...u(h,"data")},i.items.push(h),i.hasField[m]=h,i.hasSelectionId=i.hasSelectionId||m===Xn}f&&(t.init=f.map(m=>i.items.map(h=>X(m)?m[h.geoChannel||h.channel]!==void 0?m[h.geoChannel||h.channel]:m[h.field]:m))),Me(s)||(i.timeUnit=new wo(null,s))},signals:(e,t,n)=>{let r=t.name+mu;return n.filter(o=>o.name===r).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(hO)})}},xG=gbe;var lS="_curr",uS="anim_value",Xp="anim_clock",xO="eased_anim_clock",bG="min_extent",EG="max_range_extent",gO="last_tick_at",yO="is_playing",ybe=1/60*1e3,xbe=(e,t)=>[{name:xO,update:Xp},{name:`${e}_domain`,init:`domain('${t}')`},{name:bG,init:`extent(${e}_domain)[0]`},{name:EG,init:`extent(range('${t}'))[1]`},{name:uS,update:`invert('${t}', ${xO})`}],bbe={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(Mn(t)&&(n=n.concat([{name:Xp,init:"0",on:[{events:{type:"timer",throttle:ybe},update:`${yO} ? (${Xp} + (now() - ${gO}) > ${EG} ? 0 : ${Xp} + (now() - ${gO})) : ${Xp}`}]},{name:gO,init:"now()",on:[{events:[{signal:Xp},{signal:yO}],update:"now()"}]},{name:yO,init:"true"}])),n),signals:(e,t,n)=>{let r=t.name,i=r+mu,o=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=dt(e.component.selection??{}).reduce((c,f)=>f.type==="interval"?c.concat(f.name+hu):c,[]).map(c=>`indexof(item().mark.name, '${c}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`,l=`unit: ${ds(e)}, `;if(t.project.hasSelectionId)l+=`${Xn}: ${s}[${Y(Xn)}]`;else if(Mn(t))l+=`fields: ${i}, values: [${uS} ? ${uS} : ${bG}]`;else{let c=o.items.map(f=>e.fieldDef(f.channel)?.bin?`[${s}[${Y(e.vgField(f.channel,{}))}], ${s}[${Y(e.vgField(f.channel,{binSuffix:"end"}))}]]`:`${s}[${Y(f.field)}]`).join(", ");l+=`fields: ${i}, values: [${c}]`}if(Mn(t))return n.concat(xbe(t.name,e.scaleName(Oi)),[{name:r+wr,on:[{events:[{signal:xO},{signal:uS}],update:`{${l}}`,force:!0}]}]);{let c=t.events;return n.concat([{name:r+wr,on:c?[{events:c,update:`${u} ? {${l}} : null`,force:!0}]:[]}])}}},vG=bbe;function hO(e){let{signals:t,hasLegend:n,index:r,...i}=e;return i.field=sn(i.field),i}function gu(e,t=!0,n=Ot){if(M(e)){let r=e.map(i=>gu(i,t,n));return t?`[${r.join(", ")}]`:r}else if(yo(e))return n(t?as(e):rH(e));return t?n(He(e)):e}function wG(e,t){for(let n of dt(e.component.selection??{})){let r=n.name,i=`${r}${wr}, ${n.resolve==="global"?"true":`{unit: ${ds(e)}}`}`;for(let o of Kp)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+FG,on:[{events:{signal:n.name+wr},update:`modify(${Y(n.name+ps)}, ${i})`}]})}return EO(t)}function SG(e,t){if(e.component.selection&&P(e.component.selection).length){let n=Y(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:fr("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return EO(t)}function AG(e,t){let n=!1;for(let r of dt(e.component.selection??{})){let i=r.name,o=Y(i+ps);if(t.filter(a=>a.name===i).length===0){let a=r.resolve==="global"?"union":r.resolve,u=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${cS}(${o}, ${Y(a)}${u}`})}n=!0;for(let a of Kp)a.defined(r)&&a.topLevelSignals&&(t=a.topLevelSignals(e,r,t))}return n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),EO(t)}function _G(e,t){let n=[],r=[],i=ds(e,{escape:!1});for(let o of dt(e.component.selection??{})){let s={name:o.name+ps};if(o.project.hasSelectionId&&(s.transform=[{type:"collect",sort:{field:Xn}}]),o.init){let u=o.project.items.map(hO);s.values=o.project.hasSelectionId?o.init.map(l=>({unit:i,[Xn]:gu(l,!1)[0]})):o.init.map(l=>({unit:i,fields:u,values:gu(l,!1)}))}if([...n,...t].filter(u=>u.name===o.name+ps).length||n.push(s),Mn(o)&&t.length){let u=e.lookupDataSource(e.getDataName(Xe.Main)),l=t.find(f=>f.name===u),c=l.transform.find(f=>f.type==="filter"&&f.expr.includes("vlSelectionTest"));if(c){l.transform=l.transform.filter(d=>d!==c);let f={name:l.name+lS,source:l.name,transform:[c]};r.push(f)}}}return n.concat(t,r)}function bO(e,t){for(let n of dt(e.component.selection??{}))for(let r of Kp)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function CG(e,t){for(let n of e.children)qe(n)&&(t=bO(n,t));return t}function kG(e,t,n,r){let i=fS(e,t.param,t);return{signal:Dn(n.get("type"))&&M(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function EO(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}var Ebe={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{let n=t.scales=[];for(let r of t.project.items){let i=r.channel;if(!an(i))continue;let o=e.getScaleComponent(i),s=o?o.get("type"):void 0;if(s=="sequential"&&z($.SEQUENTIAL_SCALE_DEPRECATED),!o||!Dn(s)){z($.SCALE_BINDINGS_CONTINUOUS);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{let r=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||vO(e)||r.length===0)return n;let i=n.find(s=>s.name===t.name),o=i.update;if(o.includes(cS))i.update=`{${r.map(s=>`${Y(sn(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(let s of r){let a=`${Y(sn(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!vO(e))for(let r of t.scales){let i=n.find(o=>o.name===r.signals.data);i.push="outer",delete i.value,delete i.update}return n}},Hi=Ebe;function wy(e,t){return`domain(${Y(e.scaleName(t))})`}function vO(e){return e.parent&&So(e.parent)&&(!e.parent.parent||vO(e.parent.parent))}var hu="_brush",RG="_scale_trigger",Sy="geo_interval_init_tick",TG="_init",vbe="_center",wbe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var r;if(e.hasProjection){let i={...X(n.select)?n.select:{}};i.fields=[Xn],i.encodings||(i.encodings=n.value?P(n.value):[jn,Gn]),n.select={type:"interval",...i}}if(t.translate&&!Hi.defined(t)){let i=`!event.item || event.item.mark.name !== ${Y(t.name+hu)}`;for(let o of t.events){if(!o.between){z(`${o} is not an ordered event stream for interval selections.`);continue}let s=Q((r=o.between[0]).filter??(r.filter=[]));s.includes(i)||s.push(i)}}},signals:(e,t,n)=>{let r=t.name,i=r+wr,o=dt(t.project.hasChannel).filter(a=>a.channel===Ve||a.channel===pt),s=t.init?t.init[0]:null;if(n.push(...o.reduce((a,u)=>a.concat(Sbe(e,t,u,s&&s[u.index])),[])),e.hasProjection){let a=Y(e.projectionName()),u=e.projectionName()+vbe,{x:l,y:c}=t.project.hasChannel,f=l&&l.signals.visual,d=c&&c.signals.visual,p=l?s&&s[l.index]:`${u}[0]`,m=c?s&&s[c.index]:`${u}[1]`,h=v=>e.getSizeSignalRef(v).signal,g=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":h("width")}, ${d?d+"[1]":h("height")}]]`;s&&(n.unshift({name:r+TG,init:`[scale(${a}, [${l?p[0]:p}, ${c?m[0]:m}]), scale(${a}, [${l?p[1]:p}, ${c?m[1]:m}])]`}),(!l||!c)&&(n.find(S=>S.name===u)||n.unshift({name:u,update:`invert(${a}, [${h("width")}/2, ${h("height")}/2])`})));let y=`intersect(${g}, {markname: ${Y(e.getName("marks"))}}, unit.mark)`,x=`{unit: ${ds(e)}}`,b=`vlSelectionTuples(${y}, ${x})`,E=o.map(v=>v.signals.visual);return n.concat({name:i,on:[{events:[...E.length?[{signal:E.join(" || ")}]:[],...s?[{signal:Sy}]:[]],update:b}]})}else{if(!Hi.defined(t)){let l=r+RG,c=o.map(f=>{let d=f.channel,{data:p,visual:m}=f.signals,h=Y(e.scaleName(d)),g=e.getScaleComponent(d).get("type"),y=Dn(g)?"+":"";return`(!isArray(${p}) || (${y}invert(${h}, ${m})[0] === ${y}${p}[0] && ${y}invert(${h}, ${m})[1] === ${y}${p}[1]))`});c.length&&n.push({name:l,value:{},on:[{events:o.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${l} : {}`}]})}let a=o.map(l=>l.signals.data),u=`unit: ${ds(e)}, fields: ${r+mu}, values`;return n.concat({name:i,...s?{init:`{${u}: ${gu(s)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(qe(e)&&e.hasProjection&&t.init&&(n.filter(i=>i.name===Sy).length||n.unshift({name:Sy,value:null,on:[{events:"timer{1}",update:`${Sy} === null ? {} : ${Sy}`}]})),n),marks:(e,t,n)=>{let r=t.name,{x:i,y:o}=t.project.hasChannel,s=i?.signals.visual,a=o?.signals.visual,u=`data(${Y(t.name+ps)})`;if(Hi.defined(t)||!i&&!o)return n;let l={x:i!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(let g of P(l))l[g]=[{test:`${u}.length && ${u}[0].unit === ${ds(e)}`,...l[g]},{value:0}];let{fill:c,fillOpacity:f,cursor:d,...p}=t.mark,m=P(p).reduce((g,y)=>(g[y]=[{test:[i!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(x=>x).join(" && "),value:p[y]},{value:null}],g),{}),h=d??(t.translate?"move":null);return[{name:`${r+hu}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:r+hu,type:"rect",clip:!0,encode:{enter:{...h?{cursor:{value:h}}:{},fill:{value:"transparent"}},update:{...l,...m}}}]}},DG=wbe;function Sbe(e,t,n,r){let i=!e.hasProjection,o=n.channel,s=n.signals.visual,a=Y(i?e.scaleName(o):e.projectionName()),u=d=>`scale(${a}, ${d})`,l=e.getSizeSignalRef(o===Ve?"width":"height").signal,c=`${o}(unit)`,f=t.events.reduce((d,p)=>[...d,{events:p.between[0],update:`[${c}, ${c}]`},{events:p,update:`[${s}[0], clamp(${c}, 0, ${l})]`}],[]);if(i){let d=n.signals.data,p=Hi.defined(t),m=e.getScaleComponent(o),h=m?m.get("type"):void 0,g=r?{init:gu(r,!0,u)}:{value:[]};return f.push({events:{signal:t.name+RG},update:Dn(h)?`[${u(`${d}[0]`)}, ${u(`${d}[1]`)}]`:"[0, 0]"}),p?[{name:d,on:[]}]:[{name:s,...g,on:f},{name:d,...r?{init:gu(r)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${a}, ${s})`}]}]}else{let d=o===Ve?0:1,p=t.name+TG,m=r?{init:`[${p}[0][${d}], ${p}[1][${d}]]`}:{value:[]};return[{name:s,...m,on:f}]}}function Ao({model:e,channelDef:t,vgChannel:n,invalidValueRef:r,mainRefFn:i}){let o=aa(t)&&t.condition,s=[];o&&(s=Q(o).map(l=>{let c=i(l);if(VH(l)){let{param:f,empty:d}=l;return{test:dS(e,{param:f,empty:d}),...c}}else return{test:yf(e,l.test),...c}})),r!==void 0&&s.push(r);let a=i(t);return a!==void 0&&s.push(a),s.length>1||s.length===1&&s[0].test?{[n]:s}:s.length===1?{[n]:s[0]}:{}}function Nl(e,t="text"){let n=e.encoding[t];return Ao({model:e,channelDef:n,vgChannel:t,mainRefFn:r=>Qp(r,e.config),invalidValueRef:void 0})}function Qp(e,t,n="datum"){if(e){if(un(e))return Pe(e.value);if(be(e)){let{format:r,formatType:i}=zp(e);return Bp({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function Jp(e,t={}){let{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(M(s))return{tooltip:wO({tooltip:s},o,i,t)};{let a=t.reactiveGeom?"datum.datum":"datum";return Ao({model:e,channelDef:s,vgChannel:"tooltip",mainRefFn:l=>{let c=Qp(l,i,a);if(c)return c;if(l===null)return;let f=Ne("tooltip",r,i);if(f===!0&&(f={content:"encoding"}),V(f))return{value:f};if(X(f))return re(f)?f:f.content==="encoding"?wO(n,o,i,t):{signal:a}},invalidValueRef:void 0})}}function SO(e,t,n,{reactiveGeom:r}={}){let i={...n,...n.tooltipFormat},o=new Set,s=r?"datum.datum":"datum",a=[];function u(c,f){let d=Li(f),p=Mt(c)?c:{...c,type:e[d].type},m=p.title||fy(p,i),h=Q(m).join(", ").replaceAll(/"/g,'\\"'),g;if(Ye(f)){let y=f==="x"?"x2":"y2",x=hn(e[y]);if(mt(p.bin)&&x){let b=K(p,{expr:s}),E=K(x,{expr:s}),{format:v,formatType:S}=zp(p);g=pf(b,E,v,S,i),o.add(y)}}if((Ye(f)||f===qn||f===pr)&&t&&t.fieldChannel===f&&t.offset==="normalize"){let{format:y,formatType:x}=zp(p);g=Bp({fieldOrDatumDef:p,format:y,formatType:x,expr:s,config:i,normalizeStack:!0}).signal}g??(g=Qp(p,i,s).signal),a.push({channel:f,key:h,value:g})}py(e,(c,f)=>{W(c)?u(c,f):Up(c)&&u(c.condition,f)});let l={};for(let{channel:c,key:f,value:d}of a)!o.has(c)&&!l[f]&&(l[f]=d);return l}function wO(e,t,n,{reactiveGeom:r}={}){let i=SO(e,t,n,{reactiveGeom:r}),o=ci(i).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function AO(e){let{markDef:t,config:n}=e,r=Ne("aria",t,n);return r===!1?{}:{...r?{aria:r}:{},...Abe(e),..._be(e)}}function Abe(e){let{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};let i=Ne("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:ee(Wz,t)?{}:{ariaRoleDescription:{value:t}}}function _be(e){let{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return Ao({model:e,channelDef:o,vgChannel:"description",mainRefFn:u=>Qp(u,e.config),invalidValueRef:void 0});let s=Ne("description",n,r);if(s!=null)return{description:Pe(s)};if(r.aria===!1)return{};let a=SO(t,i,r);if(!Me(a))return{description:{signal:ci(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function gt(e,t,n={}){let{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n,{defaultRef:a,defaultValue:u}=n,l=i[e];a===void 0&&(u??(u=Ne(e,r,o,{vgChannel:s,ignoreVgConfig:!aa(l)})),u!==void 0&&(a=Pe(u)));let c={markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},f=ww({...c,scaleChannel:e,channelDef:l});return Ao({model:t,channelDef:l,vgChannel:s??e,invalidValueRef:f,mainRefFn:p=>uy({...c,channel:e,channelDef:p,stack:null,defaultRef:a})})}function Zp(e,t={filled:void 0}){let{markDef:n,encoding:r,config:i}=e,{type:o}=n,s=t.filled??Ne("filled",n,i),a=ge(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,u=Ne(s===!0?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[s===!0&&"color"]??a,l=Ne(s===!1?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[s===!1&&"color"],c=s?"fill":"stroke",f={...u?{fill:Pe(u)}:{},...l?{stroke:Pe(l)}:{}};return n.color&&(s?n.fill:n.stroke)&&z($.droppingColor("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...gt("color",e,{vgChannel:c,defaultValue:s?u:l}),...gt("fill",e,{defaultValue:r.fill?u:void 0}),...gt("stroke",e,{defaultValue:r.stroke?l:void 0})}}function MG(e){let{encoding:t,mark:n}=e,r=t.order;return!yr(n)&&un(r)?Ao({model:e,channelDef:r,vgChannel:"zindex",mainRefFn:i=>Pe(i.value),invalidValueRef:void 0}):{}}function yu({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){let o=`${e}Offset`,s=t[o],a=n[o];if((o==="xOffset"||o==="yOffset")&&a)return{offsetType:"encoding",offset:uy({channel:o,channelDef:a,markDef:t,config:r?.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:Pe(s),bandPosition:i})};let u=t[o];return u?{offsetType:"visual",offset:u}:{}}function Nt(e,t,{defaultPos:n,vgChannel:r}){let{encoding:i,markDef:o,config:s,stack:a}=t,u=i[e],l=i[Rn(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:p}=yu({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5}),m=Ay({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),h=!u&&Ye(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:Cbe({channel:e,channelDef:u,channel2Def:l,markDef:o,config:s,scaleName:c,scale:f,stack:a,offset:d,defaultRef:m,bandPosition:p==="encoding"?0:void 0});return h?{[r||e]:h}:void 0}function Cbe(e){let{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=e;if(be(n)&&i&&t===i.fieldChannel){if(W(n)){let a=n.bandPosition;if(a===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return Pp({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return ra(n,r,{suffix:"end"},{offset:o})}return $p(e)}function Ay({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){let{markDef:o,config:s}=e;return()=>{let a=Li(n),u=ho(n),l=Ne(n,o,s,{vgChannel:u});if(l!==void 0)return df(n,l);switch(t){case"zeroOrMin":return NG({scaleName:r,scale:i,mode:"zeroOrMin",mainChannel:a,config:s});case"zeroOrMax":return NG({scaleName:r,scale:i,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:s});case"mid":return{...e[Dt(n)],mult:.5}}}}function NG({mainChannel:e,config:t,...n}){let r=vw(n),{mode:i}=n;if(r)return r;switch(e){case"radius":{if(i==="zeroOrMin")return{value:0};let{widthSignal:o,heightSignal:s}=i.zeroOrMax;return{signal:`min(${o},${s})/2`}}case"theta":return i==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return i==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return i==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}var kbe={left:"x",center:"xc",right:"x2"},Fbe={top:"y",middle:"yc",bottom:"y2"};function pS(e,t,n,r="middle"){if(e==="radius"||e==="theta")return ho(e);let i=e==="x"?"align":"baseline",o=Ne(i,t,n),s;return re(o)?(z($.rangeMarkAlignmentCannotBeExpression(i)),s=void 0):s=o,e==="x"?kbe[s||(r==="top"?"left":"center")]:Fbe[s||r]}function Ol(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?_y(e,t,{defaultPos:n,defaultPos2:r}):Nt(e,t,{defaultPos:n})}function _y(e,t,{defaultPos:n,defaultPos2:r}){let{markDef:i,config:o}=t,s=Rn(e),a=Dt(e),u=Rbe(t,r,s),l=u[a]?pS(e,i,o):ho(e);return{...Nt(e,t,{defaultPos:n,vgChannel:l}),...u}}function Rbe(e,t,n){let{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,u=Li(n),l=Dt(n),c=ho(n),f=r[u],d=e.scaleName(u),p=e.getScaleComponent(u),{offset:m}=n in r||n in o?yu({channel:n,markDef:o,encoding:r,model:e}):yu({channel:u,markDef:o,encoding:r,model:e});if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){let g=Dt(n),y=e.markDef[g];return y!=null?{[g]:{value:y}}:{[c]:{field:e.getName(n)}}}let h=Tbe({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:d,scale:p,stack:s,offset:m,defaultRef:void 0});return h!==void 0?{[c]:h}:mS(n,o)||mS(n,{[n]:tw(n,o,a.style),[l]:tw(l,o,a.style)})||mS(n,a[i])||mS(n,a.mark)||{[c]:Ay({model:e,defaultPos:t,channel:n,scaleName:d,scale:p})()}}function Tbe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l}){return be(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?ra(t,o,{suffix:"start"},{offset:u}):$p({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:u,defaultRef:l})}function mS(e,t){let n=Dt(e),r=ho(e);if(t[r]!==void 0)return{[r]:df(e,t[r])};if(t[e]!==void 0)return{[r]:df(e,t[e])};if(t[n]){let i=t[n];if(na(i))z($.relativeBandSizeNotSupported(n));else return{[n]:df(e,i)}}}function Sr(e,t){let{config:n,encoding:r,markDef:i}=e,o=i.type,s=Rn(t),a=Dt(t),u=r[t],l=r[s],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,p=r[a]??r.size??Ne("size",i,n,{vgChannel:a}),m=uN(t),h=o==="bar"&&(t==="x"?d==="vertical":d==="horizontal")||o==="tick"&&(t==="y"?d==="vertical":d==="horizontal");return W(u)&&(Ie(u.bin)||mt(u.bin)||u.timeUnit&&!l)&&!(p&&!na(p))&&!r[m]&&!ot(f)?Nbe({fieldDef:u,fieldDef2:l,channel:t,model:e}):(be(u)&&ot(f)||h)&&!l?Mbe(u,t,e):_y(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Dbe(e,t,n,r,i,o,s){if(na(i))if(n){let u=n.get("type");if(u==="band"){let l=`bandwidth('${t}')`;i.band!==1&&(l=`${i.band} * ${l}`);let c=Wr("minBandSize",{type:s},r);return{signal:c?`max(${jr(c)}, ${l})`:l}}else i.band!==1&&(z($.cannotUseRelativeBandSizeWithNonBandScale(u)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(re(i))return i;if(i)return{value:i}}if(n){let u=n.get("range");if(hi(u)&&ke(u.step))return{value:u.step-2}}if(!o){let{bandPaddingInner:u,barBandPaddingInner:l,rectBandPaddingInner:c,tickBandPaddingInner:f}=r.scale,d=Be(u,s==="tick"?f:s==="bar"?l:c);if(re(d))return{signal:`(1 - (${d.signal})) * ${e}`};if(ke(d))return{signal:`${1-d} * ${e}`}}return{value:by(r.view,e)-2}}function Mbe(e,t,n){let{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=Dt(t),f=Rn(t),d=uN(t),p=n.scaleName(d),m=n.getScaleComponent(_p(t)),h=r.type==="tick"||a==="horizontal"&&t==="y"||a==="vertical"&&t==="x",g;(i.size||r.size)&&(h?g=gt("size",n,{vgChannel:c,defaultRef:Pe(r.size)}):z($.cannotApplySizeToNonOrientedMark(r.type)));let y=!!g,x=PN({channel:t,fieldDef:e,markDef:r,config:o,scaleType:(l||m)?.get("type"),useVlSizeChannel:h});g=g||{[c]:Dbe(c,p||u,m||l,o,x,!!e,r.type)};let b=(l||m)?.get("type")==="band"&&na(x)&&!y?"top":"middle",E=pS(t,r,o,b),v=E==="xc"||E==="yc",{offset:S,offsetType:w}=yu({channel:t,markDef:r,encoding:i,model:n,bandPosition:v?.5:0}),_=$p({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:s,offset:S,defaultRef:Ay({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:v?w==="encoding"?0:.5:re(x)?{signal:`(1-${x})/2`}:na(x)?(1-x.band)/2:0});if(c)return{[E]:_,...g};{let A=ho(f),F=g[c],R=S?{...F,offset:S}:F;return{[E]:_,[A]:M(_)?[_[0],{..._[1],offset:R}]:{..._,offset:R}}}}function OG(e,t,n,r,i,o,s){if(iN(e))return 0;let a=e==="x"||e==="y2",u=a?-t/2:t/2;if(re(n)||re(i)||re(r)||o){let l=jr(n),c=jr(i),f=jr(r),d=jr(o),m=o?`(${s} < ${d} ? ${a?"":"-"}0.5 * (${d} - (${s})) : ${u})`:u,h=f?`${f} + `:"",g=l?`(${l} ? -1 : 1) * `:"",y=c?`(${c} + ${m})`:m;return{signal:h+g+y}}else return i=i||0,r+(n?-i-u:+i+u)}function Nbe({fieldDef:e,fieldDef2:t,channel:n,model:r}){let{config:i,markDef:o,encoding:s}=r,a=r.getScaleComponent(n),u=r.scaleName(n),l=a?a.get("type"):void 0,c=a.get("reverse"),f=PN({channel:n,fieldDef:e,markDef:o,config:i,scaleType:l}),p=r.component.axes[n]?.[0]?.get("translate")??.5,m=Ye(n)?Ne("binSpacing",o,i)??0:0,h=Rn(n),g=ho(n),y=ho(h),x=Wr("minBandSize",o,i),{offset:b}=yu({channel:n,markDef:o,encoding:s,model:r,bandPosition:0}),{offset:E}=yu({channel:h,markDef:o,encoding:s,model:r,bandPosition:0}),v=zH({fieldDef:e,scaleName:u}),S=OG(n,m,c,p,b,x,v),w=OG(h,m,c,p,E??b,x,v),_=re(f)?{signal:`(1-${f.signal})/2`}:na(f)?(1-f.band)/2:.5,A=gi({fieldDef:e,fieldDef2:t,markDef:o,config:i});if(Ie(e.bin)||e.timeUnit){let F=e.timeUnit&&A!==.5;return{[y]:IG({fieldDef:e,scaleName:u,bandPosition:_,offset:w,useRectOffsetField:F}),[g]:IG({fieldDef:e,scaleName:u,bandPosition:re(_)?{signal:`1-${_.signal}`}:1-_,offset:S,useRectOffsetField:F})}}else if(mt(e.bin)){let F=ra(e,u,{},{offset:w});if(W(t))return{[y]:F,[g]:ra(t,u,{},{offset:S})};if(is(e.bin)&&e.bin.step)return{[y]:F,[g]:{signal:`scale("${u}", ${K(e,{expr:"datum"})} + ${e.bin.step})`,offset:S}}}z($.channelRequiredForBinned(h))}function IG({fieldDef:e,scaleName:t,bandPosition:n,offset:r,useRectOffsetField:i}){return Pp({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r,...i?{startSuffix:hf,endSuffix:gf}:{}})}var Obe=new Set(["aria","width","height"]);function Ft(e,t){let{fill:n=void 0,stroke:r=void 0}=t.color==="include"?Zp(e):{};return{...Ibe(e.markDef,t),...PG("fill",n),...PG("stroke",r),...gt("opacity",e),...gt("fillOpacity",e),...gt("strokeOpacity",e),...gt("strokeWidth",e),...gt("strokeDash",e),...MG(e),...Jp(e),...Nl(e,"href"),...AO(e)}}function PG(e,t){return t?{[e]:t}:{}}function Ibe(e,t){return jz.reduce((n,r)=>(!Obe.has(r)&&j(e,r)&&t[r]!=="ignore"&&(n[r]=Pe(e[r])),n),{})}function em(e){let{config:t,markDef:n}=e,r=new Set;if(e.forEachFieldDef((i,o)=>{let s;if(!an(o)||!(s=e.getScaleType(o)))return;let a=Cl(i.aggregate),u=Ip({scaleChannel:o,markDef:n,config:t,scaleType:s,isCountAggregate:a});if(LH(u)){let l=e.vgField(o,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});l&&r.add(l)}}),r.size>0)return{defined:{signal:[...r].map(o=>af(o,!0)).join(" && ")}}}function hS(e,t){if(t!==void 0)return{[e]:Pe(t)}}var _O="voronoi",Pbe={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(let n of t.events)n.markname=e.getName(_O)},marks:(e,t,n)=>{let{x:r,y:i}=t.project.hasChannel,o=e.mark;if(yr(o))return z($.nearestNotSupportForContinuous(o)),n;let s={name:e.getName(_O),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...Jp(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},a=0,u=!1;return n.forEach((l,c)=>{let f=l.name??"";f===e.component.mark[0].name?a=c:f.includes(_O)&&(u=!0)}),u||n.splice(a+1,0,s),n}},gS=Pbe;var $be={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!gy(e.bind),parse:(e,t,n)=>xS(t,n),topLevelSignals:(e,t,n)=>{let r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=gS.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{let c=ze(`${r}_${u.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...s?{init:gu(s[l])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${Y(u.field)}] : null`}]:[],bind:o[u.field]??o[u.channel]??o})}),n},signals:(e,t,n)=>{let r=t.name,i=t.project,o=n.find(l=>l.name===r+wr),s=r+mu,a=i.items.map(l=>ze(`${r}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},yS=$be;var tm="_toggle",Bbe={defined:e=>e.type==="point"&&!Mn(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+tm,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{let n=t.name+wr,r=t.name+tm;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${ds(e)}}, `)+`${r} ? ${n} : null`}},bS=Bbe;var Lbe={defined:e=>e.clear!==void 0&&e.clear!==!1&&!Mn(e),parse:(e,t)=>{t.clear&&(t.clear=V(t.clear)?fr(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(yS.defined(t))for(let r of t.project.items){let i=n.findIndex(o=>o.name===ze(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(let i of t.project.items){let o=n.findIndex(s=>s.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){let s=n.findIndex(a=>a.name===i.signals.data);r(s,"null")}}else{let i=n.findIndex(o=>o.name===t.name+wr);r(i,"null"),bS.defined(t)&&(i=n.findIndex(o=>o.name===t.name+tm),r(i,"false"))}return n}},$G=Lbe;var BG={defined:e=>{let t=e.resolve==="global"&&e.bind&&gy(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Xn;return t&&!n&&z($.LEGEND_BINDINGS_MUST_HAVE_PROJECTION),t&&n},parse:(e,t,n)=>{let r=se(n);if(r.select=V(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},xS(t,r),X(n.select)&&(n.select.on||n.select.clear)){let s='event.item && indexof(event.item.mark.role, "legend") < 0';for(let a of t.events)a.filter=Q(a.filter??[]),a.filter.includes(s)||a.filter.push(s)}let i=Ww(t.bind)?t.bind.legend:"click",o=V(i)?fr(i,"view"):Q(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{let r=t.name,i=Ww(t.bind)&&t.bind.legend,o=s=>a=>{let u=se(a);return u.markname=s,u};for(let s of t.project.items){if(!s.hasLegend)continue;let a=`${ze(s.field)}_legend`,u=`${r}_${a}`;if(n.filter(c=>c.name===u).length===0){let c=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{let r=t.name,i=t.project,o=n.find(d=>d.name===r+wr),s=r+mu,a=i.items.filter(d=>d.hasLegend).map(d=>ze(`${r}_${ze(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);let c=n.find(d=>d.name===r+tm),f=Ww(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}},LG=BG;function UG(e,t,n){let r=e.fieldDef(t)?.field;for(let i of dt(e.component.selection??{})){let o=i.project.hasField[r]??i.project.hasChannel[t];if(o&&BG.defined(i)){let s=n.get("selections")??[];s.push(i.name),n.set("selections",s,!1),o.hasLegend=!0}}}var HG="_translate_anchor",qG="_translate_delta",Ube={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{let r=t.name,i=Hi.defined(t),o=r+HG,{x:s,y:a}=t.project.hasChannel,u=fr(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+hu,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?`, extent_x: ${i?wy(e,Ve):`slice(${s.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${i?wy(e,pt):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+qG,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&zG(e,t,s,"width",n),a!==void 0&&zG(e,t,a,"height",n),n}},GG=Ube;function zG(e,t,n,r,i){let o=t.name,s=o+HG,a=o+qG,u=n.channel,l=Hi.defined(t),c=i.find(v=>v.name===n.signals[l?"data":"visual"]),f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),p=d&&d.get("type"),m=d&&d.get("reverse"),h=l?u===Ve?m?"":"-":m?"-":"":"",g=`${s}.extent_${u}`,y=`${h}${a}.${u} / ${l?`${f}`:`span(${g})`}`,x=!l||!d?"panLinear":p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear",b=l?p==="pow"?`, ${d.get("exponent")??1}`:p==="symlog"?`, ${d.get("constant")??1}`:"":"",E=`${x}(${g}, ${y}${b})`;c.on.push({events:{signal:a},update:l?E:`clampRange(${E}, 0, ${f})`})}var WG="_zoom_anchor",VG="_zoom_delta",zbe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{let r=t.name,i=Hi.defined(t),o=r+VG,{x:s,y:a}=t.project.hasChannel,u=Y(e.scaleName(Ve)),l=Y(e.scaleName(pt)),c=fr(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+hu,f))),n.push({name:r+WG,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&jG(e,t,s,"width",n),a!==void 0&&jG(e,t,a,"height",n),n}},YG=zbe;function jG(e,t,n,r,i){let o=t.name,s=n.channel,a=Hi.defined(t),u=i.find(x=>x.name===n.signals[a?"data":"visual"]),l=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(s),f=c&&c.get("type"),d=a?wy(e,s):u.name,p=o+VG,m=`${o}${WG}.${s}`,h=!a||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",g=a?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",y=`${h}(${d}, ${m}, ${p}${g})`;u.on.push({events:{signal:p},update:a?y:`clampRange(${y}, 0, ${l})`})}var ps="_store",wr="_tuple",FG="_modify";var cS="vlSelectionResolve",Kp=[vG,DG,xG,bS,yS,Hi,LG,$G,GG,YG,gS];function Hbe(e){let t=e.parent;for(;t&&!Yt(t);)t=t.parent;return t}function ds(e,{escape:t}={escape:!0}){let n=t?Y(e.name):e.name,r=Hbe(e);if(r){let{facet:i}=r;for(let o of Fn)i[o]&&(n+=` + '__facet_${o}_' + (facet[${Y(r.vgField(o))}])`)}return n}function Cy(e){return dt(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function xS(e,t){(V(t.select)||!t.select.on)&&delete e.events,(V(t.select)||!t.select.clear)&&delete e.clear,(V(t.select)||!t.select.toggle)&&delete e.toggle}function Mn(e){return e.events?.find(t=>"type"in t&&t.type==="timer")}var qbe="RawCode",Gbe="Literal",jbe="Property",Wbe="Identifier",Vbe="ArrayExpression",Ybe="BinaryExpression",Xbe="CallExpression",Kbe="ConditionalExpression",Qbe="LogicalExpression",Jbe="MemberExpression",Zbe="ObjectExpression",eEe="UnaryExpression";function ms(e){this.type=e}ms.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=tEe(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function tEe(e){switch(e.type){case Vbe:return e.elements;case Ybe:case Qbe:return[e.left,e.right];case Xbe:return[e.callee].concat(e.arguments);case Kbe:return[e.test,e.consequent,e.alternate];case Jbe:return[e.object,e.property];case Zbe:return e.properties;case jbe:return[e.key,e.value];case eEe:return[e.argument];case Wbe:case Gbe:case qbe:default:return[]}}var fa,me,G,Ar,st,wS=1,Dy=2,xf=3,Il=4,SS=5,Ef=6,bi=7,My=8,nEe=9;fa={};fa[wS]="Boolean";fa[Dy]="<end>";fa[xf]="Identifier";fa[Il]="Keyword";fa[SS]="Null";fa[Ef]="Numeric";fa[bi]="Punctuator";fa[My]="String";fa[nEe]="RegularExpression";var rEe="ArrayExpression",iEe="BinaryExpression",oEe="CallExpression",sEe="ConditionalExpression",nj="Identifier",aEe="Literal",uEe="LogicalExpression",lEe="MemberExpression",cEe="ObjectExpression",fEe="Property",dEe="UnaryExpression",Nn="Unexpected token %0",pEe="Unexpected number",mEe="Unexpected string",hEe="Unexpected identifier",gEe="Unexpected reserved word",yEe="Unexpected end of input",RO="Invalid regular expression",CO="Invalid regular expression: missing /",rj="Octal literals are not allowed in strict mode.",xEe="Duplicate data property in object literal not allowed in strict mode",Kn="ILLEGAL",Ry="Disabled.",bEe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),EEe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function AS(e,t){if(!e)throw new Error("ASSERT: "+t)}function xu(e){return e>=48&&e<=57}function DO(e){return"0123456789abcdefABCDEF".includes(e)}function Fy(e){return"01234567".includes(e)}function vEe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function Ty(e){return e===10||e===13||e===8232||e===8233}function Ny(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&bEe.test(String.fromCharCode(e))}function vS(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&EEe.test(String.fromCharCode(e))}var wEe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function ij(){for(;G<Ar;){let e=me.charCodeAt(G);if(vEe(e)||Ty(e))++G;else break}}function TO(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)G<Ar&&DO(me[G])?(r=me[G++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Ze({},Nn,Kn);return String.fromCharCode(i)}function SEe(){var e,t,n,r;for(e=me[G],t=0,e==="}"&&Ze({},Nn,Kn);G<Ar&&(e=me[G++],!!DO(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Ze({},Nn,Kn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function oj(){var e,t;for(e=me.charCodeAt(G++),t=String.fromCharCode(e),e===92&&(me.charCodeAt(G)!==117&&Ze({},Nn,Kn),++G,e=TO("u"),(!e||e==="\\"||!Ny(e.charCodeAt(0)))&&Ze({},Nn,Kn),t=e);G<Ar&&(e=me.charCodeAt(G),!!vS(e));)++G,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),me.charCodeAt(G)!==117&&Ze({},Nn,Kn),++G,e=TO("u"),(!e||e==="\\"||!vS(e.charCodeAt(0)))&&Ze({},Nn,Kn),t+=e);return t}function AEe(){var e,t;for(e=G++;G<Ar;){if(t=me.charCodeAt(G),t===92)return G=e,oj();if(vS(t))++G;else break}return me.slice(e,G)}function _Ee(){var e,t,n;return e=G,t=me.charCodeAt(G)===92?oj():AEe(),t.length===1?n=xf:wEe.hasOwnProperty(t)?n=Il:t==="null"?n=SS:t==="true"||t==="false"?n=wS:n=xf,{type:n,value:t,start:e,end:G}}function kO(){var e=G,t=me.charCodeAt(G),n,r=me[G],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++G,{type:bi,value:String.fromCharCode(t),start:e,end:G};default:if(n=me.charCodeAt(G+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return G+=2,{type:bi,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:G};case 33:case 61:return G+=2,me.charCodeAt(G)===61&&++G,{type:bi,value:me.slice(e,G),start:e,end:G}}}if(s=me.substr(G,4),s===">>>=")return G+=4,{type:bi,value:s,start:e,end:G};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return G+=3,{type:bi,value:o,start:e,end:G};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".includes(r)||i==="=>")return G+=2,{type:bi,value:i,start:e,end:G};if(i==="//"&&Ze({},Nn,Kn),"<>=!+-*%&|^/".includes(r))return++G,{type:bi,value:r,start:e,end:G};Ze({},Nn,Kn)}function CEe(e){let t="";for(;G<Ar&&DO(me[G]);)t+=me[G++];return t.length===0&&Ze({},Nn,Kn),Ny(me.charCodeAt(G))&&Ze({},Nn,Kn),{type:Ef,value:parseInt("0x"+t,16),start:e,end:G}}function kEe(e){let t="0"+me[G++];for(;G<Ar&&Fy(me[G]);)t+=me[G++];return(Ny(me.charCodeAt(G))||xu(me.charCodeAt(G)))&&Ze({},Nn,Kn),{type:Ef,value:parseInt(t,8),octal:!0,start:e,end:G}}function XG(){var e,t,n;if(n=me[G],AS(xu(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=G,e="",n!=="."){if(e=me[G++],n=me[G],e==="0"){if(n==="x"||n==="X")return++G,CEe(t);if(Fy(n))return kEe(t);n&&xu(n.charCodeAt(0))&&Ze({},Nn,Kn)}for(;xu(me.charCodeAt(G));)e+=me[G++];n=me[G]}if(n==="."){for(e+=me[G++];xu(me.charCodeAt(G));)e+=me[G++];n=me[G]}if(n==="e"||n==="E")if(e+=me[G++],n=me[G],(n==="+"||n==="-")&&(e+=me[G++]),xu(me.charCodeAt(G)))for(;xu(me.charCodeAt(G));)e+=me[G++];else Ze({},Nn,Kn);return Ny(me.charCodeAt(G))&&Ze({},Nn,Kn),{type:Ef,value:parseFloat(e),start:t,end:G}}function FEe(){var e="",t,n,r,i,o=!1;for(t=me[G],AS(t==="'"||t==='"',"String literal must starts with a quote"),n=G,++G;G<Ar;)if(r=me[G++],r===t){t="";break}else if(r==="\\")if(r=me[G++],!r||!Ty(r.charCodeAt(0)))switch(r){case"u":case"x":me[G]==="{"?(++G,e+=SEe()):e+=TO(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Fy(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),G<Ar&&Fy(me[G])&&(o=!0,i=i*8+"01234567".indexOf(me[G++]),"0123".includes(r)&&G<Ar&&Fy(me[G])&&(i=i*8+"01234567".indexOf(me[G++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&me[G]===`
`&&++G;else{if(Ty(r.charCodeAt(0)))break;e+=r}return t!==""&&Ze({},Nn,Kn),{type:My,value:e,octal:o,start:n,end:G}}function REe(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Ze({},RO)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Ze({},RO)}try{return new RegExp(e,t)}catch{return null}}function TEe(){var e,t,n,r,i;for(e=me[G],AS(e==="/","Regular expression literal must start with a slash"),t=me[G++],n=!1,r=!1;G<Ar;)if(e=me[G++],t+=e,e==="\\")e=me[G++],Ty(e.charCodeAt(0))&&Ze({},CO),t+=e;else if(Ty(e.charCodeAt(0)))Ze({},CO);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Ze({},CO),i=t.substr(1,t.length-2),{value:i,literal:t}}function DEe(){var e,t,n;for(t="",n="";G<Ar&&(e=me[G],!!vS(e.charCodeAt(0)));)++G,e==="\\"&&G<Ar?Ze({},Nn,Kn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Ze({},RO,n),{value:n,literal:t}}function MEe(){var e,t,n,r;return st=null,ij(),e=G,t=TEe(),n=DEe(),r=REe(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:G}}function NEe(e){return e.type===xf||e.type===Il||e.type===wS||e.type===SS}function sj(){if(ij(),G>=Ar)return{type:Dy,start:G,end:G};let e=me.charCodeAt(G);return Ny(e)?_Ee():e===40||e===41||e===59?kO():e===39||e===34?FEe():e===46?xu(me.charCodeAt(G+1))?XG():kO():xu(e)?XG():kO()}function Ei(){let e=st;return G=e.end,st=sj(),G=e.end,e}function aj(){let e=G;st=sj(),G=e}function OEe(e){let t=new ms(rEe);return t.elements=e,t}function KG(e,t,n){let r=new ms(e==="||"||e==="&&"?uEe:iEe);return r.operator=e,r.left=t,r.right=n,r}function IEe(e,t){let n=new ms(oEe);return n.callee=e,n.arguments=t,n}function PEe(e,t,n){let r=new ms(sEe);return r.test=e,r.consequent=t,r.alternate=n,r}function MO(e){let t=new ms(nj);return t.name=e,t}function ky(e){let t=new ms(aEe);return t.value=e.value,t.raw=me.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function QG(e,t,n){let r=new ms(lEe);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function $Ee(e){let t=new ms(cEe);return t.properties=e,t}function JG(e,t,n){let r=new ms(fEe);return r.key=t,r.value=n,r.kind=e,r}function BEe(e,t){let n=new ms(dEe);return n.operator=e,n.argument=t,n.prefix=!0,n}function Ze(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(AS(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=G,n.description=i,n}function _S(e){e.type===Dy&&Ze(e,yEe),e.type===Ef&&Ze(e,pEe),e.type===My&&Ze(e,mEe),e.type===xf&&Ze(e,hEe),e.type===Il&&Ze(e,gEe),Ze(e,Nn,e.value)}function _r(e){let t=Ei();(t.type!==bi||t.value!==e)&&_S(t)}function wt(e){return st.type===bi&&st.value===e}function FO(e){return st.type===Il&&st.value===e}function LEe(){let e=[];for(G=st.start,_r("[");!wt("]");)wt(",")?(Ei(),e.push(null)):(e.push(bf()),wt("]")||_r(","));return Ei(),OEe(e)}function ZG(){G=st.start;let e=Ei();return e.type===My||e.type===Ef?(e.octal&&Ze(e,rj),ky(e)):MO(e.value)}function UEe(){var e,t,n,r;if(G=st.start,e=st,e.type===xf)return n=ZG(),_r(":"),r=bf(),JG("init",n,r);if(e.type===Dy||e.type===bi)_S(e);else return t=ZG(),_r(":"),r=bf(),JG("init",t,r)}function zEe(){var e=[],t,n,r,i={},o=String;for(G=st.start,_r("{");!wt("}");)t=UEe(),t.key.type===nj?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Ze({},xEe):i[r]=!0,e.push(t),wt("}")||_r(",");return _r("}"),$Ee(e)}function HEe(){_r("(");let e=NO();return _r(")"),e}var qEe={if:1};function GEe(){var e,t,n;if(wt("("))return HEe();if(wt("["))return LEe();if(wt("{"))return zEe();if(e=st.type,G=st.start,e===xf||qEe[st.value])n=MO(Ei().value);else if(e===My||e===Ef)st.octal&&Ze(st,rj),n=ky(Ei());else{if(e===Il)throw new Error(Ry);e===wS?(t=Ei(),t.value=t.value==="true",n=ky(t)):e===SS?(t=Ei(),t.value=null,n=ky(t)):wt("/")||wt("/=")?(n=ky(MEe()),aj()):_S(Ei())}return n}function jEe(){let e=[];if(_r("("),!wt(")"))for(;G<Ar&&(e.push(bf()),!wt(")"));)_r(",");return _r(")"),e}function WEe(){G=st.start;let e=Ei();return NEe(e)||_S(e),MO(e.value)}function VEe(){return _r("."),WEe()}function YEe(){_r("[");let e=NO();return _r("]"),e}function XEe(){var e,t,n;for(e=GEe();;)if(wt("."))n=VEe(),e=QG(".",e,n);else if(wt("("))t=jEe(),e=IEe(e,t);else if(wt("["))n=YEe(),e=QG("[",e,n);else break;return e}function ej(){let e=XEe();if(st.type===bi&&(wt("++")||wt("--")))throw new Error(Ry);return e}function ES(){var e,t;if(st.type!==bi&&st.type!==Il)t=ej();else{if(wt("++")||wt("--"))throw new Error(Ry);if(wt("+")||wt("-")||wt("~")||wt("!"))e=Ei(),t=ES(),t=BEe(e.value,t);else{if(FO("delete")||FO("void")||FO("typeof"))throw new Error(Ry);t=ej()}}return t}function tj(e){let t=0;if(e.type!==bi&&e.type!==Il)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function KEe(){var e,t,n,r,i,o,s,a,u,l;if(e=st,u=ES(),r=st,i=tj(r),i===0)return u;for(r.prec=i,Ei(),t=[e,st],s=ES(),o=[u,r,s];(i=tj(st))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=KG(a,u,s),o.push(n);r=Ei(),r.prec=i,o.push(r),t.push(st),n=ES(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=KG(o[l-1].value,o[l-2],n),l-=2;return n}function bf(){var e,t,n;return e=KEe(),wt("?")&&(Ei(),t=bf(),_r(":"),n=bf(),e=PEe(e,t,n)),e}function NO(){let e=bf();if(wt(","))throw new Error(Ry);return e}function uj(e){me=e,G=0,Ar=me.length,st=null,aj();let t=NO();if(st.type!==Dy)throw new Error("Unexpect token after expression.");return t}function OO(e){let t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...OO(e.object)),t.push(...OO(e.property))),t)}function lj(e){return e.object.type==="MemberExpression"?lj(e.object):e.object.name==="datum"}function CS(e){let t=uj(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&lj(r)&&n.add(OO(r).slice(1).join("."))}),n}var da=class e extends ye{clone(){return new e(null,this.model,se(this.filter))}constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=yf(this.model,this.filter,this),this._dependentFields=CS(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}};function cj(e,t){let n={},r=e.config.selection;if(!t||!t.length)return n;let i=0;for(let o of t){let s=ze(o.name),a=o.select,u=V(a)?a:a.type,l=X(a)?se(a):{type:u},c=r[u];for(let p in c)p==="fields"||p==="encodings"||(p==="mark"&&(l.mark={...c.mark,...l.mark}),(l[p]===void 0||l[p]===!0)&&(l[p]=se(c[p]??l[p])));let f=n[s]={...l,name:s,type:u,init:o.value,bind:o.bind,events:V(l.on)?fr(l.on,"scope"):Q(se(l.on))};if(Mn(f)&&(i++,i>1)){delete n[s];continue}let d=se(o);for(let p of Kp)p.defined(f)&&p.parse&&p.parse(e,f,d)}return i>1&&z(xN),n}function dS(e,t,n,r="datum"){let i=V(t)?t:t.param,o=ze(i),s=Y(o+ps),a;try{a=e.getSelectionComponent(o,i)}catch{return`!!${o}`}if(a.project.timeUnit){let d=n??e.component.data.raw,p=a.project.timeUnit.clone();d.parent?p.insertAsParentOf(d):d.parent=p}let u=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",l=a.resolve==="global"?")":`, ${Y(a.resolve)})`,c=`${u}${s}, ${r}${l}`,f=`length(data(${s}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function fS(e,t,n){let r=ze(t),i=n.encoding,o=n.field,s;try{s=e.getSelectionComponent(r,t)}catch{return r}if(!i&&!o)o=s.project.items[0].field,s.project.items.length>1&&z(bN(o));else if(i&&!o){let a=s.project.items.filter(u=>u.channel===i);!a.length||a.length>1?(o=s.project.items[0].field,z(EN(a,i,n,o))):o=a[0].field}return`${s.name}[${Y(sn(o))}]`}function fj(e,t){for(let[n,r]of ci(e.component.selection??{})){let i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new Ht(new da(t,e,{param:n}),i,Xe.Lookup,e.component.data.outputNodeRefCounts)}}function yf(e,t,n){return xp(t,r=>V(r)?r:fH(r)?dS(e,r,n):pw(r))}function QEe(e,t){if(e)return M(e)&&!os(e)?e.map(n=>fy(n,t)).join(", "):e}function IO(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function nm(e,t,n,r={header:!1}){let{disable:i,orient:o,scale:s,labelExpr:a,title:u,zindex:l,...c}=e.combine();if(!i){for(let f in c){let d=f,p=nq[d],m=c[d];if(p&&p!==t&&p!=="both")delete c[d];else if(cu(m)){let{condition:h,...g}=m,y=Q(h),x=UN[d];if(x){let{vgProp:b,part:E}=x,v=[...y.map(S=>{let{test:w,..._}=S;return{test:yf(null,w),..._}}),g];IO(c,E,b,v),delete c[d]}else if(x===null){let b={signal:y.map(E=>{let{test:v,...S}=E;return`${yf(null,v)} ? ${pN(S)} : `}).join("")+pN(g)};c[d]=b}}else if(re(m)){let h=UN[d];if(h){let{vgProp:g,part:y}=h;IO(c,y,g,m),delete c[d]}}ge(["labelAlign","labelBaseline"],d)&&c[d]===null&&delete c[d]}if(t==="grid"){if(!c.grid)return;if(c.encode){let{grid:f}=c.encode;c.encode={...f?{grid:f}:{}},Me(c.encode)&&delete c.encode}return{scale:s,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Be(l,0)}}else{if(!r.header&&e.mainExtracted)return;if(a!==void 0){let d=a;c.encode?.labels?.update&&re(c.encode.labels.update.text)&&(d=es(a,"datum.label",c.encode.labels.update.text.signal)),IO(c,"labels","text",{signal:d})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(let d of Ow)e.hasAxisPart(d)||delete c.encode[d];Me(c.encode)&&delete c.encode}let f=QEe(u,n);return{scale:s,orient:o,grid:!1,...f?{title:f}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:Be(l,0)}}}}function kS(e){let{axes:t}=e.component,n=[];for(let r of Vn)if(t[r]){for(let i of t[r])if(!i.get("disable")&&!i.get("gridScale")){let o=r==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function dj(e,t){let{x:n=[],y:r=[]}=e;return[...n.map(i=>nm(i,"grid",t)),...r.map(i=>nm(i,"grid",t)),...n.map(i=>nm(i,"main",t)),...r.map(i=>nm(i,"main",t))].filter(i=>i)}function pj(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){let o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...P(s),...P(a)]),l={};for(let c of u.values())l[c]={signal:`${r.signal} === "${o}" ? ${jr(s[c])} : ${jr(a[c])}`};return l}return t[i]})])}function mj(e,t,n,r){let i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:FN(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=re(n)?"axisOrient":`axis${wl(n)}`,a=[...i,...i.map(l=>o+l.substr(4))],u=["axis",s,o];return{vlOnlyAxisConfig:pj(a,r,e,n),vgAxisConfig:pj(u,r,e,n),axisConfigStyle:JEe([...u,...a],r)}}function JEe(e,t){let n=[{}];for(let r of e){let i=t[r]?.style;if(i){i=Q(i);for(let o of i)n.push(t.style[o])}}return Object.assign.apply(null,n)}function Oy(e,t,n,r={}){let i=hN(e,n,t);if(i!==void 0)return{configFrom:"style",configValue:i};for(let o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(r[o]?.[e]!==void 0)return{configFrom:o,configValue:r[o][e]};return{}}var $O={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??ZEe(n,e),gridScale:({model:e,channel:t})=>eve(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||LO(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||BO(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??tve(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??nve(t.type,n,W(t)&&!!t.timeUnit,W(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{let o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return n.tickCount??rve({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},tickMinStep:ive,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;let r=UO(t,n);if(r!==void 0)return r;let i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return gN(i?[IN(i)]:[],W(s)?[IN(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>ove(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??sve(n,t)};function ZEe(e,t){return!ot(e)&&W(t)&&!Ie(t?.bin)&&!mt(t?.bin)}function eve(e,t){let n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function hj(e,t,n,r,i){let o=t?.labelAngle;if(o!==void 0)return re(o)?o:Sl(o);{let{configValue:s}=Oy("labelAngle",r,t?.style,i);return s!==void 0?Sl(s):n===Ve&&ge([ny,ty],e.type)&&!(W(e)&&e.timeUnit)?270:void 0}}function PO(e){return`(((${e.signal} % 360) + 360) % 360)`}function BO(e,t,n,r){if(e!==void 0)if(n==="x"){if(re(e)){let i=PO(e),o=re(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(re(t)){let i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(re(e)){let i=PO(e),o=re(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(re(t)){let i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function LO(e,t,n){if(e===void 0)return;let r=n==="x",i=r?0:90,o=r?"bottom":"left";if(re(e)){let s=PO(e),a=re(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${s} + 90)`:s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(re(t)){let s=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function tve(e,t){if(t==="x"&&ge(["quantitative","temporal"],e))return!0}function nve(e,t,n,r){if(n&&!X(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function gj(e){return e==="x"?"bottom":"left"}function rve({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){if(!r&&!ot(t)&&t!=="log"){if(W(e)){if(Ie(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ge(["month","hours","day","quarter"],ht(e.timeUnit)?.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function ive({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(W(t)){let{timeUnit:n}=t;if(n){let r=ow(n);if(r)return{signal:r}}}}function UO(e,t){let n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;if(o&&s)return yN(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function ove(e,t){let n=e.values;if(M(n))return Nw(t,n);if(re(n))return n}function sve(e,t){return e==="rect"&&ly(t)?1:0}var vf=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=CS(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(Eo(r)&&Cw(r.sort)){let{field:o,timeUnit:s}=r,a=r.sort,u=a.map((l,c)=>`${pw({field:o,timeUnit:s,equal:l})} ? ${c} : `).join("")+a.length;t=new e(t,{calculate:u,as:pa(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${fe(this.transform)}`}};function pa(e,t,n){return K(e,{prefix:t,suffix:"sort_index",...n})}function rm(e,t){return ge(["top","bottom"],t)?"column":ge(["left","right"],t)||e==="row"?"row":"column"}function bu(e,t,n,r){let i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Be((t||{})[e],i[e],n.header[e])}function Iy(e,t,n,r){let i={};for(let o of e){let s=bu(o,t||{},n,r);s!==void 0&&(i[o]=s)}return i}var im=["row","column"],om=["header","footer"];function yj(e,t){let n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=Iy(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=rm(t,a),l=Sl(s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...bj(l,u),...xj(u,l,o),...wj(r,i,t,Eq,QN)}}}function xj(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}let r=LO(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function bj(e,t){let n=BO(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Ej(e,t){let n=e.component.layoutHeaders[t],r=[];for(let i of om)if(n[i])for(let o of n[i]){let s=uve(e,t,i,n,o);s!=null&&r.push(s)}return r}function ave(e,t){let{sort:n}=e;return br(n)?{field:K(n,{expr:"datum"}),order:n.order??"ascending"}:M(n)?{field:pa(e,t,{expr:"datum"}),order:"ascending"}:{field:K(e,{expr:"datum"}),order:n??"ascending"}}function FS(e,t,n){let{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=Iy(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=Bp({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=rm(t,a);return{text:{signal:u?es(es(u,"datum.label",l),"datum.value",K(e,{expr:"parent"})):l},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...bj(o,c),...xj(c,o,s),...wj(n,e,t,vq,JN)}}function uve(e,t,n,r,i){if(i){let o=null,{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){let{labelOrient:f}=Iy(["labelOrient"],s.header,a,t);(t==="row"&&!ge(["top","bottom"],f)||t==="column"&&!ge(["left","right"],f))&&(o=FS(s,t,a))}let u=Yt(e)&&!sa(e.facet),l=i.axes,c=l?.length>0;if(o||c){let f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:ave(s,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}var lve={column:{start:0,end:1},row:{start:1,end:0}};function cve(e,t){return lve[t][e]}function vj(e,t){let n={};for(let r of Fn){let i=e[r];if(i?.facetFieldDef){let{titleAnchor:o,titleOrient:s}=Iy(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=rm(r,s),u=cve(o,a);u!==void 0&&(n[a]=u)}}return Me(n)?void 0:n}function wj(e,t,n,r,i){let o={};for(let s of r){if(!i[s])continue;let a=bu(s,t?.header,e,n);a!==void 0&&(o[i[s]]=a)}return o}function sm(e){return[...RS(e,"width"),...RS(e,"height"),...RS(e,"childWidth"),...RS(e,"childHeight")]}function RS(e,t){let n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];let i=e.getSizeSignalRef(t).signal;if(r==="step"){let o=e.getScaleComponent(n);if(o){let s=o.get("type"),a=o.get("range");if(ot(s)&&hi(a)){let u=e.scaleName(n);return Yt(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[Sj(u,a)]:[Sj(u,a),{name:i,update:zO(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){let o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=xy(e.config.view,o?"width":"height"),u=`isFinite(${s}) ? ${s} : ${a}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function Sj(e,t){let n=`${e}_step`;return re(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function zO(e,t,n){let r=t.get("type"),i=t.get("padding"),o=Be(t.get("paddingOuter"),i),s=t.get("paddingInner");return s=r==="band"?s!==void 0?s:i:1,`bandspace(${n}, ${jr(s)}, ${jr(o)}) * ${e}_step`}function TS(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function DS(e,t){return P(e).reduce((n,r)=>({...n,...Ao({model:t,channelDef:e[r],vgChannel:r,mainRefFn:i=>Pe(i.value),invalidValueRef:void 0})}),{})}function MS(e,t){if(Yt(t))return e==="theta"?"independent":"shared";if(So(t))return"shared";if(um(t))return Ye(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function am(e,t){let n=e.scale[t],r=Ye(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&z($.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}var fve={...eO,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},HO=P(fve),NS=class extends Er{};var qO={symbols:dve,gradient:pve,labels:mve,entries:hve};function dve(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){if(o!=="symbol")return;let{markDef:s,encoding:a,config:u,mark:l}=n,c=s.filled&&l!=="trail",f={...Xz({},n,MH),...Zp(n,{filled:c})},d=i.get("symbolOpacity")??u.legend.symbolOpacity,p=i.get("symbolFillColor")??u.legend.symbolFillColor,m=i.get("symbolStrokeColor")??u.legend.symbolStrokeColor,h=d===void 0?Aj(a.opacity)??s.opacity:void 0;if(f.fill){if(r==="fill"||c&&r===zt)delete f.fill;else if(j(f.fill,"field"))p?delete f.fill:(f.fill=Pe(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=Pe(h??1));else if(M(f.fill)){let g=OS(a.fill??a.color)??s.fill??(c&&s.color);g&&(f.fill=Pe(g))}}if(f.stroke){if(r==="stroke"||!c&&r===zt)delete f.stroke;else if(j(f.stroke,"field")||m)delete f.stroke;else if(M(f.stroke)){let g=Be(OS(a.stroke||a.color),s.stroke,c?s.color:void 0);g&&(f.stroke={value:g})}}if(r!==Gr){let g=W(t)&&Cj(n,i,t);g?f.opacity=[{test:g,...Pe(h??1)},Pe(u.legend.unselectedOpacity)]:h&&(f.opacity=Pe(h))}return f={...f,...e},Me(f)?void 0:f}function pve(e,{model:t,legendType:n,legendCmpt:r}){if(n!=="gradient")return;let{config:i,markDef:o,encoding:s}=t,a={},l=(r.get("gradientOpacity")??i.legend.gradientOpacity)===void 0?Aj(s.opacity)||o.opacity:void 0;return l&&(a.opacity=Pe(l)),a={...a,...e},Me(a)?void 0:a}function mve(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){let o=n.legend(r)||{},s=n.config,a=W(t)?Cj(n,i,t):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f;oa(c)?f=zi({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:s}):l===void 0&&c===void 0&&s.customFormatTypes&&(t.type==="quantitative"&&s.numberFormatType?f=zi({fieldOrDatumDef:t,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):t.type==="temporal"&&s.timeFormatType&&W(t)&&t.timeUnit===void 0&&(f=zi({fieldOrDatumDef:t,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));let d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return Me(d)?void 0:d}function hve(e,{legendCmpt:t}){return t.get("selections")?.length?{...e,fill:{value:"transparent"}}:e}function Aj(e){return _j(e,(t,n)=>Math.max(t,n.value))}function OS(e){return _j(e,(t,n)=>Be(t,n.value))}function _j(e,t){if(XH(e))return Q(e.condition).reduce(t,e.value);if(un(e))return e.value}function Cj(e,t,n){let r=t.get("selections");if(!r?.length)return;let i=Y(n.field);return r.map(o=>`(!length(data(${Y(ze(o)+ps)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}var GO={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{let{format:r,formatType:i}=t;return Aw(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{let{formatType:r}=e;return _w(r,t,n)},gradientLength:e=>{let{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??Eve(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??vve(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??yve(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>ua(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(nu(n)&&bo(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>gve(t,e)};function gve(e,t){let n=e.values;if(M(n))return Nw(t,n);if(re(n))return n}function yve(e,t,n,r){if(t!=="shape"){let i=OS(n)??r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function Fj(e){let{legend:t}=e;return Be(t.type,xve(e))}function xve({channel:e,timeUnit:t,scaleType:n}){if(nu(e)){if(ge(["quarter","month","day"],t))return"symbol";if(bo(n))return"gradient"}return"symbol"}function Rj({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??bve(n,t)}function bve(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Eve({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){let{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(bo(i))return n==="horizontal"?r==="top"||r==="bottom"?kj(t,"width",s,o):s:kj(t,"height",u,a)}function kj(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function vve(e){if(ge(["quantile","threshold","log","symlog"],e))return"greedy"}function jO(e){let t=qe(e)?wve(e):Cve(e);return e.component.legends=t,t}function wve(e){let{encoding:t}=e,n={};for(let r of[zt,...jw]){let i=tt(t[r]);!i||!e.getScaleComponent(r)||r===Tt&&W(i)&&i.type===ls||(n[r]=_ve(e,r))}return n}function Sve(e,t){let n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function Ave(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!n?.values;case"title":if(t==="title"&&e===r?.title)return!0}return e===(n||{})[t]}function _ve(e,t){let n=e.legend(t),{markDef:r,encoding:i,config:o}=e,s=o.legend,a=new NS({},Sve(e,t));UG(e,t,a);let u=n!==void 0?!n:s.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};let l=e.getScaleComponent(t).get("type"),c=tt(i[t]),f=W(c)?ht(c.timeUnit)?.unit:void 0,d=n.orient||o.legend.orient||"right",p=Fj({legend:n,channel:t,timeUnit:f,scaleType:l}),m=Rj({legend:n,legendType:p,orient:d,legendConfig:s}),h={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:s,config:o,scaleType:l,orient:d,legendType:p,direction:m};for(let E of HO){if(p==="gradient"&&E.startsWith("symbol")||p==="symbol"&&E.startsWith("gradient"))continue;let v=E in GO?GO[E](h):n[E];if(v!==void 0){let S=Ave(v,E,n,e.fieldDef(t));(S||o.legend[E]===void 0)&&a.set(E,v,S)}}let g=n?.encoding??{},y=a.get("selections"),x={},b={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:p};for(let E of["labels","legend","title","symbols","gradient","entries"]){let v=DS(g[E]??{},e),S=E in qO?qO[E](v,b):v;S!==void 0&&!Me(S)&&(x[E]={...y?.length&&W(c)?{name:`${ze(c.field)}_legend_${E}`}:{},...y?.length?{interactive:!!y}:{},update:S})}return Me(x)||a.set("encode",x,!!n?.encoding),a}function Cve(e){let{legends:t,resolve:n}=e.component;for(let r of e.children){jO(r);for(let i of P(r.component.legends))n.legend[i]=am(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=WO(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(let r of P(t))for(let i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function WO(e,t){if(!e)return t.clone();let n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(let o of HO){let s=xi(e.getWithExplicit(o),t.getWithExplicit(o),o,"legend",(a,u)=>{switch(o){case"symbolType":return kve(a,u);case"title":return rw(a,u);case"type":return i=!0,vr("symbol")}return Yp(a,u,o,"legend")});e.setWithExplicit(o,s)}return i&&(e.implicit?.encode?.gradient&&J0(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&J0(e.explicit,["encode","gradient"])),e}function kve(e,t){return t.value==="circle"?t:e}function Fve(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function IS(e){let t=e.component.legends,n={};for(let i of P(t)){let o=e.getScaleComponent(i),s=He(o.get("domains"));if(n[s])for(let a of n[s])WO(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return dt(n).flat().map(i=>Rve(i,e.config)).filter(i=>i!==void 0)}function Rve(e,t){let{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(!n){if(t.aria===!1&&o.aria==null&&(o.aria=!1),o.encode?.symbols){let s=o.encode.symbols.update;s.fill&&s.fill.value!=="transparent"&&!s.stroke&&!o.stroke&&(s.stroke={value:"transparent"});for(let a of jw)o[a]&&delete s[a]}if(o.title||delete o.title,r!==void 0){let s=r;o.encode?.labels?.update&&re(o.encode.labels.update.text)&&(s=es(r,"datum.label",o.encode.labels.update.text.signal)),Fve(o,"labels","text",{signal:s})}return o}}function Tj(e){return So(e)||um(e)?Tve(e):Dj(e)}function Tve(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),Dj(e))}function Dj(e){let t=e.component.projection;if(!t||t.merged)return[];let n=t.combine(),{name:r}=n;if(t.data){let i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{let u=re(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return ge(s,u)||s.push(u),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}else return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}var Mj=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];var Py=class extends Er{constructor(t,n,r,i){super({...n},{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}};function VO(e){e.component.projection=qe(e)?Dve(e):Ove(e)}function Dve(e){if(e.hasProjection){let t=kt(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?Mve(e):void 0,o=new Py(e.projectionName(!0),{...kt(e.config.projection),...t},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}}function Mve(e){let t=[],{encoding:n}=e;for(let r of[[jn,Gn],[Wn,mr]])(tt(n[r[0]])||tt(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Tt)&&e.typedFieldDef(Tt).type===ls&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Xe.Main)),t}function Nve(e,t){let n=Uv(Mj,i=>!!(!ee(e.explicit,i)&&!ee(t.explicit,i)||ee(e.explicit,i)&&ee(t.explicit,i)&&kn(e.get(i),t.get(i))));if(kn(e.size,t.size)){if(n)return e;if(kn(e.explicit,{}))return t;if(kn(t.explicit,{}))return e}return null}function Ove(e){if(e.children.length===0)return;let t;for(let r of e.children)VO(r);let n=Uv(e.children,r=>{let i=r.component.projection;if(i)if(t){let o=Nve(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){let r=e.projectionName(!0),i=new Py(r,t.specifiedProjection,t.size,se(t.data));for(let o of e.children){let s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}function Ive(e,t,n,r){if(ia(t,n)){let i=qe(e)?e.axis(n)??e.legend(n)??{}:{},o=K(t,{expr:"datum"}),s=K(t,{expr:"datum",binSuffix:"end"});return{formulaAs:K(t,{binSuffix:"range",forAs:!0}),formula:pf(o,s,i.format,i.formatType,r)}}return{}}function Oj(e,t){return`${Qv(e)}_${t}`}function Pve(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function lm(e,t,n){let r=Rp(n,void 0)??{},i=Oj(r,t);return e.getName(`${i}_bins`)}function $ve(e){return"as"in e}function Nj(e,t,n){let r,i;$ve(e)?r=V(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[K(e,{forAs:!0}),K(e,{binSuffix:"end",forAs:!0})];let o={...Rp(t,void 0)},s=Oj(o,e.field),{signal:a,extentSignal:u}=Pve(n,s);if(Fp(o.extent)){let c=o.extent;i=fS(n,c.param,c),delete o.extent}let l={bin:o,field:e.field,as:[r],...a?{signal:a}:{},...u?{extentSignal:u}:{},...i?{span:i}:{}};return{key:s,binComponent:l}}var hs=class e extends ye{clone(){return new e(null,se(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){let r=n.reduceFieldDef((i,o,s)=>{if(Mt(o)&&Ie(o.bin)){let{key:a,binComponent:u}=Nj(o,o.bin,n);i[a]={...u,...i[a],...Ive(n,o,s,n.config)}}return i},{});return Me(r)?null:new e(t,r)}static makeFromTransform(t,n,r){let{key:i,binComponent:o}=Nj(n,n.bin,r);return new e(t,{[i]:o})}merge(t,n){for(let r of P(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=dr([...this.bins[r].as,...t.bins[r].as],fe)):this.bins[r]=t.bins[r];for(let r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(dt(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(dt(this.bins).map(t=>t.field))}hash(){return`Bin ${fe(this.bins)}`}assemble(){return dt(this.bins).flatMap(t=>{let n=[],[r,...i]=t.as,{extent:o,...s}=t.bin,a={type:"bin",field:sn(t.field),as:r,signal:t.signal,...Fp(o)?{extent:null}:{extent:o},...t.span?{span:{signal:`span(${t.span})`}}:{},...s};!o&&t.extentSignal&&(n.push({type:"extent",field:sn(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(let u of i)for(let l=0;l<2;l++)n.push({type:"formula",expr:K({field:r[l]},{expr:"datum"}),as:u[l]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}};function Bve(e,t,n,r){let i=qe(r)?r.encoding[Rn(t)]:void 0;if(Mt(n)&&qe(r)&&Tw(n,i,r.markDef,r.config)){e.add(K(n,{})),e.add(K(n,{suffix:"end"}));let{mark:o,markDef:s,config:a}=r,u=gi({fieldDef:n,markDef:s,config:a});ou(o)&&u!==.5&&Ye(t)&&(e.add(K(n,{suffix:hf})),e.add(K(n,{suffix:gf}))),n.bin&&ia(n,t)&&e.add(K(n,{binSuffix:"range"}))}else if(jv(t)){let o=Gv(t);e.add(r.getName(o))}else e.add(K(n));return Eo(n)&&wH(n.scale?.range)&&e.add(n.scale.range.field),e}function Lve(e,t){for(let n of P(t)){let r=t[n];for(let i of P(r))n in e?e[n][i]=new Set([...e[n][i]??[],...r[i]]):e[n]={[i]:r[i]}}}var qi=class e extends ye{clone(){return new e(null,new Set(this.dimensions),se(this.measures))}constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});let i={},o=new Set;return!r||(n.forEachFieldDef((s,a)=>{let{aggregate:u,field:l}=s;if(u)if(u==="count")i["*"]??(i["*"]={}),i["*"].count=new Set([K(s,{forAs:!0})]);else{if(Ui(u)||go(u)){let c=Ui(u)?"argmin":"argmax",f=u[c];i[f]??(i[f]={}),i[f][c]=new Set([K({op:c,field:f},{forAs:!0})])}else i[l]??(i[l]={}),i[l][u]=new Set([K(s,{forAs:!0})]);an(a)&&n.scaleDomain(a)==="unaggregated"&&(i[l]??(i[l]={}),i[l].min=new Set([K({field:l,aggregate:"min"},{forAs:!0})]),i[l].max=new Set([K({field:l,aggregate:"max"},{forAs:!0})]))}else Bve(o,a,s,n)}),o.size+P(i).length===0)?null:new e(t,o,i)}static makeFromTransform(t,n){var r;let i=new Set,o={};for(let s of n.aggregate){let{op:a,field:u,as:l}=s;a&&(a==="count"?(o["*"]??(o["*"]={}),o["*"].count=new Set([l||K(s,{forAs:!0})])):(o[u]??(o[u]={}),(r=o[u])[a]??(r[a]=new Set),o[u][a].add(l||K(s,{forAs:!0}))))}for(let s of n.groupby??[])i.add(s);return i.size+P(o).length===0?null:new e(t,i,o)}merge(t){return eN(this.dimensions,t.dimensions)?(Lve(this.measures,t.measures),!0):(Zz("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...P(this.measures)])}producedFields(){let t=new Set;for(let n of P(this.measures))for(let r of P(this.measures[n])){let i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${fe({dimensions:this.dimensions,measures:this.measures})}`}assemble(){let t=[],n=[],r=[];for(let o of P(this.measures))for(let s of P(this.measures[o]))for(let a of this.measures[o][s])r.push(a),t.push(s),n.push(o==="*"?null:sn(o));return{type:"aggregate",groupby:[...this.dimensions].map(sn),ops:t,fields:n,as:r}}};var Co=class extends ye{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(let o of Fn){let s=n.facet[o];if(s){let{bin:a,sort:u}=s;this[o]={name:n.getName(`${o}_domain`),fields:[K(s),...Ie(a)?[K(s,{binSuffix:"end"})]:[]],...br(u)?{sortField:u}:M(u)?{sortIndexField:pa(s,o)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(let n of Fn)this[n]&&(t+=` ${n.charAt(0)}:${fe(this[n])}`);return t}get fields(){let t=[];for(let n of Fn)this[n]?.fields&&t.push(...this[n].fields);return t}dependentFields(){let t=new Set(this.fields);for(let n of Fn)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){let t={};for(let n of Vn){let r=this.childModel.component.scales[n];if(r&&!r.merged){let i=r.get("type"),o=r.get("range");if(ot(i)&&hi(o)){let s=Pl(this.childModel,n),a=cm(s);a?t[n]=a:z($.unknownField(n))}}}return t}assembleRowColumnHeaderData(t,n,r){let i={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));let{sortField:u,sortIndexField:l}=this[t];if(u){let{op:c=Fl,field:f}=u;o.push(f),s.push(c),a.push(K(u,{forAs:!0}))}else l&&(o.push(l),s.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...o.length?{fields:o,ops:s,as:a}:{}}]}}assembleFacetHeaderData(t){let{columns:n}=this.model.layout,{layoutHeaders:r}=this.model.component,i=[],o={};for(let u of im){for(let l of om){let c=(r[u]&&r[u][l])??[];for(let f of c)if(f.axes?.length>0){o[u]=!0;break}}if(o[u]){let l=`length(data("${this.facet.name}"))`,c=u==="row"?n?{signal:`ceil(${l} / ${n})`}:1:n?{signal:`min(${l}, ${n})`}:{signal:l};i.push({name:`${this.facet.name}_${u}`,transform:[{type:"sequence",start:0,stop:c}]})}}let{row:s,column:a}=o;return(s||a)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,t)),i}assemble(){let t=[],n=null,r=this.getChildIndependentFieldsWithStep(),{column:i,row:o,facet:s}=this;if(i&&o&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;let a=[].concat(r.x??[],r.y??[]),u=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:u}]})}for(let a of[di,fi])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,r));if(s){let a=this.assembleFacetHeaderData(r);a&&t.push(...a)}return t}};function Ij(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function Uve(e,t){let n=Z0(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){let r=Ij(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){let r=Ij(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return z($.unrecognizedParse(t)),null}function Pj(e){let t={};return Q0(e.filter,n=>{if(CN(n)){let r=null;sw(n)?r=Tn(n.equal):uw(n)?r=Tn(n.lte):aw(n)?r=Tn(n.lt):lw(n)?r=Tn(n.gt):cw(n)?r=Tn(n.gte):fw(n)?r=n.range[0]:dw(n)&&(r=(n.oneOf??n.in)[0]),r&&(yo(r)?t[n.field]="date":ke(r)?t[n.field]="number":V(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function $j(e){let t={};function n(r){uu(r)?t[r.field]="date":r.type==="quantitative"&&Uz(r.aggregate)?t[r.field]="number":tf(r.field)>1?r.field in t||(t[r.field]="flatten"):Eo(r)&&br(r.sort)&&tf(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((qe(e)||Yt(e))&&e.forEachFieldDef((r,i)=>{if(Mt(r))n(r);else{let o=Li(i),s=e.fieldDef(o);n({...r,type:s.type})}}),qe(e)){let{mark:r,markDef:i,encoding:o}=e;if(yr(r)&&!e.encoding.order){let s=i.orient==="horizontal"?"y":"x",a=o[s];W(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function Bj(e){let t={};if(qe(e)&&e.component.selection)for(let n of P(e.component.selection)){let r=e.component.selection[n];for(let i of r.project.items)!i.channel&&tf(i.field)>1&&(t[i.field]="flatten")}return t}var On=class e extends ye{clone(){return new e(null,se(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${fe(this._parse)}`}static makeExplicit(t,n,r){let i={},o=n.data;return!fs(o)&&o?.format?.parse&&(i=o.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(let a of P(r)){let u=i.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===r[a]||u.value==="derived"||r[a]==="flatten"?delete r[a]:z($.differentParse(a,r[a],u.value)))}for(let a of P(n)){let u=i.get(a);u!==void 0&&(u===n[a]?delete n[a]:z($.differentParse(a,n[a],u)))}let o=new Er(n,r);i.copyAll(o);let s={};for(let a of P(o.combine())){let u=o.get(a);u!==null&&(s[a]=u)}return P(s).length===0||i.parseNothing?null:new e(t,s)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){let t={};for(let n of P(this._parse)){let r=this._parse[n];tf(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(P(this._parse))}dependentFields(){return new Set(P(this._parse))}assembleTransforms(t=!1){return P(this._parse).filter(n=>t?tf(n)>1:!0).map(n=>{let r=Uve(n,this._parse[n]);return r?{type:"formula",expr:r,as:eu(n)}:null}).filter(n=>n!==null)}};var gs=class e extends ye{clone(){return new e(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Xn])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Xn}}};var $l=class e extends ye{clone(){return new e(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${fe(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}};var Bl=class e extends ye{clone(){return new e(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${fe(this.params)}`}assemble(){return{type:"sequence",...this.params}}};var vi=class extends ye{constructor(t){super(null),t??(t={name:"source"});let n;if(fs(t)||(n=t.format?{...Ut(t.format,["parse"])}:{}),mf(t))this._data={values:t.values};else if(pu(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];ge(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else fO(t)?this._data={values:[{type:"Sphere"}]}:(aS(t)||fs(t))&&(this._data={});this._generator=fs(t),t.name&&(this._name=t.name),n&&!Me(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}};var Lj=function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},zve=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},$y;function PS(e){return e instanceof vi||e instanceof $l||e instanceof Bl}var fm=class{constructor(){$y.set(this,void 0),Lj(this,$y,!1,"f")}setModified(){Lj(this,$y,!0,"f")}get modifiedFlag(){return zve(this,$y,"f")}};$y=new WeakMap;var ma=class extends fm{getNodeDepths(t,n,r){r.set(t,n);for(let i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){let r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(let i of r)this.run(i[0]);return this.modifiedFlag}},dm=class extends fm{optimize(t){this.run(t);for(let n of t.children)this.optimize(n);return this.modifiedFlag}};var $S=class extends dm{mergeNodes(t,n){let r=n.shift();for(let i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){let n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(let i of P(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}},BS=class extends dm{constructor(t){super(),this.requiresSelectionId=t&&Cy(t)}run(t){t instanceof gs&&(this.requiresSelectionId&&(PS(t.parent)||t.parent instanceof qi||t.parent instanceof On)||(this.setModified(),t.remove()))}},LS=class extends fm{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof wo&&(r=t.producedFields(),zv(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(let i of t.children)this.run(i,new Set([...n,...r]))}},US=class extends dm{constructor(){super()}run(t){t instanceof Ht&&!t.isRequired()&&(this.setModified(),t.remove())}},zS=class extends ma{run(t){if(!PS(t)&&!(t.numChildren()>1)){for(let n of t.children)if(n instanceof On)if(t instanceof On)this.setModified(),t.merge(n);else{if(Hv(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}},HS=class extends ma{run(t){let n=[...t.children],r=t.children.filter(i=>i instanceof On);if(t.numChildren()>1&&r.length>=1){let i={},o=new Set;for(let s of r){let a=s.parse;for(let u of P(a))u in i?i[u]!==a[u]&&o.add(u):i[u]=a[u]}for(let s of o)delete i[s];if(!Me(i)){this.setModified();let s=new On(t,i);for(let a of n){if(a instanceof On)for(let u of P(i))delete a.parse[u];t.removeChild(a),a.parent=s,a instanceof On&&P(a.parse).length===0&&a.remove()}}}}},qS=class extends ma{run(t){t instanceof Ht||t.numChildren()>0||t instanceof Co||t instanceof vi||(this.setModified(),t.remove())}},GS=class extends ma{run(t){let n=t.children.filter(i=>i instanceof wo),r=n.pop();for(let i of n)this.setModified(),r.merge(i)}},jS=class extends ma{run(t){let n=t.children.filter(i=>i instanceof qi),r={};for(let i of n){let o=fe(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(let i of P(r)){let o=r[i];if(o.length>1){let s=o.pop();for(let a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}},WS=class extends ma{constructor(t){super(),this.model=t}run(t){let n=!(PS(t)||t instanceof da||t instanceof On||t instanceof gs),r=[],i=[];for(let o of t.children)o instanceof hs&&(n&&!Hv(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){let o=r.pop();for(let s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof hs?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){let o=i.pop();for(let s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}},VS=class extends ma{run(t){let n=[...t.children];if(!vl(n,s=>s instanceof Ht)||t.numChildren()<=1)return;let i=[],o;for(let s of n)if(s instanceof Ht){let a=s;for(;a.numChildren()===1;){let[u]=a.children;if(u instanceof Ht)a=u;else break}i.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else i.push(s);if(i.length){this.setModified();for(let s of i)s.parent.removeChild(s),s.parent=o}}};var ys=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=dr(this.transform.groupby.concat(t),n=>n)}dependentFields(){let t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??K(t)}hash(){return`JoinAggregateTransform ${fe(this.transform)}`}assemble(){let t=[],n=[],r=[];for(let o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);let i=this.transform.groupby;return{type:"joinaggregate",as:r,ops:n,fields:t,...i!==void 0?{groupby:i}:{}}}};var wf=class e extends ye{clone(){return new e(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,r){let{config:i,markDef:o}=n,{marks:s,scales:a}=r;if(s==="include-invalid-values"&&a==="include-invalid-values")return null;let u=n.reduceFieldDef((l,c,f)=>{let d=an(f)&&n.getScaleComponent(f);if(d){let p=d.get("type"),{aggregate:m}=c,h=Ip({scaleChannel:f,markDef:o,config:i,scaleType:p,isCountAggregate:Cl(m)});h!=="show"&&h!=="always-valid"&&(l[c.field]=c)}return l},{});return P(u).length?new e(t,u):null}dependentFields(){return new Set(P(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${fe(this.filter)}`}assemble(){let t=P(this.filter).reduce((n,r)=>{let i=this.filter[r],o=K(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (${YS(o)}))`):i.type==="quantitative"&&n.push(YS(o))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}};function YS(e){return`isValid(${e}) && isFinite(+${e})`}function qve(e){return e.stack.stackBy.reduce((t,n)=>{let r=n.fieldDef,i=K(r);return i&&t.push(i),t},[])}function Gve(e){return M(e)&&e.every(t=>V(t))&&e.length>1}var ha=class e extends ye{clone(){return new e(null,se(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){let{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(let f of n.sort)a.push(f.field),u.push(Be(f.order,"ascending"));let l={field:a,order:u},c;return Gve(o)?c=o:V(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new e(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:s,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){let r=n.stack,{encoding:i}=n;if(!r)return null;let{groupbyChannels:o,fieldChannel:s,offset:a,impute:u}=r,l=o.map(p=>{let m=i[p];return hn(m)}).filter(p=>!!p),c=qve(n),f=n.encoding.order,d;if(M(f)||W(f))d=nw(f);else{let p=Dw(f)?f.sort:s==="y"?"descending":"ascending";d=c.reduce((m,h)=>(m.field.includes(h)||(m.field.push(h),m.order.push(p)),m),{field:[],order:[]})}return new e(t,{dimensionFieldDefs:l,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){let t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${fe(this._stack)}`}getGroupbyFields(){let{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[K(i,{binSuffix:"mid"})]:[K(i,{}),K(i,{binSuffix:"end"})]:[K(i)]).flat():r??[]}assemble(){let t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:o,sort:s,offset:a,impute:u,as:l}=this._stack;if(u)for(let c of r){let{bandPosition:f=.5,bin:d}=c;if(d){let p=K(c,{expr:"datum"}),m=K(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${YS(p)} ? ${f}*${p}+${1-f}*${m} : ${p}`,as:K(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...o,...n],key:K(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:l,offset:a}),t}};var Eu=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=dr(this.transform.groupby.concat(t),n=>n)}dependentFields(){let t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??K(t)}hash(){return`WindowTransform ${fe(this.transform)}`}assemble(){let t=[],n=[],r=[],i=[];for(let f of this.transform.window)n.push(f.op),r.push(this.getDefaultName(f)),i.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);let o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&n.every(f=>kp(f)))return{type:"joinaggregate",as:r,ops:n,fields:t,...s!==void 0?{groupby:s}:{}};let a=[],u=[];if(this.transform.sort!==void 0)for(let f of this.transform.sort)a.push(f.field),u.push(f.order??"ascending");let l={field:a,order:u},c=this.transform.ignorePeers;return{type:"window",params:i,as:r,ops:n,fields:t,sort:l,...c!==void 0?{ignorePeers:c}:{},...s!==void 0?{groupby:s}:{},...o!==void 0?{frame:o}:{}}}};function jve(e){function t(n){if(!(n instanceof Co)){let r=n.clone();if(r instanceof Ht){let i=By+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof qi||r instanceof ha||r instanceof Eu||r instanceof ys)&&r.addDimensions(e.fields);for(let i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function XS(e){if(e instanceof Co)if(e.numChildren()===1&&!(e.children[0]instanceof Ht)){let t=e.children[0];(t instanceof qi||t instanceof ha||t instanceof Eu||t instanceof ys)&&t.addDimensions(e.fields),t.swapWithParent(),XS(e)}else{let t=e.model.component.data.main;Uj(t);let n=jve(e),r=e.children.map(n).flat();for(let i of r)i.parent=t}else e.children.map(XS)}function Uj(e){if(e instanceof Ht&&e.type===Xe.Main&&e.numChildren()===1){let t=e.children[0];t instanceof Co||(t.swapWithParent(),Uj(e))}}var By="scale_",KS=5;function YO(e){for(let t of e){for(let n of t.children)if(n.parent!==t)return!1;if(!YO(t.children))return!1}return!0}function xs(e,t){let n=!1;for(let r of t)n=e.optimize(r)||n;return n}function zj(e,t,n){let r=e.sources,i=!1;return i=xs(new US,r)||i,i=xs(new BS(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=xs(new qS,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=xs(new zS,r)||i,i=xs(new WS(t),r)||i,i=xs(new LS,r)||i,i=xs(new HS,r)||i,i=xs(new jS,r)||i,i=xs(new GS,r)||i,i=xs(new $S,r)||i,i=xs(new VS,r)||i),e.sources=r,i}function Hj(e,t){YO(e.sources);let n=0,r=0;for(let i=0;i<KS&&zj(e,t,!0);i++)n++;e.sources.map(XS);for(let i=0;i<KS&&zj(e,t,!1);i++)r++;YO(e.sources),Math.max(n,r)===KS&&z(`Maximum optimization runs(${KS}) reached.`)}var Xt=class e{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new e(()=>t(n))}};function JO(e){qe(e)?Wve(e):Vve(e)}function Wve(e){let t=e.component.scales;for(let n of P(t)){let r=Xve(e,n);if(t[n].setWithExplicit("domains",r),Qve(e,n),e.component.data.isFaceted){let o=e;for(;!Yt(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(let a of r.value)ss(a)&&(a.data=By+a.data.replace(By,""))}}}function Vve(e){for(let n of e.children)JO(n);let t=e.component.scales;for(let n of P(t)){let r,i=null;for(let o of e.children){let s=o.component.scales[n];if(s){r===void 0?r=s.getWithExplicit("domains"):r=xi(r,s.getWithExplicit("domains"),"domains","scale",QO);let a=s.get("selectionExtent");i&&a&&i.param!==a.param&&z($.NEEDS_SAME_SELECTION),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function Yve(e,t,n,r){if(e==="unaggregated"){let{valid:i,reason:o}=qj(t,n);if(!i){z(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){let{valid:i}=qj(t,n);if(i)return"unaggregated"}return e}function Xve(e,t){let n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=Yve(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),t==="x"&&tt(r.x2)?tt(r.x)?xi(Ll(n,i,e,"x"),Ll(n,i,e,"x2"),"domain","scale",QO):Ll(n,i,e,"x2"):t==="y"&&tt(r.y2)?tt(r.y)?xi(Ll(n,i,e,"y"),Ll(n,i,e,"y2"),"domain","scale",QO):Ll(n,i,e,"y2"):Ll(n,i,e,t)}function Kve(e,t,n){return e.map(r=>({signal:`{data: ${uf(r,{timeUnit:n,type:t})}}`}))}function XO(e,t,n){let r=ht(n)?.unit;return t==="temporal"||r?Kve(e,t,r):[e]}function Ll(e,t,n,r){let{encoding:i,markDef:o,mark:s,config:a,stack:u}=n,l=tt(i[r]),{type:c}=l,f=l.timeUnit,d=pG({invalid:Wr("invalid",o,a),isPath:yr(s)});if(vH(t)){let h=Ll(e,void 0,n,r),g=XO(t.unionWith,c,f);return vo([...g,...h.value])}else{if(re(t))return vo([t]);if(t&&t!=="unaggregated"&&!RN(t))return vo(XO(t,c,f))}if(u&&r===u.fieldChannel){if(u.offset==="normalize")return vr([[0,1]]);let h=n.requestDataName(d);return vr([{data:h,field:n.vgField(r,{suffix:"start"})},{data:h,field:n.vgField(r,{suffix:"end"})}])}let p=an(r)&&W(l)?Jve(n,r,e):void 0;if(xr(l)){let h=XO([l.datum],c,f);return vr(h)}let m=l;if(t==="unaggregated"){let{field:h}=l;return vr([{data:n.requestDataName(d),field:K({field:h,aggregate:"min"})},{data:n.requestDataName(d),field:K({field:h,aggregate:"max"})}])}else if(Ie(m.bin)){if(ot(e))return e==="bin-ordinal"?vr([]):vr([{data:bp(p)?n.requestDataName(d):n.requestDataName(Xe.Raw),field:n.vgField(r,ia(m,r)?{binSuffix:"range"}:{}),sort:p===!0||!X(p)?{field:n.vgField(r,{}),op:"min"}:p}]);{let{bin:h}=m;if(Ie(h)){let g=lm(n,m.field,h);return vr([new Xt(()=>{let y=n.getSignalName(g);return`[${y}.start, ${y}.stop]`})])}else return vr([{data:n.requestDataName(d),field:n.vgField(r,{})}])}}else if(m.timeUnit&&ge(["time","utc"],e)){let h=i[Rn(r)];if(Tw(m,h,o,a)){let g=n.requestDataName(d),y=gi({fieldDef:m,fieldDef2:h,markDef:o,config:a}),x=ou(s)&&y!==.5&&Ye(r);return vr([{data:g,field:n.vgField(r,x?{suffix:hf}:{})},{data:g,field:n.vgField(r,{suffix:x?gf:"end"})}])}}return p?vr([{data:bp(p)?n.requestDataName(d):n.requestDataName(Xe.Raw),field:n.vgField(r),sort:p}]):vr([{data:n.requestDataName(d),field:n.vgField(r)}])}function KO(e,t){let{op:n,field:r,order:i}=e;return{op:n??(t?"sum":Fl),...r?{field:sn(r)}:{},...i?{order:i}:{}}}function Qve(e,t){let n=e.component.scales[t],r=e.specifiedScales[t].domain,i=e.fieldDef(t)?.bin,o=RN(r)?r:void 0,s=is(i)&&Fp(i.extent)?i.extent:void 0;(o||s)&&n.set("selectionExtent",o??s,!0)}function Jve(e,t,n){if(!ot(n))return;let r=e.fieldDef(t),i=r.sort;if(Cw(i))return{op:"min",field:pa(r,t),order:"ascending"};let{stack:o}=e,s=o?new Set([...o.groupbyFields,...o.stackBy.map(a=>a.fieldDef.field)]):void 0;if(br(i)){let a=o&&!s.has(i.field);return KO(i,a)}else if(WH(i)){let{encoding:a,order:u}=i,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=o&&!s.has(f);if(Ui(c)||go(c))return KO({field:K(l),order:u},d);if(kp(c)||!c)return KO({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ge(["ascending",void 0],i))return!0}}function qj(e,t){let{aggregate:n,type:r}=e;return n?V(n)&&!Hz.has(n)?{valid:!1,reason:$.unaggregateDomainWithNonSharedDomainOp(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:$.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:$.unaggregateDomainHasNoEffectForRawField(e)}}function QO(e,t,n,r){return e.explicit&&t.explicit&&z($.mergeConflictingDomainProperty(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Zve(e){let t=dr(e.map(s=>{if(ss(s)){let{sort:a,...u}=s;return u}return s}),fe),n=dr(e.map(s=>{if(ss(s)){let a=s.sort;return a!==void 0&&!bp(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),fe);if(t.length===0)return;if(t.length===1){let s=e[0];if(ss(s)&&n.length>0){let a=n[0];if(n.length>1){z($.MORE_THAN_ONE_SORT);let u=n.filter(l=>X(l)&&"op"in l&&l.op!=="min");n.every(l=>X(l)&&"op"in l)&&u.length===1?a=u[0]:a=!0}else if(X(a)&&"field"in a){let u=a.field;s.field===u&&(a=a.order?{order:a.order}:!0)}return{...s,sort:a}}return s}let r=dr(n.map(s=>bp(s)||!("op"in s)||V(s.op)&&ee(Lz,s.op)?s:(z($.domainSortDropped(s)),!0)),fe),i;r.length===1?i=r[0]:r.length>1&&(z($.MORE_THAN_ONE_SORT),i=!0);let o=dr(e.map(s=>ss(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?{data:o[0],fields:t.map(a=>a.field),...i?{sort:i}:{}}:{fields:t,...i?{sort:i}:{}}}function cm(e){if(ss(e)&&V(e.field))return e.field;if(qz(e)){let t;for(let n of e.fields)if(ss(n)&&V(n.field)){if(!t)t=n.field;else if(t!==n.field)return z($.FACETED_INDEPENDENT_DIFFERENT_SOURCES),t}return z($.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),t}else if(Gz(e)){z($.FACETED_INDEPENDENT_SAME_SOURCE);let t=e.fields[0];return V(t)?t:void 0}}function Pl(e,t){let r=e.component.scales[t].get("domains").map(i=>(ss(i)&&(i.data=e.lookupDataSource(i.data)),i));return Zve(r)}function ZO(e){return So(e)||um(e)?e.children.reduce((t,n)=>t.concat(ZO(n)),Gj(e)):Gj(e)}function Gj(e){return P(e.component.scales).reduce((t,n)=>{let r=e.component.scales[n];if(r.merged)return t;let i=r.combine(),{name:o,type:s,selectionExtent:a,domains:u,range:l,reverse:c,...f}=i,d=ewe(i.range,o,n,e),p=Pl(e,n),m=a?kG(e,a,r,p):null;return t.push({name:o,type:s,...p?{domain:p}:{},...m?{domainRaw:m}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function ewe(e,t,n,r){if(Ye(n)){if(hi(e))return{step:{signal:`${t}_step`}}}else if(X(e)&&ss(e))return{...e,data:r.lookupDataSource(e.data)};return e}var Ly=class extends Er{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){let t=this.get("type");if(ge([Vt.LOG,Vt.TIME,Vt.UTC],t))return"definitely-not";let n=this.get("zero");if(n===!0||n===void 0&&ge([Vt.LINEAR,Vt.SQRT,Vt.POW],t))return"definitely";let r=this.get("domains");if(r.length>0){let i=!1,o=!1,s=!1;for(let a of r){if(M(a)){let u=a[0],l=a[a.length-1];if(ke(u)&&ke(l))if(u<=0&&l>=0){i=!0;continue}else{o=!0;continue}}s=!0}if(i)return"definitely";if(o&&!s)return"definitely-not"}return"maybe"}};var twe=["range","scheme"];function Yj(e){let t=e.component.scales;for(let n of Cp){let r=t[n];if(!r)continue;let i=nwe(n,e);r.setWithExplicit("range",i)}}function jj(e,t){let n=e.fieldDef(t);if(n?.bin){let{bin:r,field:i}=n,o=Dt(t),s=e.getName(o);if(X(r)&&r.binned&&r.step!==void 0)return new Xt(()=>{let a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${r.step}`;return`${e.getSignalName(s)} / (${u})`});if(Ie(r)){let a=lm(e,i,r);return new Xt(()=>{let u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(s)} / (${l})`})}}}function nwe(e,t){let n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(let f of twe)if(n[f]!==void 0){let d=iy(o,f),p=hw(e,f);if(!d)z($.scalePropertyNotWorkWithScaleType(o,f,e));else if(p)z(p);else switch(f){case"range":{let m=n.range;if(M(m)){if(Ye(e))return vo(m.map(h=>{if(h==="width"||h==="height"){let g=t.getName(h),y=t.getSignalName.bind(t);return Xt.fromName(y,g)}return h}))}else if(X(m))return vo({data:t.requestDataName(Xe.Main),field:m.field,sort:{op:"min",field:t.vgField(e)}});return vo(m)}case"scheme":return vo(rwe(n[f]))}}let s=e===Ve||e==="xOffset"?"width":"height",a=r[s];if(yi(a)){if(Ye(e))if(ot(o)){let f=Kj(a,t,e);if(f)return vo({step:f})}else z($.stepDropped(s));else if(ru(e)){let f=e===mo?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){let m=Qj(a,o);if(m)return vo(m)}}}let{rangeMin:u,rangeMax:l}=n,c=iwe(e,t);return(u!==void 0||l!==void 0)&&iy(o,"rangeMin")&&M(c)&&c.length===2?vo([u??c[0],l??c[1]]):vr(c)}function rwe(e){return EH(e)?{scheme:e.name,...Ut(e,["name"])}:{scheme:e}}function Xj(e,t,n,{center:r}={}){let i=Dt(e),o=t.getName(i),s=t.getSignalName.bind(t);return e===pt&&Dn(n)?r?[Xt.fromName(a=>`${s(a)}/2`,o),Xt.fromName(a=>`-${s(a)}/2`,o)]:[Xt.fromName(s,o),0]:r?[Xt.fromName(a=>`-${s(a)}/2`,o),Xt.fromName(a=>`${s(a)}/2`,o)]:[0,Xt.fromName(s,o)]}function iwe(e,t){let{size:n,config:r,mark:i,encoding:o}=t,{type:s}=tt(o[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case Ve:case pt:{if(ge(["point","band"],u)){let f=Jj(e,n,r.view);if(yi(f))return{step:Kj(f,t,e)}}return Xj(e,t,u)}case mo:case Zs:return owe(e,t,u);case mi:{let f=uwe(i,r),d=lwe(i,n,t,r);return iu(u)?awe(f,d,swe(u,r,l,e)):[f,d]}case qn:return[0,Math.PI*2];case rs:return[0,360];case pr:return[0,new Xt(()=>{let f=t.getSignalName(Yt(t.parent)?"child_width":"width"),d=t.getSignalName(Yt(t.parent)?"child_height":"height");return`min(${f},${d})/2`})];case Oi:return{step:1e3/r.scale.framesPerSecond};case $i:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Bi:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Tt:return"symbol";case zt:case hr:case gr:return u==="ordinal"?s==="nominal"?"category":"ordinal":c!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Gr:case Ii:case Pi:return[r.scale.minOpacity,r.scale.maxOpacity]}}function Kj(e,t,n){let{encoding:r}=t,i=t.getScaleComponent(n),o=_p(n),s=r[o];if(nO({step:e,offsetIsDiscrete:be(s)&&mw(s.type)})==="offset"&&GN(r,o)){let u=t.getScaleComponent(o),c=`domain('${t.scaleName(o)}').length`;if(u.get("type")==="band"){let d=u.get("paddingInner")??u.get("padding")??0,p=u.get("paddingOuter")??u.get("padding")??0;c=`bandspace(${c}, ${d}, ${p})`}let f=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${c} / (1-${Yz(f)})`}}else return e.step}function Qj(e,t){if(nO({step:e,offsetIsDiscrete:ot(t)})==="offset")return{step:e.step}}function owe(e,t,n){let r=e===mo?"x":"y",i=t.getScaleComponent(r);if(!i)return Xj(r,t,n,{center:!0});let o=i.get("type"),s=t.scaleName(r),{markDef:a,config:u}=t;if(o==="band"){let l=Jj(r,t.size,t.config.view);if(yi(l)){let c=Qj(l,n);if(c)return c}return[0,{signal:`bandwidth('${s}')`}]}else{let l=t.encoding[r];if(W(l)&&l.timeUnit){let c=ow(l.timeUnit,m=>`scale('${s}', ${m})`),f=t.config.scale.bandWithNestedOffsetPaddingInner,d=gi({fieldDef:l,markDef:a,config:u})-.5,p=d!==0?` + ${d}`:"";if(f){let m=re(f)?`${f.signal}/2`+p:`${f/2+d}`,h=re(f)?`(1 - ${f.signal}/2)`+p:`${1-f/2+d}`;return[{signal:`${m} * (${c})`},{signal:`${h} * (${c})`}]}return[0,{signal:c}]}return JM(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}function Jj(e,t,n){let r=e===Ve?"width":"height",i=t[r];return i||jp(n,r)}function swe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&M(n)?n.length+1:(z($.domainRequiredForThresholdScale(r)),3)}}function awe(e,t,n){let r=()=>{let i=jr(t),o=jr(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return re(t)?new Xt(r):{signal:r()}}function uwe(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error($.incompatibleChannel("size",e))}var Wj=.95;function lwe(e,t,n,r){let i={x:jj(n,"x"),y:jj(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;let o=Vj(t,i,r.view);return ke(o)?o-1:new Xt(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;let o=Vj(t,i,r.view);return ke(o)?Math.pow(Wj*o,2):new Xt(()=>`pow(${Wj} * ${o.signal}, 2)`)}}throw new Error($.incompatibleChannel("size",e))}function Vj(e,t,n){let r=yi(e.width)?e.width.step:by(n,"width"),i=yi(e.height)?e.height.step:by(n,"height");return t.x||t.y?new Xt(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function eI(e,t){qe(e)?cwe(e,t):eW(e,t)}function cwe(e,t){let n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(let a of P(n)){let u=s[a],l=n[a],c=e.getScaleComponent(a),f=tt(i[a]),d=u[t],p=c.get("type"),m=c.get("padding"),h=c.get("paddingInner"),g=iy(p,t),y=hw(a,t);if(d!==void 0&&(g?y&&z(y):z($.scalePropertyNotWorkWithScaleType(p,t,a))),g&&y===void 0)if(d!==void 0){let x=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":yo(u[t])||b==="temporal"||x?l.set(t,{signal:uf(u[t],{type:b,timeUnit:x})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{let x=j(Zj,t)?Zj[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:p,scalePadding:m,scalePaddingInner:h,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:r,hasNestedOffsetScale:Iw(i,a),hasSecondaryRangeChannel:!!i[Rn(a)]}):r.scale[t];x!==void 0&&l.set(t,x,!1)}}}var Zj={bins:({model:e,fieldOrDatumDef:t})=>W(t)?fwe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>dwe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>pwe(e,t,n,r,i,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>mwe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>hwe(e,t,n.type,r,i.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>gwe(e,t,n,r,i.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{let i=W(e)?e.sort:void 0;return ywe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i,config:o,hasSecondaryRangeChannel:s})=>xwe(e,t,n,r,i,o.scale,s)};function tI(e){qe(e)?Yj(e):eW(e,"range")}function eW(e,t){let n=e.component.scales;for(let r of e.children)t==="range"?tI(r):eI(r,t);for(let r of P(n)){let i;for(let o of e.children){let s=o.component.scales[r];if(s){let a=s.getWithExplicit(t);i=xi(i,a,t,"scale",oS((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function fwe(e,t){let n=t.bin;if(Ie(n)){let r=lm(e,t.field,n);return new Xt(()=>e.getSignalName(r))}else if(mt(n)&&is(n)&&n.step!==void 0)return{step:n.step}}function dwe(e,t){if(ge([zt,hr,gr],e)&&t!=="nominal")return"hcl"}function pwe(e,t,n,r,i,o){if(!(hn(o)?.bin||M(n)||i!=null||r!=null||ge([Vt.TIME,Vt.UTC],e)))return Ye(t)?!0:void 0}function mwe(e,t,n,r,i,o){if(Ye(e)){if(bo(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;let{type:s,orient:a}=i;if(s==="bar"&&!(W(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===Vt.POINT)return n.pointPadding}}function hwe(e,t,n,r,i,o=!1){if(e===void 0){if(Ye(t)){let{bandPaddingInner:s,barBandPaddingInner:a,rectBandPaddingInner:u,tickBandPaddingInner:l,bandWithNestedOffsetPaddingInner:c}=i;return o?c:Be(s,n==="bar"?a:n==="tick"?l:u)}else if(ru(t)&&r===Vt.BAND)return i.offsetBandPaddingInner}}function gwe(e,t,n,r,i,o=!1){if(e===void 0){if(Ye(t)){let{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:a}=i;if(o)return a;if(n===Vt.BAND)return Be(s,re(r)?{signal:`${r.signal}/2`}:r/2)}else if(ru(t)){if(n===Vt.POINT)return .5;if(n===Vt.BAND)return i.offsetBandPaddingOuter}}}function ywe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Dn(e)&&t==="descending"?re(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Dn(e)&&t==="descending")return!0}function xwe(e,t,n,r,i,o,s){if(!!n&&n!=="unaggregated"&&Dn(i)){if(M(n)){let u=n[0],l=n[n.length-1];if(ke(u)&&u<=0&&ke(l)&&l>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!iu(i))return!0;if(!(W(t)&&t.bin)&&ge([...Vn,...Tz],e)){let{orient:u,type:l}=r;return ge(["bar","area","line","trail"],l)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:ge(["bar","area"],l)&&!s?!0:o?.zero}return!1}function tW(e,t,n,r,i=!1){let o=bwe(t,n,r,i),{type:s}=e;return an(t)?s!==void 0?CH(t,s)?W(n)&&!_H(s,n.type)?(z($.scaleTypeNotWorkWithFieldDef(s,o)),o):s:(z($.scaleTypeNotWorkWithChannel(t,s,o)),o):o:null}function bwe(e,t,n,r){switch(t.type){case"nominal":case"ordinal":{if(nu(e)||Kv(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&z($.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(Xv(e))return"band";if(Ye(e)||ru(e)){if(ge(["rect","bar","image","rule","tick"],n.type)||r)return"band"}else if(n.type==="arc"&&e in Yv)return"band";let i=n[Dt(e)];return na(i)||au(t)&&t.axis?.tickBand?"band":"point"}case"temporal":return nu(e)?"time":Kv(e)==="discrete"?(z($.discreteChannelCannotEncode(e,"temporal")),"ordinal"):W(t)&&t.timeUnit&&ht(t.timeUnit).utc?"utc":Xv(e)?"band":"time";case"quantitative":return nu(e)?W(t)&&Ie(t.bin)?"bin-ordinal":"linear":Kv(e)==="discrete"?(z($.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):Xv(e)?"band":"linear";case"geojson":return}throw new Error($.invalidFieldType(t.type))}function nW(e,{ignoreRange:t}={}){rW(e),JO(e);for(let n of AH)eI(e,n);t||tI(e)}function rW(e){qe(e)?e.component.scales=Ewe(e):e.component.scales=wwe(e)}function Ewe(e){let{encoding:t,mark:n,markDef:r}=e,i={};for(let o of Cp){let s=tt(t[o]);if(s&&n===yw&&o===Tt&&s.type===ls)continue;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a??(a={});let u=Iw(t,o),l=tW(a,o,s,r,u);i[o]=new Ly(e.scaleName(`${o}`,!0),{value:l,explicit:a.type===l})}}return i}var vwe=oS((e,t)=>kN(e)-kN(t));function wwe(e){var t;let n=e.component.scales={},r={},i=e.component.resolve;for(let o of e.children){rW(o);for(let s of P(o.component.scales))if((t=i.scale)[s]??(t[s]=MS(s,e)),i.scale[s]==="shared"){let a=r[s],u=o.component.scales[s].getWithExplicit("type");a?hH(a.value,u.value)?r[s]=xi(a,u,"type","scale",vwe):(i.scale[s]="independent",delete r[s]):r[s]=u}}for(let o of P(r)){let s=e.scaleName(o,!0),a=r[o];n[o]=new Ly(s,a);for(let u of e.children){let l=u.component.scales[o];l&&(u.renameScale(l.get("name"),s),l.merged=!0)}}return n}var Uy=class{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}};function qe(e){return e?.type==="unit"}function Yt(e){return e?.type==="facet"}function um(e){return e?.type==="concat"}function So(e){return e?.type==="layer"}var Sf=class{constructor(t,n,r,i,o,s,a){this.type=n,this.parent=r,this.config=o,this.parent=r,this.config=o,this.view=kt(a),this.name=t.name??i,this.title=os(t.title)?{text:t.title}:t.title?kt(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new Uy,this.projectionNameMap=r?r.projectionNameMap:new Uy,this.signalNameMap=r?r.signalNameMap:new Uy,this.data=t.data,this.description=t.description,this.transforms=sG(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:Aq(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:lu(t)||r?.component.data.isFaceted&&t.data===void 0},layoutSize:new Er,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...s?se(s):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){nW(this)}parseProjection(){VO(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){jO(this)}assembleEncodeFromView(t){let{style:n,...r}=t,i={};for(let o of P(r)){let s=r[o];s!==void 0&&(i[o]=Pe(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Pe(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Me(n)?void 0:n}assembleLayout(){if(!this.layout)return;let{spacing:t,...n}=this.layout,{component:r,config:i}=this,o=vj(r.layoutHeaders,i);return{padding:t,...this.assembleDefaultLayout(),...n,...o?{titleBand:o}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){let{layoutHeaders:t}=this.component,n=[];for(let r of Fn)t[r].title&&n.push(yj(this,r));for(let r of im)n=n.concat(Ej(this,r));return n}assembleAxes(){return dj(this.component.axes,this.config)}assembleLegends(){return IS(this)}assembleProjections(){return Tj(this)}assembleTitle(){let{encoding:t,...n}=this.title??{},r={...Jv(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(r.text)return ge(["unit","layer"],this.type)?ge(["middle",void 0],r.anchor)&&(r.frame??(r.frame="group")):r.anchor??(r.anchor="start"),Me(r)?void 0:r}assembleGroup(t=[]){let n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);let r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());let i=!this.parent||Yt(this.parent)?ZO(this):[];i.length>0&&(n.scales=i);let o=this.assembleAxes();o.length>0&&(n.axes=o);let s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return ze((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Xe[t].toLowerCase())}requestDataName(t){let n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(Yt(this.parent)){let n=TS(t),r=_l(n),i=this.component.scales[r];if(i&&!i.merged){let o=i.get("type"),s=i.get("range");if(ot(o)&&hi(s)){let a=i.get("name"),u=Pl(this,r),l=cm(u);if(l){let c=K({aggregate:"distinct",field:l},{expr:"datum"});return{signal:zO(a,i,c)}}else return z($.unknownField(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){let n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Wv(t)&&an(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");let n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){let n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error($.selectionNotFound(n));return r}hasAxisOrientSignalRef(){return this.component.axes.x?.some(t=>t.hasOrientSignalRef())||this.component.axes.y?.some(t=>t.hasOrientSignalRef())}},pm=class extends Sf{vgField(t,n={}){let r=this.fieldDef(t);if(r)return K(r,n)}reduceFieldDef(t,n){return sq(this.getMapping(),(r,i,o)=>{let s=hn(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){py(this.getMapping(),(r,i)=>{let o=hn(r);o&&t(o,i)},n)}};var mm=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=se(n);let r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"];let i=this.transform.resolve??"shared";this.transform.resolve=i}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${fe(this.transform)}`}assemble(){let{density:t,...n}=this.transform,r={type:"kde",field:t,...n};return r.resolve=this.transform.resolve,r}};var hm=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=se(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${fe(this.transform)}`}assemble(){let{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}};var gm=class e extends ye{clone(){return new e(this.parent,se(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=se(n);let{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>i[s]??o)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${fe(this.transform)}`}assemble(){let{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}};var ym=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=se(n);let r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${fe(this.transform)}`}assemble(){let{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}};var xm=class e extends ye{clone(){return new e(null,se(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(let i of[[jn,Gn],[Wn,mr]]){let o=i.map(s=>{let a=tt(n.encoding[s]);return W(a)?a.field:xr(a)?{expr:`${a.datum}`}:un(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new e(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(Tt)){let i=n.typedFieldDef(Tt);i.type===ls&&(t=new e(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}dependentFields(){let t=(this.fields??[]).filter(V);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${fe(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}};var bm=class e extends ye{clone(){return new e(null,this.projection,se(this.fields),se(this.as))}constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}static parseAll(t,n){if(!n.projectionName())return t;for(let r of[[jn,Gn],[Wn,mr]]){let i=r.map(s=>{let a=tt(n.encoding[s]);return W(a)?a.field:xr(a)?{expr:`${a.datum}`}:un(a)?{expr:`${a.value}`}:void 0}),o=r[0]===Wn?"2":"";(i[0]||i[1])&&(t=new e(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(V))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${fe(this.fields)} ${fe(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}};var Af=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){let{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new e(t,n)}static makeFromEncoding(t,n){let r=n.encoding,i=r.x,o=r.y;if(W(i)&&W(o)){let s=i.impute?i:o.impute?o:void 0;if(s===void 0)return;let a=i.impute?o:o.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=s.impute,d=Bw(n.mark,r);return new e(t,{impute:s.field,key:a.field,...u?{method:u}:{},...l!==void 0?{value:l}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${fe(this.transform)}`}assemble(){let{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...r?{keyvals:zq(r)?this.processSequence(r):r}:{},method:"value",...o?{groupby:o}:{},value:!i||i==="value"?s:null};if(i&&i!=="value"){let l={type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1,...o?{groupby:o}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}};var Em=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=se(n);let r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${fe(this.transform)}`}assemble(){let{loess:t,on:n,...r}=this.transform;return{type:"loess",x:n,y:t,...r}}};var vm=class e extends ye{clone(){return new e(null,se(this.transform),this.secondary)}constructor(t,n,r){super(t),this.transform=n,this.secondary=r}static make(t,n,r,i){let o=n.component.data.sources,{from:s}=r,a=null;if(Hq(s)){let u=nI(s.data,o);u||(u=new vi(s.data),o.push(u));let l=n.getName(`lookup_${i}`);a=new Ht(u,l,Xe.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(qq(s)){let u=s.param;r={as:u,...r};let l;try{l=n.getSelectionComponent(ze(u),u)}catch{throw new Error($.cannotLookupVariableParameter(u))}if(a=l.materialized,!a)throw new Error($.noSameUnitLookup(u))}return new e(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Q(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${fe({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:Q(this.transform.as)}:{}};else{let n=this.transform.as;V(n)||(z($.NO_FIELDS_NEEDS_AS),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}};var wm=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=se(n);let r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${fe(this.transform)}`}assemble(){let{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}};var Sm=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=se(n);let r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${fe(this.transform)}`}assemble(){let{regression:t,on:n,...r}=this.transform;return{type:"regression",x:n,y:t,...r}}};var Am=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=dr((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${fe(this.transform)}`}assemble(){let{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return{type:"pivot",field:t,value:n,...i!==void 0?{limit:i}:{},...o!==void 0?{op:o}:{},...r!==void 0?{groupby:r}:{}}}};var _m=class e extends ye{clone(){return new e(null,se(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${fe(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}};function iW(e){let t=0;function n(r,i){if(r instanceof vi&&!r.isGenerator&&!pu(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof On&&(r.parent instanceof vi&&!i.source?(i.format={...i.format,parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Co){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof $l||r instanceof Bl||r instanceof wf||r instanceof da||r instanceof vf||r instanceof bm||r instanceof qi||r instanceof vm||r instanceof Eu||r instanceof ys||r instanceof ym||r instanceof gm||r instanceof mm||r instanceof Em||r instanceof wm||r instanceof Sm||r instanceof gs||r instanceof _m||r instanceof Am||r instanceof hm)&&i.transform.push(r.assemble()),(r instanceof hs||r instanceof wo||r instanceof Af||r instanceof ha||r instanceof xm)&&i.transform.push(...r.assemble()),r instanceof Ht&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof Ht?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Ht&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(let s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function oW(e){let t=[],n=iW(t);for(let r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function sW(e,t){let n=[],r=iW(n),i=0;for(let s of e.sources){s.hasName()||(s.dataName=`source_${i++}`);let a=s.assemble();r(s,a)}for(let s of n)s.transform.length===0&&delete s.transform;let o=0;for(let[s,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(o++,0,n.splice(s,1)[0]);for(let s of n)for(let a of s.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(let s of n)s.name in t&&(s.values=t[s.name]);return n}function Swe(e){return e==="top"||e==="left"||re(e)?"header":"footer"}function uW(e){for(let t of Fn)Awe(e,t);aW(e,"x"),aW(e,"y")}function Awe(e,t){let{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){let s=n[t],a=bu("title",null,r,t),u=ua(s,r,{allowDisabling:!0,includeDefault:a===void 0||!!a});i.component.layoutHeaders[t].title&&(u=M(u)?u.join(", "):u,u+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);let l=bu("labelOrient",s.header,r,t),c=s.header!==null?Be(s.header?.labels,r.header.labels,!0):!1,f=ge(["bottom","right"],l)?"footer":"header";o.layoutHeaders[t]={title:s.header!==null?u:null,facetFieldDef:s,[f]:t==="facet"?[]:[lW(e,t,c)]}}}function lW(e,t,n){let r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function aW(e,t){let{child:n}=e;if(n.component.axes[t]){let{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=am(i,t),i.axis[t]==="shared"){let o=t==="x"?"column":"row",s=r[o];for(let a of n.component.axes[t]){let u=Swe(a.get("orient"));s[u]??(s[u]=[lW(e,o,!1)]);let l=nm(a,"main",e.config,{header:!0});l&&s[u][0].axes.push(l),a.mainExtracted=!0}}}}function cW(e){JS(e),QS(e,"width"),QS(e,"height")}function fW(e){JS(e);let t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";QS(e,t),QS(e,n)}function JS(e){for(let t of e.children)t.parseLayoutSize()}function QS(e,t){let n=TS(t),r=_l(n),i=e.component.resolve,o=e.component.layoutSize,s;for(let a of e.children){let u=a.component.layoutSize.getWithExplicit(n),l=i.scale[r]??MS(r,e);if(l==="independent"&&u.value==="step"){s=void 0;break}if(s){if(l==="independent"&&s.value!==u.value){s=void 0;break}s=xi(s,u,n,"")}else s=u}if(s){for(let a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function dW(e){let{size:t,component:n}=e;for(let r of Vn){let i=Dt(r);if(t[i]){let o=t[i];n.layoutSize.set(i,yi(o)?"step":o,!0)}else{let o=_we(e,i);n.layoutSize.set(i,o,!1)}}}function _we(e,t){let n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){let o=i.get("type"),s=i.get("range");if(ot(o)){let a=jp(r.view,t);return hi(s)||yi(a)?"step":a}else return xy(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return xy(r.view,t);{let o=jp(r.view,t);return yi(o)?o.step:o}}}function ZS(e,t,n){return K(t,{suffix:`by_${K(e)}`,...n})}var eA=class e extends pm{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=Cm(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!sa(t))return{facet:this.initFacetFieldDef(t,"facet")};let n=P(t),r={};for(let i of n){if(![fi,di].includes(i)){z($.incompatibleChannel(i,"facet"));break}let o=t[i];if(o.field===void 0){z($.emptyFieldDef(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){let r=dy(t,n);return r.header?r.header=kt(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return j(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Ul(this),this.child.parseData()}parseLayoutSize(){JS(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,Object.values(this.component.selection).some(t=>Mn(t))&&Tp(of)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),uW(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){let t={};for(let n of Fn)for(let r of om){let i=this.component.layoutHeaders[n],o=i[r],{facetFieldDef:s}=i;if(s){let a=bu("titleOrient",s.header,this.config,n);if(["right","bottom"].includes(a)){let u=rm(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[u]="end"}}if(o?.[0]){let a=n==="row"?"height":"width",u=r==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[u]??(t[u]={}),t[u][n]=.5),i.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){let{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0,i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof e))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof e?{...this.channelHasField("column")?{encode:{update:{columns:{field:K(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){let t=[],n=[],r=[];if(this.child instanceof e){if(this.child.channelHasField("column")){let i=K(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(let i of Vn){let o=this.child.component.scales[i];if(o&&!o.merged){let s=o.get("type"),a=o.get("range");if(ot(s)&&hi(a)){let u=Pl(this.child,i),l=cm(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):z($.unknownField(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){let{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),u=[];for(let c of Fn){let f=this.facet[c];if(f){u.push(K(f));let{bin:d,sort:p}=f;if(Ie(d)&&u.push(K(f,{binSuffix:"end"})),br(p)){let{field:m,op:h=Fl}=p,g=ZS(f,p);r&&i?(o.push(g),s.push("max"),a.push(g)):(o.push(m),s.push(h),a.push(g))}else if(M(p)){let m=pa(f,c);o.push(m),s.push("max"),a.push(m)}}}let l=!!r&&!!i;return{name:t,data:n,groupby:u,...l||o.length>0?{aggregate:{...l?{cross:l}:{},...o.length?{fields:o,ops:s,as:a}:{}}}:{}}}facetSortFields(t){let{facet:n}=this,r=n[t];return r?br(r.sort)?[ZS(r,r.sort,{expr:"datum"})]:M(r.sort)?[pa(r,t,{expr:"datum"})]:[K(r,{expr:"datum"})]:[]}facetSortOrder(t){let{facet:n}=this,r=n[t];if(r){let{sort:i}=r;return[(br(i)?i.order:!M(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){let{facet:t,config:n}=this;if(t.facet)return FS(t.facet,"facet",n);let r={row:["top","bottom"],column:["left","right"]};for(let i of im)if(t[i]){let o=bu("labelOrient",t[i]?.header,n,i);if(r[i].includes(o))return FS(t[i],i,n)}}assembleMarks(){let{child:t}=this,n=this.component.data.facetRoot,r=oW(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...o?{title:o}:{},...s?{style:s}:{},from:{facet:this.assembleFacet()},sort:{field:Fn.map(u=>this.facetSortFields(u)).flat(),order:Fn.map(u=>this.facetSortOrder(u)).flat()},...r.length>0?{data:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup(SG(this,[]))}]}getMapping(){return this.facet}};function pW(e,t){let{row:n,column:r}=t;if(n&&r){let i=null;for(let o of[n,r])if(br(o.sort)){let{field:s,op:a=Fl}=o.sort;e=i=new ys(e,{joinaggregate:[{op:a,field:s,as:ZS(o,o.sort,{forAs:!0})}],groupby:[K(o)]})}return i}return null}function nI(e,t){for(let n of t){let r=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;let i=e.format?.mesh,o=r.format?.feature;if(i&&o)continue;let s=e.format?.feature;if((s||o)&&s!==o)continue;let a=r.format?.mesh;if(!((i||a)&&i!==a)){if(mf(e)&&mf(r)){if(kn(e.values,r.values))return n}else if(pu(e)&&pu(r)){if(e.url===r.url)return n}else if(aS(e)&&e.name===n.dataName)return n}}return null}function Cwe(e,t){if(e.data||!e.parent){if(e.data===null){let r=new vi({values:[]});return t.push(r),r}let n=nI(e.data,t);if(n)return fs(e.data)||(n.data.format=ZM({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{let r=new vi(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function kwe(e,t,n){let r=0;for(let i of t.transforms){let o,s;if(Zq(i))s=e=new vf(e,i),o="derived";else if(Ey(i)){let a=Pj(i);s=e=On.makeWithAncestors(e,{},a,n)??e,e=new da(e,t,i.filter)}else if(nS(i))s=e=hs.makeFromTransform(e,i,t),o="number";else if(tG(i))o="date",n.getWithExplicit(i.field).value===void 0&&(e=new On(e,{[i.field]:o}),n.set(i.field,o,!1)),s=e=wo.makeFromTransform(e,i);else if(nG(i))s=e=qi.makeFromTransform(e,i),o="number",Cy(t)&&(e=new gs(e));else if(tS(i))s=e=vm.make(e,t,i,r++),o="derived";else if(Kq(i))s=e=new Eu(e,i),o="number";else if(Qq(i))s=e=new ys(e,i),o="number";else if(rG(i))s=e=ha.makeFromTransform(e,i),o="derived";else if(iG(i))s=e=new ym(e,i),o="derived";else if(oG(i))s=e=new hm(e,i),o="derived";else if(Jq(i))s=e=new gm(e,i),o="derived";else if(Gq(i))s=e=new Am(e,i),o="derived";else if(Xq(i))e=new _m(e,i);else if(eG(i))s=e=Af.makeFromTransform(e,i),o="derived";else if(jq(i))s=e=new mm(e,i),o="derived";else if(Wq(i))s=e=new wm(e,i),o="derived";else if(Vq(i))s=e=new Sm(e,i),o="derived";else if(Yq(i))s=e=new Em(e,i),o="derived";else{z($.invalidTransformIgnored(i));continue}if(s&&o!==void 0)for(let a of s.producedFields()??[])n.set(a,o,!1)}return e}function Ul(e){let t=Cwe(e,e.component.data.sources),{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,s=!(i&&(fs(i)||pu(i)||mf(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new sS;fs(i)?(cO(i)?t=new Bl(t,i.sequence):vy(i)&&(t=new $l(t,i.graticule)),s.parseNothing=!0):i?.format?.parse===null&&(s.parseNothing=!0),t=On.makeExplicit(t,e,s)??t,t=new gs(t);let a=e.parent&&So(e.parent);(qe(e)||Yt(e))&&a&&(t=hs.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=kwe(t,e,s));let u=Bj(e),l=$j(e);t=On.makeWithAncestors(t,{},{...u,...l},s)??t,qe(e)&&(t=xm.parseAll(t,e),t=bm.parseAll(t,e)),(qe(e)||Yt(e))&&(a||(t=hs.makeFromEncoding(t,e)??t),t=wo.makeFromEncoding(t,e)??t,t=vf.parseAllForSortIndex(t,e));let c=t=tA(Xe.Raw,e,t);if(qe(e)){let g=qi.makeFromEncoding(t,e);g&&(t=g,Cy(e)&&(t=new gs(t))),t=Af.makeFromEncoding(t,e)??t,t=ha.makeFromEncoding(t,e)??t}let f,d;if(qe(e)){let{markDef:g,mark:y,config:x}=e,b=Ne("invalid",g,x),{marks:E,scales:v}=d=dO({invalid:b,isPath:yr(y)});E!==v&&v==="include-invalid-values"&&(f=t=tA(Xe.PreFilterInvalid,e,t)),E==="exclude-invalid-values"&&(t=wf.make(t,e,d)??t)}let p=t=tA(Xe.Main,e,t),m;if(qe(e)&&d){let{marks:g,scales:y}=d;g==="include-invalid-values"&&y==="exclude-invalid-values"&&(t=wf.make(t,e,d)??t,m=t=tA(Xe.PostFilterInvalid,e,t))}qe(e)&&fj(e,p);let h=null;if(Yt(e)){let g=e.getName("facet");t=pW(t,e.facet)??t,h=new Co(t,e,g,p.getSource()),n[g]=h}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:c,main:p,facetRoot:h,ancestorParse:s,preFilterInvalid:f,postFilterInvalid:m}}function tA(e,t,n){let{outputNodes:r,outputNodeRefCounts:i}=t.component.data,o=t.getDataName(e),s=new Ht(n,o,e,i);return r[o]=s,s}var nA=class extends Sf{constructor(t,n,r,i){super(t,"concat",n,r,i,t.resolve),(t.resolve?.axis?.x==="shared"||t.resolve?.axis?.y==="shared")&&z($.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(t).map((o,s)=>Cm(o,this,this.getName(`concat_${s}`),void 0,i))}parseData(){this.component.data=Ul(this);for(let t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(let t of this.children){t.parseSelections();for(let n of P(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Mn(t))&&Tp(of)}parseMarkGroup(){for(let t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(let t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Dl(t)?t.vconcat:Gp(t)?t.hconcat:t.concat}parseLayoutSize(){fW(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){let t=sm(this);for(let n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{let n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...r?{style:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){let t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}};function Fwe(e){return e===!1||e===null}var Rwe={disable:1,gridScale:1,scale:1,...zN,labelExpr:1,encode:1},rI=P(Rwe),rA=class e extends Er{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new e(se(this.explicit),se(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Fwe(this.get(t))}hasOrientSignalRef(){return re(this.explicit.orient)}};function mW(e,t,n){let{encoding:r,config:i}=e,o=tt(r[t])??tt(r[Rn(t)]),s=e.axis(t)||{},{format:a,formatType:u}=s;if(oa(u))return{text:zi({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:u,config:i}),...n};if(a===void 0&&u===void 0&&i.customFormatTypes){if(su(o)==="quantitative"){if(au(o)&&o.stack==="normalize"&&i.normalizedNumberFormatType)return{text:zi({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:zi({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if(su(o)==="temporal"&&i.timeFormatType&&W(o)&&!o.timeUnit)return{text:zi({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}function hW(e){return Vn.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Pwe(n,e)]),t),{})}var Dwe={bottom:"top",top:"bottom",left:"right",right:"left"};function gW(e){let{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(let i of e.children){i.parseAxesAndHeaders();for(let o of P(i.component.axes))n.axis[o]=am(e.component.resolve,o),n.axis[o]==="shared"&&(t[o]=Mwe(t[o],i.component.axes[o]),t[o]||(n.axis[o]="independent",delete t[o]))}for(let i of Vn){for(let o of e.children)if(o.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(let s of o.component.axes[i]){let{value:a,explicit:u}=s.getWithExplicit("orient");if(!re(a)){if(r[a]>0&&!u){let l=Dwe[a];r[a]>r[l]&&s.set("orient",l,!1)}r[a]++}}}delete o.component.axes[i]}if(n.axis[i]==="independent"&&t[i]&&t[i].length>1)for(let[o,s]of(t[i]||[]).entries())o>0&&s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function Mwe(e,t){if(e){if(e.length!==t.length)return;let n=e.length;for(let r=0;r<n;r++){let i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){let s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=Nwe(i,o)}}}else return t.map(n=>n.clone());return e}function Nwe(e,t){for(let n of rI){let r=xi(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return rw(i,o);case"gridScale":return{explicit:i.explicit,value:Be(i.value,o.value)}}return Yp(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function Owe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(re(n.labelAngle)?n.labelAngle:Sl(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===UO(r,i))return!0}return e===n[t]}var Iwe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Pwe(e,t){let n=t.axis(e),r=new rA,i=tt(t.encoding[e]),{mark:o,config:s}=t,a=n?.orient||s[e==="x"?"axisX":"axisY"]?.orient||s.axis?.orient||gj(e),u=t.getScaleComponent(e).get("type"),l=mj(e,u,a,t.config),c=n!==void 0?!n:Oy("disable",s.style,n?.style,l).configValue;if(r.set("disable",c,n!==void 0),c)return r;n=n||{};let f=hj(i,n,e,s.style,l),d=_w(n.formatType,i,u),p=Aw(i,i.type,n.format,n.formatType,s,!0),m={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:f,format:p,formatType:d,mark:o,config:s};for(let y of rI){let x=y in $O?$O[y](m):HN(y)?n[y]:void 0,b=x!==void 0,E=Owe(x,y,n,t,e);if(b&&E)r.set(y,x,E);else{let{configValue:v=void 0,configFrom:S=void 0}=HN(y)&&y!=="values"?Oy(y,s.style,n.style,l):{},w=v!==void 0;b&&!w?r.set(y,x,E):(S!=="vgAxisConfig"||Iwe.has(y)&&w||cu(v)||re(v))&&r.set(y,v,!1)}}let h=n.encoding??{},g=Ow.reduce((y,x)=>{if(!r.hasAxisPart(x))return y;let b=DS(h[x]??{},t),E=x==="labels"?mW(t,e,b):b;return E!==void 0&&!Me(E)&&(y[x]={update:E}),y},{});return Me(g)||r.set("encode",g,!!n.encoding||n.labelAngle!==void 0),r}function yW({encoding:e,size:t}){for(let n of Vn){let r=Dt(n);yi(t[r])&&cs(e[n])&&(delete t[r],z($.stepDropped(r)))}return t}var xW={vgMark:"arc",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Nt("x",e,{defaultPos:"mid"}),...Nt("y",e,{defaultPos:"mid"}),...Sr(e,"radius"),...Sr(e,"theta")})};var bW={vgMark:"area",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Ol("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...Ol("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...em(e)})};var EW={vgMark:"rect",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Sr(e,"x"),...Sr(e,"y")})};var vW={vgMark:"shape",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{let{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&W(n)&&n.type===ls?{field:K(n,{expr:"datum"})}:{}}]}};var wW={vgMark:"image",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Sr(e,"x"),...Sr(e,"y"),...Nl(e,"url")})};var SW={vgMark:"line",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Nt("x",e,{defaultPos:"mid"}),...Nt("y",e,{defaultPos:"mid"}),...gt("size",e,{vgChannel:"strokeWidth"}),...em(e)})},AW={vgMark:"trail",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Nt("x",e,{defaultPos:"mid"}),...Nt("y",e,{defaultPos:"mid"}),...gt("size",e),...em(e)})};function iI(e,t){let{config:n}=e;return{...Ft(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Nt("x",e,{defaultPos:"mid"}),...Nt("y",e,{defaultPos:"mid"}),...gt("size",e),...gt("angle",e),...$we(e,n,t)}}function $we(e,t,n){return n?{shape:{value:n}}:gt("shape",e)}var _W={vgMark:"symbol",encodeEntry:e=>iI(e)},CW={vgMark:"symbol",encodeEntry:e=>iI(e,"circle")},kW={vgMark:"symbol",encodeEntry:e=>iI(e,"square")};var FW={vgMark:"rect",encodeEntry:e=>({...Ft(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Sr(e,"x"),...Sr(e,"y")})};var RW={vgMark:"rule",encodeEntry:e=>{let{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...Ft(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ol("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...Ol("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...gt("size",e,{vgChannel:"strokeWidth"})}}};var TW={vgMark:"text",encodeEntry:e=>{let{config:t,encoding:n}=e;return{...Ft(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Nt("x",e,{defaultPos:"mid"}),...Nt("y",e,{defaultPos:"mid"}),...Nl(e),...gt("size",e,{vgChannel:"fontSize"}),...gt("angle",e),...hS("align",Bwe(e.markDef,n,t)),...hS("baseline",Lwe(e.markDef,n,t)),...Nt("radius",e,{defaultPos:null}),...Nt("theta",e,{defaultPos:null})}}};function Bwe(e,t,n){if(Ne("align",e,n)===void 0)return"center"}function Lwe(e,t,n){if(Ne("baseline",e,n)===void 0)return"middle"}var DW={vgMark:"rect",encodeEntry:e=>{let{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"x":"y",o=r==="horizontal"?"y":"x",s=r==="horizontal"?"height":"width";return{...Ft(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Sr(e,i),...Nt(o,e,{defaultPos:"mid",vgChannel:o==="y"?"yc":"xc"}),[s]:Pe(Ne("thickness",n,t))}}};var iA={arc:xW,area:bW,bar:EW,circle:CW,geoshape:vW,image:wW,line:SW,point:_W,rect:FW,rule:RW,square:kW,text:TW,tick:DW,trail:AW};function OW(e){if(ge([ff,lf,TH],e.mark)){let t=Bw(e.mark,e.encoding);if(t.length>0)return Uwe(e,t)}else if(e.mark===cf){let t=Zv.some(n=>Ne(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return zwe(e)}return oI(e)}var MW="faceted_path_";function Uwe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:MW+e.requestDataName(Xe.Main),data:e.requestDataName(Xe.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:oI(e,{fromPrefix:MW})}]}var NW="stack_group_";function zwe(e){let[t]=oI(e,{fromPrefix:NW}),n=e.scaleName(e.stack.fieldChannel),r=(l={})=>e.vgField(e.stack.fieldChannel,l),i=(l,c)=>{let f=[r({prefix:"min",suffix:"start",expr:c}),r({prefix:"max",suffix:"start",expr:c}),r({prefix:"min",suffix:"end",expr:c}),r({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`},o,s;e.stack.fieldChannel==="x"?(o={...Za(t.encode.update,["y","yc","y2","height",...Zv]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Ut(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...Za(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Ut(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(let l of Zv){let c=Wr(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):c&&(o[l]=Pe(c)),c&&(t.encode.update[l]={value:0})}let a=[];if(e.stack.groupbyChannels?.length>0)for(let l of e.stack.groupbyChannels){let c=e.fieldDef(l),f=K(c);f&&a.push(f),(c?.bin||c?.timeUnit)&&a.push(K(c,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return{...l,[c]:t.encode.update[c]};{let f=Wr(c,e.markDef,e.config);return f!==void 0?{...l,[c]:Pe(f)}:l}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Xe.Main),name:NW+e.requestDataName(Xe.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function Hwe(e){let{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,s=t.order;if(!(!M(s)&&un(s)&&Lv(s.value)||!s&&Lv(Ne("order",i,o)))){if((M(s)||W(s))&&!n)return nw(s,{expr:"datum"});if(yr(r)){let a=i.orient==="horizontal"?"y":"x",u=t[a];if(W(u))return{field:a}}}}function oI(e,t={fromPrefix:""}){let{mark:n,markDef:r,encoding:i,config:o}=e,s=Be(r.clip,qwe(e),Gwe(e)),a=mN(r),u=i.key,l=Hwe(e),c=jwe(e),f=Ne("aria",r,o),d=iA[n].postEncodingTransform?iA[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:iA[n].vgMark,...s?{clip:s}:{},...a?{style:a}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(Xe.Main)},encode:{update:iA[n].encodeEntry(e)},...d?{transform:d}:{}}]}function qwe(e){let t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t?.get("selectionExtent")||n?.get("selectionExtent")?!0:void 0}function Gwe(e){let t=e.component.projection;return t&&!t.isFit?!0:void 0}function jwe(e){if(!e.component.selection)return null;let t=P(e.component.selection).length,n=t,r=e.parent;for(;r&&n===0;)n=P(r.component.selection).length,r=r.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}var km=class extends pm{constructor(t,n,r,i={},o){super(t,"unit",n,r,o,void 0,rO(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[],this.correctDataNames=l=>(l.from?.data&&(l.from.data=this.lookupDataSource(l.from.data),"time"in this.encoding&&(l.from.data=l.from.data+lS)),l.from?.facet?.data&&(l.from.facet.data=this.lookupDataSource(l.from.facet.data)),l);let s=Yn(t.mark)?{...t.mark}:{type:t.mark},a=s.type;s.filled===void 0&&(s.filled=Mq(s,o,{graticule:t.data&&vy(t.data)}));let u=this.encoding=iq(t.encoding||{},a,s.filled,o);this.markDef=Kw(s,u,o),this.size=yW({encoding:u,size:rO(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=Xw(this.markDef,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(l=>qp(l))}get hasProjection(){let{encoding:t}=this,n=this.mark===yw,r=t&&Ez.some(i=>be(t[i]));return n||r}scaleDomain(t){let n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return Cp.reduce((r,i)=>{let o=tt(n[i]);return o&&(r[i]=this.initScale(o.scale??{})),r},{})}initScale(t){let{domain:n,range:r}=t,i=kt(t);return M(n)&&(i.domain=n.map(Tn)),M(r)&&(i.range=r.map(Tn)),i}initAxes(t){return Vn.reduce((n,r)=>{let i=t[r];if(be(i)||r===Ve&&be(t.x2)||r===pt&&be(t.y2)){let o=be(i)?i.axis:void 0;n[r]=o&&this.initAxis({...o})}return n},{})}initAxis(t){let n=P(t),r={};for(let i of n){let o=t[i];r[i]=cu(o)?ew(o):Tn(o)}return r}initLegends(t){return Nz.reduce((n,r)=>{let i=tt(t[r]);if(i&&Iz(r)){let o=i.legend;n[r]=o&&kt(o)}return n},{})}parseData(){this.component.data=Ul(this)}parseLayoutSize(){dW(this)}parseSelections(){this.component.selection=cj(this,this.selection)}parseMarkGroup(){this.component.mark=OW(this)}parseAxesAndHeaders(){this.component.axes=hW(this)}assembleSelectionTopLevelSignals(t){return AG(this,t)}assembleSignals(){return[...kS(this),...wG(this,[])]}assembleSelectionData(t){return _G(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return sm(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!So(this.parent))&&(t=bO(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){let{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return ca(this.encoding,t)}fieldDef(t){let n=this.encoding[t];return hn(n)}typedFieldDef(t){let n=this.fieldDef(t);return Mt(n)?n:null}};var oA=class e extends Sf{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);let s={...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,u)=>{if(du(a))return new e(a,this,this.getName(`layer_${u}`),s,o);if(gn(a))return new km(a,this,this.getName(`layer_${u}`),s,o);throw new Error($.invalidSpec(a))})}parseData(){this.component.data=Ul(this);for(let t of this.children)t.parseData()}parseLayoutSize(){cW(this)}parseSelections(){this.component.selection={};for(let t of this.children){t.parseSelections();for(let n of P(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Mn(t))&&Tp(of)}parseMarkGroup(){for(let t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){gW(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),kS(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),sm(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){let t=new Set;for(let r of this.children)for(let i of Q(r.assembleGroupStyle()))t.add(i);let n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(let n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return CG(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),IS(this))}};function Cm(e,t,n,r,i){if(lu(e))return new eA(e,t,n,i);if(du(e))return new oA(e,t,n,r,i);if(gn(e))return new km(e,t,n,r,i);if(tO(e))return new nA(e,t,n,i);throw new Error($.invalidSpec(e))}function IW(e,t={}){t.logger&&Qz(t.logger),t.fieldTitle&&BN(t.fieldTitle);try{let n=Yw(Ts(t.config,e.config)),r=iS(e,n),i=Cm(r,null,"",void 0,n);return i.parse(),Hj(i.component.data,i),{spec:Vwe(i,Wwe(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&Jz(),t.fieldTitle&&tq()}}function Wwe(e,t,n,r){let i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):V(t)&&(t={type:t}),i&&o&&fG(t.type)){if(i==="step"&&o==="step")z($.droppingFit()),t.type="pad";else if(i==="step"||o==="step"){let s=i==="step"?"width":"height";z($.droppingFit(_l(s)));let a=s==="width"?"height":"width";t.type=dG(a)}}return{...P(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...lO(n,!1),...lO(e,!0)}}function Vwe(e,t,n={},r){let i=e.config?Rq(e.config):void 0,o=sW(e.component.data,n),s=e.assembleSelectionData(o),a=e.assembleProjections(),u=e.assembleTitle(),l=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0),f=e.assembleLayoutSignals();f=f.filter(m=>(m.name==="width"||m.name==="height")&&m.value!==void 0?(t[m.name]=+m.value,!1):!0);let{params:d,...p}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...p,...u?{title:u}:{},...l?{style:l}:{},...c?{encode:{update:c}}:{},data:s,...a.length>0?{projections:a}:{},...e.assembleGroup([...f,...e.assembleSelectionTopLevelSignals([]),...Vw(d)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}var Ywe=hz.version;function Xwe(e){let[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var aI=Xwe;var mI={};er(mI,{carbong10:()=>VSe,carbong100:()=>XSe,carbong90:()=>YSe,carbonwhite:()=>WSe,dark:()=>hSe,excel:()=>gSe,fivethirtyeight:()=>bSe,ggplot2:()=>ESe,googlecharts:()=>MSe,latimes:()=>ASe,powerbi:()=>HSe,quartz:()=>_Se,urbaninstitute:()=>DSe,version:()=>KSe,vox:()=>CSe});var Kwe="vega-themes",Qwe="2.15.0",Jwe="Themes for stylized Vega and Vega-Lite visualizations.",Zwe=["vega","vega-lite","themes","style"],eSe="BSD-3-Clause",tSe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},nSe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],rSe="build/vega-themes.js",iSe="build/vega-themes.module.js",oSe="build/vega-themes.min.js",sSe="build/vega-themes.min.js",aSe="build/vega-themes.module.d.ts",uSe={type:"git",url:"https://github.com/vega/vega-themes.git"},lSe=["src","build"],cSe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},fSe={"@babel/core":"^7.24.6","@babel/plugin-transform-runtime":"^7.24.6","@babel/preset-env":"^7.24.6","@babel/preset-typescript":"^7.24.6","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","browser-sync":"^3.0.2",concurrently:"^8.2.2",eslint:"^8.45.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.1.3","gh-pages":"^6.1.1",prettier:"^3.2.5","release-it":"^17.3.0",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.4.5",typescript:"^5.4.5",vega:"^5.25.0","vega-lite":"^5.9.3"},dSe={vega:"*","vega-lite":"*"},pSe={},mSe={name:Kwe,version:Qwe,description:Jwe,keywords:Zwe,license:eSe,author:tSe,contributors:nSe,main:rSe,module:iSe,unpkg:oSe,jsdelivr:sSe,types:aSe,repository:uSe,files:lSe,scripts:cSe,devDependencies:fSe,peerDependencies:dSe,dependencies:pSe},Fm="#fff",PW="#888",hSe={background:"#333",view:{stroke:PW},title:{color:Fm,subtitleColor:Fm},style:{"guide-label":{fill:Fm},"guide-title":{fill:Fm}},axis:{domainColor:Fm,gridColor:PW,tickColor:Fm}},_f="#4572a7",gSe={background:"#fff",arc:{fill:_f},area:{fill:_f},line:{stroke:_f,strokeWidth:2},path:{stroke:_f},rect:{fill:_f},shape:{stroke:_f},symbol:{fill:_f,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Cf="#30a2da",uI="#cbcbcb",ySe="#999",xSe="#333",$W="#f0f0f0",BW="#333",bSe={arc:{fill:Cf},area:{fill:Cf},axis:{domainColor:uI,grid:!0,gridColor:uI,gridWidth:1,labelColor:ySe,labelFontSize:10,titleColor:xSe,tickColor:uI,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:$W,group:{fill:$W},legend:{labelColor:BW,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:BW,titleFontSize:14,titlePadding:10},line:{stroke:Cf,strokeWidth:2},path:{stroke:Cf,strokeWidth:.5},rect:{fill:Cf},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Cf},bar:{binSpacing:2,fill:Cf,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},kf="#000",ESe={group:{fill:"#e5e5e5"},arc:{fill:kf},area:{fill:kf},line:{stroke:kf},path:{stroke:kf},rect:{fill:kf},shape:{stroke:kf},symbol:{fill:kf,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},vSe=22,wSe="normal",LW="Benton Gothic, sans-serif",UW=11.5,SSe="normal",Ff="#82c6df",lI="Benton Gothic Bold, sans-serif",zW="normal",HW=13,zy={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},ASe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:lI,fontSize:vSe,fontWeight:wSe},arc:{fill:Ff},area:{fill:Ff},line:{stroke:Ff,strokeWidth:2},path:{stroke:Ff},rect:{fill:Ff},shape:{stroke:Ff},symbol:{fill:Ff,size:30},axis:{labelFont:LW,labelFontSize:UW,labelFontWeight:SSe,titleFont:lI,titleFontSize:HW,titleFontWeight:zW},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:LW,labelFontSize:UW,symbolType:"square",titleFont:lI,titleFontSize:HW,titleFontWeight:zW},range:{category:zy["category-6"],diverging:zy["fireandice-6"],heatmap:zy["fire-7"],ordinal:zy["fire-7"],ramp:zy["fire-7"]}},Rf="#ab5787",sA="#979797",_Se={background:"#f9f9f9",arc:{fill:Rf},area:{fill:Rf},line:{stroke:Rf},path:{stroke:Rf},rect:{fill:Rf},shape:{stroke:Rf},symbol:{fill:Rf,size:30},axis:{domainColor:sA,domainWidth:.5,gridWidth:.2,labelColor:sA,tickColor:sA,tickWidth:.2,titleColor:sA},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Tf="#3e5c69",CSe={background:"#fff",arc:{fill:Tf},area:{fill:Tf},line:{stroke:Tf},path:{stroke:Tf},rect:{fill:Tf},shape:{stroke:Tf},symbol:{fill:Tf},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ko="#1696d2",qW="#000000",kSe="#FFFFFF",aA="Lato",cI="Lato",FSe="Lato",RSe="#DEDDDD",TSe=18,Hy={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},DSe={background:kSe,title:{anchor:"start",fontSize:TSe,font:aA},axisX:{domain:!0,domainColor:qW,domainWidth:1,grid:!1,labelFontSize:12,labelFont:cI,labelAngle:0,tickColor:qW,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:aA},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:RSe,gridWidth:1,labelFontSize:12,labelFont:cI,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:aA,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:cI,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:aA,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Hy["six-groups-cat-1"],diverging:Hy["diverging-colors"],heatmap:Hy["diverging-colors"],ordinal:Hy["six-groups-seq"],ramp:Hy["shades-blue"]},area:{fill:ko},rect:{fill:ko},line:{color:ko,stroke:ko,strokeWidth:5},trail:{color:ko,stroke:ko,strokeWidth:0,size:1},path:{stroke:ko,strokeWidth:.5},point:{filled:!0},text:{font:FSe,color:ko,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ko,stroke:null}},arc:{fill:ko},shape:{stroke:ko},symbol:{fill:ko,size:30}},Df="#3366CC",GW="#ccc",uA="Arial, sans-serif",MSe={arc:{fill:Df},area:{fill:Df},path:{stroke:Df},rect:{fill:Df},shape:{stroke:Df},symbol:{stroke:Df},circle:{fill:Df},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:uA,fontSize:12},"guide-title":{font:uA,fontSize:12},"group-title":{font:uA,fontSize:12}},title:{font:uA,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:GW,tickColor:GW,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},pI=e=>e*(1/3+1),jW=pI(9),WW=pI(10),VW=pI(12),qy="Segoe UI",YW="wf_standard-font, helvetica, arial, sans-serif",XW="#252423",Gy="#605E5C",KW="transparent",NSe="#C8C6C4",bs="#118DFF",OSe="#12239E",ISe="#E66C37",PSe="#6B007B",$Se="#E044A7",BSe="#744EC2",LSe="#D9B300",USe="#D64550",JW=bs,ZW="#DEEFFF",QW=[ZW,JW],zSe=[ZW,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",JW],HSe={view:{stroke:KW},background:KW,font:qy,header:{titleFont:YW,titleFontSize:VW,titleColor:XW,labelFont:qy,labelFontSize:WW,labelColor:Gy},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Gy,labelFontSize:jW,titleFont:YW,titleColor:XW,titleFontSize:VW,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:NSe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:bs},line:{stroke:bs,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:qy,fontSize:jW,fill:Gy},arc:{fill:bs},area:{fill:bs,line:!0,opacity:.6},path:{stroke:bs},rect:{fill:bs},point:{fill:bs,filled:!0,size:75},shape:{stroke:bs},symbol:{fill:bs,strokeWidth:1.5,size:50},legend:{titleFont:qy,titleFontWeight:"bold",titleColor:Gy,labelFont:qy,labelFontSize:WW,labelColor:Gy,symbolType:"circle",symbolSize:75},range:{category:[bs,OSe,ISe,PSe,$Se,BSe,LSe,USe],diverging:QW,heatmap:QW,ordinal:zSe}},fI='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',qSe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',dI=400,lA={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},GSe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],jSe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function cA({theme:e,background:t}){let n=["white","g10"].includes(e)?"light":"dark",r=lA.gridBg[e],i=lA.textPrimary[e],o=lA.textSecondary[e],s=n==="dark"?GSe:jSe,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:fI,fontWeight:600},axis:{labelColor:o,labelFontSize:12,labelFont:qSe,labelFontWeight:dI,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:lA.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:fI,fill:o,fontWeight:dI},"guide-title":{font:fI,fill:o,fontWeight:dI}},range:{category:s,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}var WSe=cA({theme:"white",background:"#ffffff"}),VSe=cA({theme:"g10",background:"#f4f4f4"}),YSe=cA({theme:"g90",background:"#262626"}),XSe=cA({theme:"g100",background:"#161616"}),KSe=mSe.version;var QSe="vega-tooltip",JSe="0.35.2",ZSe="A tooltip plugin for Vega-Lite and Vega visualizations.",eAe=["vega-lite","vega","tooltip"],tAe={type:"git",url:"https://github.com/vega/vega-tooltip.git"},nAe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},rAe=["Dominik Moritz","Sira Horradarn","Zening Qu","Kanit Wongsuphasawat","Yuri Astrakhan","Jeffrey Heer"],iAe="BSD-3-Clause",oAe={url:"https://github.com/vega/vega-tooltip/issues"},sAe="https://github.com/vega/vega-tooltip#readme",aAe="build/vega-tooltip.js",uAe="build/vega-tooltip.module.js",lAe="build/vega-tooltip.min.js",cAe="build/vega-tooltip.min.js",fAe="build/src/index.d.ts",dAe=["src","build","types"],pAe={prebuild:"npm run clean && npm run build:style",build:"rollup -c","build:style":"./build-style.sh",clean:"rimraf build && rimraf src/style.ts","copy:data":"cp -R node_modules/vega-datasets/data examples","copy:build":"cp -R build examples","deploy:gh":"npm run build && npm run copy:build && gh-pages -d examples && npm run clean",prepublishOnly:"npm run clean && npm run build",preversion:"npm run lint && npm run test",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"npm run build && concurrently --kill-others -n Server,Rollup 'npm run serve' 'rollup -c -w'",pretest:"npm run build:style",test:"jest","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand",prepare:"npm run copy:data",prettierbase:"prettier '*.{css,scss,html}'",format:"eslint . --fix && npm run prettierbase -- --write",lint:"eslint . && npm run prettierbase -- --check",release:"release-it"},mAe={"@babel/core":"^7.26.0","@babel/plugin-proposal-async-generator-functions":"^7.20.7","@babel/plugin-proposal-json-strings":"^7.18.6","@babel/plugin-proposal-object-rest-spread":"^7.20.7","@babel/plugin-proposal-optional-catch-binding":"^7.18.6","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/plugin-transform-runtime":"^7.25.9","@babel/preset-env":"^7.26.0","@babel/preset-typescript":"^7.26.0","@release-it/conventional-changelog":"^9.0.2","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.3.0","@rollup/plugin-terser":"^0.4.4","@rollup/plugin-typescript":"^12.1.1","@types/jest":"^29.5.14","@typescript-eslint/eslint-plugin":"^8.13.0","@typescript-eslint/parser":"^8.13.0","browser-sync":"^3.0.3",concurrently:"^9.1.0",eslint:"^8.46.0","eslint-config-prettier":"^9.1.0","eslint-plugin-jest":"^28.8.3","eslint-plugin-prettier":"^5.2.1","gh-pages":"^6.2.0",jest:"^29.7.0","jest-environment-jsdom":"^29.7.0",path:"^0.12.7",prettier:"^3.3.3","release-it":"^17.10.0",rollup:"^4.24.4","rollup-plugin-bundle-size":"^1.0.3",sass:"^1.80.6",typescript:"~5.6.3","vega-datasets":"^2.9.0","vega-typings":"^1.3.1"},hAe={"vega-util":"^1.17.2"},gAe={"@rollup/rollup-linux-x64-gnu":"^4.24.4"},yAe={name:QSe,version:JSe,description:ZSe,keywords:eAe,repository:tAe,author:nAe,collaborators:rAe,license:iAe,bugs:oAe,homepage:sAe,main:aAe,module:uAe,unpkg:lAe,jsdelivr:cAe,types:fAe,files:dAe,scripts:pAe,devDependencies:mAe,dependencies:hAe,optionalDependencies:gAe};function xAe(e,t,n,r){if(M(e))return`[${e.map(i=>t(V(i)?i:eV(i,n))).join(", ")}]`;if(X(e)){let i="",{title:o,image:s,...a}=e;o&&(i+=`<h2>${t(o)}</h2>`),s&&(i+=`<img src="${new URL(t(s),r||location.href).href}">`);let u=Object.keys(a);if(u.length>0){i+="<table>";for(let l of u){let c=a[l];c!==void 0&&(X(c)&&(c=eV(c,n)),i+=`<tr><td class="key">${t(l)}</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function bAe(e){let t=[];return function(n,r){if(typeof r!="object"||r===null)return r;let i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function eV(e,t){return JSON.stringify(e,bAe(t))}var EAe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`,tV="vg-tooltip-element",vAe={offsetX:10,offsetY:10,id:tV,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:wAe,maxDepth:2,formatTooltip:xAe,baseURL:"",anchor:"cursor",position:["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]};function wAe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function SAe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return EAe.toString().replace(tV,e)}function nV(e,t,{offsetX:n,offsetY:r}){let i=rV({x1:e.clientX,x2:e.clientX,y1:e.clientY,y2:e.clientY},t,n,r),o=["bottom-right","bottom-left","top-right","top-left"];for(let s of o)if(iV(i[s],t))return i[s];return i["top-left"]}function AAe(e,t,n,r,i){let{position:o,offsetX:s,offsetY:a}=i,u=e._el.getBoundingClientRect(),l=e._origin,c=_Ae(u,l,n),f=rV(c,r,s,a),d=Array.isArray(o)?o:[o];for(let p of d)if(iV(f[p],r)&&!CAe(t,f[p],r))return f[p];return nV(t,r,i)}function _Ae(e,t,n){let r=n.isVoronoi?n.datum.bounds:n.bounds,i=e.left+t[0]+r.x1,o=e.top+t[1]+r.y1,s=n;for(;s.mark.group;)s=s.mark.group,i+=s.x??0,o+=s.y??0;let a=r.x2-r.x1,u=r.y2-r.y1;return{x1:i,x2:i+a,y1:o,y2:o+u}}function rV(e,t,n,r){let i=(e.x1+e.x2)/2,o=(e.y1+e.y2)/2,s=e.x1-t.width-n,a=i-t.width/2,u=e.x2+n,l=e.y1-t.height-r,c=o-t.height/2,f=e.y2+r;return{top:{x:a,y:l},bottom:{x:a,y:f},left:{x:s,y:c},right:{x:u,y:c},"top-left":{x:s,y:l},"top-right":{x:u,y:l},"bottom-left":{x:s,y:f},"bottom-right":{x:u,y:f}}}function iV(e,t){return e.x>=0&&e.y>=0&&e.x+t.width<=window.innerWidth&&e.y+t.height<=window.innerHeight}function CAe(e,t,n){return e.clientX>=t.x&&e.clientX<=t.x+n.width&&e.clientY>=t.y&&e.clientY<=t.y+n.height}var fA=class{constructor(t){this.options={...vAe,...t};let n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){let r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=SAe(n);let i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);let{x:o,y:s}=this.options.anchor==="mark"?AAe(t,n,r,this.el.getBoundingClientRect(),this.options):nV(n,this.el.getBoundingClientRect(),this.options);this.el.style.top=`${s}px`,this.el.style.left=`${o}px`}},wft=yAe.version;var kAe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),FAe=Object.prototype.hasOwnProperty;function MI(e,t){return FAe.call(e,t)}function NI(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)MI(e,i)&&r.push(i);return r}function Gi(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function OI(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function Mf(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function FV(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function II(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(II(e[t]))return!0}else if(typeof e=="object"){for(var r=NI(e),i=r.length,o=0;o<i;o++)if(II(e[r[o]]))return!0}}return!1}function oV(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var RV=function(e){kAe(t,e);function t(n,r,i,o,s){var a=this.constructor,u=e.call(this,oV(n,{name:r,index:i,operation:o,tree:s}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=s,Object.setPrototypeOf(u,a.prototype),u.message=oV(n,{name:r,index:i,operation:o,tree:s}),u}return t}(Error),qt=RV,RAe=Gi,Rm={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=pA(n,this.path);r&&(r=Gi(r));var i=Nf(n,{op:"remove",path:this.from}).removed;return Nf(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=pA(n,this.from);return Nf(n,{op:"add",path:this.path,value:Gi(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Wy(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},TAe={add:function(e,t,n){return OI(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Rm.move,copy:Rm.copy,test:Rm.test,_get:Rm._get};function pA(e,t){if(t=="")return e;var n={op:"_get",path:t};return Nf(e,n),n.value}function Nf(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):mA(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=pA(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=Wy(e,t.value),s.test===!1)throw new qt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new qt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{r||(e=Gi(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,p=void 0,m=void 0;for(typeof n=="function"?m=n:m=mA;;){if(p=u[c],p&&p.indexOf("~")!=-1&&(p=FV(p)),i&&(p=="__proto__"||p=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[p]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&m(t,0,e,d)),c++,Array.isArray(l)){if(p==="-")p=l.length;else{if(n&&!OI(p))throw new qt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);OI(p)&&(p=~~p)}if(c>=f){if(n&&t.op==="add"&&p>l.length)throw new qt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=TAe[t.op].call(t,l,p,e);if(s.test===!1)throw new qt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=f){var s=Rm[t.op].call(t,l,p,e);if(s.test===!1)throw new qt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(l=l[p],n&&c<f&&(!l||typeof l!="object"))throw new qt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function gA(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new qt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Gi(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=Nf(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function DAe(e,t,n){var r=Nf(e,t);if(r.test===!1)throw new qt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function mA(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new qt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Rm[e.op]){if(typeof e.path!="string")throw new qt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new qt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new qt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new qt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&II(e.value))throw new qt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new qt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new qt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=TV([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new qt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new qt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function TV(e,t,n){try{if(!Array.isArray(e))throw new qt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)gA(Gi(t),Gi(e),n||!0);else{n=n||mA;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof qt)return i;throw i}}function Wy(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,s;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!Wy(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(i=o;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;i--!==0;)if(s=a[i],!Wy(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}var MAe=Object.freeze({__proto__:null,JsonPatchError:qt,_areEquals:Wy,applyOperation:Nf,applyPatch:gA,applyReducer:DAe,deepClone:RAe,getValueByPointer:pA,validate:TV,validator:mA});var $I=new WeakMap,NAe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),OAe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function IAe(e){return $I.get(e)}function PAe(e,t){return e.observers.get(t)}function $Ae(e,t){e.observers.delete(t.callback)}function BAe(e,t){t.unobserve()}function LAe(e,t){var n=[],r,i=IAe(e);if(!i)i=new NAe(e),$I.set(e,i);else{var o=PAe(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=Gi(e),t){r.callback=t,r.next=null;var s=function(){PI(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){PI(r),clearTimeout(r.next),$Ae(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new OAe(t,r)),r}function PI(e,t){t===void 0&&(t=!1);var n=$I.get(e.object);BI(n.value,e.object,e.patches,"",t),e.patches.length&&gA(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function BI(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=NI(t),s=NI(e),a=!1,u=s.length-1;u>=0;u--){var l=s[u],c=e[l];if(MI(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?BI(c,f,n,r+"/"+Mf(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+Mf(l),value:Gi(c)}),n.push({op:"replace",path:r+"/"+Mf(l),value:Gi(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+Mf(l),value:Gi(c)}),n.push({op:"remove",path:r+"/"+Mf(l)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&o.length==s.length))for(var u=0;u<o.length;u++){var l=o[u];!MI(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Mf(l),value:Gi(t[l])})}}}function UAe(e,t,n){n===void 0&&(n=!1);var r=[];return BI(e,t,r,"",n),r}var zAe=Object.freeze({__proto__:null,compare:UAe,generate:PI,observe:LAe,unobserve:BAe});Object.assign({},MAe,zAe,{JsonPatchError:RV,deepClone:Gi,escapePathComponent:Mf,unescapePathComponent:FV});function HAe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hI,sV;function qAe(){if(sV)return hI;sV=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){let r=this.map.get(n);if(r!==void 0)return this.map.delete(n),this.map.set(n,r),r}delete(n){return this.map.delete(n)}set(n,r){if(!this.delete(n)&&r!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(n,r)}return this}}return hI=e,hI}var gI,aV;function LI(){if(aV)return gI;aV=1;let e=Object.freeze({loose:!0}),t=Object.freeze({});return gI=r=>r?typeof r!="object"?e:r:t,gI}var dA={exports:{}},yI,uV;function UI(){if(uV)return yI;uV=1;let e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,i=t-6;return yI={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},yI}var xI,lV;function yA(){return lV||(lV=1,xI=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{}),xI}var cV;function zI(){return cV||(cV=1,function(e,t){let{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=UI(),o=yA();t=e.exports={};let s=t.re=[],a=t.safeRe=[],u=t.src=[],l=t.t={},c=0,f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],p=h=>{for(let[g,y]of d)h=h.split(`${g}*`).join(`${g}{0,${y}}`).split(`${g}+`).join(`${g}{1,${y}}`);return h},m=(h,g,y)=>{let x=p(g),b=c++;o(h,b,g),l[h]=b,u[b]=g,s[b]=new RegExp(g,y?"g":void 0),a[b]=new RegExp(x,y?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),m("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),m("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${f}+`),m("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),m("FULL",`^${u[l.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),m("LOOSE",`^${u[l.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),m("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),m("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?(?:${u[l.BUILD]})?(?:$|[^\\d])`),m("COERCERTL",u[l.COERCE],!0),m("COERCERTLFULL",u[l.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",m("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",m("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(dA,dA.exports)),dA.exports}var bI,fV;function GAe(){if(fV)return bI;fV=1;let e=/^[0-9]+$/,t=(r,i)=>{let o=e.test(r),s=e.test(i);return o&&s&&(r=+r,i=+i),r===i?0:o&&!s?-1:s&&!o?1:r<i?-1:1};return bI={compareIdentifiers:t,rcompareIdentifiers:(r,i)=>t(i,r)},bI}var EI,dV;function HI(){if(dV)return EI;dV=1;let e=yA(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=UI(),{safeRe:r,t:i}=zI(),o=LI(),{compareIdentifiers:s}=GAe();class a{constructor(l,c){if(c=o(c),l instanceof a){if(l.loose===!!c.loose&&l.includePrerelease===!!c.includePrerelease)return l;l=l.version}else if(typeof l!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof l}".`);if(l.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",l,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;let f=l.trim().match(c.loose?r[i.LOOSE]:r[i.FULL]);if(!f)throw new TypeError(`Invalid Version: ${l}`);if(this.raw=l,this.major=+f[1],this.minor=+f[2],this.patch=+f[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");f[4]?this.prerelease=f[4].split(".").map(d=>{if(/^[0-9]+$/.test(d)){let p=+d;if(p>=0&&p<n)return p}return d}):this.prerelease=[],this.build=f[5]?f[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(l){if(e("SemVer.compare",this.version,this.options,l),!(l instanceof a)){if(typeof l=="string"&&l===this.version)return 0;l=new a(l,this.options)}return l.version===this.version?0:this.compareMain(l)||this.comparePre(l)}compareMain(l){return l instanceof a||(l=new a(l,this.options)),s(this.major,l.major)||s(this.minor,l.minor)||s(this.patch,l.patch)}comparePre(l){if(l instanceof a||(l=new a(l,this.options)),this.prerelease.length&&!l.prerelease.length)return-1;if(!this.prerelease.length&&l.prerelease.length)return 1;if(!this.prerelease.length&&!l.prerelease.length)return 0;let c=0;do{let f=this.prerelease[c],d=l.prerelease[c];if(e("prerelease compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return s(f,d)}while(++c)}compareBuild(l){l instanceof a||(l=new a(l,this.options));let c=0;do{let f=this.build[c],d=l.build[c];if(e("build compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return s(f,d)}while(++c)}inc(l,c,f){switch(l){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,f);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,f);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,f),this.inc("pre",c,f);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,f),this.inc("pre",c,f);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let d=Number(f)?1:0;if(!c&&f===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[d];else{let p=this.prerelease.length;for(;--p>=0;)typeof this.prerelease[p]=="number"&&(this.prerelease[p]++,p=-2);if(p===-1){if(c===this.prerelease.join(".")&&f===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(d)}}if(c){let p=[c,d];f===!1&&(p=[c]),s(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=p):this.prerelease=p}break}default:throw new Error(`invalid increment argument: ${l}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return EI=a,EI}var vI,pV;function Tm(){if(pV)return vI;pV=1;let e=HI();return vI=(n,r,i)=>new e(n,i).compare(new e(r,i)),vI}var wI,mV;function jAe(){if(mV)return wI;mV=1;let e=Tm();return wI=(n,r,i)=>e(n,r,i)===0,wI}var SI,hV;function WAe(){if(hV)return SI;hV=1;let e=Tm();return SI=(n,r,i)=>e(n,r,i)!==0,SI}var AI,gV;function VAe(){if(gV)return AI;gV=1;let e=Tm();return AI=(n,r,i)=>e(n,r,i)>0,AI}var _I,yV;function YAe(){if(yV)return _I;yV=1;let e=Tm();return _I=(n,r,i)=>e(n,r,i)>=0,_I}var CI,xV;function XAe(){if(xV)return CI;xV=1;let e=Tm();return CI=(n,r,i)=>e(n,r,i)<0,CI}var kI,bV;function KAe(){if(bV)return kI;bV=1;let e=Tm();return kI=(n,r,i)=>e(n,r,i)<=0,kI}var FI,EV;function QAe(){if(EV)return FI;EV=1;let e=jAe(),t=WAe(),n=VAe(),r=YAe(),i=XAe(),o=KAe();return FI=(a,u,l,c)=>{switch(u){case"===":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a===l;case"!==":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a!==l;case"":case"=":case"==":return e(a,l,c);case"!=":return t(a,l,c);case">":return n(a,l,c);case">=":return r(a,l,c);case"<":return i(a,l,c);case"<=":return o(a,l,c);default:throw new TypeError(`Invalid operator: ${u}`)}},FI}var RI,vV;function JAe(){if(vV)return RI;vV=1;let e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),s("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(c){let f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(s("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return o(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||o(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||o(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}RI=t;let n=LI(),{safeRe:r,t:i}=zI(),o=QAe(),s=yA(),a=HI(),u=DV();return RI}var TI,wV;function DV(){if(wV)return TI;wV=1;let e=/\s+/g;class t{constructor(k,C){if(C=i(C),k instanceof t)return k.loose===!!C.loose&&k.includePrerelease===!!C.includePrerelease?k:new t(k.raw,C);if(k instanceof o)return this.raw=k.value,this.set=[[k]],this.formatted=void 0,this;if(this.options=C,this.loose=!!C.loose,this.includePrerelease=!!C.includePrerelease,this.raw=k.trim().replace(e," "),this.set=this.raw.split("||").map(N=>this.parseRange(N.trim())).filter(N=>N.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let N=this.set[0];if(this.set=this.set.filter(I=>!h(I[0])),this.set.length===0)this.set=[N];else if(this.set.length>1){for(let I of this.set)if(I.length===1&&g(I[0])){this.set=[I];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let k=0;k<this.set.length;k++){k>0&&(this.formatted+="||");let C=this.set[k];for(let N=0;N<C.length;N++)N>0&&(this.formatted+=" "),this.formatted+=C[N].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(k){let N=((this.options.includePrerelease&&p)|(this.options.loose&&m))+":"+k,I=r.get(N);if(I)return I;let L=this.options.loose,te=L?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];k=k.replace(te,D(this.options.includePrerelease)),s("hyphen replace",k),k=k.replace(u[l.COMPARATORTRIM],c),s("comparator trim",k),k=k.replace(u[l.TILDETRIM],f),s("tilde trim",k),k=k.replace(u[l.CARETTRIM],d),s("caret trim",k);let ie=k.split(" ").map(we=>x(we,this.options)).join(" ").split(/\s+/).map(we=>R(we,this.options));L&&(ie=ie.filter(we=>(s("loose invalid filter",we,this.options),!!we.match(u[l.COMPARATORLOOSE])))),s("range list",ie);let oe=new Map,Se=ie.map(we=>new o(we,this.options));for(let we of Se){if(h(we))return[we];oe.set(we.value,we)}oe.size>1&&oe.has("")&&oe.delete("");let Oe=[...oe.values()];return r.set(N,Oe),Oe}intersects(k,C){if(!(k instanceof t))throw new TypeError("a Range is required");return this.set.some(N=>y(N,C)&&k.set.some(I=>y(I,C)&&N.every(L=>I.every(te=>L.intersects(te,C)))))}test(k){if(!k)return!1;if(typeof k=="string")try{k=new a(k,this.options)}catch{return!1}for(let C=0;C<this.set.length;C++)if(O(this.set[C],k,this.options))return!0;return!1}}TI=t;let n=qAe(),r=new n,i=LI(),o=JAe(),s=yA(),a=HI(),{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:d}=zI(),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:m}=UI(),h=T=>T.value==="<0.0.0-0",g=T=>T.value==="",y=(T,k)=>{let C=!0,N=T.slice(),I=N.pop();for(;C&&N.length;)C=N.every(L=>I.intersects(L,k)),I=N.pop();return C},x=(T,k)=>(s("comp",T,k),T=S(T,k),s("caret",T),T=E(T,k),s("tildes",T),T=_(T,k),s("xrange",T),T=F(T,k),s("stars",T),T),b=T=>!T||T.toLowerCase()==="x"||T==="*",E=(T,k)=>T.trim().split(/\s+/).map(C=>v(C,k)).join(" "),v=(T,k)=>{let C=k.loose?u[l.TILDELOOSE]:u[l.TILDE];return T.replace(C,(N,I,L,te,ie)=>{s("tilde",T,N,I,L,te,ie);let oe;return b(I)?oe="":b(L)?oe=`>=${I}.0.0 <${+I+1}.0.0-0`:b(te)?oe=`>=${I}.${L}.0 <${I}.${+L+1}.0-0`:ie?(s("replaceTilde pr",ie),oe=`>=${I}.${L}.${te}-${ie} <${I}.${+L+1}.0-0`):oe=`>=${I}.${L}.${te} <${I}.${+L+1}.0-0`,s("tilde return",oe),oe})},S=(T,k)=>T.trim().split(/\s+/).map(C=>w(C,k)).join(" "),w=(T,k)=>{s("caret",T,k);let C=k.loose?u[l.CARETLOOSE]:u[l.CARET],N=k.includePrerelease?"-0":"";return T.replace(C,(I,L,te,ie,oe)=>{s("caret",T,I,L,te,ie,oe);let Se;return b(L)?Se="":b(te)?Se=`>=${L}.0.0${N} <${+L+1}.0.0-0`:b(ie)?L==="0"?Se=`>=${L}.${te}.0${N} <${L}.${+te+1}.0-0`:Se=`>=${L}.${te}.0${N} <${+L+1}.0.0-0`:oe?(s("replaceCaret pr",oe),L==="0"?te==="0"?Se=`>=${L}.${te}.${ie}-${oe} <${L}.${te}.${+ie+1}-0`:Se=`>=${L}.${te}.${ie}-${oe} <${L}.${+te+1}.0-0`:Se=`>=${L}.${te}.${ie}-${oe} <${+L+1}.0.0-0`):(s("no pr"),L==="0"?te==="0"?Se=`>=${L}.${te}.${ie}${N} <${L}.${te}.${+ie+1}-0`:Se=`>=${L}.${te}.${ie}${N} <${L}.${+te+1}.0-0`:Se=`>=${L}.${te}.${ie} <${+L+1}.0.0-0`),s("caret return",Se),Se})},_=(T,k)=>(s("replaceXRanges",T,k),T.split(/\s+/).map(C=>A(C,k)).join(" ")),A=(T,k)=>{T=T.trim();let C=k.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return T.replace(C,(N,I,L,te,ie,oe)=>{s("xRange",T,N,I,L,te,ie,oe);let Se=b(L),Oe=Se||b(te),we=Oe||b(ie),Qt=we;return I==="="&&Qt&&(I=""),oe=k.includePrerelease?"-0":"",Se?I===">"||I==="<"?N="<0.0.0-0":N="*":I&&Qt?(Oe&&(te=0),ie=0,I===">"?(I=">=",Oe?(L=+L+1,te=0,ie=0):(te=+te+1,ie=0)):I==="<="&&(I="<",Oe?L=+L+1:te=+te+1),I==="<"&&(oe="-0"),N=`${I+L}.${te}.${ie}${oe}`):Oe?N=`>=${L}.0.0${oe} <${+L+1}.0.0-0`:we&&(N=`>=${L}.${te}.0${oe} <${L}.${+te+1}.0-0`),s("xRange return",N),N})},F=(T,k)=>(s("replaceStars",T,k),T.trim().replace(u[l.STAR],"")),R=(T,k)=>(s("replaceGTE0",T,k),T.trim().replace(u[k.includePrerelease?l.GTE0PRE:l.GTE0],"")),D=T=>(k,C,N,I,L,te,ie,oe,Se,Oe,we,Qt)=>(b(N)?C="":b(I)?C=`>=${N}.0.0${T?"-0":""}`:b(L)?C=`>=${N}.${I}.0${T?"-0":""}`:te?C=`>=${C}`:C=`>=${C}${T?"-0":""}`,b(Se)?oe="":b(Oe)?oe=`<${+Se+1}.0.0-0`:b(we)?oe=`<${Se}.${+Oe+1}.0-0`:Qt?oe=`<=${Se}.${Oe}.${we}-${Qt}`:T?oe=`<${Se}.${Oe}.${+we+1}-0`:oe=`<=${oe}`,`${C} ${oe}`.trim()),O=(T,k,C)=>{for(let N=0;N<T.length;N++)if(!T[N].test(k))return!1;if(k.prerelease.length&&!C.includePrerelease){for(let N=0;N<T.length;N++)if(s(T[N].semver),T[N].semver!==o.ANY&&T[N].semver.prerelease.length>0){let I=T[N].semver;if(I.major===k.major&&I.minor===k.minor&&I.patch===k.patch)return!0}return!1}return!0};return TI}var DI,SV;function ZAe(){if(SV)return DI;SV=1;let e=DV();return DI=(n,r,i)=>{try{r=new e(r,i)}catch{return!1}return r.test(n)},DI}var e_e=ZAe(),MV=HAe(e_e);function t_e(e,t,n){let r=e.open(t),i=1e4,o=250,{origin:s}=new URL(t),a=~~(i/o);function u(c){c.source===r&&(a=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){a<=0||(r.postMessage(n,s),setTimeout(l,o),a-=1)}setTimeout(l,o)}var n_e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function NV(e,...t){for(let n of t)r_e(e,n);return e}function r_e(e,t){for(let n of Object.keys(t))wa(e,n,t[n],!0)}var i_e="vega-embed",o_e="6.29.0",s_e="Publish Vega visualizations as embedded web components.",a_e=["vega","data","visualization","component","embed"],u_e={type:"git",url:"http://github.com/vega/vega-embed.git"},l_e={name:"UW Interactive Data Lab",url:"http://idl.cs.washington.edu"},c_e=[{name:"Dominik Moritz",url:"https://www.domoritz.de"}],f_e={url:"https://github.com/vega/vega-embed/issues"},d_e="https://github.com/vega/vega-embed#readme",p_e="BSD-3-Clause",m_e="build/vega-embed.js",h_e="build/vega-embed.module.js",g_e="build/vega-embed.min.js",y_e="build/vega-embed.min.js",x_e="build/src/embed.d.ts",b_e=["src","build"],E_e={".":{import:{types:"./build/src/embed.d.ts",default:"./build/vega-embed.module.js"},require:{default:"./build/vega-embed.js"}}},v_e={"@babel/core":"^7.26.0","@babel/eslint-parser":"^7.25.9","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/plugin-transform-runtime":"^7.25.9","@babel/preset-env":"^7.26.0","@babel/preset-typescript":"^7.26.0","@release-it/conventional-changelog":"^9.0.3","@rollup/plugin-commonjs":"28.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.3.0","@rollup/plugin-terser":"^0.4.4","@rollup/plugin-typescript":"^12.1.1","@types/semver":"^7.5.8","@typescript-eslint/parser":"^8.15.0","@vitest/coverage-istanbul":"^2.1.5","browser-sync":"^3.0.3",concurrently:"^9.1.0","del-cli":"^6.0.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.2.1","eslint-plugin-vitest":"^0.5.4",eslint:"^9.15.0",jsdom:"^25.0.1","postinstall-postinstall":"^2.1.0",prettier:"^3.3.3","release-it":"^17.10.0","rollup-plugin-bundle-size":"^1.0.3",rollup:"4.27.3",sass:"^1.81.0","typescript-eslint":"^8.15.0",typescript:"^5.6.3","vega-lite":"^5.21.0",vega:"^5.30.0","vitest-canvas-mock":"^0.3.3",vitest:"^2.1.5"},w_e={vega:"^5.21.0","vega-lite":"*"},S_e={"fast-json-patch":"^3.1.1","json-stringify-pretty-compact":"^4.0.0",semver:"^7.6.3",tslib:"^2.8.1","vega-interpreter":"^1.0.5","vega-schema-url-parser":"^2.2.0","vega-themes":"^2.15.0","vega-tooltip":"^0.35.2"},A_e={prebuild:"npm run clean && npm run build:style",build:"rollup -c","build:style":"./build-style.sh",clean:"del-cli build src/style.ts",prepublishOnly:"npm run clean && npm run build",preversion:"npm run lint && npm run test",serve:"browser-sync start --directory -s -f build *.html",start:"npm run build && concurrently --kill-others -n Server,Rollup 'npm run serve' 'rollup -c -w'",pretest:"npm run build:style",test:"vitest run",prettierbase:"prettier '*.{css,scss,html}'",format:"eslint . --fix && npm run prettierbase -- --write",lint:"eslint . && npm run prettierbase -- --check",release:"release-it"},__e={name:i_e,version:o_e,description:s_e,keywords:a_e,repository:u_e,author:l_e,contributors:c_e,bugs:f_e,homepage:d_e,license:p_e,main:m_e,module:h_e,unpkg:g_e,jsdelivr:y_e,types:x_e,files:b_e,exports:E_e,devDependencies:v_e,peerDependencies:w_e,dependencies:S_e,scripts:A_e},Rft=__e.version,ga=XM,Vy=sI,AV=typeof window<"u"?window:void 0;Vy===void 0&&AV?.vl?.compile&&(Vy=AV.vl);var C_e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},k_e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},jy={vega:"Vega","vega-lite":"Vega-Lite"},hA={vega:ga.version,"vega-lite":Vy?Vy.version:"not available"},F_e={vega:e=>e,"vega-lite":(e,t)=>Vy.compile(e,{config:t}).spec},R_e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,T_e="chart-wrapper";function D_e(e){return typeof e=="function"}function _V(e,t,n,r){let i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+e+o),s.document.title=`${jy[r]} JSON Source`}function M_e(e,t){if(e.$schema){let n=aI(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${jy[n.library]}, but mode argument sets ${jy[t]??t}.`);let r=n.library;return MV(hA[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${jy[r]} ${n.version}, but the current version of ${jy[r]} is v${hA[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function OV(e){return!!(e&&"load"in e)}function CV(e){return OV(e)?e:ga.loader(e)}function N_e(e){let t=e.usermeta?.embedOptions??{};return V(t.defaultStyle)&&(t.defaultStyle=!1),t}async function Yy(e,t,n={}){let r,i;V(t)?(i=CV(n.loader),r=JSON.parse(await i.load(t))):r=t;let o=N_e(r),s=o.loader;(!i||s)&&(i=CV(n.loader??s));let a=await kV(o,i),u=await kV(n,i),l={...NV(u,a),config:Ts(u.config??{},a.config??{})};return await I_e(e,r,l,i)}async function kV(e,t){let n=V(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=V(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...r?{patch:r}:{},...n?{config:n}:{}}}function O_e(e){let t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function I_e(e,t,n={},r){let i=n.theme?Ts(mI[n.theme],n.config??{}):n.config,o=Zr(n.actions)?n.actions:NV({},C_e,n.actions??{}),s={...k_e,...n.i18n},a=n.renderer??"canvas",u=n.logLevel??ga.Warn,l=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){let v="vega-embed-style",{root:S,rootContainer:w}=O_e(c);if(!S.getElementById(v)){let _=document.createElement("style");_.id=v,_.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?n_e.toString():n.defaultStyle,w.appendChild(_)}}let f=M_e(t,n.mode),d=F_e[f](t,i);if(f==="vega-lite"&&d.$schema){let v=aI(d.$schema);MV(hA.vega,`^${v.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${v.version}, but current version is v${hA.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions"),c.innerHTML="";let p=c;if(o){let v=document.createElement("div");v.classList.add(T_e),c.appendChild(v),p=v}let m=n.patch;if(m&&(d=m instanceof Function?m(d):gA(d,m,!0,!1).newDocument),n.formatLocale&&ga.formatLocale(n.formatLocale),n.timeFormatLocale&&ga.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(let v in n.expressionFunctions){let S=n.expressionFunctions[v];"fn"in S?ga.expressionFunction(v,S.fn,S.visitor):S instanceof Function&&ga.expressionFunction(v,S)}let{ast:h}=n,g=ga.parse(d,f==="vega-lite"?{}:i,{ast:h}),y=new(n.viewClass||ga.View)(g,{loader:r,logLevel:u,renderer:a,...h?{expr:ga.expressionInterpreter??n.expr??mz}:{}});if(y.addSignalListener("autosize",(v,S)=>{let{type:w}=S;w=="fit-x"?(p.classList.add("fit-x"),p.classList.remove("fit-y")):w=="fit-y"?(p.classList.remove("fit-x"),p.classList.add("fit-y")):w=="fit"?p.classList.add("fit-x","fit-y"):p.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){let{loader:v,tooltip:S}=n,w=v&&!OV(v)?v?.baseURL:void 0,_=D_e(S)?S:new fA({baseURL:w,...S===!0?{}:S}).call;y.tooltip(_)}let{hover:x}=n;if(x===void 0&&(x=f==="vega"),x){let{hoverSet:v,updateSet:S}=typeof x=="boolean"?{}:x;y.hover(v,S)}n&&(n.width!=null&&y.width(n.width),n.height!=null&&y.height(n.height),n.padding!=null&&y.padding(n.padding)),await y.initialize(p,n.bind).runAsync();let b;if(o!==!1){let v=c;if(n.defaultStyle!==!1||n.forceActionsMenu){let w=document.createElement("details");w.title=s.CLICK_TO_VIEW_ACTIONS,c.append(w),v=w;let _=document.createElement("summary");_.innerHTML=R_e,w.append(_),b=A=>{w.contains(A.target)||w.removeAttribute("open")},document.addEventListener("click",b)}let S=document.createElement("div");if(v.append(S),S.classList.add("vega-actions"),o===!0||o.export!==!1){for(let w of["svg","png"])if(o===!0||o.export===!0||o.export[w]){let _=s[`${w.toUpperCase()}_ACTION`],A=document.createElement("a"),F=X(n.scaleFactor)?n.scaleFactor[w]:n.scaleFactor;A.text=_,A.href="#",A.target="_blank",A.download=`${l}.${w}`,A.addEventListener("mousedown",async function(R){R.preventDefault();let D=await y.toImageURL(w,F);this.href=D}),S.append(A)}}if(o===!0||o.source!==!1){let w=document.createElement("a");w.text=s.SOURCE_ACTION,w.href="#",w.addEventListener("click",function(_){_V(Ym(t),n.sourceHeader??"",n.sourceFooter??"",f),_.preventDefault()}),S.append(w)}if(f==="vega-lite"&&(o===!0||o.compiled!==!1)){let w=document.createElement("a");w.text=s.COMPILED_ACTION,w.href="#",w.addEventListener("click",function(_){_V(Ym(d),n.sourceHeader??"",n.sourceFooter??"","vega"),_.preventDefault()}),S.append(w)}if(o===!0||o.editor!==!1){let w=n.editorUrl??"https://vega.github.io/editor/",_=document.createElement("a");_.text=s.EDITOR_ACTION,_.href="#",_.addEventListener("click",function(A){t_e(window,w,{config:i,mode:m?"vega":f,renderer:a,spec:Ym(m?d:t)}),A.preventDefault()}),S.append(_)}}function E(){b&&document.removeEventListener("click",b),y.finalize()}return{view:y,spec:t,vgSpec:d,finalize:E,embedOptions:n}}var P_e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};var de=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,n=0,r={},i={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function h(g){return g instanceof o?new o(g.type,h(g.content),g.alias):Array.isArray(g)?g.map(h):g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(h){return Object.prototype.toString.call(h).slice(8,-1)},objId:function(h){return h.__id||Object.defineProperty(h,"__id",{value:++n}),h.__id},clone:function h(g,y){y=y||{};var x,b;switch(i.util.type(g)){case"Object":if(b=i.util.objId(g),y[b])return y[b];x={},y[b]=x;for(var E in g)g.hasOwnProperty(E)&&(x[E]=h(g[E],y));return x;case"Array":return b=i.util.objId(g),y[b]?y[b]:(x=[],y[b]=x,g.forEach(function(v,S){x[S]=h(v,y)}),x);default:return g}},getLanguage:function(h){for(;h;){var g=t.exec(h.className);if(g)return g[1].toLowerCase();h=h.parentElement}return"none"},setLanguage:function(h,g){h.className=h.className.replace(RegExp(t,"gi"),""),h.classList.add("language-"+g)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(x){var h=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(x.stack)||[])[1];if(h){var g=document.getElementsByTagName("script");for(var y in g)if(g[y].src==h)return g[y]}return null}},isActive:function(h,g,y){for(var x="no-"+g;h;){var b=h.classList;if(b.contains(g))return!0;if(b.contains(x))return!1;h=h.parentElement}return!!y}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(h,g){var y=i.util.clone(i.languages[h]);for(var x in g)y[x]=g[x];return y},insertBefore:function(h,g,y,x){x=x||i.languages;var b=x[h],E={};for(var v in b)if(b.hasOwnProperty(v)){if(v==g)for(var S in y)y.hasOwnProperty(S)&&(E[S]=y[S]);y.hasOwnProperty(v)||(E[v]=b[v])}var w=x[h];return x[h]=E,i.languages.DFS(i.languages,function(_,A){A===w&&_!=h&&(this[_]=E)}),E},DFS:function h(g,y,x,b){b=b||{};var E=i.util.objId;for(var v in g)if(g.hasOwnProperty(v)){y.call(g,v,g[v],x||v);var S=g[v],w=i.util.type(S);w==="Object"&&!b[E(S)]?(b[E(S)]=!0,h(S,y,null,b)):w==="Array"&&!b[E(S)]&&(b[E(S)]=!0,h(S,y,v,b))}}},plugins:{},highlightAll:function(h,g){i.highlightAllUnder(document,h,g)},highlightAllUnder:function(h,g,y){var x={callback:y,container:h,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",x),x.elements=Array.prototype.slice.apply(x.container.querySelectorAll(x.selector)),i.hooks.run("before-all-elements-highlight",x);for(var b=0,E;E=x.elements[b++];)i.highlightElement(E,g===!0,x.callback)},highlightElement:function(h,g,y){var x=i.util.getLanguage(h),b=i.languages[x];i.util.setLanguage(h,x);var E=h.parentElement;E&&E.nodeName.toLowerCase()==="pre"&&i.util.setLanguage(E,x);var v=h.textContent,S={element:h,language:x,grammar:b,code:v};function w(A){S.highlightedCode=A,i.hooks.run("before-insert",S),S.element.innerHTML=S.highlightedCode,i.hooks.run("after-highlight",S),i.hooks.run("complete",S),y&&y.call(S.element)}if(i.hooks.run("before-sanity-check",S),E=S.element.parentElement,E&&E.nodeName.toLowerCase()==="pre"&&!E.hasAttribute("tabindex")&&E.setAttribute("tabindex","0"),!S.code){i.hooks.run("complete",S),y&&y.call(S.element);return}if(i.hooks.run("before-highlight",S),!S.grammar){w(i.util.encode(S.code));return}if(g&&e.Worker){var _=new Worker(i.filename);_.onmessage=function(A){w(A.data)},_.postMessage(JSON.stringify({language:S.language,code:S.code,immediateClose:!0}))}else w(i.highlight(S.code,S.grammar,S.language))},highlight:function(h,g,y){var x={code:h,grammar:g,language:y};return i.hooks.run("before-tokenize",x),x.tokens=i.tokenize(x.code,x.grammar),i.hooks.run("after-tokenize",x),o.stringify(i.util.encode(x.tokens),x.language)},tokenize:function(h,g){var y=g.rest;if(y){for(var x in y)g[x]=y[x];delete g.rest}var b=new u;return l(b,b.head,h),a(h,b,g,b.head,0),f(b)},hooks:{all:{},add:function(h,g){var y=i.hooks.all;y[h]=y[h]||[],y[h].push(g)},run:function(h,g){var y=i.hooks.all[h];if(!(!y||!y.length))for(var x=0,b;b=y[x++];)b(g)}},Token:o};e.Prism=i;function o(h,g,y,x){this.type=h,this.content=g,this.alias=y,this.length=(x||"").length|0}o.stringify=function h(g,y){if(typeof g=="string")return g;if(Array.isArray(g)){var x="";return g.forEach(function(w){x+=h(w,y)}),x}var b={type:g.type,content:h(g.content,y),tag:"span",classes:["token",g.type],attributes:{},language:y},E=g.alias;E&&(Array.isArray(E)?Array.prototype.push.apply(b.classes,E):b.classes.push(E)),i.hooks.run("wrap",b);var v="";for(var S in b.attributes)v+=" "+S+'="'+(b.attributes[S]||"").replace(/"/g,"&quot;")+'"';return"<"+b.tag+' class="'+b.classes.join(" ")+'"'+v+">"+b.content+"</"+b.tag+">"};function s(h,g,y,x){h.lastIndex=g;var b=h.exec(y);if(b&&x&&b[1]){var E=b[1].length;b.index+=E,b[0]=b[0].slice(E)}return b}function a(h,g,y,x,b,E){for(var v in y)if(!(!y.hasOwnProperty(v)||!y[v])){var S=y[v];S=Array.isArray(S)?S:[S];for(var w=0;w<S.length;++w){if(E&&E.cause==v+","+w)return;var _=S[w],A=_.inside,F=!!_.lookbehind,R=!!_.greedy,D=_.alias;if(R&&!_.pattern.global){var O=_.pattern.toString().match(/[imsuy]*$/)[0];_.pattern=RegExp(_.pattern.source,O+"g")}for(var T=_.pattern||_,k=x.next,C=b;k!==g.tail&&!(E&&C>=E.reach);C+=k.value.length,k=k.next){var N=k.value;if(g.length>h.length)return;if(!(N instanceof o)){var I=1,L;if(R){if(L=s(T,C,h,F),!L||L.index>=h.length)break;var Se=L.index,te=L.index+L[0].length,ie=C;for(ie+=k.value.length;Se>=ie;)k=k.next,ie+=k.value.length;if(ie-=k.value.length,C=ie,k.value instanceof o)continue;for(var oe=k;oe!==g.tail&&(ie<te||typeof oe.value=="string");oe=oe.next)I++,ie+=oe.value.length;I--,N=h.slice(C,ie),L.index-=C}else if(L=s(T,0,N,F),!L)continue;var Se=L.index,Oe=L[0],we=N.slice(0,Se),Qt=N.slice(Se+Oe.length),Ro=C+N.length;E&&Ro>E.reach&&(E.reach=Ro);var Ai=k.prev;we&&(Ai=l(g,Ai,we),C+=we.length),c(g,Ai,I);var ce=new o(v,A?i.tokenize(Oe,A):Oe,D,Oe);if(k=l(g,Ai,ce),Qt&&l(g,k,Qt),I>1){var Fe={cause:v+","+w,reach:Ro};a(h,g,y,k.prev,C,Fe),E&&Fe.reach>E.reach&&(E.reach=Fe.reach)}}}}}}function u(){var h={value:null,prev:null,next:null},g={value:null,prev:h,next:null};h.next=g,this.head=h,this.tail=g,this.length=0}function l(h,g,y){var x=g.next,b={value:y,prev:g,next:x};return g.next=b,x.prev=b,h.length++,b}function c(h,g,y){for(var x=g.next,b=0;b<y&&x!==h.tail;b++)x=x.next;g.next=x,x.prev=g,h.length-=b}function f(h){for(var g=[],y=h.head.next;y!==h.tail;)g.push(y.value),y=y.next;return g}if(!e.document)return e.addEventListener&&(i.disableWorkerMessageHandler||e.addEventListener("message",function(h){var g=JSON.parse(h.data),y=g.language,x=g.code,b=g.immediateClose;e.postMessage(i.highlight(x,i.languages[y],y)),b&&e.close()},!1)),i;var d=i.util.currentScript();d&&(i.filename=d.src,d.hasAttribute("data-manual")&&(i.manual=!0));function p(){i.manual||i.highlightAll()}if(!i.manual){var m=document.readyState;m==="loading"||m==="interactive"&&d&&d.defer?document.addEventListener("DOMContentLoaded",p):window.requestAnimationFrame?window.requestAnimationFrame(p):window.setTimeout(p,16)}return i}(P_e);typeof module<"u"&&module.exports&&(module.exports=de);typeof global<"u"&&(global.Prism=de);de.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};de.languages.markup.tag.inside["attr-value"].inside.entity=de.languages.markup.entity;de.languages.markup.doctype.inside["internal-subset"].inside=de.languages.markup;de.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(de.languages.markup.tag,"addInlined",{value:function(t,n){var r={};r["language-"+n]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:de.languages[n]},r.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:r}};i["language-"+n]={pattern:/[\s\S]+/,inside:de.languages[n]};var o={};o[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:i},de.languages.insertBefore("markup","cdata",o)}});Object.defineProperty(de.languages.markup.tag,"addAttribute",{value:function(e,t){de.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:de.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});de.languages.html=de.languages.markup;de.languages.mathml=de.languages.markup;de.languages.svg=de.languages.markup;de.languages.xml=de.languages.extend("markup",{});de.languages.ssml=de.languages.xml;de.languages.atom=de.languages.xml;de.languages.rss=de.languages.xml;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))})(de);de.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};de.languages.javascript=de.languages.extend("clike",{"class-name":[de.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});de.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;de.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)\/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/,lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:de.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:de.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:de.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:de.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:de.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});de.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:de.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});de.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});de.languages.markup&&(de.languages.markup.tag.addInlined("script","javascript"),de.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));de.languages.js=de.languages.javascript;de.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};de.languages.python["string-interpolation"].inside.interpolation.inside.rest=de.languages.python;de.languages.py=de.languages.python;(function(){if(typeof de>"u")return;var e=Object.assign||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s]);return i};function t(i){this.defaults=e({},i)}function n(i){return i.replace(/-(\w)/g,function(o,s){return s.toUpperCase()})}function r(i){for(var o=0,s=0;s<i.length;++s)i.charCodeAt(s)==9&&(o+=3);return i.length+o}t.prototype={setDefaults:function(i){this.defaults=e(this.defaults,i)},normalize:function(i,o){o=e(this.defaults,o);for(var s in o){var a=n(s);s!=="normalize"&&a!=="setDefaults"&&o[s]&&this[a]&&(i=this[a].call(this,i,o[s]))}return i},leftTrim:function(i){return i.replace(/^\s+/,"")},rightTrim:function(i){return i.replace(/\s+$/,"")},tabsToSpaces:function(i,o){return o=o|0||4,i.replace(/\t/g,new Array(++o).join(" "))},spacesToTabs:function(i,o){return o=o|0||4,i.replace(RegExp(" {"+o+"}","g"),"	")},removeTrailing:function(i){return i.replace(/\s*?$/gm,"")},removeInitialLineFeed:function(i){return i.replace(/^(?:\r?\n|\r)/,"")},removeIndent:function(i){var o=i.match(/^[^\S\n\r]*(?=\S)/gm);return!o||!o[0].length||(o.sort(function(s,a){return s.length-a.length}),!o[0].length)?i:i.replace(RegExp("^"+o[0],"gm"),"")},indent:function(i,o){return i.replace(/^[^\S\n\r]*(?=\S)/gm,new Array(++o).join("	")+"$&")},breakLines:function(i,o){o=o===!0?80:o|0||80;for(var s=i.split(`
`),a=0;a<s.length;++a)if(!(r(s[a])<=o)){for(var u=s[a].split(/(\s+)/g),l=0,c=0;c<u.length;++c){var f=r(u[c]);l+=f,l>o&&(u[c]=`
`+u[c],l=f)}s[a]=u.join("")}return s.join(`
`)}},typeof module<"u"&&module.exports&&(module.exports=t),de.plugins.NormalizeWhitespace=new t({"remove-trailing":!0,"remove-indent":!1,"left-trim":!1,"right-trim":!0}),de.hooks.add("before-sanity-check",function(i){var o=de.plugins.NormalizeWhitespace;if(!(i.settings&&i.settings["whitespace-normalization"]===!1)&&de.util.isActive(i.element,"whitespace-normalization",!0)){if((!i.element||!i.element.parentNode)&&i.code){i.code=o.normalize(i.code,i.settings);return}var s=i.element.parentNode;if(!(!i.code||!s||s.nodeName.toLowerCase()!=="pre")){for(var a=s.childNodes,u="",l="",c=!1,f=0;f<a.length;++f){var d=a[f];d==i.element?c=!0:d.nodeName==="#text"&&(c?l+=d.nodeValue:u+=d.nodeValue,s.removeChild(d),--f)}if(!i.element.children.length||!de.plugins.KeepMarkup)i.code=u+i.code+l,i.code=o.normalize(i.code,i.settings);else{var p=u+i.element.innerHTML+l;i.element.innerHTML=o.normalize(p,i.settings),i.code=i.element.textContent}}}})})();var IV=e=>{let t;return!window.CustomEvent||typeof window.CustomEvent!="function"?(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!1,!1,void 0)):t=new CustomEvent(e),t},PV=(e,t)=>e.getAttribute(t.sortAttribute||"data-sort")||e.textContent||e.innerText||"",$_e=(e,t)=>(e=e.trim().toLowerCase(),t=t.trim().toLowerCase(),e===t?0:e<t?1:-1),$V=(e,t)=>Array.from(e).find(n=>n.getAttribute("data-sort-column-key")===t),BV=(e,t)=>(n,r)=>{let i=e(n.td,r.td);return i===0?t?r.index-n.index:n.index-r.index:i},LV=[],xA=class{constructor(t,n={}){if(!(t instanceof HTMLTableElement))throw new Error("Element must be a table");this.init(t,n)}static extend(t,n,r){if(typeof n!="function"||typeof r!="function")throw new Error("Pattern and sort must be a function");LV.push({name:t,pattern:n,sort:r})}init(t,n){this.table=t,this.thead=!1,this.options=n;let r;if(t.tHead&&t.tHead.rows.length>0?(r=Array.from(t.tHead.rows).find(o=>o.getAttribute("data-sort-method")==="thead")||t.tHead.rows[t.tHead.rows.length-1],this.thead=!0):r=t.rows[0],!r)return;let i=o=>{this.current&&this.current!==o.currentTarget&&this.current.removeAttribute("aria-sort"),this.current=o.currentTarget,this.sortTable(o.currentTarget)};for(let o of r.cells)o.setAttribute("role","columnheader"),o.getAttribute("data-sort-method")!=="none"&&(o.tabIndex=0,o.addEventListener("click",i,!1),o.getAttribute("data-sort-default")!==null&&(this.current=o,this.sortTable(o)))}sortTable(t,n=!1){let r=t.getAttribute("data-sort-column-key"),i=t.cellIndex,o=$_e,s=[],a=this.thead?0:1,u=t.getAttribute("data-sort-method"),l=t.getAttribute("aria-sort");if(this.table.dispatchEvent(IV("beforeSort")),n||(l=l==="ascending"?"descending":l==="descending"?"ascending":this.options.descending?"descending":"ascending",t.setAttribute("aria-sort",l)),!(this.table.rows.length<2)){for(;s.length<3&&a<this.table.tBodies[0].rows.length;){let c=r?$V(this.table.tBodies[0].rows[a].cells,r):this.table.tBodies[0].rows[a].cells[i],f=c?PV(c,this.options).trim():"";f.length>0&&s.push(f),a++}for(let c of LV)if(u&&c.name===u){o=c.sort;break}else if(s.every(c.pattern)){o=c.sort;break}this.col=i;for(let c of this.table.tBodies){let f=[],d={},p=0,m=0;for(let h of c.rows){if(h.getAttribute("data-sort-method")==="none")d[p]=h;else{let g=r?$V(h.cells,r):h.cells[this.col];f.push({tr:h,td:g?PV(g,this.options):"",index:p})}p++}l==="descending"?f.sort(BV(o,!0)):f.sort(BV(o,!1)).reverse();for(let h=0;h<p;h++){let g=d[h]||f[h-m].tr;c.appendChild(g)}}this.table.dispatchEvent(IV("afterSort"))}}refresh(){this.current&&this.sortTable(this.current,!0)}},UV=e=>e.replace(/[^\-?0-9.]/g,""),B_e=(e,t)=>(parseFloat(t)||0)-(parseFloat(e)||0);xA.extend("number",e=>e.match(/^[-+]?[\x24]?\d+\s*([,\.]\d{0,2})/)||e.match(/^[-+]?\d+\s*([,\.]\d{0,2})?[\x24]/)||e.match(/^[-+]?(\d)*-?([,\.]){0,1}-?(\d)+([E,e][\-+][\d]+)?%?$/),(e,t)=>B_e(UV(e),UV(t)));var zV=xA;async function L_e(e){return await fetch("https://api.openai.com/v1/completions",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}})}async function qI(e){let n=await(await L_e(e)).json();return!(n.error&&n.error.code&&n.error.code in{invalid_api_key:!0,invalid_request_error:!0,model_not_found:!0,insufficient_quota:!0})}function GI(e){(async()=>{try{window.localStorage.setItem("scalene-api-key",e)}catch{}if(e.length===0){let r=document.getElementById("valid-api-key");r&&(r.innerHTML="");return}let t=await qI(e),n=document.getElementById("valid-api-key");n&&(t?n.innerHTML="&check;":n.innerHTML="&#10005;")})()}async function HV(e,t){let n="https://api.openai.com/v1/chat/completions",i=document.getElementById("language-model-openai")?.value??"gpt-4",o=JSON.stringify({model:i,messages:[{role:"system",content:"You are a Python programming assistant who ONLY responds with blocks of commented, optimized code. You never respond with text. Just code, starting with ``` and ending with ```."},{role:"user",content:e}],user:"scalene-user"});console.log(o);let a=await(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:o})).json();if(a.error&&a.error.code&&a.error.code in{invalid_request_error:!0,model_not_found:!0,insufficient_quota:!0})return a.error.code==="model_not_found"&&i==="gpt-4"?alert("You either need to add funds to your OpenAI account to use this feature, or you need to switch to GPT-3.5 if you are using free credits."):alert("You need to add funds to your OpenAI account to use this feature."),"";try{a.choices&&a.choices[0]&&console.log(`Debugging info: Retrieved ${JSON.stringify(a.choices[0],null,4)}`)}catch{console.log(`Debugging info: Failed to retrieve data.choices from the server. data = ${JSON.stringify(a)}`)}try{return a.choices&&a.choices[0]?a.choices[0].message.content.replace(/^\s*[\r\n]/gm,""):`# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.
`}catch{return`# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.
`}}async function qV(e,t,n){try{let r=await fetch(`http://${e}:${t}/api/tags`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let o=(await r.json()).models.map(s=>s.name);return o.length===0&&n(),o}catch(r){return console.error("Error fetching model names:",r),n(),[]}}async function GV(e,t,n,r){let i=`http://${n}:${r}/api/chat`,o={"Content-Type":"application/json"},s=JSON.stringify({model:t,messages:[{role:"system",content:"You are an expert code assistant who only responds in Python code."},{role:"user",content:e}],stream:!1,temperature:.3,frequency_penalty:0,presence_penalty:0,user:"scalene-user"});console.log(s);let a=!1,u="",l=0,c=3;for(;!a;){if(l>=c)return"";try{let f=await fetch(i,{method:"POST",headers:o,body:s});if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);let p=(await f.text()).split(`
`);for(let m of p){if(!m.trim())continue;let h=JSON.parse(m);if(h.message&&h.message.content&&(u+=h.message.content),h.done){a=!0;break}}}catch(f){console.log(`Error: ${f}`),l++}}console.log(u);try{return u}catch{return`# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.
`}}function jV(e){let t=e.signer,n=e.signer,r=Object.assign(e,{eventSigner:t,messageSigner:n}),i=r.eventStreamPayloadHandlerProvider(r);return Object.assign(r,{eventStreamPayloadHandler:i})}var WV=e=>({setHttpHandler(t){e.httpHandler=t},httpHandler(){return e.httpHandler},updateHttpClientConfig(t,n){e.httpHandler?.updateHttpClientConfig(t,n)},httpHandlerConfigs(){return e.httpHandler.httpHandlerConfigs()}}),VV=e=>({httpHandler:e.httpHandler()});var YV;(function(e){e.HEADER="header",e.QUERY="query"})(YV||(YV={}));var XV;(function(e){e.HEADER="header",e.QUERY="query"})(XV||(XV={}));var Dm;(function(e){e.HTTP="http",e.HTTPS="https"})(Dm||(Dm={}));var Mm;(function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"})(Mm||(Mm={}));var jI;(function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"})(jI||(jI={}));var Xy="__smithy_context";var KV;(function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"})(KV||(KV={}));var QV;(function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"})(QV||(QV={}));var et=class e{constructor(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/",this.username=t.username,this.password=t.password,this.fragment=t.fragment}static clone(t){let n=new e({...t,headers:{...t.headers}});return n.query&&(n.query=U_e(n.query)),n}static isInstance(t){if(!t)return!1;let n=t;return"method"in n&&"protocol"in n&&"hostname"in n&&"path"in n&&typeof n.query=="object"&&typeof n.headers=="object"}clone(){return e.clone(this)}};function U_e(e){return Object.keys(e).reduce((t,n)=>{let r=e[n];return{...t,[n]:Array.isArray(r)?[...r]:r}},{})}var wi=class{constructor(t){this.statusCode=t.statusCode,this.reason=t.reason,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;let n=t;return typeof n.statusCode=="number"&&typeof n.headers=="object"}};var z_e=e=>t=>async n=>{if(!et.isInstance(n.request))return t(n);let{request:r}=n,{handlerProtocol:i=""}=e.requestHandler.metadata||{};if(i.indexOf("h2")>=0&&!r.headers[":authority"])delete r.headers.host,r.headers[":authority"]=r.hostname+(r.port?":"+r.port:"");else if(!r.headers.host){let o=r.hostname;r.port!=null&&(o+=`:${r.port}`),r.headers.host=o}return t(n)},H_e={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},JV=e=>({applyToStack:t=>{t.add(z_e(e),H_e)}});var q_e=()=>(e,t)=>async n=>{try{let r=await e(n),{clientName:i,commandName:o,logger:s,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:u,overrideOutputFilterSensitiveLog:l}=a,c=u??t.inputFilterSensitiveLog,f=l??t.outputFilterSensitiveLog,{$metadata:d,...p}=r.output;return s?.info?.({clientName:i,commandName:o,input:c(n.input),output:f(p),metadata:d}),r}catch(r){let{clientName:i,commandName:o,logger:s,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:u}=a,l=u??t.inputFilterSensitiveLog;throw s?.error?.({clientName:i,commandName:o,input:l(n.input),error:r,metadata:r.$metadata}),r}},G_e={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},ZV=e=>({applyToStack:t=>{t.add(q_e(),G_e)}});var WI="X-Amzn-Trace-Id",j_e="AWS_LAMBDA_FUNCTION_NAME",W_e="_X_AMZN_TRACE_ID",V_e=e=>t=>async n=>{let{request:r}=n;if(!et.isInstance(r)||e.runtime!=="node")return t(n);let i=Object.keys(r.headers??{}).find(u=>u.toLowerCase()===WI.toLowerCase())??WI;if(r.headers.hasOwnProperty(i))return t(n);let o=process.env[j_e],s=process.env[W_e],a=u=>typeof u=="string"&&u.length>0;return a(o)&&a(s)&&(r.headers[WI]=s),t({...n,request:r})},Y_e={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},eY=e=>({applyToStack:t=>{t.add(V_e(e),Y_e)}});var zl=e=>e[Xy]||(e[Xy]={});var Yr=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t};var tY=(e,t)=>{if(!t||t.length===0)return e;let n=[];for(let r of t)for(let i of e)i.schemeId.split("#")[1]===r&&n.push(i);for(let r of e)n.find(({schemeId:i})=>i===r.schemeId)||n.push(r);return n};function X_e(e){let t=new Map;for(let n of e)t.set(n.schemeId,n);return t}var nY=(e,t)=>(n,r)=>async i=>{let o=e.httpAuthSchemeProvider(await t.httpAuthSchemeParametersProvider(e,r,i.input)),s=e.authSchemePreference?await e.authSchemePreference():[],a=tY(o,s),u=X_e(e.httpAuthSchemes),l=zl(r),c=[];for(let f of a){let d=u.get(f.schemeId);if(!d){c.push(`HttpAuthScheme \`${f.schemeId}\` was not enabled for this service.`);continue}let p=d.identityProvider(await t.identityProviderConfigProvider(e));if(!p){c.push(`HttpAuthScheme \`${f.schemeId}\` did not have an IdentityProvider configured.`);continue}let{identityProperties:m={},signingProperties:h={}}=f.propertiesExtractor?.(e,r)||{};f.identityProperties=Object.assign(f.identityProperties||{},m),f.signingProperties=Object.assign(f.signingProperties||{},h),l.selectedHttpAuthScheme={httpAuthOption:f,identity:await p(f.identityProperties),signer:d.signer};break}if(!l.selectedHttpAuthScheme)throw new Error(c.join(`
`));return n(i)};var K_e={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},rY=(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:n})=>({applyToStack:r=>{r.addRelativeTo(nY(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:n}),K_e)}});var iY=(e,t)=>(n,r)=>async i=>{let{response:o}=await n(i);try{let s=await t(o,e);return{response:o,output:s}}catch(s){if(Object.defineProperty(s,"$response",{value:o}),!("$metadata"in s)){let a="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{s.message+=`
  `+a}catch{!r.logger||r.logger?.constructor?.name==="NoOpLogger"?console.warn(a):r.logger?.warn?.(a)}typeof s.$responseBodyText<"u"&&s.$response&&(s.$response.body=s.$responseBodyText);try{if(wi.isInstance(o)){let{headers:u={}}=o,l=Object.entries(u);s.$metadata={httpStatusCode:o.statusCode,requestId:VI(/^x-[\w-]+-request-?id$/,l),extendedRequestId:VI(/^x-[\w-]+-id-2$/,l),cfId:VI(/^x-[\w-]+-cf-id$/,l)}}}catch{}}throw s}},VI=(e,t)=>(t.find(([n])=>n.match(e))||[void 0,void 0])[1];var oY=(e,t)=>(n,r)=>async i=>{let o=e,s=r.endpointV2?.url&&o.urlParser?async()=>o.urlParser(r.endpointV2.url):o.endpoint;if(!s)throw new Error("No valid endpoint provider available.");let a=await t(i.input,{...e,endpoint:s});return n({...i,request:a})};var Q_e={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},YI={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function sY(e,t,n){return{applyToStack:r=>{r.add(iY(e,n),Q_e),r.add(oY(e,t),YI)}}}var J_e=e=>t=>{throw t},Z_e=(e,t)=>{},aY=e=>(t,n)=>async r=>{if(!et.isInstance(r.request))return t(r);let o=zl(n).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");let{httpAuthOption:{signingProperties:s={}},identity:a,signer:u}=o,l=await t({...r,request:await u.sign(r.request,a,s)}).catch((u.errorHandler||J_e)(s));return(u.successHandler||Z_e)(l.response,s),l};var e2e={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},uY=e=>({applyToStack:t=>{t.addRelativeTo(aY(e),e2e)}});var Of=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t};var vu={},If=new Array(64);for(let e=0,t=65,n=90;e+t<=n;e++){let r=String.fromCharCode(e+t);vu[r]=e,If[e]=r}for(let e=0,t=97,n=122;e+t<=n;e++){let r=String.fromCharCode(e+t),i=e+26;vu[r]=i,If[i]=r}for(let e=0;e<10;e++){vu[e.toString(10)]=e+52;let t=e.toString(10),n=e+52;vu[t]=n,If[n]=t}vu["+"]=62;If[62]="+";vu["/"]=63;If[63]="/";var Hl=6,Pf=8,lY=63;var Nm=e=>{let t=e.length/4*3;e.slice(-2)==="=="?t-=2:e.slice(-1)==="="&&t--;let n=new ArrayBuffer(t),r=new DataView(n);for(let i=0;i<e.length;i+=4){let o=0,s=0;for(let l=i,c=i+3;l<=c;l++)if(e[l]!=="="){if(!(e[l]in vu))throw new TypeError(`Invalid character ${e[l]} in base64 string.`);o|=vu[e[l]]<<(c-l)*Hl,s+=Hl}else o>>=Hl;let a=i/4*3;o>>=s%Pf;let u=Math.floor(s/Pf);for(let l=0;l<u;l++){let c=(u-l-1)*Pf;r.setUint8(a+l,(o&255<<c)>>c)}}return new Uint8Array(n)};var Es=e=>new TextEncoder().encode(e);var wu=e=>typeof e=="string"?Es(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e);var Ky=e=>{if(typeof e=="string")return e;if(typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(e)};function Om(e){let t;typeof e=="string"?t=Es(e):t=e;let n=typeof t=="object"&&typeof t.length=="number",r=typeof t=="object"&&typeof t.byteOffset=="number"&&typeof t.byteLength=="number";if(!n&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let i="";for(let o=0;o<t.length;o+=3){let s=0,a=0;for(let l=o,c=Math.min(o+3,t.length);l<c;l++)s|=t[l]<<(c-l-1)*Pf,a+=Pf;let u=Math.ceil(a/Hl);s<<=u*Hl-a;for(let l=1;l<=u;l++){let c=(u-l)*Hl;i+=If[(s&lY<<c)>>c]}i+="==".slice(0,4-u)}return i}function cY(e,t="utf-8"){return t==="base64"?Om(e):Ky(e)}function fY(e,t){return t==="base64"?Su.mutate(Nm(e)):Su.mutate(Es(e))}var Su=class e extends Uint8Array{static fromString(t,n="utf-8"){switch(typeof t){case"string":return fY(t,n);default:throw new Error(`Unsupported conversion from ${typeof t} to Uint8ArrayBlobAdapter.`)}}static mutate(t){return Object.setPrototypeOf(t,e.prototype),t}transformToString(t="utf-8"){return cY(this,t)}};var vs=e=>encodeURIComponent(e).replace(/[!'()*]/g,n2e),n2e=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;function bA(e){let t=[];for(let n of Object.keys(e).sort()){let r=e[n];if(n=vs(n),Array.isArray(r))for(let i=0,o=r.length;i<o;i++)t.push(`${n}=${vs(r[i])}`);else{let i=n;(r||typeof r=="string")&&(i+=`=${vs(r)}`),t.push(i)}}return t.join("&")}function XI(e,t){return new Request(e,t)}function dY(e=0){return new Promise((t,n)=>{e&&setTimeout(()=>{let r=new Error(`Request did not complete within ${e} ms`);r.name="TimeoutError",n(r)},e)})}var KI={supported:void 0},$f=class e{static create(t){return typeof t?.handle=="function"?t:new e(t)}constructor(t){typeof t=="function"?this.configProvider=t().then(n=>n||{}):(this.config=t??{},this.configProvider=Promise.resolve(this.config)),KI.supported===void 0&&(KI.supported=typeof Request<"u"&&"keepalive"in XI("https://[::1]"))}destroy(){}async handle(t,{abortSignal:n,requestTimeout:r}={}){this.config||(this.config=await this.configProvider);let i=r??this.config.requestTimeout,o=this.config.keepAlive===!0,s=this.config.credentials;if(n?.aborted){let x=new Error("Request aborted");return x.name="AbortError",Promise.reject(x)}let a=t.path,u=bA(t.query||{});u&&(a+=`?${u}`),t.fragment&&(a+=`#${t.fragment}`);let l="";if(t.username!=null||t.password!=null){let x=t.username??"",b=t.password??"";l=`${x}:${b}@`}let{port:c,method:f}=t,d=`${t.protocol}//${l}${t.hostname}${c?`:${c}`:""}${a}`,p=f==="GET"||f==="HEAD"?void 0:t.body,m={body:p,headers:new Headers(t.headers),method:f,credentials:s};this.config?.cache&&(m.cache=this.config.cache),p&&(m.duplex="half"),typeof AbortController<"u"&&(m.signal=n),KI.supported&&(m.keepalive=o),typeof this.config.requestInit=="function"&&Object.assign(m,this.config.requestInit(t));let h=()=>{},g=XI(d,m),y=[fetch(g).then(x=>{let b=x.headers,E={};for(let S of b.entries())E[S[0]]=S[1];return x.body!=null?{response:new wi({headers:E,reason:x.statusText,statusCode:x.status,body:x.body})}:x.blob().then(S=>({response:new wi({headers:E,reason:x.statusText,statusCode:x.status,body:S})}))}),dY(i)];return n&&y.push(new Promise((x,b)=>{let E=()=>{let v=new Error("Request aborted");v.name="AbortError",b(v)};if(typeof n.addEventListener=="function"){let v=n;v.addEventListener("abort",E,{once:!0}),h=()=>v.removeEventListener("abort",E)}else n.onabort=E})),Promise.race(y).finally(h)}updateHttpClientConfig(t,n){this.config=void 0,this.configProvider=this.configProvider.then(r=>(r[t]=n,r))}httpHandlerConfigs(){return this.config??{}}};var QI=async e=>typeof Blob=="function"&&e instanceof Blob||e.constructor?.name==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await e.arrayBuffer()):r2e(e):i2e(e);async function r2e(e){let t=await o2e(e),n=Nm(t);return new Uint8Array(n)}async function i2e(e){let t=[],n=e.getReader(),r=!1,i=0;for(;!r;){let{done:a,value:u}=await n.read();u&&(t.push(u),i+=u.length),r=a}let o=new Uint8Array(i),s=0;for(let a of t)o.set(a,s),s+=a.length;return o}function o2e(e){return new Promise((t,n)=>{let r=new FileReader;r.onloadend=()=>{if(r.readyState!==2)return n(new Error("Reader aborted too early"));let i=r.result??"",o=i.indexOf(","),s=o>-1?o+1:i.length;t(i.substring(s))},r.onabort=()=>n(new Error("Read aborted")),r.onerror=()=>n(r.error),r.readAsDataURL(e)})}var pY={},JI={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),pY[e]=t,JI[t]=e}function Im(e){if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){let r=e.slice(n,n+2).toLowerCase();if(r in JI)t[n/2]=JI[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t}function Kt(e){let t="";for(let n=0;n<e.byteLength;n++)t+=pY[e[n]];return t}var Qy=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return Su.mutate(e);if(!e)return Su.mutate(new Uint8Array);let n=t.streamCollector(e);return Su.mutate(await n)};function ZI(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}var Wht=Math.ceil(34028234663852886e22);var s2e=e=>{if(e!=null){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}};var eP=e=>a2e(e,32);var a2e=(e,t)=>{let n=s2e(e);if(n!==void 0&&u2e(n,t)!==n)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return n},u2e=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}};var Xr=e=>{if(e!=null){if(typeof e=="string")return e;if(["boolean","number","bigint"].includes(typeof e))return c2e.warn(l2e(`Expected string, got ${typeof e}: ${e}`)),String(e);throw new TypeError(`Expected string, got ${typeof e}: ${e}`)}};var l2e=e=>String(new TypeError(e).stack||e).split(`
`).slice(0,5).filter(t=>!t.includes("stackTraceWarning")).join(`
`),c2e={warn:console.warn};var EA,f2e=new Uint8Array(16);function tP(){if(!EA&&(EA=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!EA))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return EA(f2e)}var Qn=[];for(let e=0;e<256;++e)Qn.push((e+256).toString(16).slice(1));function mY(e,t=0){return Qn[e[t+0]]+Qn[e[t+1]]+Qn[e[t+2]]+Qn[e[t+3]]+"-"+Qn[e[t+4]]+Qn[e[t+5]]+"-"+Qn[e[t+6]]+Qn[e[t+7]]+"-"+Qn[e[t+8]]+Qn[e[t+9]]+"-"+Qn[e[t+10]]+Qn[e[t+11]]+Qn[e[t+12]]+Qn[e[t+13]]+Qn[e[t+14]]+Qn[e[t+15]]}var d2e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),nP={randomUUID:d2e};function p2e(e,t,n){if(nP.randomUUID&&!t&&!e)return nP.randomUUID();e=e||{};let r=e.random||(e.rng||tP)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return mY(r)}var rP=p2e;var hY=(e,t,n,r,i,o)=>{if(t!=null&&t[n]!==void 0){let s=r();if(s.length<=0)throw new Error("Empty value provided for input HTTP label: "+n+".");e=e.replace(i,o?s.split("/").map(a=>ZI(a)).join("/"):ZI(s))}else throw new Error("No value provided for input HTTP label: "+n+".");return e};function oP(e,t){return new iP(e,t)}var iP=class{constructor(t,n){this.input=t,this.context=n,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){let{hostname:t,protocol:n="https",port:r,path:i}=await this.context.endpoint();this.path=i;for(let o of this.resolvePathStack)o(this.path);return new et({protocol:n,hostname:this.hostname||t,port:r,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(t){return this.hostname=t,this}bp(t){return this.resolvePathStack.push(n=>{this.path=`${n?.endsWith("/")?n.slice(0,-1):n||""}`+t}),this}p(t,n,r,i){return this.resolvePathStack.push(o=>{this.path=hY(o,this.input,t,n,r,i)}),this}h(t){return this.headers=t,this}q(t){return this.query=t,this}b(t){return this.body=t,this}m(t){return this.method=t,this}};function gY(e,t,n){e.__smithy_context?e.__smithy_context.features||(e.__smithy_context.features={}):e.__smithy_context={features:{}},e.__smithy_context.features[t]=n}var vA=class{constructor(t){this.authSchemes=new Map;for(let[n,r]of Object.entries(t))r!==void 0&&this.authSchemes.set(n,r)}getIdentityProvider(t){return this.authSchemes.get(t)}};var wA=class{async sign(t,n,r){let i=et.clone(t);if(!n.token)throw new Error("request could not be signed with `token` since the `token` is not defined");return i.headers.Authorization=`Bearer ${n.token}`,i}};var m2e=e=>t=>Jy(t)&&t.expiration.getTime()-Date.now()<e;var SA=m2e(3e5),Jy=e=>e.expiration!==void 0,AA=(e,t,n)=>{if(e===void 0)return;let r=typeof e!="function"?async()=>Promise.resolve(e):e,i,o,s,a=!1,u=async l=>{o||(o=r(l));try{i=await o,s=!0,a=!1}finally{o=void 0}return i};return t===void 0?async l=>((!s||l?.forceRefresh)&&(i=await u(l)),i):async l=>((!s||l?.forceRefresh)&&(i=await u(l)),a?i:n(i)?(t(i)&&await u(l),i):(a=!0,i))};var h2e=void 0;function g2e(e){return e===void 0?!0:typeof e=="string"&&e.length<=50}function yY(e){let t=Of(e.userAgentAppId??h2e),{customUserAgent:n}=e;return Object.assign(e,{customUserAgent:typeof n=="string"?[[n]]:n,userAgentAppId:async()=>{let r=await t();if(!g2e(r)){let i=e.logger?.constructor?.name==="NoOpLogger"||!e.logger?console:e.logger;typeof r!="string"?i?.warn("userAgentAppId must be a string or undefined."):r.length>50&&i?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return r}})}var _A=class{constructor({size:t,params:n}){this.data=new Map,this.parameters=[],this.capacity=t??50,n&&(this.parameters=n)}get(t,n){let r=this.hash(t);if(r===!1)return n();if(!this.data.has(r)){if(this.data.size>this.capacity+10){let i=this.data.keys(),o=0;for(;;){let{value:s,done:a}=i.next();if(this.data.delete(s),a||++o>10)break}}this.data.set(r,n())}return this.data.get(r)}size(){return this.data.size}hash(t){let n="",{parameters:r}=this;if(r.length===0)return!1;for(let i of r){let o=String(t[i]??"");if(o.includes("|;"))return!1;n+=o+"|;"}return n}};var y2e=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),Zy=e=>y2e.test(e)||e.startsWith("[")&&e.endsWith("]");var x2e=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),ex=(e,t=!1)=>{if(!t)return x2e.test(e);let n=e.split(".");for(let r of n)if(!ex(r))return!1;return!0};var Bf={};var Au="endpoints";function Fo(e){return typeof e!="object"||e==null?e:"ref"in e?`$${Fo(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(Fo).join(", ")})`:JSON.stringify(e,null,2)}var yt=class extends Error{constructor(t){super(t),this.name="EndpointError"}};var xY=(e,t)=>e===t;var bY=e=>{let t=e.split("."),n=[];for(let r of t){let i=r.indexOf("[");if(i!==-1){if(r.indexOf("]")!==r.length-1)throw new yt(`Path: '${e}' does not end with ']'`);let o=r.slice(i+1,-1);if(Number.isNaN(parseInt(o)))throw new yt(`Invalid array index: '${o}' in path: '${e}'`);i!==0&&n.push(r.slice(0,i)),n.push(o)}else n.push(r)}return n};var CA=(e,t)=>bY(t).reduce((n,r)=>{if(typeof n!="object")throw new yt(`Index '${r}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(n)?n[parseInt(r)]:n[r]},e);var EY=e=>e!=null;var vY=e=>!e;var sP={[Dm.HTTP]:80,[Dm.HTTPS]:443},wY=e=>{let t=(()=>{try{if(e instanceof URL)return e;if(typeof e=="object"&&"hostname"in e){let{hostname:d,port:p,protocol:m="",path:h="",query:g={}}=e,y=new URL(`${m}//${d}${p?`:${p}`:""}${h}`);return y.search=Object.entries(g).map(([x,b])=>`${x}=${b}`).join("&"),y}return new URL(e)}catch{return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;let n=t.href,{host:r,hostname:i,pathname:o,protocol:s,search:a}=t;if(a)return null;let u=s.slice(0,-1);if(!Object.values(Dm).includes(u))return null;let l=Zy(i),c=n.includes(`${r}:${sP[u]}`)||typeof e=="string"&&e.includes(`${r}:${sP[u]}`),f=`${r}${c?`:${sP[u]}`:""}`;return{scheme:u,authority:f,path:o,normalizedPath:o.endsWith("/")?o:`${o}/`,isIp:l}};var SY=(e,t)=>e===t;var AY=(e,t,n,r)=>t>=n||e.length<n?null:r?e.substring(e.length-n,e.length-t):e.substring(t,n);var _Y=e=>encodeURIComponent(e).replace(/[!*'()]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`);var CY={booleanEquals:xY,getAttr:CA,isSet:EY,isValidHostLabel:ex,not:vY,parseURL:wY,stringEquals:SY,substring:AY,uriEncode:_Y};var kA=(e,t)=>{let n=[],r={...t.endpointParams,...t.referenceRecord},i=0;for(;i<e.length;){let o=e.indexOf("{",i);if(o===-1){n.push(e.slice(i));break}n.push(e.slice(i,o));let s=e.indexOf("}",o);if(s===-1){n.push(e.slice(o));break}e[o+1]==="{"&&e[s+1]==="}"&&(n.push(e.slice(o+1,s)),i=s+2);let a=e.substring(o+1,s);if(a.includes("#")){let[u,l]=a.split("#");n.push(CA(r[u],l))}else n.push(r[a]);i=s+1}return n.join("")};var kY=({ref:e},t)=>({...t.endpointParams,...t.referenceRecord})[e];var ql=(e,t,n)=>{if(typeof e=="string")return kA(e,n);if(e.fn)return FA(e,n);if(e.ref)return kY(e,n);throw new yt(`'${t}': ${String(e)} is not a string, function or reference.`)};var FA=({fn:e,argv:t},n)=>{let r=t.map(o=>["boolean","number"].includes(typeof o)?o:ql(o,"arg",n)),i=e.split(".");return i[0]in Bf&&i[1]!=null?Bf[i[0]][i[1]](...r):CY[e](...r)};var FY=({assign:e,...t},n)=>{if(e&&e in n.referenceRecord)throw new yt(`'${e}' is already defined in Reference Record.`);let r=FA(t,n);return n.logger?.debug?.(`${Au} evaluateCondition: ${Fo(t)} = ${Fo(r)}`),{result:r===""?!0:!!r,...e!=null&&{toAssign:{name:e,value:r}}}};var Pm=(e=[],t)=>{let n={};for(let r of e){let{result:i,toAssign:o}=FY(r,{...t,referenceRecord:{...t.referenceRecord,...n}});if(!i)return{result:i};o&&(n[o.name]=o.value,t.logger?.debug?.(`${Au} assign: ${o.name} := ${Fo(o.value)}`))}return{result:!0,referenceRecord:n}};var RY=(e,t)=>Object.entries(e).reduce((n,[r,i])=>({...n,[r]:i.map(o=>{let s=ql(o,"Header value entry",t);if(typeof s!="string")throw new yt(`Header '${r}' value '${s}' is not a string`);return s})}),{});var aP=(e,t)=>{if(Array.isArray(e))return e.map(n=>aP(n,t));switch(typeof e){case"string":return kA(e,t);case"object":if(e===null)throw new yt(`Unexpected endpoint property: ${e}`);return RA(e,t);case"boolean":return e;default:throw new yt(`Unexpected endpoint property type: ${typeof e}`)}};var RA=(e,t)=>Object.entries(e).reduce((n,[r,i])=>({...n,[r]:aP(i,t)}),{});var TY=(e,t)=>{let n=ql(e,"Endpoint URL",t);if(typeof n=="string")try{return new URL(n)}catch(r){throw console.error(`Failed to construct URL with ${n}`,r),r}throw new yt(`Endpoint URL must be a string, got ${typeof n}`)};var DY=(e,t)=>{let{conditions:n,endpoint:r}=e,{result:i,referenceRecord:o}=Pm(n,t);if(!i)return;let s={...t,referenceRecord:{...t.referenceRecord,...o}},{url:a,properties:u,headers:l}=r;return t.logger?.debug?.(`${Au} Resolving endpoint from template: ${Fo(r)}`),{...l!=null&&{headers:RY(l,s)},...u!=null&&{properties:RA(u,s)},url:TY(a,s)}};var MY=(e,t)=>{let{conditions:n,error:r}=e,{result:i,referenceRecord:o}=Pm(n,t);if(i)throw new yt(ql(r,"Error",{...t,referenceRecord:{...t.referenceRecord,...o}}))};var NY=(e,t)=>{let{conditions:n,rules:r}=e,{result:i,referenceRecord:o}=Pm(n,t);if(i)return TA(r,{...t,referenceRecord:{...t.referenceRecord,...o}})};var TA=(e,t)=>{for(let n of e)if(n.type==="endpoint"){let r=DY(n,t);if(r)return r}else if(n.type==="error")MY(n,t);else if(n.type==="tree"){let r=NY(n,t);if(r)return r}else throw new yt(`Unknown endpoint rule: ${n}`);throw new yt("Rules evaluation failed")};var uP=(e,t)=>{let{endpointParams:n,logger:r}=t,{parameters:i,rules:o}=e;t.logger?.debug?.(`${Au} Initial EndpointParams: ${Fo(n)}`);let s=Object.entries(i).filter(([,l])=>l.default!=null).map(([l,c])=>[l,c.default]);if(s.length>0)for(let[l,c]of s)n[l]=n[l]??c;let a=Object.entries(i).filter(([,l])=>l.required).map(([l])=>l);for(let l of a)if(n[l]==null)throw new yt(`Missing required parameter: '${l}'`);let u=TA(o,{endpointParams:n,logger:r,referenceRecord:{}});return t.logger?.debug?.(`${Au} Resolved endpoint: ${Fo(u)}`),u};var lP=(e,t=!1)=>{if(t){for(let n of e.split("."))if(!lP(n))return!1;return!0}return!(!ex(e)||e.length<3||e.length>63||e!==e.toLowerCase()||Zy(e))};var OY=":",b2e="/",IY=e=>{let t=e.split(OY);if(t.length<6)return null;let[n,r,i,o,s,...a]=t;if(n!=="arn"||r===""||i===""||a.join(OY)==="")return null;let u=a.map(l=>l.split(b2e)).flat();return{partition:r,service:i,region:o,accountId:s,resourceId:u}};var PY={partitions:[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"AWS ISOE (Europe) global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"AWS ISOF global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"amazonaws.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"EU (Germany)"}}}],version:"1.1"};var v2e=PY,w2e="",$Y=e=>{let{partitions:t}=v2e;for(let r of t){let{regions:i,outputs:o}=r;for(let[s,a]of Object.entries(i))if(s===e)return{...o,...a}}for(let r of t){let{regionRegex:i,outputs:o}=r;if(new RegExp(i).test(e))return{...o}}let n=t.find(r=>r.id==="aws");if(!n)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...n.outputs}};var BY=()=>w2e;var cP={isVirtualHostableS3Bucket:lP,parseArn:IY,partition:$Y};Bf.aws=cP;function LY(e){let t={};if(e=e.replace(/^\?/,""),e)for(let n of e.split("&")){let[r,i=null]=n.split("=");r=decodeURIComponent(r),i&&(i=decodeURIComponent(i)),r in t?Array.isArray(t[r])?t[r].push(i):t[r]=[t[r],i]:t[r]=i}return t}var Lf=e=>{if(typeof e=="string")return Lf(new URL(e));let{hostname:t,pathname:n,port:r,protocol:i,search:o}=e,s;return o&&(s=LY(o)),{hostname:t,port:r?parseInt(r):void 0,protocol:i,path:n,query:s}};function UY(e,t,n){return e.$source||(e.$source={}),e.$source[t]=n,e}function ws(e,t,n){e.__aws_sdk_context?e.__aws_sdk_context.features||(e.__aws_sdk_context.features={}):e.__aws_sdk_context={features:{}},e.__aws_sdk_context.features[t]=n}var fP=e=>wi.isInstance(e)?e.headers?.date??e.headers?.Date:void 0;var DA=e=>new Date(Date.now()+e);var zY=(e,t)=>Math.abs(DA(t).getTime()-e)>=3e5;var dP=(e,t)=>{let n=Date.parse(e);return zY(n,t)?n-Date.now():t};var tx=(e,t)=>{if(!t)throw new Error(`Property \`${e}\` is not resolved for AWS SDK SigV4Auth`);return t},HY=async e=>{let t=tx("context",e.context),n=tx("config",e.config),r=t.endpointV2?.properties?.authSchemes?.[0],o=await tx("signer",n.signer)(r),s=e?.signingRegion,a=e?.signingRegionSet,u=e?.signingName;return{config:n,signer:o,signingRegion:s,signingRegionSet:a,signingName:u}},nx=class{async sign(t,n,r){if(!et.isInstance(t))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");let i=await HY(r),{config:o,signer:s}=i,{signingRegion:a,signingName:u}=i,l=r.context;if(l?.authSchemes?.length??!1){let[f,d]=l.authSchemes;f?.name==="sigv4a"&&d?.name==="sigv4"&&(a=d?.signingRegion??a,u=d?.signingName??u)}return await s.sign(t,{signingDate:DA(o.systemClockOffset),signingRegion:a,signingService:u})}errorHandler(t){return n=>{let r=n.ServerTime??fP(n.$response);if(r){let i=tx("config",t.config),o=i.systemClockOffset;i.systemClockOffset=dP(r,i.systemClockOffset),i.systemClockOffset!==o&&n.$metadata&&(n.$metadata.clockSkewCorrected=!0)}throw n}}successHandler(t,n){let r=fP(t);if(r){let i=tx("config",n.config);i.systemClockOffset=dP(r,i.systemClockOffset)}}};var GY=(e,t,n)=>{let r,i,o,s=!1,a=async()=>{i||(i=e());try{r=await i,o=!0,s=!1}finally{i=void 0}return r};return t===void 0?async u=>((!o||u?.forceRefresh)&&(r=await a()),r):async u=>((!o||u?.forceRefresh)&&(r=await a()),s?r:n&&!n(r)?(s=!0,r):(t(r)&&await a(),r))};var jY="X-Amz-Algorithm",WY="X-Amz-Credential",pP="X-Amz-Date",VY="X-Amz-SignedHeaders",YY="X-Amz-Expires",mP="X-Amz-Signature",hP="X-Amz-Security-Token";var gP="authorization",yP=pP.toLowerCase(),S2e="date",XY=[gP,yP,S2e],KY=mP.toLowerCase(),rx="x-amz-content-sha256",QY=hP.toLowerCase();var JY={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},ZY=/^proxy-/,eX=/^sec-/;var MA="AWS4-HMAC-SHA256";var tX="AWS4-HMAC-SHA256-PAYLOAD",nX="UNSIGNED-PAYLOAD",rX=50,xP="aws4_request",iX=60*60*24*7;var NA={},bP=[],OA=(e,t,n)=>`${e}/${t}/${n}/${xP}`,sX=async(e,t,n,r,i)=>{let o=await oX(e,t.secretAccessKey,t.accessKeyId),s=`${n}:${r}:${i}:${Kt(o)}:${t.sessionToken}`;if(s in NA)return NA[s];for(bP.push(s);bP.length>rX;)delete NA[bP.shift()];let a=`AWS4${t.secretAccessKey}`;for(let u of[n,r,i,xP])a=await oX(e,a,u);return NA[s]=a};var oX=(e,t,n)=>{let r=new e(t);return r.update(wu(n)),r.digest()};var IA=({headers:e},t,n)=>{let r={};for(let i of Object.keys(e).sort()){if(e[i]==null)continue;let o=i.toLowerCase();(o in JY||t?.has(o)||ZY.test(o)||eX.test(o))&&(!n||n&&!n.has(o))||(r[o]=e[i].trim().replace(/\s+/g," "))}return r};var aX=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]";var ix=async({headers:e,body:t},n)=>{for(let r of Object.keys(e))if(r.toLowerCase()===rx)return e[r];if(t==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof t=="string"||ArrayBuffer.isView(t)||aX(t)){let r=new n;return r.update(wu(t)),Kt(await r.digest())}return nX};var PA=class{format(t){let n=[];for(let o of Object.keys(t)){let s=Es(o);n.push(Uint8Array.from([s.byteLength]),s,this.formatHeaderValue(t[o]))}let r=new Uint8Array(n.reduce((o,s)=>o+s.byteLength,0)),i=0;for(let o of n)r.set(o,i),i+=o.byteLength;return r}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":let n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,t.value,!1),new Uint8Array(n.buffer);case"integer":let r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,t.value,!1),new Uint8Array(r.buffer);case"long":let i=new Uint8Array(9);return i[0]=5,i.set(t.value.bytes,1),i;case"binary":let o=new DataView(new ArrayBuffer(3+t.value.byteLength));o.setUint8(0,6),o.setUint16(1,t.value.byteLength,!1);let s=new Uint8Array(o.buffer);return s.set(t.value,3),s;case"string":let a=Es(t.value),u=new DataView(new ArrayBuffer(3+a.byteLength));u.setUint8(0,7),u.setUint16(1,a.byteLength,!1);let l=new Uint8Array(u.buffer);return l.set(a,3),l;case"timestamp":let c=new Uint8Array(9);return c[0]=8,c.set(EP.fromNumber(t.value.valueOf()).bytes,1),c;case"uuid":if(!A2e.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);let f=new Uint8Array(17);return f[0]=9,f.set(Im(t.value.replace(/\-/g,"")),1),f}}},uX;(function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"})(uX||(uX={}));var A2e=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,EP=class e{constructor(t){if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);let n=new Uint8Array(8);for(let r=7,i=Math.abs(Math.round(t));r>-1&&i>0;r--,i/=256)n[r]=i;return t<0&&lX(n),new e(n)}valueOf(){let t=this.bytes.slice(0),n=t[0]&128;return n&&lX(t),parseInt(Kt(t),16)*(n?-1:1)}toString(){return String(this.valueOf())}};function lX(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}var vP=(e,t)=>{e=e.toLowerCase();for(let n of Object.keys(t))if(e===n.toLowerCase())return!0;return!1};var wP=(e,t={})=>{let{headers:n,query:r={}}=et.clone(e);for(let i of Object.keys(n)){let o=i.toLowerCase();(o.slice(0,6)==="x-amz-"&&!t.unhoistableHeaders?.has(o)||t.hoistableHeaders?.has(o))&&(r[i]=n[i],delete n[i])}return{...e,headers:n,query:r}};var $A=e=>{e=et.clone(e);for(let t of Object.keys(e.headers))XY.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e};var SP=({query:e={}})=>{let t=[],n={};for(let r of Object.keys(e)){if(r.toLowerCase()===KY)continue;let i=vs(r);t.push(i);let o=e[r];typeof o=="string"?n[i]=`${i}=${vs(o)}`:Array.isArray(o)&&(n[i]=o.slice(0).reduce((s,a)=>s.concat([`${i}=${vs(a)}`]),[]).sort().join("&"))}return t.sort().map(r=>n[r]).filter(r=>r).join("&")};var cX=e=>_2e(e).toISOString().replace(/\.\d{3}Z$/,"Z"),_2e=e=>typeof e=="number"?new Date(e*1e3):typeof e=="string"?Number(e)?new Date(Number(e)*1e3):new Date(e):e;var ox=class{constructor({applyChecksum:t,credentials:n,region:r,service:i,sha256:o,uriEscapePath:s=!0}){this.service=i,this.sha256=o,this.uriEscapePath=s,this.applyChecksum=typeof t=="boolean"?t:!0,this.regionProvider=Yr(r),this.credentialProvider=Yr(n)}createCanonicalRequest(t,n,r){let i=Object.keys(n).sort();return`${t.method}
${this.getCanonicalPath(t)}
${SP(t)}
${i.map(o=>`${o}:${n[o]}`).join(`
`)}

${i.join(";")}
${r}`}async createStringToSign(t,n,r,i){let o=new this.sha256;o.update(wu(r));let s=await o.digest();return`${i}
${t}
${n}
${Kt(s)}`}getCanonicalPath({path:t}){if(this.uriEscapePath){let n=[];for(let o of t.split("/"))o?.length!==0&&o!=="."&&(o===".."?n.pop():n.push(o));let r=`${t?.startsWith("/")?"/":""}${n.join("/")}${n.length>0&&t?.endsWith("/")?"/":""}`;return vs(r).replace(/%2F/g,"/")}return t}validateResolvedCredentials(t){if(typeof t!="object"||typeof t.accessKeyId!="string"||typeof t.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(t){let n=cX(t).replace(/[\-:]/g,"");return{longDate:n,shortDate:n.slice(0,8)}}getCanonicalHeaderList(t){return Object.keys(t).sort().join(";")}};var sx=class extends ox{constructor({applyChecksum:t,credentials:n,region:r,service:i,sha256:o,uriEscapePath:s=!0}){super({applyChecksum:t,credentials:n,region:r,service:i,sha256:o,uriEscapePath:s}),this.headerFormatter=new PA}async presign(t,n={}){let{signingDate:r=new Date,expiresIn:i=3600,unsignableHeaders:o,unhoistableHeaders:s,signableHeaders:a,hoistableHeaders:u,signingRegion:l,signingService:c}=n,f=await this.credentialProvider();this.validateResolvedCredentials(f);let d=l??await this.regionProvider(),{longDate:p,shortDate:m}=this.formatDate(r);if(i>iX)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let h=OA(m,d,c??this.service),g=wP($A(t),{unhoistableHeaders:s,hoistableHeaders:u});f.sessionToken&&(g.query[hP]=f.sessionToken),g.query[jY]=MA,g.query[WY]=`${f.accessKeyId}/${h}`,g.query[pP]=p,g.query[YY]=i.toString(10);let y=IA(g,o,a);return g.query[VY]=this.getCanonicalHeaderList(y),g.query[mP]=await this.getSignature(p,h,this.getSigningKey(f,d,m,c),this.createCanonicalRequest(g,y,await ix(t,this.sha256))),g}async sign(t,n){return typeof t=="string"?this.signString(t,n):t.headers&&t.payload?this.signEvent(t,n):t.message?this.signMessage(t,n):this.signRequest(t,n)}async signEvent({headers:t,payload:n},{signingDate:r=new Date,priorSignature:i,signingRegion:o,signingService:s}){let a=o??await this.regionProvider(),{shortDate:u,longDate:l}=this.formatDate(r),c=OA(u,a,s??this.service),f=await ix({headers:{},body:n},this.sha256),d=new this.sha256;d.update(t);let p=Kt(await d.digest()),m=[tX,l,c,i,p,f].join(`
`);return this.signString(m,{signingDate:r,signingRegion:a,signingService:s})}async signMessage(t,{signingDate:n=new Date,signingRegion:r,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:n,signingRegion:r,signingService:i,priorSignature:t.priorSignature}).then(s=>({message:t.message,signature:s}))}async signString(t,{signingDate:n=new Date,signingRegion:r,signingService:i}={}){let o=await this.credentialProvider();this.validateResolvedCredentials(o);let s=r??await this.regionProvider(),{shortDate:a}=this.formatDate(n),u=new this.sha256(await this.getSigningKey(o,s,a,i));return u.update(wu(t)),Kt(await u.digest())}async signRequest(t,{signingDate:n=new Date,signableHeaders:r,unsignableHeaders:i,signingRegion:o,signingService:s}={}){let a=await this.credentialProvider();this.validateResolvedCredentials(a);let u=o??await this.regionProvider(),l=$A(t),{longDate:c,shortDate:f}=this.formatDate(n),d=OA(f,u,s??this.service);l.headers[yP]=c,a.sessionToken&&(l.headers[QY]=a.sessionToken);let p=await ix(l,this.sha256);!vP(rx,l.headers)&&this.applyChecksum&&(l.headers[rx]=p);let m=IA(l,i,r),h=await this.getSignature(c,d,this.getSigningKey(a,u,f,s),this.createCanonicalRequest(l,m,p));return l.headers[gP]=`${MA} Credential=${a.accessKeyId}/${d}, SignedHeaders=${this.getCanonicalHeaderList(m)}, Signature=${h}`,l}async getSignature(t,n,r,i){let o=await this.createStringToSign(t,n,i,MA),s=new this.sha256(await r);return s.update(wu(o)),Kt(await s.digest())}getSigningKey(t,n,r,i){return sX(this.sha256,t,r,n,i||this.service)}};var fX=e=>{let t=e.credentials,n=!!e.credentials,r;Object.defineProperty(e,"credentials",{set(l){l&&l!==t&&l!==r&&(n=!0),t=l;let c=C2e(e,{credentials:t,credentialDefaultProvider:e.credentialDefaultProvider}),f=k2e(e,c);n&&!f.attributed?(r=async d=>f(d).then(p=>UY(p,"CREDENTIALS_CODE","e")),r.memoized=f.memoized,r.configBound=f.configBound,r.attributed=!0):r=f},get(){return r},enumerable:!0,configurable:!0}),e.credentials=t;let{signingEscapePath:i=!0,systemClockOffset:o=e.systemClockOffset||0,sha256:s}=e,a;return e.signer?a=Of(e.signer):e.regionInfoProvider?a=()=>Of(e.region)().then(async l=>[await e.regionInfoProvider(l,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},l]).then(([l,c])=>{let{signingRegion:f,signingService:d}=l;e.signingRegion=e.signingRegion||f||c,e.signingName=e.signingName||d||e.serviceId;let p={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:s,uriEscapePath:i},m=e.signerConstructor||sx;return new m(p)}):a=async l=>{l=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await Of(e.region)(),properties:{}},l);let c=l.signingRegion,f=l.signingName;e.signingRegion=e.signingRegion||c,e.signingName=e.signingName||f||e.serviceId;let d={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:s,uriEscapePath:i},p=e.signerConstructor||sx;return new p(d)},Object.assign(e,{systemClockOffset:o,signingEscapePath:i,signer:a})};function C2e(e,{credentials:t,credentialDefaultProvider:n}){let r;return t?t?.memoized?r=t:r=AA(t,SA,Jy):n?r=Of(n(Object.assign({},e,{parentClientConfig:e}))):r=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},r.memoized=!0,r}function k2e(e,t){if(t.configBound)return t;let n=async r=>t({...r,callerClientConfig:e});return n.memoized=t.memoized,n.configBound=!0,n}var dX=typeof TextEncoder=="function"?new TextEncoder:null,pX=e=>{if(typeof e=="string"){if(dX)return dX.encode(e).byteLength;let t=e.length;for(let n=t-1;n>=0;n--){let r=e.charCodeAt(n);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&n--}return t}else{if(typeof e.byteLength=="number")return e.byteLength;if(typeof e.size=="number")return e.size}throw new Error(`Body Length computation failed for ${e}`)};var Uf=(e,t)=>{let n=[];if(e&&n.push(e),t)for(let r of t)n.push(r);return n},Gl=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,$m=()=>{let e=[],t=[],n=!1,r=new Set,i=f=>f.sort((d,p)=>mX[p.step]-mX[d.step]||hX[p.priority||"normal"]-hX[d.priority||"normal"]),o=f=>{let d=!1,p=m=>{let h=Uf(m.name,m.aliases);if(h.includes(f)){d=!0;for(let g of h)r.delete(g);return!1}return!0};return e=e.filter(p),t=t.filter(p),d},s=f=>{let d=!1,p=m=>{if(m.middleware===f){d=!0;for(let h of Uf(m.name,m.aliases))r.delete(h);return!1}return!0};return e=e.filter(p),t=t.filter(p),d},a=f=>(e.forEach(d=>{f.add(d.middleware,{...d})}),t.forEach(d=>{f.addRelativeTo(d.middleware,{...d})}),f.identifyOnResolve?.(c.identifyOnResolve()),f),u=f=>{let d=[];return f.before.forEach(p=>{p.before.length===0&&p.after.length===0?d.push(p):d.push(...u(p))}),d.push(f),f.after.reverse().forEach(p=>{p.before.length===0&&p.after.length===0?d.push(p):d.push(...u(p))}),d},l=(f=!1)=>{let d=[],p=[],m={};return e.forEach(g=>{let y={...g,before:[],after:[]};for(let x of Uf(y.name,y.aliases))m[x]=y;d.push(y)}),t.forEach(g=>{let y={...g,before:[],after:[]};for(let x of Uf(y.name,y.aliases))m[x]=y;p.push(y)}),p.forEach(g=>{if(g.toMiddleware){let y=m[g.toMiddleware];if(y===void 0){if(f)return;throw new Error(`${g.toMiddleware} is not found when adding ${Gl(g.name,g.aliases)} middleware ${g.relation} ${g.toMiddleware}`)}g.relation==="after"&&y.after.push(g),g.relation==="before"&&y.before.push(g)}}),i(d).map(u).reduce((g,y)=>(g.push(...y),g),[])},c={add:(f,d={})=>{let{name:p,override:m,aliases:h}=d,g={step:"initialize",priority:"normal",middleware:f,...d},y=Uf(p,h);if(y.length>0){if(y.some(x=>r.has(x))){if(!m)throw new Error(`Duplicate middleware name '${Gl(p,h)}'`);for(let x of y){let b=e.findIndex(v=>v.name===x||v.aliases?.some(S=>S===x));if(b===-1)continue;let E=e[b];if(E.step!==g.step||g.priority!==E.priority)throw new Error(`"${Gl(E.name,E.aliases)}" middleware with ${E.priority} priority in ${E.step} step cannot be overridden by "${Gl(p,h)}" middleware with ${g.priority} priority in ${g.step} step.`);e.splice(b,1)}}for(let x of y)r.add(x)}e.push(g)},addRelativeTo:(f,d)=>{let{name:p,override:m,aliases:h}=d,g={middleware:f,...d},y=Uf(p,h);if(y.length>0){if(y.some(x=>r.has(x))){if(!m)throw new Error(`Duplicate middleware name '${Gl(p,h)}'`);for(let x of y){let b=t.findIndex(v=>v.name===x||v.aliases?.some(S=>S===x));if(b===-1)continue;let E=t[b];if(E.toMiddleware!==g.toMiddleware||E.relation!==g.relation)throw new Error(`"${Gl(E.name,E.aliases)}" middleware ${E.relation} "${E.toMiddleware}" middleware cannot be overridden by "${Gl(p,h)}" middleware ${g.relation} "${g.toMiddleware}" middleware.`);t.splice(b,1)}}for(let x of y)r.add(x)}t.push(g)},clone:()=>a($m()),use:f=>{f.applyToStack(c)},remove:f=>typeof f=="string"?o(f):s(f),removeByTag:f=>{let d=!1,p=m=>{let{tags:h,name:g,aliases:y}=m;if(h&&h.includes(f)){let x=Uf(g,y);for(let b of x)r.delete(b);return d=!0,!1}return!0};return e=e.filter(p),t=t.filter(p),d},concat:f=>{let d=a($m());return d.use(f),d.identifyOnResolve(n||d.identifyOnResolve()||(f.identifyOnResolve?.()??!1)),d},applyToStack:a,identify:()=>l(!0).map(f=>{let d=f.step??f.relation+" "+f.toMiddleware;return Gl(f.name,f.aliases)+" - "+d}),identifyOnResolve(f){return typeof f=="boolean"&&(n=f),n},resolve:(f,d)=>{for(let p of l().map(m=>m.middleware).reverse())f=p(f,d);return n&&console.log(c.identify()),f}};return c},mX={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},hX={high:3,normal:2,low:1};var BA=class{constructor(t){this.config=t,this.middlewareStack=$m()}send(t,n,r){let i=typeof n!="function"?n:void 0,o=typeof n=="function"?n:r,s=i===void 0&&this.config.cacheMiddleware===!0,a;if(s){this.handlers||(this.handlers=new WeakMap);let u=this.handlers;u.has(t.constructor)?a=u.get(t.constructor):(a=t.resolveMiddleware(this.middlewareStack,this.config,i),u.set(t.constructor,a))}else delete this.handlers,a=t.resolveMiddleware(this.middlewareStack,this.config,i);if(o)a(t).then(u=>o(null,u.output),u=>o(u)).catch(()=>{});else return a(t).then(u=>u.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}};var ax=class{constructor(){this.middlewareStack=$m()}static classBuilder(){return new AP}resolveMiddlewareWithContext(t,n,r,{middlewareFn:i,clientName:o,commandName:s,inputFilterSensitiveLog:a,outputFilterSensitiveLog:u,smithyContext:l,additionalContext:c,CommandCtor:f}){for(let g of i.bind(this)(f,t,n,r))this.middlewareStack.use(g);let d=t.concat(this.middlewareStack),{logger:p}=n,m={logger:p,clientName:o,commandName:s,inputFilterSensitiveLog:a,outputFilterSensitiveLog:u,[Xy]:{commandInstance:this,...l},...c},{requestHandler:h}=n;return d.resolve(g=>h.handle(g.request,r||{}),m)}},AP=class{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=t=>t,this._outputFilterSensitiveLog=t=>t,this._serializer=null,this._deserializer=null}init(t){this._init=t}ep(t){return this._ep=t,this}m(t){return this._middlewareFn=t,this}s(t,n,r={}){return this._smithyContext={service:t,operation:n,...r},this}c(t={}){return this._additionalContext=t,this}n(t,n){return this._clientName=t,this._commandName=n,this}f(t=r=>r,n=r=>r){return this._inputFilterSensitiveLog=t,this._outputFilterSensitiveLog=n,this}ser(t){return this._serializer=t,this}de(t){return this._deserializer=t,this}sc(t){return this._operationSchema=t,this._smithyContext.operationSchema=t,this}build(){let t=this,n;return n=class extends ax{static getEndpointParameterInstructions(){return t._ep}constructor(...[r]){super(),this.serialize=t._serializer,this.deserialize=t._deserializer,this.input=r??{},t._init(this),this.schema=t._operationSchema}resolveMiddleware(r,i,o){return this.resolveMiddlewareWithContext(r,i,o,{CommandCtor:n,middlewareFn:t._middlewareFn,clientName:t._clientName,commandName:t._commandName,inputFilterSensitiveLog:t._inputFilterSensitiveLog,outputFilterSensitiveLog:t._outputFilterSensitiveLog,smithyContext:t._smithyContext,additionalContext:t._additionalContext})}}}};var _P="***SensitiveInformation***";var LA=class e extends Error{constructor(t){super(t.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;let n=t;return e.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;let n=t;return this===e?e.isInstance(t):e.isInstance(t)?n.name&&this.name?this.prototype.isPrototypeOf(t)||n.name===this.name:this.prototype.isPrototypeOf(t):!1}},Kr=(e,t={})=>{Object.entries(t).filter(([,r])=>r!==void 0).forEach(([r,i])=>{(e[r]==null||e[r]==="")&&(e[r]=i)});let n=e.message||e.Message||"UnknownError";return e.message=n,delete e.Message,e};var F2e=({output:e,parsedBody:t,exceptionCtor:n,errorCode:r})=>{let i=R2e(e),o=i.httpStatusCode?i.httpStatusCode+"":void 0,s=new n({name:t?.code||t?.Code||r||o||"UnknownError",$fault:"client",$metadata:i});throw Kr(s,t)},gX=e=>({output:t,parsedBody:n,errorCode:r})=>{F2e({output:t,parsedBody:n,exceptionCtor:e,errorCode:r})},R2e=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]});var yX=e=>{switch(e){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}};var xX=e=>{let t=[];for(let n in Mm){let r=Mm[n];e[r]!==void 0&&t.push({algorithmId:()=>r,checksumConstructor:()=>e[r]})}return{addChecksumAlgorithm(n){t.push(n)},checksumAlgorithms(){return t}}},bX=e=>{let t={};return e.checksumAlgorithms().forEach(n=>{t[n.algorithmId()]=n.checksumConstructor()}),t};var EX=e=>({setRetryStrategy(t){e.retryStrategy=t},retryStrategy(){return e.retryStrategy}}),vX=e=>{let t={};return t.retryStrategy=e.retryStrategy(),t};var wX=e=>Object.assign(xX(e),EX(e));var SX=e=>Object.assign(bX(e),vX(e));var AX=e=>e!=null;var Bm=class{trace(){}debug(){}info(){}warn(){}error(){}};function Cr(e,t,n){let r,i,o;if(typeof t>"u"&&typeof n>"u")r={},o=e;else{if(r=e,typeof t=="function")return i=t,o=n,T2e(r,i,o);o=t}for(let s of Object.keys(o)){if(!Array.isArray(o[s])){r[s]=o[s];continue}_X(r,null,o,s)}return r}var ji=(e,t)=>{let n={};for(let r in t)_X(n,e,t,r);return n},T2e=(e,t,n)=>Cr(e,Object.entries(n).reduce((r,[i,o])=>(Array.isArray(o)?r[i]=o:typeof o=="function"?r[i]=[t,o()]:r[i]=[t,o],r),{})),_X=(e,t,n,r)=>{if(t!==null){let s=n[r];typeof s=="function"&&(s=[,s]);let[a=D2e,u=M2e,l=r]=s;(typeof a=="function"&&a(t[l])||typeof a!="function"&&a)&&(e[r]=u(t[l]));return}let[i,o]=n[r];if(typeof o=="function"){let s,a=i===void 0&&(s=o())!=null,u=typeof i=="function"&&!!i(void 0)||typeof i!="function"&&!!i;a?e[r]=s:u&&(e[r]=o())}else{let s=i===void 0&&o!=null,a=typeof i=="function"&&!!i(o)||typeof i!="function"&&!!i;(s||a)&&(e[r]=o)}},D2e=e=>e!=null,M2e=e=>e;var CX=(e,t)=>Qy(e,t).then(n=>t.utf8Encoder(n));var kX=(e,t)=>CX(e,t).then(n=>{if(n.length)try{return JSON.parse(n)}catch(r){throw r?.name==="SyntaxError"&&Object.defineProperty(r,"$responseBodyText",{value:n}),r}return{}}),FX=async(e,t)=>{let n=await kX(e,t);return n.message=n.message??n.Message,n},RX=(e,t)=>{let n=(o,s)=>Object.keys(o).find(a=>a.toLowerCase()===s.toLowerCase()),r=o=>{let s=o;return typeof s=="number"&&(s=s.toString()),s.indexOf(",")>=0&&(s=s.split(",")[0]),s.indexOf(":")>=0&&(s=s.split(":")[0]),s.indexOf("#")>=0&&(s=s.split("#")[1]),s},i=n(e.headers,"x-amzn-errortype");if(i!==void 0)return r(e.headers[i]);if(t&&typeof t=="object"){let o=n(t,"code");if(o&&t[o]!==void 0)return r(t[o]);if(t.__type!==void 0)return r(t.__type)}};var N2e=/\d{12}\.ddb/;async function TX(e,t,n){if(n.request?.headers?.["smithy-protocol"]==="rpc-v2-cbor"&&ws(e,"PROTOCOL_RPC_V2_CBOR","M"),typeof t.retryStrategy=="function"){let o=await t.retryStrategy();typeof o.acquireInitialRetryToken=="function"?o.constructor?.name?.includes("Adaptive")?ws(e,"RETRY_MODE_ADAPTIVE","F"):ws(e,"RETRY_MODE_STANDARD","E"):ws(e,"RETRY_MODE_LEGACY","D")}if(typeof t.accountIdEndpointMode=="function"){let o=e.endpointV2;switch(String(o?.url?.hostname).match(N2e)&&ws(e,"ACCOUNT_ID_ENDPOINT","O"),await t.accountIdEndpointMode?.()){case"disabled":ws(e,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":ws(e,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":ws(e,"ACCOUNT_ID_MODE_REQUIRED","R");break}}let i=e.__smithy_context?.selectedHttpAuthScheme?.identity;if(i?.$source){let o=i;o.accountId&&ws(e,"RESOLVED_ACCOUNT_ID","T");for(let[s,a]of Object.entries(o.$source??{}))ws(e,s,a)}}var CP="user-agent",UA="x-amz-user-agent",kP=" ",zA="/",DX=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,MX=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,FP="-";function NX(e){let t="";for(let n in e){let r=e[n];if(t.length+r.length+1<=1024){t.length?t+=","+r:t+=r;continue}break}return t}var O2e=e=>(t,n)=>async r=>{let{request:i}=r;if(!et.isInstance(i))return t(r);let{headers:o}=i,s=n?.userAgent?.map(HA)||[],a=(await e.defaultUserAgentProvider()).map(HA);await TX(n,e,r);let u=n;a.push(`m/${NX(Object.assign({},n.__smithy_context?.features,u.__aws_sdk_context?.features))}`);let l=e?.customUserAgent?.map(HA)||[],c=await e.userAgentAppId();c&&a.push(HA([`app/${c}`]));let f=BY(),d=(f?[f]:[]).concat([...a,...s,...l]).join(kP),p=[...a.filter(m=>m.startsWith("aws-sdk-")),...l].join(kP);return e.runtime!=="browser"?(p&&(o[UA]=o[UA]?`${o[CP]} ${p}`:p),o[CP]=d):o[UA]=d,t({...r,request:i})},HA=e=>{let t=e[0].split(zA).map(s=>s.replace(DX,FP)).join(zA),n=e[1]?.replace(MX,FP),r=t.indexOf(zA),i=t.substring(0,r),o=t.substring(r+1);return i==="api"&&(o=o.toLowerCase()),[i,o,n].filter(s=>s&&s.length>0).reduce((s,a,u)=>{switch(u){case 0:return a;case 1:return`${s}/${a}`;default:return`${s}#${a}`}},"")},I2e={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},OX=e=>({applyToStack:t=>{t.add(O2e(e),I2e)}});function qA(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(c){try{l(r.next(c))}catch(f){s(f)}}function u(c){try{l(r.throw(c))}catch(f){s(f)}}function l(c){c.done?o(c.value):i(c.value).then(a,u)}l((r=r.apply(e,t||[])).next())})}function GA(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function IX(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var RP=e=>new TextEncoder().encode(e);var P2e=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:RP;function Ss(e){return e instanceof Uint8Array?e:typeof e=="string"?P2e(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function jl(e){return typeof e=="string"?e.length===0:e.byteLength===0}function TP(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}function DP(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),n=0;n<e.length;)t[n]=e[n],n+=1;return t}return Uint32Array.from(e)}var $2e=function(){function e(){this.crc32=new zf}return e.prototype.update=function(t){jl(t)||this.crc32.update(Ss(t))},e.prototype.digest=function(){return qA(this,void 0,void 0,function(){return GA(this,function(t){return[2,TP(this.crc32.digest())]})})},e.prototype.reset=function(){this.crc32=new zf},e}();var zf=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(t){var n,r;try{for(var i=IX(t),o=i.next();!o.done;o=i.next()){var s=o.value;this.checksum=this.checksum>>>8^L2e[(this.checksum^s)&255]}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return this},e.prototype.digest=function(){return(this.checksum^4294967295)>>>0},e}();var B2e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],L2e=DP(B2e);var Lm=class e{constructor(t){if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);let n=new Uint8Array(8);for(let r=7,i=Math.abs(Math.round(t));r>-1&&i>0;r--,i/=256)n[r]=i;return t<0&&PX(n),new e(n)}valueOf(){let t=this.bytes.slice(0),n=t[0]&128;return n&&PX(t),parseInt(Kt(t),16)*(n?-1:1)}toString(){return String(this.valueOf())}};function PX(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}var jA=class{constructor(t,n){this.toUtf8=t,this.fromUtf8=n}format(t){let n=[];for(let o of Object.keys(t)){let s=this.fromUtf8(o);n.push(Uint8Array.from([s.byteLength]),s,this.formatHeaderValue(t[o]))}let r=new Uint8Array(n.reduce((o,s)=>o+s.byteLength,0)),i=0;for(let o of n)r.set(o,i),i+=o.byteLength;return r}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":let n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,t.value,!1),new Uint8Array(n.buffer);case"integer":let r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,t.value,!1),new Uint8Array(r.buffer);case"long":let i=new Uint8Array(9);return i[0]=5,i.set(t.value.bytes,1),i;case"binary":let o=new DataView(new ArrayBuffer(3+t.value.byteLength));o.setUint8(0,6),o.setUint16(1,t.value.byteLength,!1);let s=new Uint8Array(o.buffer);return s.set(t.value,3),s;case"string":let a=this.fromUtf8(t.value),u=new DataView(new ArrayBuffer(3+a.byteLength));u.setUint8(0,7),u.setUint16(1,a.byteLength,!1);let l=new Uint8Array(u.buffer);return l.set(a,3),l;case"timestamp":let c=new Uint8Array(9);return c[0]=8,c.set(Lm.fromNumber(t.value.valueOf()).bytes,1),c;case"uuid":if(!Y2e.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);let f=new Uint8Array(17);return f[0]=9,f.set(Im(t.value.replace(/\-/g,"")),1),f}}parse(t){let n={},r=0;for(;r<t.byteLength;){let i=t.getUint8(r++),o=this.toUtf8(new Uint8Array(t.buffer,t.byteOffset+r,i));switch(r+=i,t.getUint8(r++)){case 0:n[o]={type:BX,value:!0};break;case 1:n[o]={type:BX,value:!1};break;case 2:n[o]={type:U2e,value:t.getInt8(r++)};break;case 3:n[o]={type:z2e,value:t.getInt16(r,!1)},r+=2;break;case 4:n[o]={type:H2e,value:t.getInt32(r,!1)},r+=4;break;case 5:n[o]={type:q2e,value:new Lm(new Uint8Array(t.buffer,t.byteOffset+r,8))},r+=8;break;case 6:let s=t.getUint16(r,!1);r+=2,n[o]={type:G2e,value:new Uint8Array(t.buffer,t.byteOffset+r,s)},r+=s;break;case 7:let a=t.getUint16(r,!1);r+=2,n[o]={type:j2e,value:this.toUtf8(new Uint8Array(t.buffer,t.byteOffset+r,a))},r+=a;break;case 8:n[o]={type:W2e,value:new Date(new Lm(new Uint8Array(t.buffer,t.byteOffset+r,8)).valueOf())},r+=8;break;case 9:let u=new Uint8Array(t.buffer,t.byteOffset+r,16);r+=16,n[o]={type:V2e,value:`${Kt(u.subarray(0,4))}-${Kt(u.subarray(4,6))}-${Kt(u.subarray(6,8))}-${Kt(u.subarray(8,10))}-${Kt(u.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return n}},$X;(function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"})($X||($X={}));var BX="boolean",U2e="byte",z2e="short",H2e="integer",q2e="long",G2e="binary",j2e="string",W2e="timestamp",V2e="uuid",Y2e=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;var LX=4,Wl=LX*2,Hf=4,X2e=Wl+Hf*2;function UX({byteLength:e,byteOffset:t,buffer:n}){if(e<X2e)throw new Error("Provided message too short to accommodate event stream message overhead");let r=new DataView(n,t,e),i=r.getUint32(0,!1);if(e!==i)throw new Error("Reported message length does not match received message length");let o=r.getUint32(LX,!1),s=r.getUint32(Wl,!1),a=r.getUint32(e-Hf,!1),u=new zf().update(new Uint8Array(n,t,Wl));if(s!==u.digest())throw new Error(`The prelude checksum specified in the message (${s}) does not match the calculated CRC32 checksum (${u.digest()})`);if(u.update(new Uint8Array(n,t+Wl,e-(Wl+Hf))),a!==u.digest())throw new Error(`The message checksum (${u.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(n,t+Wl+Hf,o),body:new Uint8Array(n,t+Wl+Hf+o,i-o-(Wl+Hf+Hf))}}var Um=class{constructor(t,n){this.headerMarshaller=new jA(t,n),this.messageBuffer=[],this.isEndOfStream=!1}feed(t){this.messageBuffer.push(this.decode(t))}endOfStream(){this.isEndOfStream=!0}getMessage(){let t=this.messageBuffer.pop(),n=this.isEndOfStream;return{getMessage(){return t},isEndOfStream(){return n}}}getAvailableMessages(){let t=this.messageBuffer;this.messageBuffer=[];let n=this.isEndOfStream;return{getMessages(){return t},isEndOfStream(){return n}}}encode({headers:t,body:n}){let r=this.headerMarshaller.format(t),i=r.byteLength+n.byteLength+16,o=new Uint8Array(i),s=new DataView(o.buffer,o.byteOffset,o.byteLength),a=new zf;return s.setUint32(0,i,!1),s.setUint32(4,r.byteLength,!1),s.setUint32(8,a.update(o.subarray(0,8)).digest(),!1),o.set(r,12),o.set(n,r.byteLength+12),s.setUint32(i-4,a.update(o.subarray(8,i-4)).digest(),!1),o}decode(t){let{headers:n,body:r}=UX(t);return{headers:this.headerMarshaller.parse(n),body:r}}formatHeaders(t){return this.headerMarshaller.format(t)}};var WA=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.inputStream)yield this.options.decoder.decode(t)}};var VA=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.messageStream)yield this.options.encoder.encode(t);this.options.includeEndFrame&&(yield new Uint8Array(0))}};var YA=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.messageStream){let n=await this.options.deserializer(t);n!==void 0&&(yield n)}}};var XA=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.inputStream)yield this.options.serializer(t)}};var zX=(e,t,n,r)=>{let i=e,o={start(){},async transform(s,a){try{let u=new Date(Date.now()+await r()),l={":date":{type:"timestamp",value:u}},c=await t.sign({message:{body:s,headers:l},priorSignature:i},{signingDate:u});i=c.signature;let f=n.encode({headers:{...l,":chunk-signature":{type:"binary",value:Im(c.signature)}},body:s});a.enqueue(f)}catch(u){a.error(u)}}};return new TransformStream({...o})};var KA=class{constructor(t){Re(this,"messageSigner");Re(this,"eventStreamCodec");Re(this,"systemClockOffsetProvider");this.messageSigner=t.messageSigner,this.eventStreamCodec=new Um(t.utf8Encoder,t.utf8Decoder),this.systemClockOffsetProvider=async()=>t.systemClockOffset??0}async handle(t,n,r={}){let i=n.request,{body:o,headers:s,query:a}=i;if(!(o instanceof ReadableStream))throw new Error("Eventstream payload must be a ReadableStream.");let u=new TransformStream;i.body=u.readable;let l;try{l=await t(n)}catch(m){throw i.body.cancel(),m}let f=((s.authorization||"").match(/Signature=([\w]+)$/)||[])[1]||a&&a["X-Amz-Signature"]||"",d=zX(f,await this.messageSigner(),this.eventStreamCodec,this.systemClockOffsetProvider);return o.pipeThrough(d).pipeThrough(u),l}};var HX=e=>new KA(e);var QA=e=>e.protocol==="ws:"||e.protocol==="wss:";var JA=class{constructor(t){Re(this,"signer");this.signer=t.signer}presign(t,n={}){return this.signer.presign(t,n)}async sign(t,n){return et.isInstance(t)&&QA(t)?{...await this.signer.presign({...t,body:""},{...n,expiresIn:60,unsignableHeaders:new Set(Object.keys(t.headers).filter(i=>i!=="host"))}),body:t.body}:this.signer.sign(t,n)}};var qX=e=>{let{signer:t}=e;return Object.assign(e,{signer:async n=>{let r=await t(n);if(K2e(r))return new JA({signer:r});throw new Error("Expected WebsocketSignatureV4 signer, please check the client constructor.")}})},K2e=e=>!!e;function GX(e){let{port:t,query:n}=e,{protocol:r,path:i,hostname:o}=e;r&&r.slice(-1)!==":"&&(r+=":"),t&&(o+=`:${t}`),i&&i.charAt(0)!=="/"&&(i=`/${i}`);let s=n?bA(n):"";s&&s[0]!=="?"&&(s=`?${s}`);let a="";if(e.username!=null||e.password!=null){let l=e.username??"",c=e.password??"";a=`${l}:${c}@`}let u="";return e.fragment&&(u=`#${e.fragment}`),`${r}//${a}${o}${i}${s}${u}`}function jX(e){let t=0,n=0,r=null,i=null,o=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);t=a,n=4,r=new Uint8Array(a),new DataView(r.buffer).setUint32(0,a,!1)},s=async function*(){let a=e[Symbol.asyncIterator]();for(;;){let{value:u,done:l}=await a.next();if(l){if(t)if(t===n)yield r;else throw new Error("Truncated event message received.");else return;return}let c=u.length,f=0;for(;f<c;){if(!r){let p=c-f;i||(i=new Uint8Array(4));let m=Math.min(4-n,p);if(i.set(u.slice(f,f+m),n),n+=m,f+=m,n<4)break;o(new DataView(i.buffer).getUint32(0,!1)),i=null}let d=Math.min(t-n,c-f);r.set(u.slice(f,f+d),n),n+=d,f+=d,t&&t===n&&(yield r,r=null,t=0,n=0)}}};return{[Symbol.asyncIterator]:s}}function WX(e,t){return async function(n){let{value:r}=n.headers[":message-type"];if(r==="error"){let i=new Error(n.headers[":error-message"].value||"UnknownError");throw i.name=n.headers[":error-code"].value,i}else if(r==="exception"){let i=n.headers[":exception-type"].value,o={[i]:n},s=await e(o);if(s.$unknown){let a=new Error(t(n.body));throw a.name=i,a}throw s[i]}else if(r==="event"){let i={[n.headers[":event-type"].value]:n},o=await e(i);return o.$unknown?void 0:o}else throw Error(`Unrecognizable event type: ${n.headers[":event-type"].value}`)}}var ux=class{constructor({utf8Encoder:t,utf8Decoder:n}){this.eventStreamCodec=new Um(t,n),this.utfEncoder=t}deserialize(t,n){let r=jX(t);return new YA({messageStream:new WA({inputStream:r,decoder:this.eventStreamCodec}),deserializer:WX(n,this.utfEncoder)})}serialize(t,n){return new VA({messageStream:new XA({inputStream:t,serializer:n}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};var ZA=e=>({[Symbol.asyncIterator]:async function*(){let t=e.getReader();try{for(;;){let{done:n,value:r}=await t.read();if(n)return;yield r}}finally{t.releaseLock()}}}),e_=e=>{let t=e[Symbol.asyncIterator]();return new ReadableStream({async pull(n){let{done:r,value:i}=await t.next();if(r)return n.close();n.enqueue(i)}})};var t_=class{constructor({utf8Encoder:t,utf8Decoder:n}){this.universalMarshaller=new ux({utf8Decoder:n,utf8Encoder:t})}deserialize(t,n){let r=Q2e(t)?ZA(t):t;return this.universalMarshaller.deserialize(r,n)}serialize(t,n){let r=this.universalMarshaller.serialize(t,n);return typeof ReadableStream=="function"?e_(r):r}},Q2e=e=>typeof ReadableStream=="function"&&e instanceof ReadableStream;var VX=e=>new t_(e);var J2e=2e3,n_=class e{constructor(t,n=new $f){Re(this,"metadata",{handlerProtocol:"websocket/h1.1"});Re(this,"config");Re(this,"configPromise");Re(this,"httpHandler");Re(this,"sockets",{});this.httpHandler=n,typeof t=="function"?(this.config={},this.configPromise=t().then(r=>this.config=r??{})):(this.config=t??{},this.configPromise=Promise.resolve(this.config))}static create(t,n=new $f){return typeof t?.handle=="function"?t:new e(t,n)}destroy(){for(let[t,n]of Object.entries(this.sockets)){for(let r of n)r.close(1e3,"Socket closed through destroy() call");delete this.sockets[t]}}async handle(t){if(!QA(t))return this.httpHandler.handle(t);let n=GX(t),r=new WebSocket(n);this.sockets[n]||(this.sockets[n]=[]),this.sockets[n].push(r),r.binaryType="arraybuffer",this.config=await this.configPromise;let{connectionTimeout:i=J2e}=this.config;await this.waitForReady(r,i);let{body:o}=t,s=Z2e(o),a=this.connect(r,s),u=eCe(a);return{response:new wi({statusCode:200,body:u})}}updateHttpClientConfig(t,n){this.configPromise=this.configPromise.then(r=>(r[t]=n,r))}httpHandlerConfigs(){return this.config??{}}removeNotUsableSockets(t){this.sockets[t]=(this.sockets[t]??[]).filter(n=>![WebSocket.CLOSING,WebSocket.CLOSED].includes(n.readyState))}waitForReady(t,n){return new Promise((r,i)=>{let o=setTimeout(()=>{this.removeNotUsableSockets(t.url),i({$metadata:{httpStatusCode:500}})},n);t.onopen=()=>{clearTimeout(o),r()}})}connect(t,n){let r,i=!1,o=()=>{},s=()=>{};t.onmessage=l=>{s({done:!1,value:new Uint8Array(l.data)})},t.onerror=l=>{i=!0,t.close(),o(l)},t.onclose=()=>{this.removeNotUsableSockets(t.url),!i&&(r?o(r):s({done:!0,value:void 0}))};let a={[Symbol.asyncIterator]:()=>({next:()=>new Promise((l,c)=>{s=l,o=c})})};return(async()=>{try{for await(let l of n)t.send(l)}catch(l){r=l}finally{t.close(1e3)}})(),a}},Z2e=e=>e[Symbol.asyncIterator]?e:tCe(e)?ZA(e):{[Symbol.asyncIterator]:async function*(){yield e}},eCe=e=>typeof ReadableStream=="function"?e_(e):e,tCe=e=>typeof ReadableStream=="function"&&e instanceof ReadableStream;var r_;(function(e){e.ENV="env",e.CONFIG="shared config entry"})(r_||(r_={}));var YX=!1;var XX=!1;var i_=e=>typeof e=="string"&&(e.startsWith("fips-")||e.endsWith("-fips"));var MP=e=>i_(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e;var KX=e=>{let{region:t,useFipsEndpoint:n}=e;if(!t)throw new Error("Region is missing");return Object.assign(e,{region:async()=>{if(typeof t=="string")return MP(t);let r=await t();return MP(r)},useFipsEndpoint:async()=>{let r=typeof t=="string"?t:await t();return i_(r)?!0:typeof n!="function"?Promise.resolve(!!n):n()}})};var QX=e=>Object.assign(e,{eventStreamMarshaller:e.eventStreamSerdeProvider(e)});var JX="content-length";function rCe(e){return t=>async n=>{let r=n.request;if(et.isInstance(r)){let{body:i,headers:o}=r;if(i&&Object.keys(o).map(s=>s.toLowerCase()).indexOf(JX)===-1)try{let s=e(i);r.headers={...r.headers,[JX]:String(s)}}catch{}}return t({...n,request:r})}}var iCe={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},ZX=e=>({applyToStack:t=>{t.add(rCe(e.bodyLengthChecker),iCe)}});var eK=async e=>{let t=e?.Bucket||"";if(typeof e.Bucket=="string"&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),lCe(t)){if(e.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!uCe(t)||t.indexOf(".")!==-1&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e},oCe=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,sCe=/(\d+\.){3}\d+/,aCe=/\.\./;var uCe=e=>oCe.test(e)&&!sCe.test(e)&&!aCe.test(e),lCe=e=>{let[t,n,r,,,i]=e.split(":"),o=t==="arn"&&e.split(":").length>=6,s=!!(o&&n&&r&&i);if(o&&!s)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return s};var tK=(e,t,n)=>{let r=async()=>{let i=n[e]??n[t];return typeof i=="function"?i():i};return e==="credentialScope"||t==="CredentialScope"?async()=>{let i=typeof n.credentials=="function"?await n.credentials():n.credentials;return i?.credentialScope??i?.CredentialScope}:e==="accountId"||t==="AccountId"?async()=>{let i=typeof n.credentials=="function"?await n.credentials():n.credentials;return i?.accountId??i?.AccountId}:e==="endpoint"||t==="endpoint"?async()=>{if(n.isCustomEndpoint===!1)return;let i=await r();if(i&&typeof i=="object"){if("url"in i)return i.url.href;if("hostname"in i){let{protocol:o,hostname:s,port:a,path:u}=i;return`${o}//${s}${a?":"+a:""}${u}`}}return i}:r};var o_=async e=>{};var s_=e=>typeof e=="object"?"url"in e?Lf(e.url):e:Lf(e);var nK=async(e,t,n,r)=>{if(!n.isCustomEndpoint){let s;n.serviceConfiguredEndpoint?s=await n.serviceConfiguredEndpoint():s=await o_(n.serviceId),s&&(n.endpoint=()=>Promise.resolve(s_(s)),n.isCustomEndpoint=!0)}let i=await cCe(e,t,n);if(typeof n.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return n.endpointProvider(i,r)},cCe=async(e,t,n)=>{let r={},i=t?.getEndpointParameterInstructions?.()||{};for(let[o,s]of Object.entries(i))switch(s.type){case"staticContextParams":r[o]=s.value;break;case"contextParams":r[o]=e[s.name];break;case"clientContextParams":case"builtInParams":r[o]=await tK(s.name,o,n)();break;case"operationContextParams":r[o]=s.get(e);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(s))}return Object.keys(i).length===0&&Object.assign(r,n),String(n.serviceId).toLowerCase()==="s3"&&await eK(r),r};var rK=({config:e,instructions:t})=>(n,r)=>async i=>{e.isCustomEndpoint&&gY(r,"ENDPOINT_OVERRIDE","N");let o=await nK(i.input,{getEndpointParameterInstructions(){return t}},{...e},r);r.endpointV2=o,r.authSchemes=o.properties?.authSchemes;let s=r.authSchemes?.[0];if(s){r.signing_region=s.signingRegion,r.signing_service=s.signingName;let u=zl(r)?.selectedHttpAuthScheme?.httpAuthOption;u&&(u.signingProperties=Object.assign(u.signingProperties||{},{signing_region:s.signingRegion,signingRegion:s.signingRegion,signing_service:s.signingName,signingName:s.signingName,signingRegionSet:s.signingRegionSet},s.properties))}return n({...i})};var fCe={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:YI.name},iK=(e,t)=>({applyToStack:n=>{n.addRelativeTo(rK({config:e,instructions:t}),fCe)}});var oK=e=>{let t=e.tls??!0,{endpoint:n,useDualstackEndpoint:r,useFipsEndpoint:i}=e,o=n!=null?async()=>s_(await Yr(n)()):void 0,a=Object.assign(e,{endpoint:o,tls:t,isCustomEndpoint:!!n,useDualstackEndpoint:Yr(r??!1),useFipsEndpoint:Yr(i??!1)}),u;return a.serviceConfiguredEndpoint=async()=>(e.serviceId&&!u&&(u=o_(e.serviceId)),u),a};var As;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(As||(As={}));var Vl=3,NP=As.STANDARD;var sK=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],aK=["TimeoutError","RequestTimeout","RequestTimeoutException"],uK=[500,502,503,504],lK=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],cK=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"];var dCe=e=>e.$metadata?.clockSkewCorrected,pCe=e=>{let t=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return e&&e instanceof TypeError?t.has(e.message):!1},zm=e=>e.$metadata?.httpStatusCode===429||sK.includes(e.name)||e.$retryable?.throttling==!0,lx=(e,t=0)=>dCe(e)||aK.includes(e.name)||lK.includes(e?.code||"")||cK.includes(e?.code||"")||uK.includes(e.$metadata?.httpStatusCode||0)||pCe(e)||e.cause!==void 0&&t<=10&&lx(e.cause,t+1),fK=e=>{if(e.$metadata?.httpStatusCode!==void 0){let t=e.$metadata.httpStatusCode;return 500<=t&&t<=599&&!lx(e)}return!1};var Hm=class e{constructor(t){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=t?.beta??.7,this.minCapacity=t?.minCapacity??1,this.minFillRate=t?.minFillRate??.5,this.scaleConstant=t?.scaleConstant??.4,this.smooth=t?.smooth??.8;let n=this.getCurrentTimeInSeconds();this.lastThrottleTime=n,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(t){if(this.enabled){if(this.refillTokenBucket(),t>this.currentCapacity){let n=(t-this.currentCapacity)/this.fillRate*1e3;await new Promise(r=>e.setTimeoutFn(r,n))}this.currentCapacity=this.currentCapacity-t}}refillTokenBucket(){let t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}let n=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+n),this.lastTimestamp=t}updateClientSendingRate(t){let n;if(this.updateMeasuredRate(),zm(t)){let i=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=i,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),n=this.cubicThrottle(i),this.enableTokenBucket()}else this.calculateTimeWindow(),n=this.cubicSuccess(this.getCurrentTimeInSeconds());let r=Math.min(n,2*this.measuredTxRate);this.updateTokenBucketRate(r)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(t){return this.getPrecise(t*this.beta)}cubicSuccess(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){let t=this.getCurrentTimeInSeconds(),n=Math.floor(t*2)/2;if(this.requestCount++,n>this.lastTxRateBucket){let r=this.requestCount/(n-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(r*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=n}}getPrecise(t){return parseFloat(t.toFixed(8))}};Hm.setTimeoutFn=setTimeout;var a_="amz-sdk-invocation-id",u_="amz-sdk-request";var dK=()=>{let e=100;return{computeNextBackoffDelay:r=>Math.floor(Math.min(2e4,Math.random()*2**r*e)),setDelayBase:r=>{e=r}}};var OP=({retryDelay:e,retryCount:t,retryCost:n})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(2e4,e),getRetryCost:()=>n});var qf=class{constructor(t){this.maxAttempts=t,this.mode=As.STANDARD,this.capacity=500,this.retryBackoffStrategy=dK(),this.maxAttemptsProvider=typeof t=="function"?t:async()=>t}async acquireInitialRetryToken(t){return OP({retryDelay:100,retryCount:0})}async refreshRetryTokenForRetry(t,n){let r=await this.getMaxAttempts();if(this.shouldRetry(t,n,r)){let i=n.errorType;this.retryBackoffStrategy.setDelayBase(i==="THROTTLING"?500:100);let o=this.retryBackoffStrategy.computeNextBackoffDelay(t.getRetryCount()),s=n.retryAfterHint?Math.max(n.retryAfterHint.getTime()-Date.now()||0,o):o,a=this.getCapacityCost(i);return this.capacity-=a,OP({retryDelay:s,retryCount:t.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(t){this.capacity=Math.max(500,this.capacity+(t.getRetryCost()??1))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Vl}`),Vl}}shouldRetry(t,n,r){return t.getRetryCount()+1<r&&this.capacity>=this.getCapacityCost(n.errorType)&&this.isRetryableError(n.errorType)}getCapacityCost(t){return t==="TRANSIENT"?10:5}isRetryableError(t){return t==="THROTTLING"||t==="TRANSIENT"}};var c_=class{constructor(t,n){this.maxAttemptsProvider=t,this.mode=As.ADAPTIVE;let{rateLimiter:r}=n??{};this.rateLimiter=r??new Hm,this.standardRetryStrategy=new qf(t)}async acquireInitialRetryToken(t){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(t)}async refreshRetryTokenForRetry(t,n){return this.rateLimiter.updateClientSendingRate(n),this.standardRetryStrategy.refreshRetryTokenForRetry(t,n)}recordSuccess(t){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(t)}};var PP=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):typeof e=="string"?new Error(e):new Error(`AWS SDK error wrapper for ${e}`);var yK=e=>{let{retryStrategy:t,retryMode:n,maxAttempts:r}=e,i=Yr(r??Vl);return Object.assign(e,{maxAttempts:i,retryStrategy:async()=>t||(await Yr(n)()===As.ADAPTIVE?new c_(i):new qf(i))})};var xK=e=>e?.body instanceof ReadableStream;var mCe=e=>(t,n)=>async r=>{let i=await e.retryStrategy(),o=await e.maxAttempts();if(hCe(i)){i=i;let s=await i.acquireInitialRetryToken(n.partition_id),a=new Error,u=0,l=0,{request:c}=r,f=et.isInstance(c);for(f&&(c.headers[a_]=rP());;)try{f&&(c.headers[u_]=`attempt=${u+1}; max=${o}`);let{response:d,output:p}=await t(r);return i.recordSuccess(s),p.$metadata.attempts=u+1,p.$metadata.totalRetryDelay=l,{response:d,output:p}}catch(d){let p=gCe(d);if(a=PP(d),f&&xK(c))throw(n.logger instanceof Bm?console:n.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{s=await i.refreshRetryTokenForRetry(s,p)}catch{throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=u+1,a.$metadata.totalRetryDelay=l,a}u=s.getRetryCount();let m=s.getRetryDelay();l+=m,await new Promise(h=>setTimeout(h,m))}}else return i=i,i?.mode&&(n.userAgent=[...n.userAgent||[],["cfg/retry-mode",i.mode]]),i.retry(t,r)},hCe=e=>typeof e.acquireInitialRetryToken<"u"&&typeof e.refreshRetryTokenForRetry<"u"&&typeof e.recordSuccess<"u",gCe=e=>{let t={error:e,errorType:yCe(e)},n=bCe(e.$response);return n&&(t.retryAfterHint=n),t},yCe=e=>zm(e)?"THROTTLING":lx(e)?"TRANSIENT":fK(e)?"SERVER_ERROR":"CLIENT_ERROR",xCe={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},bK=e=>({applyToStack:t=>{t.add(mCe(e),xCe)}}),bCe=e=>{if(!wi.isInstance(e))return;let t=Object.keys(e.headers).find(o=>o.toLowerCase()==="retry-after");if(!t)return;let n=e.headers[t],r=Number(n);return Number.isNaN(r)?new Date(n):new Date(r*1e3)};var EK=async(e,t,n)=>({operation:zl(t).operation,region:await Yr(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function ECe(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"bedrock",region:e.region},propertiesExtractor:(t,n)=>({signingProperties:{config:t,context:n}})}}function vCe(e){return{schemeId:"smithy.api#httpBearerAuth",propertiesExtractor:({profile:t,filepath:n,configFilepath:r,ignoreCache:i},o)=>({identityProperties:{profile:t,filepath:n,configFilepath:r,ignoreCache:i}})}}var vK=e=>{let t=[];switch(e.operation){default:t.push(ECe(e)),t.push(vCe(e))}return t},wK=e=>{let t=AA(e.token,SA,Jy),n=fX(e);return Object.assign(n,{authSchemePreference:Yr(e.authSchemePreference??[]),token:t})};var SK=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"bedrock"}),AK={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};var _K={name:"@aws-sdk/client-bedrock-runtime",description:"AWS SDK for JavaScript Bedrock Runtime Client for Node.js, Browser and React Native",version:"3.864.0",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-bedrock-runtime","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo bedrock-runtime"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.864.0","@aws-sdk/credential-provider-node":"3.864.0","@aws-sdk/eventstream-handler-node":"3.862.0","@aws-sdk/middleware-eventstream":"3.862.0","@aws-sdk/middleware-host-header":"3.862.0","@aws-sdk/middleware-logger":"3.862.0","@aws-sdk/middleware-recursion-detection":"3.862.0","@aws-sdk/middleware-user-agent":"3.864.0","@aws-sdk/middleware-websocket":"3.862.0","@aws-sdk/region-config-resolver":"3.862.0","@aws-sdk/token-providers":"3.864.0","@aws-sdk/types":"3.862.0","@aws-sdk/util-endpoints":"3.862.0","@aws-sdk/util-user-agent-browser":"3.862.0","@aws-sdk/util-user-agent-node":"3.864.0","@smithy/config-resolver":"^4.1.5","@smithy/core":"^3.8.0","@smithy/eventstream-serde-browser":"^4.0.5","@smithy/eventstream-serde-config-resolver":"^4.1.3","@smithy/eventstream-serde-node":"^4.0.5","@smithy/fetch-http-handler":"^5.1.1","@smithy/hash-node":"^4.0.5","@smithy/invalid-dependency":"^4.0.5","@smithy/middleware-content-length":"^4.0.5","@smithy/middleware-endpoint":"^4.1.18","@smithy/middleware-retry":"^4.1.19","@smithy/middleware-serde":"^4.0.9","@smithy/middleware-stack":"^4.0.5","@smithy/node-config-provider":"^4.1.4","@smithy/node-http-handler":"^4.1.1","@smithy/protocol-http":"^5.1.3","@smithy/smithy-client":"^4.4.10","@smithy/types":"^4.3.2","@smithy/url-parser":"^4.0.5","@smithy/util-base64":"^4.0.0","@smithy/util-body-length-browser":"^4.0.0","@smithy/util-body-length-node":"^4.0.0","@smithy/util-defaults-mode-browser":"^4.0.26","@smithy/util-defaults-mode-node":"^4.0.26","@smithy/util-endpoints":"^3.0.7","@smithy/util-middleware":"^4.0.5","@smithy/util-retry":"^4.0.7","@smithy/util-stream":"^4.2.4","@smithy/util-utf8":"^4.0.0","@types/uuid":"^9.0.1",tslib:"^2.6.2",uuid:"^9.0.1"},devDependencies:{"@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-bedrock-runtime",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-bedrock-runtime"}};var $P={name:"SHA-256"},BP={name:"HMAC",hash:$P},CK=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);var SCe={};function Gm(){return typeof window<"u"?window:typeof self<"u"?self:SCe}var LP=function(){function e(t){this.toHash=new Uint8Array(0),this.secret=t,this.reset()}return e.prototype.update=function(t){if(!jl(t)){var n=Ss(t),r=new Uint8Array(this.toHash.byteLength+n.byteLength);r.set(this.toHash,0),r.set(n,this.toHash.byteLength),this.toHash=r}},e.prototype.digest=function(){var t=this;return this.key?this.key.then(function(n){return Gm().crypto.subtle.sign(BP,n,t.toHash).then(function(r){return new Uint8Array(r)})}):jl(this.toHash)?Promise.resolve(CK):Promise.resolve().then(function(){return Gm().crypto.subtle.digest($P,t.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},e.prototype.reset=function(){var t=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(n,r){Gm().crypto.subtle.importKey("raw",Ss(t.secret),BP,!1,["sign"]).then(n,r)}),this.key.catch(function(){}))},e}();var Si=64,kK=32,FK=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),RK=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],TK=Math.pow(2,53)-1;var cx=function(){function e(){this.state=Int32Array.from(RK),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,r=t.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>TK)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=t[n++],r--,this.bufferLength===Si&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(n.setUint8(this.bufferLength++,128),r%Si>=Si-8){for(var i=this.bufferLength;i<Si;i++)n.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(var i=this.bufferLength;i<Si-8;i++)n.setUint8(i,0);n.setUint32(Si-8,Math.floor(t/4294967296),!0),n.setUint32(Si-4,t),this.hashBuffer(),this.finished=!0}for(var o=new Uint8Array(kK),i=0;i<8;i++)o[i*4]=this.state[i]>>>24&255,o[i*4+1]=this.state[i]>>>16&255,o[i*4+2]=this.state[i]>>>8&255,o[i*4+3]=this.state[i]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var t=this,n=t.buffer,r=t.state,i=r[0],o=r[1],s=r[2],a=r[3],u=r[4],l=r[5],c=r[6],f=r[7],d=0;d<Si;d++){if(d<16)this.temp[d]=(n[d*4]&255)<<24|(n[d*4+1]&255)<<16|(n[d*4+2]&255)<<8|n[d*4+3]&255;else{var p=this.temp[d-2],m=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10;p=this.temp[d-15];var h=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3;this.temp[d]=(m+this.temp[d-7]|0)+(h+this.temp[d-16]|0)}var g=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&l^~u&c)|0)+(f+(FK[d]+this.temp[d]|0)|0)|0,y=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&o^i&s^o&s)|0;f=c,c=l,l=u,u=a+g|0,a=s,s=o,o=i,i=g+y|0}r[0]+=i,r[1]+=o,r[2]+=s,r[3]+=a,r[4]+=u,r[5]+=l,r[6]+=c,r[7]+=f},e}();var DK=function(){function e(t){this.secret=t,this.hash=new cx,this.reset()}return e.prototype.update=function(t){if(!(jl(t)||this.error))try{this.hash.update(Ss(t))}catch(n){this.error=n}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return qA(this,void 0,void 0,function(){return GA(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new cx,this.secret){this.outer=new cx;var t=ACe(this.secret),n=new Uint8Array(Si);n.set(t);for(var r=0;r<Si;r++)t[r]^=54,n[r]^=92;this.hash.update(t),this.outer.update(n);for(var r=0;r<t.byteLength;r++)t[r]=0}},e}();function ACe(e){var t=Ss(e);if(t.byteLength>Si){var n=new cx;n.update(t),t=n.digest()}var r=new Uint8Array(Si);return r.set(t),r}var _Ce=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function MK(e){if(CCe(e)&&typeof e.crypto.subtle=="object"){var t=e.crypto.subtle;return kCe(t)}return!1}function CCe(e){if(typeof e=="object"&&typeof e.crypto=="object"){var t=e.crypto.getRandomValues;return typeof t=="function"}return!1}function kCe(e){return e&&_Ce.every(function(t){return typeof e[t]=="function"})}var NK=function(){function e(t){MK(Gm())?this.hash=new LP(t):this.hash=new DK(t)}return e.prototype.update=function(t,n){this.hash.update(Ss(t))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e}();var OK=D_(zP()),IK=({serviceId:e,clientVersion:t})=>async n=>{let r=typeof window<"u"&&window?.navigator?.userAgent?OK.default.parse(window.navigator.userAgent):void 0,i=[["aws-sdk-js",t],["ua","2.1"],[`os/${r?.os?.name||"other"}`,r?.os?.version],["lang/js"],["md/browser",`${r?.browser?.name??"unknown"}_${r?.browser?.version??"unknown"}`]];e&&i.push([`api/${e}`,t]);let o=await n?.userAgentAppId?.();return o&&i.push([`app/${o}`]),i};var PK=e=>()=>Promise.reject(e);var WK="required",xa="fn",ba="argv",Wm="ref";var $K="isSet",px="booleanEquals",jm="error",dx="endpoint",Qr="tree",HP="PartitionResult",BK={[WK]:!1,type:"String"},LK={[WK]:!0,default:!1,type:"Boolean"},UK={[Wm]:"Endpoint"},VK={[xa]:px,[ba]:[{[Wm]:"UseFIPS"},!0]},YK={[xa]:px,[ba]:[{[Wm]:"UseDualStack"},!0]},ya={},zK={[xa]:"getAttr",[ba]:[{[Wm]:HP},"supportsFIPS"]},HK={[xa]:px,[ba]:[!0,{[xa]:"getAttr",[ba]:[{[Wm]:HP},"supportsDualStack"]}]},qK=[VK],GK=[YK],jK=[{[Wm]:"Region"}],FCe={version:"1.0",parameters:{Region:BK,UseDualStack:LK,UseFIPS:LK,Endpoint:BK},rules:[{conditions:[{[xa]:$K,[ba]:[UK]}],rules:[{conditions:qK,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:jm},{rules:[{conditions:GK,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:jm},{endpoint:{url:UK,properties:ya,headers:ya},type:dx}],type:Qr}],type:Qr},{rules:[{conditions:[{[xa]:$K,[ba]:jK}],rules:[{conditions:[{[xa]:"aws.partition",[ba]:jK,assign:HP}],rules:[{conditions:[VK,YK],rules:[{conditions:[{[xa]:px,[ba]:[!0,zK]},HK],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ya,headers:ya},type:dx}],type:Qr}],type:Qr},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:jm}],type:Qr},{conditions:qK,rules:[{conditions:[{[xa]:px,[ba]:[zK,!0]}],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:ya,headers:ya},type:dx}],type:Qr}],type:Qr},{error:"FIPS is enabled but this partition does not support FIPS",type:jm}],type:Qr},{conditions:GK,rules:[{conditions:[HK],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ya,headers:ya},type:dx}],type:Qr}],type:Qr},{error:"DualStack is enabled but this partition does not support DualStack",type:jm}],type:Qr},{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dnsSuffix}",properties:ya,headers:ya},type:dx}],type:Qr}],type:Qr}],type:Qr},{error:"Invalid Configuration: Missing Region",type:jm}],type:Qr}]},XK=FCe;var RCe=new _A({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),KK=(e,t={})=>RCe.get(e,()=>uP(XK,{endpointParams:e,logger:t.logger}));Bf.aws=cP;var QK=e=>({apiVersion:"2023-09-30",base64Decoder:e?.base64Decoder??Nm,base64Encoder:e?.base64Encoder??Om,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??KK,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??vK,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new nx},{schemeId:"smithy.api#httpBearerAuth",identityProvider:t=>t.getIdentityProvider("smithy.api#httpBearerAuth"),signer:new wA}],logger:e?.logger??new Bm,serviceId:e?.serviceId??"Bedrock Runtime",urlParser:e?.urlParser??Lf,utf8Decoder:e?.utf8Decoder??Es,utf8Encoder:e?.utf8Encoder??Ky});var ZK=D_(zP());var JK=["in-region","cross-region","mobile","standard","legacy"];var eQ=({defaultsMode:e}={})=>GY(async()=>{let t=typeof e=="function"?await e():e;switch(t?.toLowerCase()){case"auto":return Promise.resolve(TCe()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(t?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${JK.join(", ")}, got ${t}`)}}),TCe=()=>{let t=(typeof window<"u"&&window?.navigator?.userAgent?ZK.default.parse(window.navigator.userAgent):void 0)?.platform?.type;return t==="tablet"||t==="mobile"};var tQ=e=>{let t=eQ(e),n=()=>t().then(yX),r=QK(e);return{...r,...e,runtime:"browser",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??pX,credentialDefaultProvider:e?.credentialDefaultProvider??(i=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:e?.defaultUserAgentProvider??IK({serviceId:r.serviceId,clientVersion:_K.version}),eventStreamPayloadHandlerProvider:e?.eventStreamPayloadHandlerProvider??HX,eventStreamSerdeProvider:e?.eventStreamSerdeProvider??VX,maxAttempts:e?.maxAttempts??Vl,region:e?.region??PK("Region is missing"),requestHandler:n_.create(e?.requestHandler??n,$f.create(n)),retryMode:e?.retryMode??(async()=>(await n()).retryMode||NP),sha256:e?.sha256??NK,streamCollector:e?.streamCollector??QI,useDualstackEndpoint:e?.useDualstackEndpoint??(()=>Promise.resolve(YX)),useFipsEndpoint:e?.useFipsEndpoint??(()=>Promise.resolve(XX))}};var nQ=e=>({setRegion(t){e.region=t},region(){return e.region}}),rQ=e=>({region:e.region()});var iQ=e=>{let t=e.httpAuthSchemes,n=e.httpAuthSchemeProvider,r=e.credentials,i=e.token;return{setHttpAuthScheme(o){let s=t.findIndex(a=>a.schemeId===o.schemeId);s===-1?t.push(o):t.splice(s,1,o)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(o){n=o},httpAuthSchemeProvider(){return n},setCredentials(o){r=o},credentials(){return r},setToken(o){i=o},token(){return i}}},oQ=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials(),token:e.token()});var sQ=(e,t)=>{let n=Object.assign(nQ(e),wX(e),WV(e),iQ(e));return t.forEach(r=>r.configure(n)),Object.assign(e,rQ(n),SX(n),VV(n),oQ(n))};var f_=class extends BA{constructor(...[n]){let r=tQ(n||{});super(r);Re(this,"config");this.initConfig=r;let i=SK(r),o=yY(i),s=yK(o),a=KX(s),u=a,l=oK(u),c=QX(l),f=wK(c),d=jV(f),p=qX(d),m=sQ(p,n?.extensions||[]);this.config=m,this.middlewareStack.use(OX(this.config)),this.middlewareStack.use(bK(this.config)),this.middlewareStack.use(ZX(this.config)),this.middlewareStack.use(JV(this.config)),this.middlewareStack.use(ZV(this.config)),this.middlewareStack.use(eY(this.config)),this.middlewareStack.use(rY(this.config,{httpAuthSchemeParametersProvider:EK,identityProviderConfigProvider:async h=>new vA({"aws.auth#sigv4":h.credentials,"smithy.api#httpBearerAuth":h.token})})),this.middlewareStack.use(uY(this.config))}destroy(){super.destroy()}};var Jn=class e extends LA{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}};var d_=class e extends Jn{constructor(n){super({name:"AccessDeniedException",$fault:"client",...n});Re(this,"name","AccessDeniedException");Re(this,"$fault","client");Object.setPrototypeOf(this,e.prototype)}},aQ;(function(e){e.visit=(t,n)=>t.s3OutputDataConfig!==void 0?n.s3OutputDataConfig(t.s3OutputDataConfig):n._(t.$unknown[0],t.$unknown[1])})(aQ||(aQ={}));var p_=class e extends Jn{constructor(n){super({name:"InternalServerException",$fault:"server",...n});Re(this,"name","InternalServerException");Re(this,"$fault","server");Object.setPrototypeOf(this,e.prototype)}},m_=class e extends Jn{constructor(n){super({name:"ThrottlingException",$fault:"client",...n});Re(this,"name","ThrottlingException");Re(this,"$fault","client");Object.setPrototypeOf(this,e.prototype)}},h_=class e extends Jn{constructor(n){super({name:"ValidationException",$fault:"client",...n});Re(this,"name","ValidationException");Re(this,"$fault","client");Object.setPrototypeOf(this,e.prototype)}};var g_=class e extends Jn{constructor(n){super({name:"ConflictException",$fault:"client",...n});Re(this,"name","ConflictException");Re(this,"$fault","client");Object.setPrototypeOf(this,e.prototype)}},y_=class e extends Jn{constructor(n){super({name:"ResourceNotFoundException",$fault:"client",...n});Re(this,"name","ResourceNotFoundException");Re(this,"$fault","client");Object.setPrototypeOf(this,e.prototype)}},x_=class e extends Jn{constructor(n){super({name:"ServiceQuotaExceededException",$fault:"client",...n});Re(this,"name","ServiceQuotaExceededException");Re(this,"$fault","client");Object.setPrototypeOf(this,e.prototype)}},b_=class e extends Jn{constructor(n){super({name:"ServiceUnavailableException",$fault:"server",...n});Re(this,"name","ServiceUnavailableException");Re(this,"$fault","server");Object.setPrototypeOf(this,e.prototype)}};var qP;(function(e){e.visit=(t,n)=>t.bytes!==void 0?n.bytes(t.bytes):n._(t.$unknown[0],t.$unknown[1])})(qP||(qP={}));var GP;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):t.image!==void 0?n.image(t.image):n._(t.$unknown[0],t.$unknown[1])})(GP||(GP={}));var uQ;(function(e){e.visit=(t,n)=>t.valid!==void 0?n.valid(t.valid):t.invalid!==void 0?n.invalid(t.invalid):t.satisfiable!==void 0?n.satisfiable(t.satisfiable):t.impossible!==void 0?n.impossible(t.impossible):t.translationAmbiguous!==void 0?n.translationAmbiguous(t.translationAmbiguous):t.tooComplex!==void 0?n.tooComplex(t.tooComplex):t.noTranslations!==void 0?n.noTranslations(t.noTranslations):n._(t.$unknown[0],t.$unknown[1])})(uQ||(uQ={}));var lQ;(function(e){e.visit=(t,n)=>t.documentChar!==void 0?n.documentChar(t.documentChar):t.documentPage!==void 0?n.documentPage(t.documentPage):t.documentChunk!==void 0?n.documentChunk(t.documentChunk):n._(t.$unknown[0],t.$unknown[1])})(lQ||(lQ={}));var cQ;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):n._(t.$unknown[0],t.$unknown[1])})(cQ||(cQ={}));var fQ;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):n._(t.$unknown[0],t.$unknown[1])})(fQ||(fQ={}));var dQ;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):n._(t.$unknown[0],t.$unknown[1])})(dQ||(dQ={}));var jP;(function(e){e.visit=(t,n)=>t.bytes!==void 0?n.bytes(t.bytes):t.s3Location!==void 0?n.s3Location(t.s3Location):t.text!==void 0?n.text(t.text):t.content!==void 0?n.content(t.content):n._(t.$unknown[0],t.$unknown[1])})(jP||(jP={}));var WP;(function(e){e.visit=(t,n)=>t.bytes!==void 0?n.bytes(t.bytes):n._(t.$unknown[0],t.$unknown[1])})(WP||(WP={}));var VP;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):t.image!==void 0?n.image(t.image):n._(t.$unknown[0],t.$unknown[1])})(VP||(VP={}));var YP;(function(e){e.visit=(t,n)=>t.bytes!==void 0?n.bytes(t.bytes):t.s3Location!==void 0?n.s3Location(t.s3Location):n._(t.$unknown[0],t.$unknown[1])})(YP||(YP={}));var XP;(function(e){e.visit=(t,n)=>t.reasoningText!==void 0?n.reasoningText(t.reasoningText):t.redactedContent!==void 0?n.redactedContent(t.redactedContent):n._(t.$unknown[0],t.$unknown[1])})(XP||(XP={}));var KP;(function(e){e.visit=(t,n)=>t.bytes!==void 0?n.bytes(t.bytes):t.s3Location!==void 0?n.s3Location(t.s3Location):n._(t.$unknown[0],t.$unknown[1])})(KP||(KP={}));var QP;(function(e){e.visit=(t,n)=>t.json!==void 0?n.json(t.json):t.text!==void 0?n.text(t.text):t.image!==void 0?n.image(t.image):t.document!==void 0?n.document(t.document):t.video!==void 0?n.video(t.video):n._(t.$unknown[0],t.$unknown[1])})(QP||(QP={}));var JP;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):t.image!==void 0?n.image(t.image):t.document!==void 0?n.document(t.document):t.video!==void 0?n.video(t.video):t.toolUse!==void 0?n.toolUse(t.toolUse):t.toolResult!==void 0?n.toolResult(t.toolResult):t.guardContent!==void 0?n.guardContent(t.guardContent):t.cachePoint!==void 0?n.cachePoint(t.cachePoint):t.reasoningContent!==void 0?n.reasoningContent(t.reasoningContent):t.citationsContent!==void 0?n.citationsContent(t.citationsContent):n._(t.$unknown[0],t.$unknown[1])})(JP||(JP={}));var pQ;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):n._(t.$unknown[0],t.$unknown[1])})(pQ||(pQ={}));var ZP;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):t.guardContent!==void 0?n.guardContent(t.guardContent):t.cachePoint!==void 0?n.cachePoint(t.cachePoint):n._(t.$unknown[0],t.$unknown[1])})(ZP||(ZP={}));var mQ;(function(e){e.visit=(t,n)=>t.auto!==void 0?n.auto(t.auto):t.any!==void 0?n.any(t.any):t.tool!==void 0?n.tool(t.tool):n._(t.$unknown[0],t.$unknown[1])})(mQ||(mQ={}));var e3;(function(e){e.visit=(t,n)=>t.json!==void 0?n.json(t.json):n._(t.$unknown[0],t.$unknown[1])})(e3||(e3={}));var t3;(function(e){e.visit=(t,n)=>t.toolSpec!==void 0?n.toolSpec(t.toolSpec):t.cachePoint!==void 0?n.cachePoint(t.cachePoint):n._(t.$unknown[0],t.$unknown[1])})(t3||(t3={}));var hQ;(function(e){e.visit=(t,n)=>t.message!==void 0?n.message(t.message):n._(t.$unknown[0],t.$unknown[1])})(hQ||(hQ={}));var E_=class e extends Jn{constructor(n){super({name:"ModelErrorException",$fault:"client",...n});Re(this,"name","ModelErrorException");Re(this,"$fault","client");Re(this,"originalStatusCode");Re(this,"resourceName");Object.setPrototypeOf(this,e.prototype),this.originalStatusCode=n.originalStatusCode,this.resourceName=n.resourceName}},v_=class e extends Jn{constructor(n){super({name:"ModelNotReadyException",$fault:"client",...n});Re(this,"name","ModelNotReadyException");Re(this,"$fault","client");Re(this,"$retryable",{});Object.setPrototypeOf(this,e.prototype)}},w_=class e extends Jn{constructor(n){super({name:"ModelTimeoutException",$fault:"client",...n});Re(this,"name","ModelTimeoutException");Re(this,"$fault","client");Object.setPrototypeOf(this,e.prototype)}};var gQ;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):t.redactedContent!==void 0?n.redactedContent(t.redactedContent):t.signature!==void 0?n.signature(t.signature):n._(t.$unknown[0],t.$unknown[1])})(gQ||(gQ={}));var yQ;(function(e){e.visit=(t,n)=>t.text!==void 0?n.text(t.text):t.toolUse!==void 0?n.toolUse(t.toolUse):t.reasoningContent!==void 0?n.reasoningContent(t.reasoningContent):t.citation!==void 0?n.citation(t.citation):n._(t.$unknown[0],t.$unknown[1])})(yQ||(yQ={}));var xQ;(function(e){e.visit=(t,n)=>t.toolUse!==void 0?n.toolUse(t.toolUse):n._(t.$unknown[0],t.$unknown[1])})(xQ||(xQ={}));var S_=class e extends Jn{constructor(n){super({name:"ModelStreamErrorException",$fault:"client",...n});Re(this,"name","ModelStreamErrorException");Re(this,"$fault","client");Re(this,"originalStatusCode");Re(this,"originalMessage");Object.setPrototypeOf(this,e.prototype),this.originalStatusCode=n.originalStatusCode,this.originalMessage=n.originalMessage}},bQ;(function(e){e.visit=(t,n)=>t.messageStart!==void 0?n.messageStart(t.messageStart):t.contentBlockStart!==void 0?n.contentBlockStart(t.contentBlockStart):t.contentBlockDelta!==void 0?n.contentBlockDelta(t.contentBlockDelta):t.contentBlockStop!==void 0?n.contentBlockStop(t.contentBlockStop):t.messageStop!==void 0?n.messageStop(t.messageStop):t.metadata!==void 0?n.metadata(t.metadata):t.internalServerException!==void 0?n.internalServerException(t.internalServerException):t.modelStreamErrorException!==void 0?n.modelStreamErrorException(t.modelStreamErrorException):t.validationException!==void 0?n.validationException(t.validationException):t.throttlingException!==void 0?n.throttlingException(t.throttlingException):t.serviceUnavailableException!==void 0?n.serviceUnavailableException(t.serviceUnavailableException):n._(t.$unknown[0],t.$unknown[1])})(bQ||(bQ={}));var n3;(function(e){e.visit=(t,n)=>t.chunk!==void 0?n.chunk(t.chunk):n._(t.$unknown[0],t.$unknown[1])})(n3||(n3={}));var EQ;(function(e){e.visit=(t,n)=>t.chunk!==void 0?n.chunk(t.chunk):t.internalServerException!==void 0?n.internalServerException(t.internalServerException):t.modelStreamErrorException!==void 0?n.modelStreamErrorException(t.modelStreamErrorException):t.validationException!==void 0?n.validationException(t.validationException):t.throttlingException!==void 0?n.throttlingException(t.throttlingException):t.modelTimeoutException!==void 0?n.modelTimeoutException(t.modelTimeoutException):t.serviceUnavailableException!==void 0?n.serviceUnavailableException(t.serviceUnavailableException):n._(t.$unknown[0],t.$unknown[1])})(EQ||(EQ={}));var vQ;(function(e){e.visit=(t,n)=>t.chunk!==void 0?n.chunk(t.chunk):t.internalServerException!==void 0?n.internalServerException(t.internalServerException):t.modelStreamErrorException!==void 0?n.modelStreamErrorException(t.modelStreamErrorException):t.validationException!==void 0?n.validationException(t.validationException):t.throttlingException!==void 0?n.throttlingException(t.throttlingException):t.modelTimeoutException!==void 0?n.modelTimeoutException(t.modelTimeoutException):t.serviceUnavailableException!==void 0?n.serviceUnavailableException(t.serviceUnavailableException):n._(t.$unknown[0],t.$unknown[1])})(vQ||(vQ={}));var wQ=e=>({...e,...e.body&&{body:_P}}),SQ=e=>({...e,...e.body&&{body:_P}});var _Q=async(e,t)=>{let n=oP(e,t),r=Cr({},AX,{[FQ]:e[kQ]||"application/octet-stream",[AQ]:e[AQ],[QCe]:e[YCe],[XCe]:e[WCe],[KCe]:e[VCe],[TQ]:e[RQ]});n.bp("/model/{modelId}/invoke"),n.p("modelId",()=>e.modelId,"{modelId}",!1);let i;return e.body!==void 0&&(i=e.body),n.m("POST").h(r).b(i),n.build()};var CQ=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return MCe(e,t);let n=Cr({$metadata:Wi(e),[kQ]:[,e.headers[FQ]],[RQ]:[,e.headers[TQ]]}),r=await Qy(e.body,t);return n.body=r,n};var MCe=async(e,t)=>{let n={...e,body:await FX(e.body,t)},r=RX(e,n.body);switch(r){case"AccessDeniedException":case"com.amazonaws.bedrockruntime#AccessDeniedException":throw await OCe(n,t);case"InternalServerException":case"com.amazonaws.bedrockruntime#InternalServerException":throw await PCe(n,t);case"ResourceNotFoundException":case"com.amazonaws.bedrockruntime#ResourceNotFoundException":throw await zCe(n,t);case"ServiceQuotaExceededException":case"com.amazonaws.bedrockruntime#ServiceQuotaExceededException":throw await HCe(n,t);case"ThrottlingException":case"com.amazonaws.bedrockruntime#ThrottlingException":throw await GCe(n,t);case"ValidationException":case"com.amazonaws.bedrockruntime#ValidationException":throw await jCe(n,t);case"ModelErrorException":case"com.amazonaws.bedrockruntime#ModelErrorException":throw await $Ce(n,t);case"ModelNotReadyException":case"com.amazonaws.bedrockruntime#ModelNotReadyException":throw await BCe(n,t);case"ModelTimeoutException":case"com.amazonaws.bedrockruntime#ModelTimeoutException":throw await UCe(n,t);case"ServiceUnavailableException":case"com.amazonaws.bedrockruntime#ServiceUnavailableException":throw await qCe(n,t);case"ModelStreamErrorException":case"com.amazonaws.bedrockruntime#ModelStreamErrorException":throw await LCe(n,t);case"ConflictException":case"com.amazonaws.bedrockruntime#ConflictException":throw await ICe(n,t);default:let i=n.body;return NCe({output:e,parsedBody:i,errorCode:r})}},NCe=gX(Jn),OCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new d_({$metadata:Wi(e),...n});return Kr(o,e.body)},ICe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new g_({$metadata:Wi(e),...n});return Kr(o,e.body)},PCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new p_({$metadata:Wi(e),...n});return Kr(o,e.body)},$Ce=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr,originalStatusCode:eP,resourceName:Xr});Object.assign(n,i);let o=new E_({$metadata:Wi(e),...n});return Kr(o,e.body)},BCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new v_({$metadata:Wi(e),...n});return Kr(o,e.body)},LCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr,originalMessage:Xr,originalStatusCode:eP});Object.assign(n,i);let o=new S_({$metadata:Wi(e),...n});return Kr(o,e.body)},UCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new w_({$metadata:Wi(e),...n});return Kr(o,e.body)},zCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new y_({$metadata:Wi(e),...n});return Kr(o,e.body)},HCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new x_({$metadata:Wi(e),...n});return Kr(o,e.body)},qCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new b_({$metadata:Wi(e),...n});return Kr(o,e.body)},GCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new m_({$metadata:Wi(e),...n});return Kr(o,e.body)},jCe=async(e,t)=>{let n=Cr({}),r=e.body,i=ji(r,{message:Xr});Object.assign(n,i);let o=new h_({$metadata:Wi(e),...n});return Kr(o,e.body)};var Wi=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]});var AQ="accept",kQ="contentType",FQ="content-type",WCe="guardrailIdentifier",VCe="guardrailVersion";var RQ="performanceConfigLatency";var YCe="trace";var XCe="x-amzn-bedrock-guardrailidentifier",KCe="x-amzn-bedrock-guardrailversion",TQ="x-amzn-bedrock-performanceconfig-latency",QCe="x-amzn-bedrock-trace";var A_=class extends ax.classBuilder().ep(AK).m(function(t,n,r,i){return[sY(r,this.serialize,this.deserialize),iK(r,t.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","InvokeModel",{}).n("BedrockRuntimeClient","InvokeModelCommand").f(wQ,SQ).ser(_Q).de(CQ).build(){};async function DQ(e){let t=document.getElementById("aws-access-key"),n=document.getElementById("aws-secret-key"),r=document.getElementById("aws-region"),i=t?.value||localStorage.getItem("aws-access-key")||"",o=n?.value||localStorage.getItem("aws-secret-key")||"",s=r?.value||localStorage.getItem("aws-region")||"us-east-1",a={accessKeyId:i,secretAccessKey:o},u=new f_({region:s,credentials:a}),l={},c=65536,d=document.getElementById("language-model-amazon")?.value??"";d.startsWith("us.anthropic")?l={anthropic_version:"bedrock-2023-05-31",max_tokens:c,messages:[{role:"user",content:[{type:"text",text:e}]}]}:l={max_completion_tokens:c,messages:[{role:"user",content:[{type:"text",text:e}]}]};let p={modelId:d,body:JSON.stringify(l)};try{let m=new A_(p),h=await u.send(m),y=await new Blob([h.body]).text(),x=JSON.parse(y);return console.log("parsedResponse = "+y),d.startsWith("us.anthropic")?x.content[0].text.trim():x.choices[0].message.content.replace(/<reasoning>[\s\S]*?<\/reasoning>/g,"").trim()}catch(m){let h=m;return console.error(m),`# Error: ${h.message}`}}async function MQ(e,t,n,r){let o=document.getElementById("azure-api-model-version")?.value??"2024-02-15-preview",s=`${n}/openai/deployments/${r}/chat/completions?api-version=${o}`,a=JSON.stringify({messages:[{role:"system",content:"You are a Python programming assistant who ONLY responds with blocks of commented, optimized code. You never respond with text. Just code, starting with ``` and ending with ```."},{role:"user",content:e}],user:"scalene-user"});console.log(a);let l=await(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","api-key":t},body:a})).json();if(l.error&&l.error.code&&l.error.code in{invalid_request_error:!0,model_not_found:!0,insufficient_quota:!0})return"";try{l.choices&&l.choices[0]&&console.log(`Debugging info: Retrieved ${JSON.stringify(l.choices[0],null,4)}`)}catch{console.log(`Debugging info: Failed to retrieve data.choices from the server. data = ${JSON.stringify(l)}`)}try{return l.choices&&l.choices[0]?l.choices[0].message.content.replace(/^\s*[\r\n]/gm,""):`# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.
`}catch{return`# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.
`}}function NQ(e){return e.replace(/\\u([\dA-F]{4})/gi,function(t,n){return String.fromCharCode(parseInt(n,16))})}function OQ(e){let t=e.match(/^\s+/);return t?t[0].length:0}function _u(e){let t=Math.floor(e/1024);return Math.floor(t/1024)>0?`${(e/1048576).toFixed(0)}T`:t>0?`${(e/1024).toFixed(0)}G`:`${e.toFixed(0)}M`}function Vi(e){let t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3),i=e%36e5/6e4,o=e%6e4/1e3;return t>0?`${t.toFixed(0)}h:${i.toFixed(0)}m:${o.toFixed(3)}s`:n>=1?`${n.toFixed(0)}m:${o.toFixed(3)}s`:r>=1?`${o.toFixed(3)}s`:`${e.toFixed(0)}ms`}var i3="&#9889;",o3="&#128165;",__=`<span style="opacity:0">${i3}</span>`,mx=`<span style="opacity:0">${o3}</span>`,C_="&#9658",k_="&#9660";function r3(e,t){let n=t/100*globalThis.profile.elapsed_time_sec;return`(${e}) `+t.toFixed(1)+"% ["+Vi(n*1e3)+"]"}function F_(e,t,n,r){return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{view:{stroke:"transparent"}},autosize:{contains:"padding"},width:r.width,height:r.height,padding:0,data:{values:[{x:0,y:e.toFixed(1),c:r3("Python",e),d:e>=20?e.toFixed(0)+"%":e>=10?e.toFixed(0):"",q:e/2},{x:0,y:t.toFixed(1),c:r3("native",t),d:t>=20?t.toFixed(0)+"%":t>=10?t.toFixed(0):"",q:e+t/2},{x:0,y:n.toFixed(1),c:r3("system",n),d:n>=20?n.toFixed(0)+"%":n>=10?n.toFixed(0):"",q:e+t+n/2}]},layer:[{mark:{type:"bar"},encoding:{x:{aggregate:"sum",field:"y",axis:!1,stack:"zero",scale:{domain:[0,100]}},color:{field:"c",type:"nominal",legend:!1,scale:{range:["darkblue","#6495ED","blue"]}},tooltip:[{field:"c",type:"nominal",title:"time"}]}},{mark:{type:"text",align:"center",baseline:"middle",dx:0},encoding:{x:{aggregate:"sum",field:"q",axis:!1},text:{field:"d"},color:{value:"white"},tooltip:[{field:"c",type:"nominal",title:"time"}]}}]}}function IQ(e,t,n){return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{view:{stroke:"transparent"}},autosize:{contains:"padding"},width:n.width,height:n.height,padding:0,data:{values:[{category:1,value:e.toFixed(1),c:"in use: "+e.toFixed(1)+"%"}]},mark:"arc",encoding:{theta:{field:"value",type:"quantitative",scale:{domain:[0,100]}},color:{field:"c",type:"nominal",legend:!1,scale:{range:["goldenrod","#f4e6c2"]}},tooltip:[{field:"c",type:"nominal",title:t}]}}}function PQ(e,t,n){return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",width:n.width,height:20,padding:0,data:{values:[{category:1,value:e.toFixed(1),c:"native: "+e.toFixed(1)+"%"},{category:2,value:t.toFixed(1),c:"Python: "+t.toFixed(1)+"%"}]},mark:"arc",encoding:{theta:{field:"value",type:"quantitative",scale:{domain:[0,100]}},color:{field:"c",type:"nominal",legend:!1,scale:{range:["darkgreen","#50C878"]}},tooltip:[{field:"c",type:"nominal",title:"memory"}]}}}function hx(e,t,n,r,i,o){let s=typeof e=="string"?parseFloat(e):e,a=typeof r=="string"?parseFloat(r):r;return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{view:{stroke:"transparent"}},autosize:{contains:"padding"},width:o.width,height:o.height,padding:0,data:{values:[{x:0,y:n*s,c:"(Python) "+_u(n*s),d:n*s>a*.2?_u(n*s):"",q:n*s/2},{x:0,y:(1-n)*s,c:"(native) "+_u((1-n)*s),d:(1-n)*s>a*.2?_u((1-n)*s):"",q:n*s+(1-n)*s/2}]},layer:[{mark:{type:"bar"},encoding:{x:{aggregate:"sum",field:"y",axis:!1,scale:{domain:[0,a]}},color:{field:"c",type:"nominal",legend:!1,scale:{range:[i,"#50C878","green"]}}}},{mark:{type:"text",align:"center",baseline:"middle",dx:0},encoding:{x:{aggregate:"sum",field:"q",axis:!1},text:{field:"d"},color:{value:"white"}}}]}}function s3(e,t,n,r=0,i){let o=e.map(u=>{let l="";return r!=0&&(l=`; possible leak (${_u(r)}/s)`),{x:u[0],y:u[1],y_text:_u(u[1])+" (@ "+Vi(u[0]/1e6)+")"+l}}),s="",a=i.height;return r!=0&&(s="possible leak",a-=10),{$schema:"https://vega.github.io/schema/vega-lite/v5.json",data:{values:o},width:i.width,height:a,padding:0,title:{text:s,baseline:"line-bottom",color:"red",offset:0,lineHeight:10,orient:"bottom",fontStyle:"italic"},encoding:{x:{field:"x",type:"quantitative",title:"",axis:{tickCount:10,tickSize:0,labelExpr:""},scale:{domain:[0,t]}}},layer:[{encoding:{y:{field:"y",type:"quantitative",axis:null,scale:{domain:[0,n]}},color:{field:"c",type:"nominal",legend:null,scale:{range:["darkgreen"]}}},layer:[{mark:"line"},{transform:[{filter:{param:"hover",empty:!1}}],mark:"point"}]},{mark:"rule",encoding:{opacity:{condition:{value:.3,param:"hover",empty:!1},value:0},tooltip:[{field:"y_text",type:"nominal",title:"memory"}]},params:[{name:"hover",select:{type:"point",fields:["y"],nearest:!0,on:"mousemove"}}]}]}}function $Q(e,t,n){let o=t*1e3,s=o>0?e/o*100:0,a="NRT: "+s.toFixed(1)+"% of elapsed time ["+Vi(e)+"]";return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{view:{stroke:"transparent"}},autosize:{contains:"padding"},width:n.width,height:n.height,padding:0,data:{values:[{x:0,y:s.toFixed(1),c:a,d:s>=15?s.toFixed(0)+"%":s>=8?s.toFixed(0):"",q:s/2}]},layer:[{mark:{type:"bar"},encoding:{x:{aggregate:"sum",field:"y",axis:!1,stack:"zero",scale:{domain:[0,100]}},color:{field:"c",type:"nominal",legend:!1,scale:{range:["purple"]}},tooltip:[{field:"c",type:"nominal",title:"NRT time"}]}},{mark:{type:"text",align:"center",baseline:"middle",dx:0},encoding:{x:{aggregate:"sum",field:"q",axis:!1},text:{field:"d"},color:{value:"white"},tooltip:[{field:"c",type:"nominal",title:"NRT time"}]}}]}}function BQ(e,t,n){let o=t*1e3,s=o>0?e/o*100:0,a="NC: "+s.toFixed(1)+"% of elapsed time ["+Vi(e)+"]";return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{view:{stroke:"transparent"}},autosize:{contains:"padding"},width:n.width,height:n.height,padding:0,data:{values:[{x:0,y:s.toFixed(1),c:a,d:s>=15?s.toFixed(0)+"%":s>=8?s.toFixed(0):"",q:s/2}]},layer:[{mark:{type:"bar"},encoding:{x:{aggregate:"sum",field:"y",axis:!1,stack:"zero",scale:{domain:[0,100]}},color:{field:"c",type:"nominal",legend:!1,scale:{range:["darkorange"]}},tooltip:[{field:"c",type:"nominal",title:"NC time"}]}},{mark:{type:"text",align:"center",baseline:"middle",dx:0},encoding:{x:{aggregate:"sum",field:"q",axis:!1},text:{field:"d"},color:{value:"white"},tooltip:[{field:"c",type:"nominal",title:"NC time"}]}}]}}function a3(e,t,n,r,i){let a=t*1e3,u=a>0?e/a*100:0,l=`${n}: ${u.toFixed(1)}% of elapsed time [${Vi(e)}]`;return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{view:{stroke:"transparent"}},autosize:{contains:"padding"},width:i.width,height:i.height,padding:0,data:{values:[{x:0,y:u.toFixed(1),c:l,d:u>=15?u.toFixed(0)+"%":u>=8?u.toFixed(0):"",q:u/2}]},layer:[{mark:{type:"bar"},encoding:{x:{aggregate:"sum",field:"y",axis:!1,stack:"zero",scale:{domain:[0,100]}},color:{field:"c",type:"nominal",legend:!1,scale:{range:[r]}},tooltip:[{field:"c",type:"nominal",title:n+" time"}]}},{mark:{type:"text",align:"center",baseline:"middle",dx:0},encoding:{x:{aggregate:"sum",field:"q",axis:!1},text:{field:"d"},color:{value:"white"},tooltip:[{field:"c",type:"nominal",title:n+" time"}]}}]}}async function JCe(e,t){e.preventDefault(),e.stopPropagation(),await navigator.clipboard.writeText(t)}function u3(e){if(!e)return e;let t=e.split(`
`),n=0;for(;n<t.length&&t[n].trim()==="";)n++;let r=t[n].trim(),i;if(r==="```")i=e.slice(3);else if(r.startsWith("```")){let s=r.slice(3).trim();s.length>0&&!s.includes(" ")?i=e.slice(r.length):i=e}else i=e;let o=i.indexOf("```");return o!==-1&&(i=i.slice(0,o)),i}function ZCe(e,t,n,r=[],i=!1,o="GPU"){let s=["NumPy","Scikit-learn","Pandas","TensorFlow","PyTorch"],a=[...new Set([...s,...r])],u=[`Optimize the following Python code to make it more efficient WITHOUT CHANGING ITS RESULTS.

`,e.trim(),`
# Start of code
`,t.trim(),`
# End of code

`,"Rewrite the above Python code from 'Start of code' to 'End of code', aiming for clear and simple optimizations. ","Your output should consist only of valid Python code, with brief explanatory comments prefaced with #. ","Include a detailed explanatory comment before the code, starting with '# Proposed optimization:'. ",`Leverage high-performance native libraries, especially those utilizing ${o}, for significant performance improvements. `,`Consider using the following other libraries, if appropriate:
`,a.map(c=>"  import "+c).join(`
`)+`
`,"Eliminate as many for loops, while loops, and list or dict comprehensions as possible, replacing them with vectorized equivalents. ","Quantify the expected speedup in terms of orders of magnitude if possible. ","Fix any errors in the optimized code. "];i&&u.push(`Use ${o}-accelerated libraries whenever it would substantially increase performance. `),u.push(`Consider the following insights gathered from the Scalene profiler for optimization:
`);let l=n.n_cpu_percent_python+n.n_cpu_percent_c+n.n_sys_percent;return u.push(`- CPU time: percent spent in the Python interpreter: ${(100*n.n_cpu_percent_python/l).toFixed(2)}%
`),u.push(`- CPU time: percent spent executing native code: ${(100*n.n_cpu_percent_c/l).toFixed(2)}%
`),u.push(`- CPU time: percent of system time: ${(100*n.n_sys_percent/l).toFixed(2)}%
`),u.push(`- Core utilization: ${(100*n.n_core_utilization/l).toFixed(2)}%
`),u.push(`- Peak memory usage: ${n.n_peak_mb.toFixed(0)}MB (${(100*n.n_python_fraction).toFixed(2)}% Python memory)
`),n.n_copy_mb_s>1&&u.push(`- Megabytes copied per second by memcpy/strcpy: ${n.n_copy_mb_s.toFixed(2)}
`),i&&u.push(`- GPU percent utilization: ${(100*n.n_gpu_percent).toFixed(2)}%
`),u.push("Optimized code:"),u.join("")}function eke(e){let t=/```python\s*([\s\S]*?)```|```([\s\S]*?)```/g,n,r="";for(;(n=t.exec(e))!==null;){let i=n[1]?n[1]:n[2];r&&i&&(r+=`

`),r+=i}return r}async function tke(e,t,n,r){let o=document.getElementById("use-gpu-checkbox")?.checked??!1,s=["sklearn"];o?s.push("cupy"):s.push("numpy");let u=document.getElementById("accelerator-name")?.innerHTML||"GPU",l=ZCe(r,t,n,s,o,u),c=o?` or ${u}-optimizations `:" ",f="",p=document.getElementById("service-select")?.value??"";if(p==="openai"?f=document.getElementById("api-key")?.value??"":p==="azure-openai"&&(f=document.getElementById("azure-api-key")?.value??""),(p==="openai"||p==="azure-openai")&&!f){alert("To activate proposed optimizations, enter an OpenAI API key in AI optimization options.");let v=document.getElementById("ai-optimization-options");return v&&(v.open=!0),""}let m=" ";t.split(`
`).length<=2&&(m=" line of ");let h="import sklearn";o?h+=`
import cupy`:h+=`
import numpy as np`;let g=`Optimize the following${m}Python code:

${r}

# Start of code

${t}

# End of code

Rewrite the above Python code only from "Start of code" to "End of code", to make it more efficient WITHOUT CHANGING ITS RESULTS. Assume the code has already executed all these imports; do NOT include them in the optimized code:

${e}

Use native libraries if that would make it faster than pure Python. Consider using the following other libraries, if appropriate:

${h}

Your output should only consist of valid Python code. Output the resulting Python with brief explanations only included as comments prefaced with #. Include a detailed explanatory comment before the code, starting with the text "# Proposed optimization:". Make the code as clear and simple as possible, while also making it as fast and memory-efficient as possible. Use vectorized operations${c}whenever it would substantially increase performance, and quantify the speedup in terms of orders of magnitude. Eliminate as many for loops, while loops, and list or dict comprehensions as possible, replacing them with vectorized equivalents. If the performance is not likely to increase, leave the code unchanged. Fix any errors in the optimized code. Optimized${m}code:`,y=`Optimize the following${m} Python code:

${r}

# Start of code

${t}


# End of code

Rewrite the above Python code only from "Start of code" to "End of code", to make it more memory-efficient WITHOUT CHANGING ITS RESULTS. Assume the code has already executed all these imports; do NOT include them in the optimized code:

${e}

Use native libraries if that would make it more space efficient than pure Python. Consider using the following other libraries, if appropriate:

${h}

Your output should only consist of valid Python code. Output the resulting Python with brief explanations only included as comments prefaced with #. Include a detailed explanatory comment before the code, starting with the text "# Proposed optimization:". Make the code as clear and simple as possible, while also making it as fast and memory-efficient as possible. Use native libraries whenever possible to reduce memory consumption; invoke del on variables and array elements as soon as it is safe to do so. If the memory consumption is not likely to be reduced, leave the code unchanged. Fix any errors in the optimized code. Optimized${m}code:`,b=document.getElementById("optimize-performance")?.checked??!0,E;switch(b?E=g:E=y,E=l,p){case"openai":{console.log(E);let v=await HV(E,f);return u3(v)}case"local":{console.log("Running "+p),console.log(E);let v=document.getElementById("language-model-local"),S=document.getElementById("local-ip"),w=document.getElementById("local-port"),_=await GV(E,v?.value??"",S?.value??"",w?.value??"");return _.includes("```")?eke(_):_}case"amazon":{console.log("Running "+p),console.log(E);let v=await DQ(E);return u3(v)}case"azure-openai":{console.log("Running "+p),console.log(E);let v=document.getElementById("azure-api-url"),S=document.getElementById("azure-api-model"),w=v?.value??"",_=S?.value??"",A=await MQ(E,f,w,_);return u3(A)}default:return""}}function l3(e,t,n,r){e=unescape(e);let i=r.regions,o=globalThis.profile,s=o.files[e].lines,a=o.files[e].imports.join(`
`),u=s[n.lineno-1].start_region_line,l=s[n.lineno-1].end_region_line,c,f=s[n.lineno-1].line,d;i?(d=s.slice(u-1,l).map(g=>g.line).join(""),c=s.slice(Math.max(0,u-10),Math.min(u-1,s.length)).map(g=>g.line).join("")):(d=f,c=s.slice(Math.max(0,n.lineno-10),Math.min(n.lineno-1,s.length)).map(g=>g.line).join(""));let p=OQ(f)+3,m=__+mx+"&nbsp;".repeat(p-1),h=document.getElementById(`code-${t}-${n.lineno}`);(async()=>{let y=document.getElementById("service-select")?.value??"";if(y==="openai"){let v=document.getElementById("api-key");if(!await qI(v?.value??"")){alert("You must enter a valid OpenAI API key to activate proposed optimizations.");let w=document.getElementById("ai-optimization-options");w&&(w.open=!0);return}}if(y==="local"&&document.getElementById("local-models-list")?.style.display==="none"){alert("You must be connected to a running Ollama server to activate proposed optimizations.");let S=document.getElementById("ai-optimization-options");S&&(S.open=!0);return}h&&(h.innerHTML=`<em>${m}working...</em>`);let x=await tke(a,d,n,c);if(!x){h&&(h.innerHTML="");return}x=x.replace(/\r?\n/g,`
`);let b=x.split(`
`).map(v=>m+Prism.highlight(v,Prism.languages.python,"python")).join("<br />");h&&(h.innerHTML=`<hr><span title="click to copy" style="cursor: copy" id="opt-${t}-${n.lineno}">${b}</span>`);let E=document.getElementById(`opt-${t}-${n.lineno}`);E&&E.addEventListener("click",async v=>{await JCe(v,x),E.style.cursor="auto",await new Promise(S=>setTimeout(S,125)),E.style.cursor="copy"})})()}function LQ(e){let t=localStorage.getItem(e.id);if(t!==null)switch(e.type){case"checkbox":case"radio":e.checked=t==="true";break;default:e.value=t;break}}function UQ(e){e.addEventListener("change",()=>{switch(e.type){case"checkbox":case"radio":localStorage.setItem(e.id,String(e.checked));break;default:localStorage.setItem(e.id,e.value);break}})}function zQ(){let e=document.querySelectorAll(".persistent");e.forEach(t=>{LQ(t)}),e.forEach(t=>{UQ(t)})}var HQ=()=>{new MutationObserver(t=>{t.forEach(n=>{n.addedNodes&&n.addedNodes.forEach(r=>{if(r.nodeType===1){let i=r;if(i.matches&&i.matches(".persistent")){let o=i;LQ(o),o.addEventListener("change",()=>UQ(o))}}})})}).observe(document.body,{childList:!0,subtree:!0})};window.Buffer=jQ.Buffer;window.checkApiKey=GI;function nke(e,t){try{window.acquireVsCodeApi().postMessage({command:"jumpToLine",filePath:e,lineNumber:t})}catch{}}var rke=50,c3={};function ike(e,t,n){l3(e,t,JSON.parse(decodeURIComponent(n)),{regions:!0})}function oke(e,t,n){l3(e,t,JSON.parse(decodeURIComponent(n)),{regions:!1})}var ske="blue",R_="green",gx="goldenrod",_s=[];function ake(e){let t=new Set,n=!1,r=null;for(let i=0;i<e.length;i++){let o=e[i],s=0,a=n;for(;;){let u=o.indexOf("'''",s),l=o.indexOf('"""',s),c=-1,f=null;if(u!==-1&&(l===-1||u<l)?(c=u,f="'''"):l!==-1&&(u===-1||l<u)&&(c=l,f='"""'),c===-1)break;s=c+3,n?r===f&&(n=!1,r=null):(n=!0,r=f)}(a||n)&&t.add(i)}return t}function qQ(e,t,n,r,i,o){let s;i.functions?s="function profile":s="line profile",_s=[{title:["time",""],color:ske,width:0,info:"Execution time (Python + native + system)"}],o&&_s.push({title:["Unused Device","%"],color:"darkred",width:0,info:"Percentage of CPU samples where device was not being utilized concurrently"}),r&&(_s=_s.concat([{title:["memory","peak"],color:R_,width:0,info:"Peak amount of memory allocated by line / function"},{title:["memory","average"],color:R_,width:0,info:"Average amount of memory allocated by line / function"},{title:["memory","timeline"],color:R_,width:0,info:"Memory footprint over time"},{title:["memory","activity"],color:R_,width:0,info:"% of bytes allocated by line / function over total bytes allocated in file"},{title:["copy",""],color:gx,width:0,info:"Rate of copying memory"}])),t&&!o&&(_s.push({title:[n,"util."],color:gx,width:0,info:`% utilization of ${n} by line / function (may be inaccurate if ${n} is not dedicated)`}),_s.push({title:[n,"memory"],color:gx,width:0,info:`Peak ${n} memory allocated by line / function (may be inaccurate if ${n} is not dedicated)`})),o&&(_s.push({title:["NRT","%"],color:"purple",width:0,info:"Neural Runtime percentage"}),_s.push({title:["NC","time"],color:"darkorange",width:0,info:"Neuron Compute time"})),_s.push({title:["",""],color:"black",width:100});let a="";a+='<thead class="thead-light">',a+='<tr data-sort-method="thead">';for(let l of _s)a+=`<th class="F${escape(e)}-nonline"><font style="font-variant: small-caps; text-decoration: underline; width:${l.width}" color=${l.color}>`,l.info?a+=`<a style="cursor:pointer;" title="${l.info}">${l.title[0]}</a>`:a+=`<a style="cursor:pointer;">${l.title[0]}</a>`,a+="</font>&nbsp;&nbsp;</th>";let u;i.functions?u="functionProfile":u="lineProfile",a+=`<th id=${escape(e)+"-"+u} style="width:10000"><font style="font-variant: small-caps; text-decoration: underline">${s}</font><font style="font-size:small; font-style: italic">&nbsp; (click to reset order)</font></th>`,a+="</tr>",a+='<tr data-sort-method="thead">';for(let l of _s)a+=`<th style="width:${l.width}"><em><font style="font-size: small" color=${l.color}>${l.title[1]}</font></em></th>`;return a+=`<th><code>${e}</code></th></tr>`,a+="</thead>",a}function uke(){let e=document.getElementsByClassName("empty-profile");for(let t of e)t.style.display="none"}function lke(){let e=document.getElementsByClassName("empty-profile");for(let t of e)t.style.display===""?t.style.display="none":t.style.display=""}function GQ(e,t,n,r,i,o,s,a,u,l,c,f,d,p,m,h){let g=e.n_cpu_percent_python+e.n_cpu_percent_c+e.n_sys_percent,y=0,x=0,b=!1;for(let te=e.start_region_line;te<e.end_region_line;te++){let ie=i.files[n].lines[te];y+=ie.n_cpu_percent_python+ie.n_cpu_percent_c+ie.n_sys_percent,x+=ie.n_avg_mb+ie.n_peak_mb+ie.memory_samples.length+(ie.n_usage_fraction>=.01?1:0),b=b||e.n_gpu_percent>=1}c&&(g<1&&e.start_region_line===e.end_region_line&&(c=!1),e.start_region_line!==e.end_region_line&&y<1&&(c=!1));let E=e.n_avg_mb+e.n_peak_mb+e.memory_samples.length+(e.n_usage_fraction>=.01?1:0),v=e.n_gpu_percent>=1,S=e.nrt_time_ms!==void 0&&e.nrt_time_ms>0||e.nc_time_ms!==void 0&&e.nc_time_ms>0,w=e.start_region_line,_=e.end_region_line,A,F,R=`${w-1},${_}`;w===_||R in c3?(A=mx,F=!1):(A=o3,w&&_?(c3[R]=!0,F=!0):F=!1),F=F&&_-w<=rke;let D="";g>1||E||v&&i.gpu&&!h||S||F&&w!==_&&(y>=1||x||b&&i.gpu&&!h)?D+="<tr>":D+="<tr class='empty-profile'>";let O=String(g.toFixed(1)).padStart(10," ");if(D+=`<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${O}'>`,D+=`<span style="height: 20; width: 100; vertical-align: middle" id="cpu_bar${o.length}"></span>`,g?o.push(F_(e.n_cpu_percent_python,e.n_cpu_percent_c,e.n_sys_percent,{height:20,width:100})):o.push(null),D+="</td>",h)if((g>=1||S)&&e.cpu_samples_nc_overlap_percent!==void 0){let ie=100-(e.cpu_samples_nc_overlap_percent||0),oe="green";ie>=60?oe="darkred":ie>=30&&(oe="goldenrod"),D+=`<td style="width: 100; vertical-align: middle; padding-right: 8px;" align="right" data-sort='${ie.toFixed(1)}'>`,D+=`<font style="font-size: small" color="${oe}">${ie.toFixed(1)}%&nbsp;&nbsp;&nbsp;</font>`,D+="</td>"}else D+='<td style="width: 100; padding-right: 8px;"></td>';if(i.memory){if(D+=`<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${String(e.n_peak_mb.toFixed(0)).padStart(10,"0")}'>`,D+=`<span style="height: 20; width: 100; vertical-align: middle" id="memory_bar${s.length}"></span>`,e.n_peak_mb?s.push(hx(e.n_peak_mb.toFixed(0),"peak memory",parseFloat(String(e.n_python_fraction)),i.max_footprint_mb.toFixed(2),"darkgreen",{height:20,width:100})):s.push(null),D+=`<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${String(e.n_avg_mb.toFixed(0)).padStart(10,"0")}'>`,D+=`<span style="height: 20; width: 100; vertical-align: middle" id="memory_bar${s.length}"></span>`,D+="</td>",e.n_avg_mb?s.push(hx(e.n_avg_mb.toFixed(0),"average memory",parseFloat(String(e.n_python_fraction)),i.max_footprint_mb.toFixed(2),"darkgreen",{height:20,width:100})):s.push(null),D+="</td>",D+=`<td style='vertical-align: middle; width: 100'><span style="height:20; width: 100; vertical-align: middle" id="memory_sparkline${a.length}"></span>`,D+="</td>",e.memory_samples.length>0){let te=0;if("leaks"in i.files[n]){let ie=i.files[n].leaks;ie&&e.lineno in ie&&(te=ie[e.lineno].velocity_mb_s)}a.push(s3(e.memory_samples,i.elapsed_time_sec*1e9,i.max_footprint_mb,te,{height:20,width:75}))}else a.push(null);D+='<td style="width: 100; vertical-align: middle" align="center">',e.n_usage_fraction>=.01?(D+=`<span style="height: 20; width: 30; vertical-align: middle" id="memory_activity${u.length}"></span>`,u.push(PQ(100*e.n_usage_fraction*(1-parseFloat(String(e.n_python_fraction))),100*e.n_usage_fraction*parseFloat(String(e.n_python_fraction)),{width:30}))):u.push(null),D+="</td>",e.n_copy_mb_s<1?D+='<td style="width: 100"></td>':D+=`<td style="width: 100; vertical-align: middle" align="right"><font style="font-size: small" color="${gx}">${e.n_copy_mb_s.toFixed(0)}&nbsp;&nbsp;&nbsp;</font></td>`}if(i.gpu&&!h)if(e.n_gpu_percent<1?D+='<td style="width: 100"></td>':(D+=`<td style="width: 50; vertical-align: middle" align="right" data-sort="${e.n_gpu_percent}">`,D+=`<span style="height: 20; width: 30; vertical-align: middle" id="gpu_pie${l.length}"></span>`,D+="</td>",l.push(IQ(e.n_gpu_percent,i.gpu_device,{height:20,width:30}))),e.n_gpu_peak_memory_mb<1||e.n_gpu_percent<1)D+='<td style="width: 100"></td>';else{let te=e.n_gpu_peak_memory_mb,ie="MB";te>=1024&&(te/=1024,ie="GB"),D+=`<td style="width: 100; vertical-align: middle" align="right"><font style="font-size: small" color="${gx}">${te.toFixed(0)}${ie}&nbsp;&nbsp;</font></td>`}if(h){if(e.nrt_time_ms!==void 0&&e.nrt_time_ms>0||e.nrt_percent!==void 0&&e.nrt_percent>0){let te=e.nrt_time_ms||e.nrt_percent||0;D+=`<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${te.toFixed(1)}'>`,D+=`<span style="height: 20; width: 100; vertical-align: middle" id="nrt_bar${f.length}"></span>`,D+="</td>",f.push($Q(e.nrt_time_ms||0,i.elapsed_time_sec,{height:20,width:100}))}else D+='<td style="width: 100"></td>',f.push(null);e.nc_time_ms!==void 0&&e.nc_time_ms>0?(D+=`<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${e.nc_time_ms.toFixed(1)}'>`,D+=`<span style="height: 20; width: 100; vertical-align: middle" id="nc_bar${d.length}"></span>`,D+="</td>",d.push(BQ(e.nc_time_ms,i.elapsed_time_sec,{height:20,width:100}))):(D+='<td style="width: 100"></td>',d.push(null))}let T=g||E||v&&i.gpu&&!h||S||_!==w?"":"empty-profile";D+=`<td align="right" class="dummy ${T}" style="vertical-align: middle; width: 50" data-sort="${e.lineno}"><span onclick="vsNavigate('${escape(n)}',${e.lineno})"><font color="gray" style="font-size: 70%; vertical-align: middle" >${e.lineno}&nbsp;</font></span></td>`;let k=c&&F?`${A}&nbsp;`:`${mx}&nbsp;`;e.line=NQ(e.line);let C=de.highlight(e.line,de.languages.python,"python"),N="";t&&(N="token comment"),D+=`<td style="height:10" align="left" bgcolor="whitesmoke" style="vertical-align: middle" data-sort="${e.lineno}">`;let I=structuredClone(e);if(c&&F){let te=0;for(let ie=w;ie<_;ie++){let oe=i.files[n].lines[ie];te+=oe.n_copy_mb*i.elapsed_time_sec,I.n_cpu_percent_python+=oe.n_cpu_percent_python,I.n_cpu_percent_c+=oe.n_cpu_percent_c,I.n_sys_percent+=oe.n_sys_percent,I.n_gpu_percent+=oe.n_gpu_percent,oe.n_peak_mb>I.n_peak_mb&&(I.n_peak_mb=oe.n_peak_mb,I.n_python_fraction=oe.n_python_fraction),I.n_core_utilization+=(oe.n_cpu_percent_python+oe.n_cpu_percent_c)*oe.n_core_utilization}I.n_copy_mb_s=te/i.elapsed_time_sec,D+=`<span style="vertical-align: middle; cursor: pointer" title="Propose an optimization for the entire region starting here." onclick="proposeOptimizationRegion('${escape(n)}', ${r}, '${encodeURIComponent(JSON.stringify(I))}'); event.preventDefault()">${k}</span>`}else D+=k;let L=c?`${i3}`:`${__}`;return c?D+=`<span style="vertical-align: middle; cursor: pointer" title="Propose an optimization for this line." onclick="proposeOptimizationLine('${escape(n)}', ${r}, '${encodeURIComponent(JSON.stringify(e))}'); event.preventDefault()">${L}</span>`:D+=L,D+=`<pre style="height: 10; display: inline; white-space: pre-wrap; overflow-x: auto; border: 0px; vertical-align: middle"><code class="language-python ${N} ${T}">${C}<span id="code-${r}-${e.lineno}" bgcolor="white"></span></code></pre></td>`,D+="</tr>",D}var T_=[];function cke(){for(let e of T_)dke(e)}function fke(){for(let e of T_)pke(e)}function dke(e){let t=document.getElementById(`profile-${e}`);t&&(t.style.display="none");let n=document.getElementById(`button-${e}`);n&&(n.innerHTML=C_)}function pke(e){let t=document.getElementById(`profile-${e}`);t&&(t.style.display="block");let n=document.getElementById(`button-${e}`);n&&(n.innerHTML=k_)}function mke(e){let t=document.getElementById(`profile-${e}`);if(t)if(t.style.display==="block"){t.style.display="none";let n=document.getElementById(`button-${e}`);n&&(n.innerHTML=C_)}else{t.style.display="block";let n=document.getElementById(`button-${e}`);n&&(n.innerHTML=k_)}}String.prototype.padWithNonBreakingSpaces=function(e){let t="&nbsp;",n="",r=this.length*t.length;for(e*=t.length;r<e;)n+=t,r+=t.length;return n+this};async function hke(e){c3={};let t=0,n=0,r=0,i=0,o=0,s={},a={},u={},l={},c={},f={},d={},p=!1;for(let C in e.files){s[C]=0,a[C]=0,u[C]=0,l[C]=0,c[C]=0,f[C]=0,d[C]=0;for(let N in e.files[C].lines){let I=e.files[C].lines[N];s[C]+=I.n_cpu_percent_python,a[C]+=I.n_cpu_percent_c,u[C]+=I.n_sys_percent,I.n_peak_mb>c[C]&&(c[C]=I.n_peak_mb,l[C]+=I.n_peak_mb*I.n_python_fraction),o+=I.n_malloc_mb,I.nc_time_ms!==void 0&&I.nc_time_ms>0&&(f[C]+=I.nc_time_ms,p=!0),I.nrt_time_ms!==void 0&&I.nrt_time_ms>0&&(d[C]+=I.nrt_time_ms,p=!0),I.nrt_percent!==void 0&&I.nrt_percent>0&&(p=!0)}t+=s[C],n+=a[C],r+=u[C],i+=l[C]}let m=window.localStorage.getItem("scalene-api-key");if(m){let C=document.getElementById("api-key");C&&(C.value=m),GI(m)}let h=window.localStorage.getItem("scalene-service-select");if(h){let C=document.getElementById("service-select");C&&(C.value=h),WQ()}let g=document.getElementById("use-gpu-checkbox");if(g&&g.checked!==e.gpu&&g.click(),e.gpu){let C=document.getElementById("accelerator-name");C&&(C.innerHTML=e.gpu_device)}globalThis.profile=e;let y=[],x=[],b=[],E=[],v=[],S=[],w=[],_=0,A="";A+='<span class="row justify-content-center">',A+='<span class="col-auto">',A+='<table width="50%" class="table text-center table-condensed">',A+="<tr>",A+='<td><font style="font-size: small"><b>Time:</b> <font color="darkblue">Python</font> | <font color="#6495ED">native</font> | <font color="blue">system</font><br /></font></td>',A+='<td width="10"></td>',e.memory&&(A+='<td><font style="font-size: small"><b>Memory:</b> <font color="darkgreen">Python</font> | <font color="#50C878">native</font><br /></font></td>',A+='<td width="10"></td>',A+='<td valign="middle" style="vertical-align: middle">',A+=`<font style="font-size: small"><b>Memory timeline: </b>(max: ${_u(e.max_footprint_mb)}, growth: ${e.growth_rate.toFixed(1)}%)</font>`,A+="</td>"),A+="</tr>",A+="<tr>",A+='<td height="10"><span style="height: 20; width: 200; vertical-align: middle" id="cpu_bar0"></span></td>',A+="<td></td>",e.memory&&(A+='<td height="20"><span style="height: 20; width: 150; vertical-align: middle" id="memory_bar0"></span></td>',A+="<td></td>",A+='<td align="left"><span style="vertical-align: middle" id="memory_sparkline0"></span></td>',y.push(s3(e.samples,e.elapsed_time_sec*1e9,e.max_footprint_mb,0,{height:20,width:200}))),A+="</tr>";let F=[];if(F.push(F_(t,n,r,{height:20,width:200})),e.memory&&E.push(hx(e.max_footprint_mb.toFixed(2),"memory",i/o,e.max_footprint_mb.toFixed(2),"darkgreen",{height:20,width:150})),A+='<tr><td colspan="10">',A+='<span class="text-center"><font style="font-size: 90%; font-style: italic; font-color: darkgray">hover over bars to see breakdowns; click on <font style="font-variant:small-caps; text-decoration:underline">column headers</font> to sort.</font></span>',A+="</td></tr>",A+="</table>",A+="</span>",A+="</span>",JSON.stringify(e)==="{}"){A+=`
    <form id="jsonFile" name="jsonFile" enctype="multipart/form-data" method="post">
      <div class="form-group">
	<div class="d-flex justify-content-center">
	  <label for='fileinput' style="padding: 5px 5px; border-radius: 5px; border: 1px ridge black; font-size: 0.8rem; height: auto;">Select a profile (.json)</label>
	  <input style="height: 0; width: 10; opacity:0" type='file' id='fileinput' accept='.json' onchange="loadFile();">
	</div>
      </div>
    </form>
    </div>`;let C=document.getElementById("profile");C&&(C.innerHTML=A);return}A+='<br class="text-left"><span style="font-size: 80%; color: blue; cursor : pointer;" onClick="expandAll()">&nbsp;show all</span> | <span style="font-size: 80%; color: blue; cursor : pointer;" onClick="collapseAll()">hide all</span>',A+=` | <span style="font-size: 80%; color: blue" onClick="document.getElementById('reduce-checkbox').click()">only display profiled lines&nbsp;</span><input type="checkbox" id="reduce-checkbox" checked onClick="toggleReduced()" /></br>`,A+='<div class="container-fluid">';let R=Object.entries(e.files);R.sort((C,N)=>N[1].percent_cpu_time-C[1].percent_cpu_time);let D=0;T_=[];let O=new Set;for(let C of R){if(D++,C[1].percent_cpu_time<1&&c[C[0]]<.01*o){O.add(C);continue}let N=`file-${D}`;T_.push(N),A+='<p class="text-left sticky-top bg-white bg-opacity-75" style="backdrop-filter: blur(2px)">';let I="display:block;",L=k_;if(D!==1&&(I="display:none;",L=C_),A+=`<span style="height: 20; width: 100; vertical-align: middle" id="cpu_bar${F.length}"></span>&nbsp;`,F.push(F_(s[C[0]],a[C[0]],u[C[0]],{height:20,width:100})),e.memory&&(A+=`<span style="height: 20; width: 100; vertical-align: middle" id="memory_bar${E.length}"></span>`,E.push(hx(c[C[0]],"peak memory",l[C[0]]/c[C[0]],e.max_footprint_mb.toFixed(2),"darkgreen",{height:20,width:100}))),A+=`<font style="font-size: 90%">% of time = ${C[1].percent_cpu_time.toFixed(1).padWithNonBreakingSpaces(5)}% (${Vi(C[1].percent_cpu_time/100*e.elapsed_time_sec*1e3).padWithNonBreakingSpaces(8)} / ${Vi(e.elapsed_time_sec*1e3).padWithNonBreakingSpaces(8)})`,p&&d[C[0]]>0){A+=`<br /><span style="height: 20; width: 100; vertical-align: middle" id="nrt_bar${v.length}"></span>&nbsp;`,v.push(a3(d[C[0]],e.elapsed_time_sec,"NRT","purple",{height:20,width:100}));let Oe=d[C[0]]/1e3/e.elapsed_time_sec*100;A+=`% of nrt time = ${Oe.toFixed(1).padWithNonBreakingSpaces(5)}% (${Vi(d[C[0]]).padWithNonBreakingSpaces(8)} / ${Vi(e.elapsed_time_sec*1e3).padWithNonBreakingSpaces(8)})`}if(p&&f[C[0]]>0){A+=`<br /><span style="height: 20; width: 100; vertical-align: middle" id="nc_bar${S.length}"></span>&nbsp;`,S.push(a3(f[C[0]],e.elapsed_time_sec,"NC","darkorange",{height:20,width:100}));let Oe=f[C[0]]/1e3/e.elapsed_time_sec*100;A+=`% of nc time = ${Oe.toFixed(1).padWithNonBreakingSpaces(5)}% (${Vi(f[C[0]]).padWithNonBreakingSpaces(8)} / ${Vi(e.elapsed_time_sec*1e3).padWithNonBreakingSpaces(8)})`}A+="</font>",A+=`<br /><span id="button-${N}" title="Click to show or hide profile." style="cursor: pointer; color: blue;" onClick="toggleDisplay('${N}')">`,A+=`${L}`,A+="</span>",A+=`<code> ${C[0]}</code>`,A+="</p>",A+=`<div style="${I}" id="profile-${N}">`,A+=`<table class="profile table table-hover table-condensed" id="table-${_}">`,_++,A+=qQ(C[0],e.gpu,e.gpu_device,e.memory,{functions:!1},p),A+="<tbody>";let te=C[1].lines.map(Oe=>Oe.line),ie=ake(te),oe=-1,Se=-1;for(let Oe in C[1].lines){Se+=1;let we=C[1].lines[Oe];oe=we.lineno,A+=GQ(we,ie.has(Se),C[0],D,e,F,E,y,x,b,!0,v,S,w,f[C[0]],p)}if(A+="</tbody>",A+="</table>",e.files[C[0]].functions.length){A+=`<table class="profile table table-hover table-condensed" id="table-${_}">`,A+=qQ(C[0],e.gpu,e.gpu_device,e.memory,{functions:!0},p),A+="<tbody>",_++;for(let Oe in e.files[C[0]].functions){let we=e.files[C[0]].functions[Oe];A+=GQ(we,!1,C[0],D,e,F,E,y,x,b,!1,v,S,w,f[C[0]],p)}A+="</table>"}A+="</div>",D<R.length&&(A+="<hr>")}R=R.filter(C=>!O.has(C)),A+="</div>";let T=document.getElementById("profile");T&&(T.innerHTML=A);for(let C of R){let N=document.getElementsByClassName(`F${escape(C[0])}-nonline`);for(let I=0;I<N.length;I++)N[I].addEventListener("click",()=>{let L=document.getElementsByClassName(`F${escape(C[0])}-blankline`);for(let te=0;te<L.length;te++)L[te].style.display="none"})}for(let C of R){let N=document.getElementById(`${escape(C[0])}-lineProfile`);N&&N.addEventListener("click",()=>{let I=document.getElementsByClassName(`F${escape(C[0])}-blankline`);for(let L=0;L<I.length;L++)I[L].style.display==="none"&&(I[L].style.display="block")})}for(let C=0;C<_;C++){let N=document.getElementById(`table-${C}`);N&&new zV(N,{ascending:!0})}y.forEach((C,N)=>{C&&(async()=>await Yy(`#memory_sparkline${N}`,C,{actions:!1,renderer:"svg"}))()});function k(C,N){C.forEach((I,L)=>{I&&(async()=>await Yy(`#${N}${L}`,I,{actions:!1}))()})}if(k(F,"cpu_bar"),k(b,"gpu_pie"),k(x,"memory_activity"),k(E,"memory_bar"),p){for(let C=0;C<v.length;C++)v[C]&&(async()=>await Yy(`#nrt_bar${C}`,v[C],{actions:!1}))();for(let C=0;C<S.length;C++)S[C]&&(async()=>await Yy(`#nc_bar${C}`,S[C],{actions:!1}))()}uke(),e.program?document.title="Scalene - "+e.program:document.title="Scalene"}function yx(e){(async()=>await hke(e))()}function gke(){(async()=>{let t=await(await fetch("profile.json")).json();yx(t)})()}function yke(){let e=document.getElementById("fileinput");if(e&&e.files&&e.files[0]){let t=e.files[0],n=new FileReader;n.onload=xke,n.readAsText(t)}}function xke(e){let t=e.target;if(t&&t.result){let n=t.result,r=JSON.parse(n);yx(r)}}function bke(){yx(example_profile)}function WQ(){let t=document.getElementById("service-select")?.value??"";window.localStorage.setItem("scalene-service-select",t);let n=document.getElementById("openai-fields"),r=document.getElementById("amazon-fields"),i=document.getElementById("local-fields"),o=document.getElementById("azure-openai-fields");n&&(n.style.display=t==="openai"?"block":"none"),r&&(r.style.display=t==="amazon"?"block":"none"),i&&(i.style.display=t==="local"?"block":"none"),o&&(o.style.display=t==="azure-openai"?"block":"none")}function Eke(){let e=document.getElementById("install-models-message"),t=document.getElementById("local-models-list");e&&(e.style.display="block"),t&&(t.style.display="none")}function vke(e){let t=document.createElement("select");return t.style.fontSize="0.8rem",t.id="language-model-local",t.classList.add("persistent"),t.name="language-model-local-label",e.forEach(n=>{let r=document.createElement("option");r.value=n,r.textContent=n,r.id=n,t.appendChild(r)}),t}function wke(){let e=document.getElementById("local-ip"),t=document.getElementById("local-port"),n=e?.value??"127.0.0.1",r=t?.value??"11434";qV(n,r,Eke).then(i=>{let o=vke(i),s=document.getElementById("language-local-models");s?(s.innerHTML="",s.appendChild(o)):console.error('Div with ID "language-local-models" not found.')})}wke();document.addEventListener("DOMContentLoaded",()=>{zQ()});HQ();function Ske(){let e=new XMLHttpRequest;e.open("GET","/heartbeat",!0),e.send()}window.addEventListener("load",()=>{yx(profile)});setInterval(Ske,1e4);window.vsNavigate=nke;window.proposeOptimizationRegion=ike;window.proposeOptimizationLine=oke;window.collapseAll=cke;window.expandAll=fke;window.toggleDisplay=mke;window.toggleReduced=lke;window.load=yx;window.loadFetch=gke;window.loadFile=yke;window.loadDemo=bke;window.toggleServiceFields=WQ;})();
/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

vega-embed/build/vega-embed.module.js:
  (*!
   * https://github.com/Starcounter-Jack/JSON-Patch
   * (c) 2017-2022 Joachim Wester
   * MIT licensed
   *)
  (*!
   * https://github.com/Starcounter-Jack/JSON-Patch
   * (c) 2017-2021 Joachim Wester
   * MIT license
   *)
*/
//# sourceMappingURL=scalene-gui-bundle.js.map
